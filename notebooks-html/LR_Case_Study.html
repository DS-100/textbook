
<div id="ipython-notebook">
    <div class="buttons">
        <button class="interact-button js-nbinteract-widget">
            Show Widgets
        </button>
        <a class="interact-button" href="http://data100.datahub.berkeley.edu/user-redirect/git-pull?repo=https://github.com/DS-100/textbook&subPath=notebooks/ch12/LR_Case_Study.ipynb">Open on DataHub</a></div>
    




<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">&#39;~/notebooks/ch12&#39;</span><span class="p">))</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">def minimize(cost_fn, grad_cost_fn, X, y, alpha=0.2, progress=True):</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    Uses gradient descent to minimize cost_fn. Returns the minimizing value of</span>
<span class="sd">    theta once theta changes less than 0.001 between iterations.</span>
<span class="sd">    &#39;&#39;&#39;</span>
<span class="sd">    theta = np.zeros(X.shape[1])</span>
<span class="sd">    old_cost = 10000000</span>
<span class="sd">    while True:</span>
<span class="sd">        if progress:</span>
<span class="sd">            print(f&#39;theta: {theta} | cost: {cost_fn(theta, X, y):.2f}&#39;)</span>
<span class="sd">        gradient = grad_cost_fn(theta, X, y)</span>
<span class="sd">        new_theta = theta - alpha * gradient</span>
<span class="sd">        cost = cost_fn(theta, X, y)</span>
<span class="sd">        if abs(old_cost - cost) &lt; 10:</span>
<span class="sd">            return new_theta</span>
<span class="sd">        old_cost = cost</span>
<span class="sd">        </span>
<span class="sd">        theta = new_theta</span>
<span class="sd">        </span>
<span class="sd">&quot;&quot;&quot;</span>
        
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">minimize</span> <span class="k">as</span> <span class="n">sci_min</span>

<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">cost_fn</span><span class="p">,</span> <span class="n">grad_cost_fn</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Uses scipy.minimize to minimize cost_fn using a form of gradient descent.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">iters</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">grad_cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">iters</span>
        <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">iters</span> <span class="o">%</span> <span class="n">progress</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;theta: </span><span class="si">{theta}</span><span class="s1"> | cost: {cost_fn(theta, X, y):.2f}&#39;</span><span class="p">)</span>
        <span class="n">iters</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="n">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sci_min</span><span class="p">(</span>
        <span class="n">objective</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BFGS&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_theta</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span>
    <span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Case-Study">Linear Regression Case Study<a class="anchor-link" href="#Linear-Regression-Case-Study">&#182;</a></h2><p>In this section, we perform an end-to-end case study of the application of a linear regression model to a dataset.</p>
<p>The dataset we will be working with is a record of the population and drinking data in various states. The dataset is from this website: <a href="http://people.sc.fsu.edu/~jburkardt/datasets/regression/x20.txt">http://people.sc.fsu.edu/~jburkardt/datasets/regression/x20.txt</a>, with some properties of the dataset changed for didactical purposes.</p>
<p>Our task: predict the cirrhosis death rate using linear regression.</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploring-the-Dataset">Exploring the Dataset<a class="anchor-link" href="#Exploring-the-Dataset">&#182;</a></h2><p>As in any data science project, we'll begin with exploratory data analysis.</p>
<p>We'll start by reading in the dataset using <code>pandas</code>.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;drinking.csv&quot;</span><span class="p">)</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's always a good idea to look at <em>how much</em> data we have by looking at the dimensions of the dataset. An example of how this might be useful: if our data has a large number of observations, it would not be a good idea to print out the whole dataframe.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_text output_subarea output_execute_result">
<pre>(46, 6)</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is small, with only 46 rows of observations and 6 columns. Let's look at what columns we have available to us.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_text output_subarea output_execute_result">
<pre>array([&#39;Bias&#39;, &#39;Urban population (percentage)&#39;,
       &#39;Late births (reciprocal * 100)&#39;, &#39;Wine consumption per capita&#39;,
       &#39;Liquor consumption per capita&#39;, &#39;Cirrhosis death rate&#39;], dtype=object)</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But what do any of these column names mean? Just looking at the column names is not enough because they may be unclear and our assumptions of what they mean can be wrong. Looking at the documentation provided by the source of the dataset, we can create a table describing each column, sometimes referred to as a data dictionary:</p>
<table>
<thead><tr>
<th style="text-align:left">Column</th>
<th style="text-align:left">Description   </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>'Bias'</code></td>
<td style="text-align:left">a column of all 1's</td>
</tr>
<tr>
<td style="text-align:left"><code>'Urban population (percentage)'</code></td>
<td style="text-align:left">the size of the urban population</td>
</tr>
<tr>
<td style="text-align:left"><code>'Late births (reciprocal * 100)'</code></td>
<td style="text-align:left">the reciprocal of the number of births to women between 45 to 49, times 100</td>
</tr>
<tr>
<td style="text-align:left"><code>'Wine consumption per capita'</code></td>
<td style="text-align:left">the consumption of wine per capita</td>
</tr>
<tr>
<td style="text-align:left"><code>'Liquor consumption per capita'</code></td>
<td style="text-align:left">the consumption of hard liquor per capita</td>
</tr>
<tr>
<td style="text-align:left"><code>'Cirrhosis death rate'</code></td>
<td style="text-align:left">the death rate from cirrhosis</td>
</tr>
</tbody>
</table>
<p>At this point, we may want to look up words we do not understand. For example, a quick Google search reveals that cirrhosis is chronic liver disease and can be caused by chronic alcohol abuse. Some of these column names are really long, so it may be convenient to rename some of them later.</p>
<p>Now that we have a good understanding of each of the columns, we can actually start to look at the data. Let's take a quick look at the first few rows of our dataset using the <code>head</code> function.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bias</th>
      <th>Urban population (percentage)</th>
      <th>Late births (reciprocal * 100)</th>
      <th>Wine consumption per capita</th>
      <th>Liquor consumption per capita</th>
      <th>Cirrhosis death rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>44.0</td>
      <td>33.2</td>
      <td>5</td>
      <td>30</td>
      <td>41.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>43.0</td>
      <td>33.8</td>
      <td>4</td>
      <td>41</td>
      <td>31.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>48.0</td>
      <td>40.6</td>
      <td>3</td>
      <td>38</td>
      <td>39.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>52.0</td>
      <td>39.2</td>
      <td>7</td>
      <td>48</td>
      <td>57.5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>71.0</td>
      <td>45.5</td>
      <td>11</td>
      <td>53</td>
      <td>74.8</td>
    </tr>
  </tbody>
</table></div></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we cannot see any null values from the first 5 rows of the dataset, there may be some present in our dataset that we will need to deal with. We can write code to loop through every column of the dataset and tell us if there are null values present using the pandas <code>isnull</code> function.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">cname</span> <span class="ow">in</span> <span class="n">drinking_data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">column</span> <span class="o">=</span> <span class="n">drinking_data</span><span class="p">[</span><span class="n">cname</span><span class="p">]</span> <span class="c1"># Get the column corresponding to that column name</span>
    <span class="n">null_mask</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="c1"># Get a mask that is True if there is a null value present, False otherwise</span>
    <span class="n">nulls_series</span> <span class="o">=</span> <span class="n">column</span><span class="p">[</span><span class="n">null_mask</span><span class="p">]</span> <span class="c1"># Get only values where the null value was detected</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nulls_series</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># If a null value was detected</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">nulls_series</span><span class="p">)</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>35   NaN
Name: Urban population (percentage), dtype: float64
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears that there is a null value present in row 35 of our dataset in the <code>Urban population (percentage)</code> column. Let's examine that row more closely:</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">35</span><span class="p">]</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_text output_subarea output_execute_result">
<pre>Bias                                1.0
Urban population (percentage)       NaN
Late births (reciprocal * 100)     53.0
Wine consumption per capita        28.0
Liquor consumption per capita     149.0
Cirrhosis death rate              122.5
Name: 35, dtype: float64</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With null values, we have two options: either drop the row with the null value or try to impute a value in the place of the null. Since we only have one null value in our dataset and it may not be a good idea to try to guess a value because it may negatively influence our linear regression model, we can just drop the row.</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Cleaning">Data Cleaning<a class="anchor-link" href="#Data-Cleaning">&#182;</a></h2></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's rename the column names to shorter names. It will make our code look cleaner and easier to read. We can make a new list of column names and assign <code>drinking_data.columns</code> to this list.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">new_column_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Bias&#39;</span><span class="p">,</span> <span class="s1">&#39;Urban population&#39;</span><span class="p">,</span> <span class="s1">&#39;Late births&#39;</span><span class="p">,</span> <span class="s1">&#39;Wine&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquor&#39;</span><span class="p">,</span> <span class="s1">&#39;Cirrhosis&#39;</span><span class="p">]</span>
<span class="n">drinking_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">new_column_names</span> 
</pre></div></div></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bias</th>
      <th>Urban population</th>
      <th>Late births</th>
      <th>Wine</th>
      <th>Liquor</th>
      <th>Cirrhosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>44.0</td>
      <td>33.2</td>
      <td>5</td>
      <td>30</td>
      <td>41.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>43.0</td>
      <td>33.8</td>
      <td>4</td>
      <td>41</td>
      <td>31.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>48.0</td>
      <td>40.6</td>
      <td>3</td>
      <td>38</td>
      <td>39.4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>44.0</td>
      <td>35.3</td>
      <td>3</td>
      <td>32</td>
      <td>51.6</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1</td>
      <td>63.0</td>
      <td>39.3</td>
      <td>8</td>
      <td>40</td>
      <td>55.7</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1</td>
      <td>58.0</td>
      <td>43.8</td>
      <td>13</td>
      <td>57</td>
      <td>55.5</td>
    </tr>
  </tbody>
</table>
<p>46 rows × 6 columns</p></div></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's deal with that pesky null value.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span> <span class="o">=</span> <span class="n">drinking_data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">drinking_data</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bias</th>
      <th>Urban population</th>
      <th>Late births</th>
      <th>Wine</th>
      <th>Liquor</th>
      <th>Cirrhosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>44.0</td>
      <td>33.2</td>
      <td>5</td>
      <td>30</td>
      <td>41.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>43.0</td>
      <td>33.8</td>
      <td>4</td>
      <td>41</td>
      <td>31.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>48.0</td>
      <td>40.6</td>
      <td>3</td>
      <td>38</td>
      <td>39.4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>44.0</td>
      <td>35.3</td>
      <td>3</td>
      <td>32</td>
      <td>51.6</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1</td>
      <td>63.0</td>
      <td>39.3</td>
      <td>8</td>
      <td>40</td>
      <td>55.7</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1</td>
      <td>58.0</td>
      <td>43.8</td>
      <td>13</td>
      <td>57</td>
      <td>55.5</td>
    </tr>
  </tbody>
</table>
<p>45 rows × 6 columns</p></div></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like it worked! We now have 45 rows instead of 46 rows.</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Visualization">Data Visualization<a class="anchor-link" href="#Data-Visualization">&#182;</a></h2></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we are going to try to create a <em>linear</em> model, we should make sure that all of our predictor variables have a somewhat linear relationship with the target variable of Cirrhosis. Let's plot every predictor variable individually against Cirrhosis.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Urban population&#39;</span><span class="p">],</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Urban population vs. Cirrhosis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Urban population&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cirrhosis&quot;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_26_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This looks like reasonably linear.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Late births&#39;</span><span class="p">],</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Late births vs. Cirrhosis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Late births&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cirrhosis&quot;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_28_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like we have an outlier for late births. Late births and cirrhosis seem to have a pretty strong linear relationship, but because this point is not close to the linear trend at all, this outlier would negatively affect our linear regression model. Thus, we should take this row out of our dataset.</p>
<p>Since we can easily see that this lates births value is less than 10, we can just filter our dataset by selecting only rows where late births is over 10.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">drinking_data</span> <span class="o">=</span> <span class="n">drinking_data</span><span class="p">[</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Late births&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">drinking_data</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">




<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Bias</th>
      <th>Urban population</th>
      <th>Late births</th>
      <th>Wine</th>
      <th>Liquor</th>
      <th>Cirrhosis</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>44.0</td>
      <td>33.2</td>
      <td>5</td>
      <td>30</td>
      <td>41.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>43.0</td>
      <td>33.8</td>
      <td>4</td>
      <td>41</td>
      <td>31.7</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>48.0</td>
      <td>40.6</td>
      <td>3</td>
      <td>38</td>
      <td>39.4</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>1</td>
      <td>44.0</td>
      <td>35.3</td>
      <td>3</td>
      <td>32</td>
      <td>51.6</td>
    </tr>
    <tr>
      <th>44</th>
      <td>1</td>
      <td>63.0</td>
      <td>39.3</td>
      <td>8</td>
      <td>40</td>
      <td>55.7</td>
    </tr>
    <tr>
      <th>45</th>
      <td>1</td>
      <td>58.0</td>
      <td>43.8</td>
      <td>13</td>
      <td>57</td>
      <td>55.5</td>
    </tr>
  </tbody>
</table>
<p>44 rows × 6 columns</p></div></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How does our scatterplot look now without that outlier?</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Late births&#39;</span><span class="p">],</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Late births vs. Cirrhosis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Late births&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cirrhosis&quot;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_32_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much better!</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Wine&#39;</span><span class="p">],</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Wine vs. Cirrhosis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Wine&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cirrhosis&quot;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_34_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This looks like a pretty strong linear relationship between wine and cirrhosis.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Liquor&#39;</span><span class="p">],</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Liquor vs. Cirrhosis&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Liquor&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Cirrhosis&quot;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_36_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There seems to be a somewhat linear relationship between liquor and cirrhosis, though it is definitely not as strong as that between wine and cirrhosis.</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Model">Linear Regression Model<a class="anchor-link" href="#Linear-Regression-Model">&#182;</a></h2><p>Since all variables seem to have a linear relationship with cirrhosis, we can just include all of them in our model.</p>
<p>Our model looks like this:</p>
<p>$$
f_\hat{\theta} (x) = \hat{\theta_0} + \hat{\theta_1} (Urban population) + \hat{\theta_2} (Late births) + \hat{\theta_3} (Wine) + \hat{\theta_3} (Liquor)
$$</p>
<p>Remember, the $\hat{\theta_0}$ is accounted for due to the bias column in our dataframe.</p>
<p>Here are the functions we defined earlier in the multiple linear regression section, which we will use again:</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns predictions by a linear model on x_vals.&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">X</span> <span class="o">@</span> <span class="n">thetas</span>

<span class="k">def</span> <span class="nf">mse_cost</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_mse_cost</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span>  <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span> <span class="o">@</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to use the above functions, we need <code>X</code>, and <code>y</code>. These can both be obtained from our dataframe. Remember that <code>X</code> and <code>y</code> have to be numpy matrices in order to be able to multiply them with <code>@</code> notation.</p>
<p><code>X</code> consists of all columns of the dataframe except for the target column, <code>Cirrhosis</code>.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">(</span><span class="n">drinking_data</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">&#39;Bias&#39;</span><span class="p">,</span> <span class="s1">&#39;Urban population&#39;</span><span class="p">,</span> <span class="s1">&#39;Late births&#39;</span><span class="p">,</span> <span class="s1">&#39;Wine&#39;</span><span class="p">,</span> <span class="s1">&#39;Liquor&#39;</span> <span class="p">]]</span>
     <span class="o">.</span><span class="n">as_matrix</span><span class="p">())</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>y</code> consists of the <code>Cirrhosis</code> column of our dataset.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we just need to call the <code>minimize</code> function defined in a previous section.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thetas</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">mse_cost</span><span class="p">,</span> <span class="n">grad_mse_cost</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">



<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: [ 0.  0.  0.  0.  0.] | cost: 4217.20
theta: [ 0.01  0.64  0.45  0.14  0.63] | cost: 999.01
theta: [ 0.    1.    0.39  0.59  0.21] | cost: 955.60
theta: [-0.02  0.86  0.1   1.58  0.34] | cost: 902.97
theta: [-0.01  0.41  0.82  2.13  0.13] | cost: 809.45
theta: [-0.08  0.55  0.54  1.86  0.19] | cost: 634.59
theta: [-0.33  0.43  0.63  1.86  0.11] | cost: 339.56
theta: [-1.26  0.22  0.76  1.8  -0.01] | cost: 98.33
theta: [-3.18  0.2   0.85  1.81 -0.02] | cost: 97.67
theta: [-7.49  0.17  1.01  1.81 -0.04] | cost: 96.69
theta: [-11.19   0.14   1.16   1.81  -0.05] | cost: 96.43
theta: [-11.19   0.14   1.16   1.81  -0.05] | cost: 96.43
theta: [-11.19   0.14   1.16   1.81  -0.05] | cost: 96.43
theta: [-11.19   0.14   1.16   1.81  -0.05] | cost: 96.43
</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like gradient descent converged to those theta values! Thus, our linear model is:</p>
<p>$y = -11.19 + 0.14x_1 + 1.16x_2 + 1.81x_3 - 0.05x_4$</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compare this equation that we obtained to the one we would get if we had used <code>sklearn</code>'s LinearRegression model instead.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_text output_subarea output_execute_result">
<pre>array([ 0.  ,  0.14,  1.16,  1.81, -0.05])</pre></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The coefficients look pretty similar! Our homemade functions create the same model as an established Python package!</p></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluating-our-Model">Evaluating our Model<a class="anchor-link" href="#Evaluating-our-Model">&#182;</a></h2></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have a model, let's see how well it does on our dataset by plotting a residual plot of the percent error between the predicted Cirrhosis death rate values and the actual Cirrhosis death rate values.</p></div></div></div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell"
  style="display:none;"
>
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">resid_prop</span> <span class="o">=</span> <span class="n">resid</span> <span class="o">/</span> <span class="n">drinking_data</span><span class="p">[</span><span class="s1">&#39;Cirrhosis&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid_prop</span><span class="p">)),</span> <span class="n">resid_prop</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Residual proportions (resid / actual Cirrhosis death rate)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Index of row in data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error proportion&#39;</span><span class="p">);</span>
</pre></div></div></div></div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">





<div class="output_png output_subarea ">
<img src="/notebooks-images/LR_Case_Study_52_0.png"
></div></div></div></div></div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like our linear model does pretty well when it predicts something higher than the actual value (it is usually within 25% of the correct value), but our model can do pretty abysmally when it predicts something lower than the actual value (there are a good number of error proportions around and above 30%).</p>
<p>As we can tell from the residual plot, our model is subpar. We can hypothesize why our model is not doing well:</p>
<p>1) We don't have enough data (only 44 rows of observations)</p>
<p>2) A better model fits the data.</p>
<p>Regardless, we have successfully fit a linear regression model to the data! Nice!</p></div></div></div></div>
