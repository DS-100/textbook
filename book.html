---
layout: single_page
---

{% raw %}
<h1>Principles and Techniques of Data Science</h1>

<p><strong>By <a href="http://www.samlau.me/">Sam Lau</a>, <a href="https://www.stat.berkeley.edu/~nolan/">Deb Nolan</a>, and <a href="https://people.eecs.berkeley.edu/~jegonzal/">Joey Gonzalez</a>.</strong></p>

<p>This is the textbook for
<a href="http://www.ds100.org/">Data 100, the Principles and Techniques of Data Science course at UC Berkeley</a>.</p>

<p>Data 100 is the upper-division, semester-long data science course that follows
<a href="http://data8.org/">Data 8, the Foundations of Data Science</a>. The reader's assumed
background is detailed in the <a href="/about_this_book">About This Book</a> page.</p>

<p>The contents of this book are licensed for free consumption under the following license:
<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)</a></p>

<p>To set up the textbook for local development, see the <a href="https://github.com/DS-100/textbook/blob/master/SETUP.md">the setup guide</a>.</p>
<h2>About This Book</h2>

<p>In this book, we will proceed as though the reader is comfortable with the
knowledge presented in <a href="http://data8.org/">Data 8</a> or some equivalent. In particular, we
will assume that the reader is familiar with the following topics (links to
pages from the Data 8 textbook are given in parentheses).</p>

<ul>
<li>Tabular data manipulation: selection, filtering, grouping, joining <a href="https://www.inferentialthinking.com/chapters/08/2/classifying-by-one-variable.html">(link)</a></li>
<li>Basic probability concepts <a href="https://www.inferentialthinking.com/chapters/09/5/finding-probabilities.html">(link)</a></li>
<li>Sampling, empirical distributions of statistics <a href="https://www.inferentialthinking.com/chapters/10/3/empirical-distribution-of-a-statistic.html">(link)</a></li>
<li>Hypothesis testing using bootstrap resampling <a href="https://www.inferentialthinking.com/chapters/13/4/using-confidence-intervals.html">(link)</a></li>
<li>Least squares regression and regression inference <a href="https://www.inferentialthinking.com/chapters/16/2/inference-for-the-true-slope.html">(link)</a></li>
<li>Classification <a href="https://www.inferentialthinking.com/chapters/17/1/nearest-neighbors.html">(link)</a></li>
</ul>

<p>In addition, we assume that the reader has taken a course in computer
programming in Python, such as <a href="https://cs61a.org/">CS61A</a> or some equivalent. We will not
explain Python syntax except in special cases.</p>

<p>Finally, we assume that the reader has basic familiarity with partial
derivatives, gradients, vector algebra, and matrix algebra.</p>

<h3>Notation</h3>

<p>This book covers topics from multiple disciplines. Unfortunately, some of these
disciplines use the same notation to describe different concepts. In order to
prevent headaches, we have devised notation that may differ slightly
from the notation used in your discipline.</p>

<p>A population parameter is denoted by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title">
<title id="MathJax-SVG-1-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>. The model parameter that
minimizes a specified loss function is denoted by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-2-Title">
<title id="MathJax-SVG-2-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>. Typically,
we desire <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.599ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 2841.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-3-Title">
<title id="MathJax-SVG-3-Title"> \hat{\theta} \approx \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-2248" x="861" y="0"></use>
<g transform="translate(1917,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</g>
</svg></span>. We use the plain variable
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-4-Title">
<title id="MathJax-SVG-4-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to denote a model parameter that does not minimize a particular loss
function. For example, we may arbitrarily set <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-5-Title">
<title id="MathJax-SVG-5-Title"> \theta = 16</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</svg></span> in order to
calculate a model's loss at that choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-6-Title">
<title id="MathJax-SVG-6-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. When using gradient
descent to minimize a loss function, we use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.196ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1376 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-7-Title">
<title id="MathJax-SVG-7-Title"> \theta^{(t)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span> to represent the
intermediate values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-8-Title">
<title id="MathJax-SVG-8-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>

<p>We will always use bold lowercase letters for vectors. For example, we
represent a vector of population parameters using
$ \boldsymbol{\theta^*} = [ \theta^*<em>1, \theta^*</em>2, \ldots, \theta^*<em>n ] <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="40.115ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 17271.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-9-Title">
<title id="MathJax-SVG-9-Title">
and a vector of fitted model parameters as
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="529" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="1130" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1653" y="0"></use>
 <use xlink:href="#MJMATHI-76" x="2183" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="2668" y="0"></use>
 <use xlink:href="#MJMATHI-63" x="3135" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="3568" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="3930" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="4415" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="4867" y="0"></use>
 <use xlink:href="#MJMATHI-66" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-66" x="5903" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="6453" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="6799" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="7160" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="7522" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="7988" y="0"></use>
 <use xlink:href="#MJMATHI-6D" x="8512" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="9390" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="9876" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="10399" y="0"></use>
 <use xlink:href="#MJMATHI-6C" x="10866" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="11164" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="11668" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="12197" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="12649" y="0"></use>
 <use xlink:href="#MJMATHI-6D" x="13178" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="14057" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="14523" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="14885" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="15351" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="15803" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="16272" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="16802" y="0"></use>
</g>
</svg></span> \boldsymbol{\hat{\theta}} = [\hat{\theta</em>1}, \hat{\theta<em>2}, \ldots, \hat{\theta</em>n} ] $.</p>

<p>We will always use bold uppercase letters for matrices. For example, we
commonly represent a data matrix using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.215ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 953.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-10-Title">
<title id="MathJax-SVG-10-Title"> \boldsymbol X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-58" x="0" y="0"></use>
</g>
</svg></span>.</p>

<p>We will always use non-bolded uppercase letters for random variables, such as
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-11-Title">
<title id="MathJax-SVG-11-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> or <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-12-Title">
<title id="MathJax-SVG-12-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>.</p>

<p>When discussing the bootstrap, we use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-13-Title">
<title id="MathJax-SVG-13-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> to denote the population
parameter, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-14-Title">
<title id="MathJax-SVG-14-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> to denote the sample test statistic, and
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-15-Title">
<title id="MathJax-SVG-15-Title"> \tilde{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span> to denote a bootstrapped test statistic.</p>
<div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/01'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Data-Science-Lifecycle">The Data Science Lifecycle<a class="anchor-link" href="#The-Data-Science-Lifecycle">¶</a></h1><p>In data science, we use large and diverse data sets to make conclusions about
the world. In this book we discuss principles and techniques of
data science through the dual lens of computational and inferential thinking.
Practically speaking, this involves the following process:</p>
<ol>
<li>Formulating a question or problem</li>
<li>Acquiring and cleaning data</li>
<li>Conducting exploratory data analysis</li>
<li>Using prediction and inference to draw conclusions</li>
</ol>
<p>It is quite common for more questions and problems to emerge after the last
step of this process, and we can thus repeatedly engage in this procedure to
discover new characteristics of our world. This positive feedback loop is so
central to our work that we call it the <strong>data science lifecycle</strong>.</p>
<p>If the data science lifecycle were as easy to conduct as it is to state, there
would be no need for textbooks about the the subject. Fortunately, each of the
steps in the lifecycle contain numerous challenges that reveal powerful and
often surprising insights that form the foundation of making thoughtful
decisions using data.</p>
<p>As in Data 8, we will begin with an example.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/01'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.dtype size changed"</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.ufunc size changed"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Students-of-Data-100">The Students of Data 100<a class="anchor-link" href="#The-Students-of-Data-100">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data science lifecycle involves the following general steps:</p>
<ol>
<li><strong>Question/Problem Formulation:</strong> <ol>
<li>What do we want to know or what problems are we trying to solve?  </li>
<li>What are our hypotheses? </li>
<li>What are our metrics of success? <br><br></li>
</ol>
</li>
<li><strong>Data Acquisition and Cleaning:</strong> <ol>
<li>What data do we have and what data do we need?  </li>
<li>How will we collect more data? </li>
<li>How do we organize the data for analysis?  <br><br></li>
</ol>
</li>
<li><strong>Exploratory Data Analysis:</strong> <ol>
<li>Do we already have relevant data?  </li>
<li>What are the biases, anomalies, or other issues with the data?  </li>
<li>How do we transform the data to enable effective analysis? <br><br></li>
</ol>
</li>
<li><strong>Prediction and Inference:</strong> <ol>
<li>What does the data say about the world?  </li>
<li>Does it answer our questions or accurately solve the problem?  </li>
<li>How robust are our conclusions? <br><br></li>
</ol>
</li>
</ol>
<p>We now demonstrate this process applied to a dataset of student first names from a previous offering of Data 100. In this chapter, we proceed quickly in order to give the reader a general sense of a complete iteration through the lifecycle. In later chapters, we expand on each step in this process to develop a repertoire of skills and principles.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Question-Formulation">Question Formulation<a class="anchor-link" href="#Question-Formulation">¶</a></h3><p>We would like to figure out if the student first names give
us additional information about the students themselves. Although this is a
vague question to ask, it is enough to get us working with our data and we can
make the question more precise as we go.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data-Acquisition-and-Cleaning">Data Acquisition and Cleaning<a class="anchor-link" href="#Data-Acquisition-and-Cleaning">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's begin by looking at our data, the roster of student first names that we've downloaded from a previous offering of Data 100.</p>
<p>Don't worry if you don't understand the code for now; we introduce the libraries in more depth soon. Instead, focus on the process and the charts that we create.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'roster.csv'</span><span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Keeley</td>
<td>Student</td>
</tr>
<tr>
<th>1</th>
<td>John</td>
<td>Student</td>
</tr>
<tr>
<th>2</th>
<td>BRYAN</td>
<td>Student</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>276</th>
<td>Ernesto</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>277</th>
<td>Athan</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>278</th>
<td>Michael</td>
<td>Waitlist Student</td>
</tr>
</tbody>
</table>
<p>279 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can quickly see that there are some quirks in the data. For example, one of the student's names is all uppercase letters. In addition, it is not obvious what the Role column is for.</p>
<p><strong>In Data 100, we will study how to identify anomalies in data and apply corrections.</strong> The differences in capitalization will cause our programs to think that <code>'BRYAN'</code> and <code>'Bryan'</code> are different names when they are identical for our purposes. Let's convert all names to lower case to avoid this.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>keeley</td>
<td>Student</td>
</tr>
<tr>
<th>1</th>
<td>john</td>
<td>Student</td>
</tr>
<tr>
<th>2</th>
<td>bryan</td>
<td>Student</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>276</th>
<td>ernesto</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>277</th>
<td>athan</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>278</th>
<td>michael</td>
<td>Waitlist Student</td>
</tr>
</tbody>
</table>
<p>279 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that our data are in a more useful format, we proceed to exploratory data analysis.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/01'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.dtype size changed"</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.ufunc size changed"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'roster.csv'</span><span class="p">)</span>
<span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploratory-Data-Analysis">Exploratory Data Analysis<a class="anchor-link" href="#Exploratory-Data-Analysis">¶</a></h2><p>The term Exploratory Data Analysis (EDA for short) refers to the process of discovering traits about our data that inform future analysis.</p>
<p>Here's the <code>students</code> table from the previous page:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>keeley</td>
<td>Student</td>
</tr>
<tr>
<th>1</th>
<td>john</td>
<td>Student</td>
</tr>
<tr>
<th>2</th>
<td>bryan</td>
<td>Student</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>276</th>
<td>ernesto</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>277</th>
<td>athan</td>
<td>Waitlist Student</td>
</tr>
<tr>
<th>278</th>
<td>michael</td>
<td>Waitlist Student</td>
</tr>
</tbody>
</table>
<p>279 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are left with a number of questions. How many students are in this roster? What does the <code>Role</code> column mean? We conduct EDA in order to understand our data more thoroughly.</p>
<p>Oftentimes, we explore the data by repeatedly posing questions as we uncover more information.</p>
<p><strong>How many students are in our dataset?</strong></p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"There are"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">students</span><span class="p">),</span> <span class="s2">"students on the roster."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>There are 279 students on the roster.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A natural follow-up question: does this dataset contain the complete list of students? In this case, this table contains all students in one semester's offering of Data 100.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>What is the meaning of the <code>Role</code> field?</strong></p>
<p>We often example the field's data in order to understand the field itself.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'Role'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Role</th>
</tr>
</thead>
<tbody>
<tr>
<th>Student</th>
<td>237</td>
</tr>
<tr>
<th>Waitlist Student</th>
<td>42</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see here that our data contain not only students enrolled in the class at the time but also the students on the waitlist. The <code>Role</code> column tells us whether each student is enrolled.</p>
<p><strong>What about the names?  How can we summarize this field?</strong></p>
<p>In Data 100 we will work with many different kinds of data, including numerical, categorical, and text data. Each type of data has its own set of tools and techniques.</p>
<p>A quick way to start understanding the names is to examine the lengths of the names.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">(),</span>
             <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span>
             <span class="n">axlabel</span><span class="o">=</span><span class="s2">"Number of Characters"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per character'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/lifecycle_students_2_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This visualization shows us that most names are between 3 and 9 characters long. This gives us a chance to check whether our data seem reasonable — if there were many names that were 1 character long we'd have good reason to re-examine our data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="What's-in-a-Name?">What's in a Name?<a class="anchor-link" href="#What's-in-a-Name?">¶</a></h3><p>Although this dataset is rather simple, we will soon see that first names alone can reveal quite a bit about our group of students.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/01'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.dtype size changed"</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">"numpy.ufunc size changed"</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">students</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'roster.csv'</span><span class="p">)</span>
<span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="What's-in-a-Name?">What's in a Name?<a class="anchor-link" href="#What's-in-a-Name?">¶</a></h2><p>So far, we have asked a broad question about our data: "Do the first names of students in Data 100 tell us anything about the class?"</p>
<p>We have cleaned our data by converting all our names to lowercase. During our exploratory data analysis we discovered that our roster contains about 270 names of students in the class and on the waitlist. Most of our first names are between 4 and 8 characters long.</p>
<p>What else can we discover about our class based on their first names? We might consider a single name from our dataset:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'jerry'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this name we can infer that the student is likely a male. We can also take a guess at the student's age. For example, if we happen to know that Jerry was a very popular baby name in 1998, we might guess that this student is around twenty years old.</p>
<p>This thinking gives us two new questions to investigate:</p>
<ol>
<li>"Do the first names of students in Data 100 tell us the distribution of sex in the class?"</li>
<li>"Do the first names of students in Data 100 tell us the distribution of ages in the class?"</li>
</ol>
<p>In order to investigate these questions, we will need a dataset that associates names with sex and year. Conveniently, the US Social Security department hosts such a dataset online (<a href="https://www.ssa.gov/oact/babynames/index.html">https://www.ssa.gov/oact/babynames/index.html</a>). Their dataset records the names given to babies at birth and is thus often referred to as the Baby Names dataset.</p>
<p>We will start by downloading and then loading the dataset into Python. Again, don't worry about understanding the code in this this chapter—focus instead on understanding the overall process.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="n">data_url</span> <span class="o">=</span> <span class="s2">"https://www.ssa.gov/oact/babynames/names.zip"</span>
<span class="n">local_filename</span> <span class="o">=</span> <span class="s2">"babynames.zip"</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">local_filename</span><span class="p">):</span> <span class="c1"># if the data exists don't download again</span>
    <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">data_url</span><span class="p">)</span> <span class="k">as</span> <span class="n">resp</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="n">babynames</span> <span class="o">=</span> <span class="p">[]</span> 
<span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">local_filename</span><span class="p">,</span> <span class="s2">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
    <span class="n">data_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">zf</span><span class="o">.</span><span class="n">filelist</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">filename</span><span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"txt"</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">extract_year_from_filename</span><span class="p">(</span><span class="n">fn</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">fn</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">7</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">data_files</span><span class="p">:</span>
        <span class="n">year</span> <span class="o">=</span> <span class="n">extract_year_from_filename</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">filename</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">zf</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">fp</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Sex"</span><span class="p">,</span> <span class="s2">"Count"</span><span class="p">])</span>
            <span class="n">df</span><span class="p">[</span><span class="s2">"Year"</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
            <span class="n">babynames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">babynames</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">babynames</span><span class="p">)</span>
<span class="n">babynames</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2081</th>
<td>Verna</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>2082</th>
<td>Winnie</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>2083</th>
<td>Winthrop</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like the dataset contains names, the sex given to the baby, the number of babies with that name, and the year of birth for those babies. To be sure, we check the dataset description from the SSN Office (<a href="https://www.ssa.gov/oact/babynames/background.html">https://www.ssa.gov/oact/babynames/background.html</a>).</p>
<blockquote><p>All names are from Social Security card applications for births that occurred in the United States after 1879. Note  that many people born before 1937 never applied for a Social Security card, so their names are not included in our data. For others who did apply, our records may not show the place of birth, and again their names are not included in our data.</p>
<p>All data are from a 100% sample of our records on Social Security card applications as of March 2017.</p>
</blockquote>
<p>We begin by plotting the number of male and female babies born each year:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pivot_year_name_count</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">babynames</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'Sex'</span><span class="p">,</span>
    <span class="n">values</span><span class="o">=</span><span class="s1">'Count'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">)</span>

<span class="n">pink_blue</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"#E188DB"</span><span class="p">,</span> <span class="s2">"#334FFF"</span><span class="p">]</span>
<span class="k">with</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="n">pink_blue</span><span class="p">)):</span>
    <span class="n">pivot_year_name_count</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s2">"."</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Registered Names vs Year Stratified by Sex"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Names Registered that Year'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/lifecycle_students_3_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The meteoric rise in babies born in the years leading up to 1920 may seem suspicious. A sentence from the quote above helps explain:</p>
<blockquote><p>Note that many people born before 1937 never applied for a Social Security card, so their names are not included in our data. For others who did apply, our records may not show the place of birth, and again their names are not included in our data.</p>
</blockquote>
<p>We can also see the <a href="https://www.wikiwand.com/en/Baby_boomers">baby boomer period</a> quite clearly in the plot above.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inferring-Sex-From-Name">Inferring Sex From Name<a class="anchor-link" href="#Inferring-Sex-From-Name">¶</a></h3><p>Let's use this dataset to estimate the number of females and males in our class. As with our class roster, we begin by lowercasing the names:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">babynames</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">babynames</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
<span class="n">babynames</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2081</th>
<td>verna</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>2082</th>
<td>winnie</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>2083</th>
<td>winthrop</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we count up how many male and female babies were born in total for each name:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sex_counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">babynames</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">'Name'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'Sex'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'Count'</span><span class="p">,</span>
                            <span class="n">aggfunc</span><span class="o">=</span><span class="s1">'sum'</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">margins</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sex_counts</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Sex</th>
<th>F</th>
<th>M</th>
<th>All</th>
</tr>
<tr>
<th>Name</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>aaban</th>
<td>0</td>
<td>96</td>
<td>96</td>
</tr>
<tr>
<th>aabha</th>
<td>35</td>
<td>0</td>
<td>35</td>
</tr>
<tr>
<th>aabid</th>
<td>0</td>
<td>10</td>
<td>10</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>zyyon</th>
<td>0</td>
<td>6</td>
<td>6</td>
</tr>
<tr>
<th>zzyzx</th>
<td>0</td>
<td>5</td>
<td>5</td>
</tr>
<tr>
<th>All</th>
<td>170639571</td>
<td>173894326</td>
<td>344533897</td>
</tr>
</tbody>
</table>
<p>96175 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To determine whether a name is more popular for male or female babies, we can compute the proportion of times the name was given to a female baby.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prop_female</span> <span class="o">=</span> <span class="n">sex_counts</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span> <span class="o">/</span> <span class="n">sex_counts</span><span class="p">[</span><span class="s1">'All'</span><span class="p">]</span>
<span class="n">sex_counts</span><span class="p">[</span><span class="s1">'prop_female'</span><span class="p">]</span> <span class="o">=</span> <span class="n">prop_female</span>
<span class="n">sex_counts</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Sex</th>
<th>F</th>
<th>M</th>
<th>All</th>
<th>prop_female</th>
</tr>
<tr>
<th>Name</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>aaban</th>
<td>0</td>
<td>96</td>
<td>96</td>
<td>0.0</td>
</tr>
<tr>
<th>aabha</th>
<td>35</td>
<td>0</td>
<td>35</td>
<td>1.0</td>
</tr>
<tr>
<th>aabid</th>
<td>0</td>
<td>10</td>
<td>10</td>
<td>0.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>zyyon</th>
<td>0</td>
<td>6</td>
<td>6</td>
<td>0.0</td>
</tr>
<tr>
<th>zzyzx</th>
<td>0</td>
<td>5</td>
<td>5</td>
<td>0.0</td>
</tr>
<tr>
<th>All</th>
<td>170639571</td>
<td>173894326</td>
<td>344533897</td>
<td>0.5</td>
</tr>
</tbody>
</table>
<p>96175 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then define a function that looks up the proportion of female names given a name.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sex_from_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">sex_counts</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">prop</span> <span class="o">=</span> <span class="n">sex_counts</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">'prop_female'</span><span class="p">]</span>
        <span class="k">return</span> <span class="s1">'F'</span> <span class="k">if</span> <span class="n">prop</span> <span class="o">&gt;</span> <span class="mf">0.5</span> <span class="k">else</span> <span class="s1">'M'</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">'Name not in dataset'</span>

<span class="n">sex_from_name</span><span class="p">(</span><span class="s1">'sam'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'M'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Our-First-Widget">Our First Widget<a class="anchor-link" href="#Our-First-Widget">¶</a></h3><p>In this book, we include widgets that allow the reader to interact with functions defined in the book. The widget below displays the output of <code>sex_from_name</code> on a reader-provided name.</p>
<p>Try typing in the name "josephine" and see how the inferred sex changes as more characters are entered.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">interact</span><span class="p">(</span><span class="n">sex_from_name</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'sam'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We mark each name in our class roster with its most likely sex.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'sex'</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">sex_from_name</span><span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Role</th>
<th>sex</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>keeley</td>
<td>Student</td>
<td>F</td>
<td>1998.15</td>
</tr>
<tr>
<th>1</th>
<td>john</td>
<td>Student</td>
<td>M</td>
<td>1951.08</td>
</tr>
<tr>
<th>2</th>
<td>bryan</td>
<td>Student</td>
<td>M</td>
<td>1983.57</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>276</th>
<td>ernesto</td>
<td>Waitlist Student</td>
<td>M</td>
<td>1981.44</td>
</tr>
<tr>
<th>277</th>
<td>athan</td>
<td>Waitlist Student</td>
<td>M</td>
<td>2004.40</td>
</tr>
<tr>
<th>278</th>
<td>michael</td>
<td>Waitlist Student</td>
<td>M</td>
<td>1971.18</td>
</tr>
</tbody>
</table>
<p>279 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now it is easy to estimate how many male and female students we have:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'sex'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>M                      144
F                       92
Name not in dataset     43
Name: sex, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inferring-Age-From-Name">Inferring Age From Name<a class="anchor-link" href="#Inferring-Age-From-Name">¶</a></h3><p>We can proceed in a similar way to estimate the age distribution of the class, mapping each name to its average age in the dataset.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">avg_year</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">group</span><span class="p">[</span><span class="s1">'Count'</span><span class="p">])</span>

<span class="n">avg_years</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">babynames</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">)</span>
    <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">avg_year</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">'avg_year'</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">avg_years</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>avg_year</th>
</tr>
<tr>
<th>Name</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>aaban</th>
<td>2012.57</td>
</tr>
<tr>
<th>aabha</th>
<td>2013.71</td>
</tr>
<tr>
<th>aabid</th>
<td>2009.50</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>zyyanna</th>
<td>2010.00</td>
</tr>
<tr>
<th>zyyon</th>
<td>2014.00</td>
</tr>
<tr>
<th>zzyzx</th>
<td>2010.00</td>
</tr>
</tbody>
</table>
<p>96174 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, we define a function to lookup the average birth year using a given name. We've included a widget for the reader to try out some names. We suggest trying names that seem older (e.g. "Mary") and names that seem newer (e.g. "Beyonce").</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">year_from_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">avg_years</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="s1">'avg_year'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">avg_years</span><span class="o">.</span><span class="n">index</span>
            <span class="k">else</span> <span class="kc">None</span><span class="p">)</span>

<span class="c1"># Generate input box for you to try some names out:</span>
<span class="n">interact</span><span class="p">(</span><span class="n">year_from_name</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">'fernando'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can mark each name in Data 100 with its inferred birth year.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span> <span class="o">=</span> <span class="n">students</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">year_from_name</span><span class="p">)</span>
<span class="n">students</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Role</th>
<th>sex</th>
<th>year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>keeley</td>
<td>Student</td>
<td>F</td>
<td>1998.15</td>
</tr>
<tr>
<th>1</th>
<td>john</td>
<td>Student</td>
<td>M</td>
<td>1951.08</td>
</tr>
<tr>
<th>2</th>
<td>bryan</td>
<td>Student</td>
<td>M</td>
<td>1983.57</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>276</th>
<td>ernesto</td>
<td>Waitlist Student</td>
<td>M</td>
<td>1981.44</td>
</tr>
<tr>
<th>277</th>
<td>athan</td>
<td>Waitlist Student</td>
<td>M</td>
<td>2004.40</td>
</tr>
<tr>
<th>278</th>
<td>michael</td>
<td>Waitlist Student</td>
<td>M</td>
<td>1971.18</td>
</tr>
</tbody>
</table>
<p>279 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, it is easy to plot the distribution of years:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">students</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">());</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/lifecycle_students_3_31_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To compute the average year:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">students</span><span class="p">[</span><span class="s1">'year'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>1983.846741800525</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our class has an average age of 35 years old—nearly twice our expected age in a course for college undergraduates. Why might our estimate be so far off?</p>
<p>As data scientists, we often run into results that don't agree with our expectations. Our constant challenge is to determine whether surprising results are caused by an error in our procedure or by an actual, real-world phenomenon. Since there are no simple recipes to guarantee accurate conclusions, data scientists must equip themselves with guidelines and principles to reduce the likelihood of false discovery.</p>
<p>In this particular case, the most likely explanation for our unexpected result is that most common names have been used for many years. For example, the name John was quite popular throughout the history recorded in our data. We can confirm this by plotting the number of babies given the name "John" each year:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">babynames</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span>
<span class="n">john</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'john'</span><span class="p">]</span>
<span class="n">john</span><span class="p">[</span><span class="n">john</span><span class="p">[</span><span class="s1">'Sex'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'M'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Frequency of "John"'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/lifecycle_students_3_35_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears that the average birth year does not provide an accurate estimate for a given person's age in general. In a few cases, however, a person's first name is quite revealing!</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">babynames</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">'Name'</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span>
<span class="n">kanye</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'kanye'</span><span class="p">]</span>
<span class="n">kanye</span><span class="p">[</span><span class="n">kanye</span><span class="p">[</span><span class="s1">'Sex'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'M'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Frequency of "Kanye"'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/lifecycle_students_3_37_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this chapter, we walk through a complete iteration of the data science lifecycle: question formulation, data manipulation, exploratory data analysis, and prediction. We expand upon each of these steps in the following chapters.</p>
<p>The first half of the book (chapters 1-9) broadly covers the first three steps in the lifecycle and has a strong focus on computation. The second half of the book (chapters 10-18) uses both computational and statistical thinking to cover modeling, inference, and prediction.</p>
<p>As a whole, this book hopes to impart the reader with the principles and techniques of data science.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/02'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Design">Data Design<a class="anchor-link" href="#Data-Design">¶</a></h1><p>Data science would hardly be a discipline without data. It is thus of utmost importance that we begin any data analysis by understanding how our data were collected.</p>
<p>In this chapter we discuss <strong>data design</strong>, the process of data collection. Many well-meaning scientists have drawn premature conclusions because they were not careful enough in understanding their data design. We will use examples and simulations to justify the importance of probability sampling in data science.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/02'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dewey-Defeats-Truman">Dewey Defeats Truman<a class="anchor-link" href="#Dewey-Defeats-Truman">¶</a></h2><p>In the 1948 US Presidential election, New York Governor Thomas Dewey ran
against the incumbent Harry Truman. As usual, a number of polling agencies
conducted polls of voters in order to predict which candidate was more likely
to win the election.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1936:-A-Previous-Polling-Catastrophe">1936: A Previous Polling Catastrophe<a class="anchor-link" href="#1936:-A-Previous-Polling-Catastrophe">¶</a></h3><p>In 1936, three elections prior to 1948, the <em>Literary Digest</em> infamously
predicted a landslide defeat for Franklin Delano Roosevelt. To make this
claim, the magazine polled a sample of over 2 million people based on telephone
and car registrations. As you may know, this sampling scheme suffers from
sampling bias: those with telephones and cars tend to be wealthier than those
without. In this case, the sampling bias was so great that the <em>Literary
Digest</em> thought Roosevelt would only receive 43% of the popular vote when he
ended up with 61% of the popular vote, a difference of almost 20% and the
largest error ever made by a major poll. The <em>Literary Digest</em> went out of
business soon after.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="1948:-The-Gallup-Poll">1948: The Gallup Poll<a class="anchor-link" href="#1948:-The-Gallup-Poll">¶</a></h3><p>Determined to learn from past mistakes, the Gallup Poll used a method called
<em>quota sampling</em> to predict the results of the 1948 election. In their sampling
scheme, each interviewer polled a set number of people from each demographic
class. For example, the interviews were required to interview both males and
females from different ages, ethnicities, and income levels to match the
demographics in the US Census. This ensured that the poll would not leave out
important subgroups of the voting population.</p>
<p>Using this method, the Gallup Poll predicted that Thomas Dewey would earn 5%
more of the popular vote than Harry Truman would. This difference was
significant enough that the <em>Chicago Tribune</em> famously printed the headline
"Dewey Defeats Truman":</p>
<p><img alt="" src="https://github.com/DS-100/textbook/raw/master/assets/Deweytruman12.jpg"></p>
<p>As we know now, Truman ended up winning the election. In fact, he won with 5%
more of the popular vote than Dewey! What went wrong with the Gallup Poll?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Problem-With-Quota-Sampling">The Problem With Quota Sampling<a class="anchor-link" href="#The-Problem-With-Quota-Sampling">¶</a></h3><p>Although quota sampling did help pollsters reduce sampling bias, it introduced
bias in another way. The Gallup Poll told its interviewers that as long as they
fulfilled their quotas they could interview whomever they wished. Here's one
possible explanation for why the interviewers ended up polling a
disproportionate number of Republicans: at the time, Republicans were on
average wealthier and more likely to live in nicer neighborhoods, making them
easier to interview. This observation is supported by the fact that the Gallup
Poll predicted 2-6% more Republican votes than the actual results for the 3
elections prior.</p>
<p>These examples highlight the importance of understanding sampling bias as much
as possible during the data collection process. Both <em>Literary Digest</em> and
Gallup Poll made the mistake of assuming their methods were unbiased when
their sampling schemes were based on human judgement all along.</p>
<p>We now rely on <strong>probability sampling</strong>, a family of sampling methods that
assigns precise probabilities to the appearance of each sample, to reduce bias
as much as possible in our data collection process.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Big-Data?">Big Data?<a class="anchor-link" href="#Big-Data?">¶</a></h3><p>In the age of Big Data, we are tempted to deal with bias by collecting more
data. After all, we know that a census will give us perfect estimates;
shouldn't a very large sample give almost perfect estimates regardless of the
sampling technique?</p>
<p>We will return to this question after discussing probability sampling methods
to compare the two approaches.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="footnotes">
<hr>
<ol></ol>
</div>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/02'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Probability-Overview">Probability Overview<a class="anchor-link" href="#Probability-Overview">¶</a></h2><p>Many fundamental aspects of data science, including data design, rely on uncertain phenomenon. The laws of probability allow us to quantify this uncertainty. In this section, we will provide a quick review of important probability concepts for this course.</p>
<p>Suppose we toss two coins with one side labeled heads (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 888.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-16-Title">
<title id="MathJax-SVG-16-Title">H</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-48" x="0" y="0"></use>
</g>
</svg></span>) and the other labeled tails (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 704.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-17-Title">
<title id="MathJax-SVG-17-Title">T</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
</g>
</svg></span>). We call the action of tossing the coins and observing the results our <strong>experiment</strong>. The <strong>outcome space</strong> <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-18-Title">
<title id="MathJax-SVG-18-Title">\Omega</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3A9" x="0" y="0"></use>
</g>
</svg></span> consists of all the possible outcomes of an experiment. In this experiment, our outcome space consists of the following outcomes: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.003ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10765.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-19-Title">
<title id="MathJax-SVG-19-Title">\Omega = \{HH, HT, TH, TT\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3A9" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-7B" x="2056" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="2557" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="3445" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4334" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="4779" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="5667" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6372" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="6817" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="7521" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="8410" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="8855" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="9560" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="10264" y="0"></use>
</g>
</svg></span>.</p>
<p>An <strong>event</strong> is any subset of the outcome space. For example, "getting one tails and one heads" is an event for the coin toss experiment. This event consists of the outcomes <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.759ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4632.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-20-Title">
<title id="MathJax-SVG-20-Title">\{HT, TH\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="500" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="1389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2093" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="2538" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="3243" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="4131" y="0"></use>
</g>
</svg></span>. We use the notation <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.044ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3894 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-21-Title">
<title id="MathJax-SVG-21-Title">P(\text{event})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMAIN-65"></use>
 <use xlink:href="#MJMAIN-76" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="973" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="1974" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3504" y="0"></use>
</g>
</svg></span> to represent the probability of an event occurring, in this case, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.573ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11441 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-22-Title">
<title id="MathJax-SVG-22-Title">P(\text{one heads and one tails})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-6E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1057" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="1751" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2308" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="3253" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3809" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="4454" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="4954" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="5511" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="6317" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="6818" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7374" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8069" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="8458" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="8959" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="9237" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="9516" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11051" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Probability-of-Events">Probability of Events<a class="anchor-link" href="#Probability-of-Events">¶</a></h2><p>In this course, we will typically deal with outcome spaces where each outcome is equally likely to occur. These spaces have simple probability calculations. The probability of an event occurring is equal to the proportion of outcomes in the event, or the number of outcomes in the event divided by the total number of outcomes in the outcome space:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.698ex" height="8.843ex" style="vertical-align: -3.838ex;" viewBox="0 -2154.8 19245.1 3807.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-23-Title">
<title id="MathJax-SVG-23-Title">
\begin{aligned}
P(\text{event})
&amp;= \frac{\text{# of outcomes in event}}{\text{# of all possible outcomes}} \\
&amp;= \text{proportion of outcomes in event} \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMAIN-65"></use>
 <use xlink:href="#MJMAIN-76" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="973" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="1974" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3504" y="0"></use>
</g>
</g>
<g transform="translate(3883,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="11286" height="60" x="0" y="220"></rect>
<g transform="translate(691,714)">
 <use xlink:href="#MJMAIN-23"></use>
 <use xlink:href="#MJMAIN-6F" x="1083" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="1584" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-75" x="2641" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3197" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="3587" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4031" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="4532" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="5365" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5810" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="6454" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="6733" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7539" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="7984" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="8512" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="8957" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="9513" y="0"></use>
</g>
<g transform="translate(60,-726)">
 <use xlink:href="#MJMAIN-23"></use>
 <use xlink:href="#MJMAIN-6F" x="1083" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="1584" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="2641" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="2919" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3448" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4004" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="4505" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="4899" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="5294" y="0"></use>
 <use xlink:href="#MJMAIN-62" x="5572" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="6129" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="6407" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="7102" y="0"></use>
 <use xlink:href="#MJMAIN-75" x="7602" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8159" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="8548" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8993" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="9493" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="10327" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="10771" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1371)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-70"></use>
 <use xlink:href="#MJMAIN-72" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="949" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="1449" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="2506" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2899" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3288" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="3567" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="4067" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4874" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="5374" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="5931" y="0"></use>
 <use xlink:href="#MJMAIN-75" x="6431" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="6988" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="7377" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="7822" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="8322" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="9156" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="9600" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="10245" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="10523" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="11330" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="11774" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="12303" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="12747" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="13304" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In the coin toss experiment, the events <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.226ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8708.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-24-Title">
<title id="MathJax-SVG-24-Title">\{HH, HT, TH, TT\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="500" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="1389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2277" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="2722" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="3611" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4315" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="4760" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="5465" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6353" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="6799" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="7503" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="8208" y="0"></use>
</g>
</svg></span> are all equally likely to occur. To calculate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.573ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11441 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-25-Title">
<title id="MathJax-SVG-25-Title">P(\text{one heads and one tails})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-6E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1057" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="1751" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2308" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="3253" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3809" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="4454" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="4954" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="5511" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="6317" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="6818" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7374" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8069" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="8458" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="8959" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="9237" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="9516" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11051" y="0"></use>
</g>
</svg></span>, we see that there are two outcomes in the event and four outcomes total:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.518ex" height="5.176ex" style="vertical-align: -1.791ex; margin-bottom: -0.214ex;" viewBox="0 -1365.4 16153.7 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-26-Title">
<title id="MathJax-SVG-26-Title">
\begin{aligned}
P(\text{one heads and one tails}) = \frac{2}{4} = \frac{1}{2}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-73)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-6E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1057" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="1751" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2308" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="3253" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3809" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="4454" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="4954" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="5511" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="6317" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="6818" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7374" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8069" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="8458" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="8959" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="9237" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="9516" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11051" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11718" y="0"></use>
<g transform="translate(12497,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="13913" y="0"></use>
<g transform="translate(14691,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-32" x="60" y="-687"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>There are three fundamental axioms of probability:</p>
<ol>
<li>The probability of an event is a real number between 0 and 1, inclusive: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.566ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7563.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-27-Title">
<title id="MathJax-SVG-27-Title">0 \leq P(\text{event}) \leq 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="778" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1834" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2586" y="0"></use>
<g transform="translate(2975,0)">
 <use xlink:href="#MJMAIN-65"></use>
 <use xlink:href="#MJMAIN-76" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="973" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="1974" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5339" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="6006" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="7062" y="0"></use>
</g>
</svg></span>.</li>
<li>The probability of the entire outcome space is 1: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.494ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4087.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-28-Title">
<title id="MathJax-SVG-28-Title">P(\Omega) = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMAIN-3A9" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1863" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2530" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3587" y="0"></use>
</g>
</svg></span>.</li>
</ol>
<p>The third axiom involves mutually exclusive events.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-or-B">A or B<a class="anchor-link" href="#A-or-B">¶</a></h2><p>We often want to calculate the probability that event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-29-Title">
<title id="MathJax-SVG-29-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> <em>or</em> event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-30-Title">
<title id="MathJax-SVG-30-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occurs. For example, a polling agency might want to know the probability that a randomly selected US citizen is either 17 or 18 years old.</p>
<p>We state that events are <em>mutually exclusive</em> when at most one of them can happen. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-31-Title">
<title id="MathJax-SVG-31-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> is the event that we select an 17-year-old and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-32-Title">
<title id="MathJax-SVG-32-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> is the event that we select a 18-year old, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-33-Title">
<title id="MathJax-SVG-33-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-34-Title">
<title id="MathJax-SVG-34-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are mutually exclusive because a person cannot be both 18 and 19 at the same time.</p>
<p>The probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.644ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4152.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-35-Title">
<title id="MathJax-SVG-35-Title">P(A \cup B)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
</g>
</svg></span> that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-36-Title">
<title id="MathJax-SVG-36-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> or <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-37-Title">
<title id="MathJax-SVG-37-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occurs is simple to calculate when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-38-Title">
<title id="MathJax-SVG-38-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-39-Title">
<title id="MathJax-SVG-39-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are mutually exclusive:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.951ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11604 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-40-Title">
<title id="MathJax-SVG-40-Title">
\begin{aligned}
P(A \cup B) = P(A) + P(B)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4430" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5486" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6237" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="6627" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7377" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7989" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="8990" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9741" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="10131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10890" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>This is the third axiom of probability, the addition rule.</p>
<p>In <a href="https://factfinder.census.gov/faces/tableservices/jsf/pages/productview.xhtml?pid=DEC_10_SF1_QTP2&amp;prodType=table">the 2010 census</a>, 1.4% of US citizens were 17 years old and 1.5% were 18. Thus, for a randomly chosen US citizen in 2010, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.693ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5895.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-41-Title">
<title id="MathJax-SVG-41-Title">P(A) = 0.014</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3615,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1780" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.714ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5904.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-42-Title">
<title id="MathJax-SVG-42-Title">P(B) = 0.015</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1900" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2567" y="0"></use>
<g transform="translate(3624,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
</g>
</svg></span>, giving <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.595ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14895 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-43-Title">
<title id="MathJax-SVG-43-Title"> P(A \cup B) = P(A) + P(B) = 0.029 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4430" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5486" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6237" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="6627" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7377" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7989" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="8990" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9741" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="10131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10890" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11558" y="0"></use>
<g transform="translate(12614,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1780" y="0"></use>
</g>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To understand this rule, consider the following Venn diagram from the <a href="http://prob140.org/textbook/chapters/Chapter_02/01_Addition">Prob 140 textbook</a>:</p>
<p><img alt="addition_venn" src="http://prob140.org/textbook/images/chapters/Chapter_02/01_Addition_2_0.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When events <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-44-Title">
<title id="MathJax-SVG-44-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-45-Title">
<title id="MathJax-SVG-45-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are mutually exclusive, there are no outcomes that appear in both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-46-Title">
<title id="MathJax-SVG-46-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-47-Title">
<title id="MathJax-SVG-47-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span>. Thus, if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-48-Title">
<title id="MathJax-SVG-48-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> has 5 possible outcomes and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-49-Title">
<title id="MathJax-SVG-49-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> has 4 possible outcomes, we know that the event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2621.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-50-Title">
<title id="MathJax-SVG-50-Title">A \cup B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="972" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1862" y="0"></use>
</g>
</svg></span> has 9 possible outcomes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately, when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-51-Title">
<title id="MathJax-SVG-51-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-52-Title">
<title id="MathJax-SVG-52-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are not mutually exclusive, the simple addition rule does not apply. Suppose we want to calculate the probability that in two coin flips, exactly one flip is heads or exactly one flip is tails.</p>
<p>If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-53-Title">
<title id="MathJax-SVG-53-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> is the event that exactly one heads appears, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.054ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 4329 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-54-Title">
<title id="MathJax-SVG-54-Title">P(A) = \frac{2}{4}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3337,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="84" y="-600"></use>
</g>
</g>
</g>
</svg></span> since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-55-Title">
<title id="MathJax-SVG-55-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> consists of the outcomes <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.759ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4632.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-56-Title">
<title id="MathJax-SVG-56-Title">\{ HT, TH \}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="500" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="1389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2093" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="2538" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="3243" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="4131" y="0"></use>
</g>
</svg></span> and there are four outcomes total. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-57-Title">
<title id="MathJax-SVG-57-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> is the event that exactly one heads appears, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.075ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 4338 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-58-Title">
<title id="MathJax-SVG-58-Title">P(B) = \frac{2}{4}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1900" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2567" y="0"></use>
<g transform="translate(3346,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="84" y="-600"></use>
</g>
</g>
</g>
</svg></span> since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-59-Title">
<title id="MathJax-SVG-59-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> consists of the outcomes <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.759ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4632.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-60-Title">
<title id="MathJax-SVG-60-Title">\{ HT, TH \}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="500" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="1389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2093" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="2538" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="3243" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="4131" y="0"></use>
</g>
</svg></span>. However, the event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2621.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-61-Title">
<title id="MathJax-SVG-61-Title">A \cup B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="972" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1862" y="0"></use>
</g>
</svg></span> only contains two outcomes since the outcomes are the same in both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-62-Title">
<title id="MathJax-SVG-62-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-63-Title">
<title id="MathJax-SVG-63-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.401ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 6200.4 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-64-Title">
<title id="MathJax-SVG-64-Title">P(A \cup B) = \frac{1}{2} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4430" y="0"></use>
<g transform="translate(5208,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
</g>
</svg></span>. Blindly applying the addition rule results in an incorrect conclusion. There are outcomes that appear in both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-65-Title">
<title id="MathJax-SVG-65-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-66-Title">
<title id="MathJax-SVG-66-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span>; adding the number of outcomes in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-67-Title">
<title id="MathJax-SVG-67-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-68-Title">
<title id="MathJax-SVG-68-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> counts them twice. In the image below, we illustrate the fact that the overlapping region of the Venn diagram gets shaded twice, once by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-69-Title">
<title id="MathJax-SVG-69-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and once by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-70-Title">
<title id="MathJax-SVG-70-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p><img alt="AB_overlap" src="http://prob140.org/textbook/images/chapters/Chapter_05/01_Bounding_the_Chance_of_a_Union_2_0.png"></p>
<p>To compensate for this overlap, we need to subtract out the the probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.644ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4152.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-71-Title">
<title id="MathJax-SVG-71-Title">P(A \cap B)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-2229" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
</g>
</svg></span> that both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-72-Title">
<title id="MathJax-SVG-72-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-73-Title">
<title id="MathJax-SVG-73-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occur. To calculate the probability that either of two non-mutually exclusive events occurs, we use:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.436ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 16979.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-74-Title">
<title id="MathJax-SVG-74-Title">
\begin{aligned}
P(A \cup B) = P(A) + P(B) - P(A \cap B)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-222A" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4430" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5486" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6237" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="6627" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7377" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7989" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="8990" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9741" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="10131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10890" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="11502" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="12503" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13254" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="13644" y="0"></use>
 <use xlink:href="#MJMAIN-2229" x="14617" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="15506" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="16266" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Notice that when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-75-Title">
<title id="MathJax-SVG-75-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-76-Title">
<title id="MathJax-SVG-76-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are mutually exclusive, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.905ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5987 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-77-Title">
<title id="MathJax-SVG-77-Title"> P(A \cap B) = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-2229" x="2113" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3762" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4430" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="5486" y="0"></use>
</g>
</svg></span> and the equation simplifies to the addition rule above.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-and-B">A and B<a class="anchor-link" href="#A-and-B">¶</a></h2><p>We also often wish to calculate probability that both event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-78-Title">
<title id="MathJax-SVG-78-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-79-Title">
<title id="MathJax-SVG-79-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occur. Suppose we have a class with only three students, whom we'll label as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-80-Title">
<title id="MathJax-SVG-80-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-81-Title">
<title id="MathJax-SVG-81-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-82-Title">
<title id="MathJax-SVG-82-Title">Z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span>. What is the probability that drawing a sample of size 2 without replacement results in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-83-Title">
<title id="MathJax-SVG-83-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>, then <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-84-Title">
<title id="MathJax-SVG-84-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>?</p>
<p>One simple way to calculate this probability is to enumerate the entire outcome space:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.757ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14964.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-85-Title">
<title id="MathJax-SVG-85-Title">
\begin{aligned}
\Omega = \{ XY, XZ, YX, YZ, ZX, ZY \}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3A9" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-7B" x="2056" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2557" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4173" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4618" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="5470" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6194" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="6639" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="7402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="8255" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="8700" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="9464" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="10187" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="10632" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="11356" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="12208" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="12653" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="13377" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="14140" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Since there our event consists of only one outcome:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.157ex" height="5.176ex" style="vertical-align: -1.803ex; margin-bottom: -0.201ex;" viewBox="0 -1365.4 5664.6 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-86-Title">
<title id="MathJax-SVG-86-Title">
\begin{aligned}
P(YX) = \frac{1}{6}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-68)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1904" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2757" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3424" y="0"></use>
<g transform="translate(4202,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also calculate this probability by noticing that this event can be broken down into two events that happen in sequence, the event of drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-87-Title">
<title id="MathJax-SVG-87-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the first student, then the event of drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-88-Title">
<title id="MathJax-SVG-88-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> after drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-89-Title">
<title id="MathJax-SVG-89-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>The probability of drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-90-Title">
<title id="MathJax-SVG-90-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the first student is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.658ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 713.9 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-91-Title">
<title id="MathJax-SVG-91-Title"> \frac{1}{3} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="84" y="-588"></use>
</g>
</g>
</svg></span> since there are three outcomes in the outcome space (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-92-Title">
<title id="MathJax-SVG-92-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-93-Title">
<title id="MathJax-SVG-93-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-94-Title">
<title id="MathJax-SVG-94-Title">Z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span>) and our event only contains one.</p>
<p>After drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-95-Title">
<title id="MathJax-SVG-95-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>, the outcome space of the second event only contains <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.019ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3022.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-96-Title">
<title id="MathJax-SVG-96-Title"> \{ X, Z \} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1353" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="2521" y="0"></use>
</g>
</svg></span>. Thus, the probability of drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-97-Title">
<title id="MathJax-SVG-97-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the second student is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.658ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 713.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-98-Title">
<title id="MathJax-SVG-98-Title"> \frac{1}{2} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
</svg></span>. This probability is called the <em>conditional probability</em> of drawing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-99-Title">
<title id="MathJax-SVG-99-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> second given that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-100-Title">
<title id="MathJax-SVG-100-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> was drawn first. We use the notation <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.709ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3319 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-101-Title">
<title id="MathJax-SVG-101-Title">P(B | A)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1900" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="2179" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2929" y="0"></use>
</g>
</svg></span> to describe the conditional probability of an event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-102-Title">
<title id="MathJax-SVG-102-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occurring given event <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-103-Title">
<title id="MathJax-SVG-103-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> occurs.</p>
<p>Now, observe that:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.991ex" height="13.843ex" style="vertical-align: -6.338ex;" viewBox="0 -3231.2 18510 5960" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-104-Title">
<title id="MathJax-SVG-104-Title">
\begin{aligned}
P(YX) &amp;= \frac{1}{6} \\
&amp;= \frac{1}{3} \cdot \frac{1}{2} \\
&amp;= P(\text{Y first}) * P(\text{X second} | \text{Y first})
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1784)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1904" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2757" y="0"></use>
</g>
</g>
<g transform="translate(3136,0)">
<g transform="translate(0,1784)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-569)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2416" y="0"></use>
<g transform="translate(2695,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-32" x="60" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-2378)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
<g transform="translate(2475,0)">
 <use xlink:href="#MJMAIN-59"></use>
 <use xlink:href="#MJMAIN-66" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1307" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1585" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1978" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2372" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5237" y="0"></use>
 <use xlink:href="#MJMAIN-2217" x="5848" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6571" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7323" y="0"></use>
<g transform="translate(7712,0)">
 <use xlink:href="#MJMAIN-58"></use>
 <use xlink:href="#MJMAIN-73" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1395" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="1839" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="2284" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2784" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="3341" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="11610" y="0"></use>
<g transform="translate(11888,0)">
 <use xlink:href="#MJMAIN-59"></use>
 <use xlink:href="#MJMAIN-66" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1307" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1585" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1978" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2372" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14650" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>This happens to be a general rule of probability, the multiplication rule. For any events <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-105-Title">
<title id="MathJax-SVG-105-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-106-Title">
<title id="MathJax-SVG-106-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span>, the probability that both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-107-Title">
<title id="MathJax-SVG-107-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-108-Title">
<title id="MathJax-SVG-108-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occur is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.918ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10298.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-109-Title">
<title id="MathJax-SVG-109-Title">
\begin{aligned}
P(AB) = P(A) P(B | A)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2651" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3318" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4374" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5126" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="5515" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6266" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6655" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7407" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="7796" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="8556" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="8834" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9585" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In certain cases, two events may be <em>independent</em>. That is, the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-110-Title">
<title id="MathJax-SVG-110-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> occurs does not change after <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-111-Title">
<title id="MathJax-SVG-111-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> occurs. For example, the event that a 6 occurs on a dice roll does not affect the probability that a 5 occurs on the next dice roll. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-112-Title">
<title id="MathJax-SVG-112-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-113-Title">
<title id="MathJax-SVG-113-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> are independent, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.126ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6943.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-114-Title">
<title id="MathJax-SVG-114-Title"> P(B | A) = P(B) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1900" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="2179" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2929" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3596" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4653" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5404" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="5794" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6553" y="0"></use>
</g>
</svg></span>. This simplifies our multiplication rule:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.746ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 22279.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-115-Title">
<title id="MathJax-SVG-115-Title">
\begin{aligned}
P(AB) = P(A)P(B) \qquad \text{For independent $A$ and $B$}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2651" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3318" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4374" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5126" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="5515" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6266" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6655" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7407" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="7796" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8556" y="0"></use>
<g transform="translate(10945,0)">
 <use xlink:href="#MJMAIN-46"></use>
 <use xlink:href="#MJMAIN-6F" x="653" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1154" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1796" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2075" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="2631" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3188" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3632" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="4189" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="4633" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="5190" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="5746" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="6191" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="6747" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="7387" y="0"></use>
<g transform="translate(8137,0)">
 <use xlink:href="#MJMAIN-61" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="1307" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-42" x="10251" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Although this simplification is extremely convenient for calculation, many real-world events are not independent even if their relationship is not obvious at a first glance. For example, the event that a randomly selected US citizen is over 90 years old is not independent from the event that the citizen is male—given that the person is over 90, the person is almost twice as likely to be female than male.</p>
<p>As data scientists, we must examine assumptions of independence very closely! The US housing crash of 2008 might have been avoided if the bankers did not assume that housing markets in different cities moved independently of one another (<a href="https://www.economist.com/schools-brief/2013/09/07/crash-course">link to an Economist article</a>).</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/02'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Probability-Sampling">Probability Sampling<a class="anchor-link" href="#Probability-Sampling">¶</a></h2><p>Unlike convenience sampling, probability sampling allows us to assign a precise
probability to the event that we draw a particular sample. We will begin by
reviewing simple random samples from Data 8, then introduce two alternative
methods of probability sampling: cluster sampling and stratified sampling.</p>
<p>Suppose we have a population of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-116-Title">
<title id="MathJax-SVG-116-Title">6</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-36" x="0" y="0"></use>
</g>
</svg></span> individuals. We've given each individual a
different letter from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.324ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2722.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-117-Title">
<title id="MathJax-SVG-117-Title">A-F</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="972" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="1973" y="0"></use>
</g>
</svg></span>.</p>
<h3 id="Simple-Random-Sample-(SRS)">Simple Random Sample (SRS)<a class="anchor-link" href="#Simple-Random-Sample-(SRS)">¶</a></h3><p>To take an simple random sample of size <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-118-Title">
<title id="MathJax-SVG-118-Title">2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
</g>
</svg></span> from this population, we can write
each letter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.324ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2722.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-119-Title">
<title id="MathJax-SVG-119-Title">A-F</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="972" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="1973" y="0"></use>
</g>
</svg></span> on a single index card, place all the cards into a hat, mix
the cards well, and draw <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-120-Title">
<title id="MathJax-SVG-120-Title">2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
</g>
</svg></span> cards without looking. That is, a SRS is sampling
uniformly at random without replacement.</p>
<p>Here are all possible samples of size 2:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.304ex" height="32.176ex" style="vertical-align: -15.505ex;" viewBox="0 -7177.9 12186.5 13853.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-121-Title">
<title id="MathJax-SVG-121-Title">
\begin{matrix}
AB &amp; BC &amp; CD &amp; DE &amp; EF\\\\
AC&amp;BD&amp;CE&amp;DF&amp;\\\\
AD&amp;BE&amp;CF&amp;&amp;\\\\
AE&amp;BF&amp;&amp;&amp;\\\\
AF&amp;&amp;&amp;&amp;\\\\
\end{matrix}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(34,6250)">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="750" y="0"></use>
</g>
<g transform="translate(34,3450)">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="750" y="0"></use>
</g>
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="750" y="0"></use>
</g>
<g transform="translate(32,-2150)">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="750" y="0"></use>
</g>
<g transform="translate(39,-4950)">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="750" y="0"></use>
</g>
</g>
<g transform="translate(2568,0)">
<g transform="translate(34,6250)">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="759" y="0"></use>
</g>
<g transform="translate(0,3450)">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="759" y="0"></use>
</g>
<g transform="translate(32,650)">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="759" y="0"></use>
</g>
<g transform="translate(39,-2150)">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="759" y="0"></use>
</g>
</g>
<g transform="translate(5156,0)">
<g transform="translate(0,6250)">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="760" y="0"></use>
</g>
<g transform="translate(32,3450)">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="760" y="0"></use>
</g>
<g transform="translate(39,650)">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="760" y="0"></use>
</g>
</g>
<g transform="translate(7745,0)">
<g transform="translate(0,6250)">
 <use xlink:href="#MJMATHI-44" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="828" y="0"></use>
</g>
<g transform="translate(7,3450)">
 <use xlink:href="#MJMATHI-44" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="828" y="0"></use>
</g>
</g>
<g transform="translate(10338,0)">
<g transform="translate(0,6250)">
 <use xlink:href="#MJMATHI-45" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="764" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>There are <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-122-Title">
<title id="MathJax-SVG-122-Title">15</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</svg></span> possible samples of size <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-123-Title">
<title id="MathJax-SVG-123-Title">2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
</g>
</svg></span> from our population of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-124-Title">
<title id="MathJax-SVG-124-Title">6</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-36" x="0" y="0"></use>
</g>
</svg></span>. Another
way to count the number of possible samples is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.56ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 7560.6 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-125-Title">
<title id="MathJax-SVG-125-Title">
\binom{6}{2} = \frac{6!}{2!4!} = 15
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ3-28" x="0" y="-1"></use>
<g transform="translate(736,0)">
 <use xlink:href="#MJMAIN-36" x="0" y="676"></use>
 <use xlink:href="#MJMAIN-32" x="0" y="-686"></use>
</g>
 <use xlink:href="#MJSZ3-29" x="1237" y="-1"></use>
 <use xlink:href="#MJMAIN-3D" x="2251" y="0"></use>
<g transform="translate(3029,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1678" height="60" x="0" y="220"></rect>
<g transform="translate(449,676)">
 <use xlink:href="#MJMAIN-36" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-21" x="500" y="0"></use>
</g>
<g transform="translate(60,-737)">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-21" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-21" x="1279" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="5503" y="0"></use>
<g transform="translate(6559,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span><p>Since in a SRS we sample uniformly at random, each of these <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-126-Title">
<title id="MathJax-SVG-126-Title">15</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</svg></span> samples are
equally likely to be chosen:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.805ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 17138.2 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-127-Title">
<title id="MathJax-SVG-127-Title"> P(AB) = P(CD) = \ldots = P(DF) = \frac{1}{15} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2651" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3318" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4374" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5126" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="5515" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="6276" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7104" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7771" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="8828" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10278" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="11334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12086" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="12475" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="13304" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14053" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14720" y="0"></use>
<g transform="translate(15499,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>We can also use this chance mechanism to answer other questions about the
composition of the sample. For example:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.741ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 11513.6 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-128-Title">
<title id="MathJax-SVG-128-Title"> P(A \text{ in sample}) = \frac{5}{15} = \frac{1}{3}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6901" y="0"></use>
<g transform="translate(7680,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-35" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="9596" y="0"></use>
<g transform="translate(10375,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
</g>
</svg></span><p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-129-Title">
<title id="MathJax-SVG-129-Title">5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-35" x="0" y="0"></use>
</g>
</svg></span> out of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-130-Title">
<title id="MathJax-SVG-130-Title">15</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</svg></span> of the possible samples listed above contain <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-131-Title">
<title id="MathJax-SVG-131-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>By symmetry, we can say:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.963ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 16775.6 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-132-Title">
<title id="MathJax-SVG-132-Title"> P(A \text{ in sample}) = P(F \text{ in sample}) = \frac{1}{3} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6901" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="7958" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8709" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="9099" y="0"></use>
<g transform="translate(9848,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14191" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14858" y="0"></use>
<g transform="translate(15637,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
</g>
</svg></span><p>Another way of computing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.385ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6624 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-133-Title">
<title id="MathJax-SVG-133-Title"> P(A \text{ in sample}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
</g>
</svg></span> is to recognize that for
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-134-Title">
<title id="MathJax-SVG-134-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> to be in the sample, we either need to draw it as the first marble or as
the second marble.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.939ex" height="29.176ex" style="vertical-align: -14.005ex;" viewBox="0 -6532.1 21071 12561.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-135-Title">
<title id="MathJax-SVG-135-Title">
\begin{aligned}
P(A \text{ in sample}) &amp;= P(\text{A is first or A is second}) \\\\
&amp;= P(\text{A is first}) + P(\text{A is second}) \\\\
&amp;= \frac{1}{6} \cdot \frac{5}{5} + \frac{5}{6} \cdot \frac{1}{5} \\\\
&amp;= \frac{1}{3} \\\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,5603)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
</g>
</g>
<g transform="translate(6613,0)">
<g transform="translate(0,5603)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
<g transform="translate(2475,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-69" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="1923" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="2508" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="2901" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3295" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="3935" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4435" y="0"></use>
 <use xlink:href="#MJMAIN-41" x="5078" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="6078" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="6357" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="7001" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7396" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="7840" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8285" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="8785" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="9342" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12373" y="0"></use>
</g>
<g transform="translate(0,2952)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
<g transform="translate(2475,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-69" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="1923" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="2508" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="2901" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3295" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6160" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="6771" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="7772" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8524" y="0"></use>
<g transform="translate(8913,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-69" x="1000" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1923" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2318" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="2762" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="3207" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="3707" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="4264" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="13734" y="0"></use>
</g>
<g transform="translate(0,-242)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2416" y="0"></use>
<g transform="translate(2695,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-35" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-35" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="4000" y="0"></use>
<g transform="translate(4778,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-35" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="6083" y="0"></use>
<g transform="translate(6362,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-35" x="60" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-3895)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><h3 id="Cluster-Sampling">Cluster Sampling<a class="anchor-link" href="#Cluster-Sampling">¶</a></h3><p>In cluster sampling, we divide the population into clusters. Then, we use SRS
to select clusters at random instead of individuals.</p>
<p>As an example, suppose we take our population of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-136-Title">
<title id="MathJax-SVG-136-Title">6</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-36" x="0" y="0"></use>
</g>
</svg></span> individuals and we pair
each of them up: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.889ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10285.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-137-Title">
<title id="MathJax-SVG-137-Title"> (A,B)\quad (C,D) \quad (E,F) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1140" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1585" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2344" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3734" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="4123" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4884" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="5329" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6157" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7547" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="7936" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="8701" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="9146" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9896" y="0"></use>
</g>
</svg></span> to form 3 clusters of 2
individuals. Then, we use SRS to select one cluster to produce a sample of size 2.</p>
<p>As before, we can compute the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-138-Title">
<title id="MathJax-SVG-138-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> is in our sample:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.56ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 16171.6 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-139-Title">
<title id="MathJax-SVG-139-Title"> P(A \text{ in sample}) = P(AB \text{ drawn}) = \frac{1}{3} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6901" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="7958" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8709" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="9099" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="9849" y="0"></use>
<g transform="translate(10609,0)">
 <use xlink:href="#MJMAIN-64" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="806" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1199" y="0"></use>
 <use xlink:href="#MJMAIN-77" x="1699" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2422" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="13587" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14254" y="0"></use>
<g transform="translate(15033,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
</g>
</svg></span><p>Similarly the probability that any particular person appears in our sample is
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.658ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 713.9 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-140-Title">
<title id="MathJax-SVG-140-Title">\frac{1}{3}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="84" y="-588"></use>
</g>
</g>
</svg></span>. Note that this is the same as our SRS. However, we see
differences when we look at the samples themselves. For example, in a SRS the
chance of getting <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.507ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1510 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-141-Title">
<title id="MathJax-SVG-141-Title">AB</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="750" y="0"></use>
</g>
</svg></span> is the same as the chance of getting <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.509ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1511 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-142-Title">
<title id="MathJax-SVG-142-Title">AC</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="750" y="0"></use>
</g>
</svg></span>:
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.48ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 1067.8 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-143-Title">
<title id="MathJax-SVG-143-Title">\frac{1}{15}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="335" y="629"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</g>
</svg></span>. However, with this cluster sampling scheme:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.913ex" height="11.509ex" style="vertical-align: -4.881ex; margin-bottom: -0.29ex;" viewBox="0 -2728.8 5559.6 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-144-Title">
<title id="MathJax-SVG-144-Title">
\begin{aligned}
P(AB) &amp;= \frac{1}{3} \\\\
P(AC) &amp;= 0
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(1,1258)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2651" y="0"></use>
</g>
<g transform="translate(0,-1851)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2652" y="0"></use>
</g>
</g>
<g transform="translate(3031,0)">
<g transform="translate(0,1258)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-33" x="60" y="-686"></use>
</g>
</g>
</g>
<g transform="translate(0,-1851)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-145-Title">
<title id="MathJax-SVG-145-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-146-Title">
<title id="MathJax-SVG-146-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> can never appear in the same sample if we only select one
cluster.</p>
<p>Cluster sampling is still probability sampling since we can assign a
probability to each potential sample. However, the resulting probabilities are
different than using a SRS depending on how the population is clustered.</p>
<p>Why use cluster sampling? Cluster sampling is most useful because it makes
sample collection easier. For example, it is much easier to poll towns of 100
people each than to poll thousands of people distributed across the entire US.
This is the reason why many polling agencies today use forms of cluster
sampling to conduct surveys.</p>
<p>The main downside of cluster sampling is that it tends to produce greater
variation in estimation. This typically means that we take larger samples when
using cluster sampling. Note that the reality is much more complicated than
this, but we will leave the details to a future course on sampling techniques.</p>
<h3 id="Stratified-Sampling">Stratified Sampling<a class="anchor-link" href="#Stratified-Sampling">¶</a></h3><p>In stratified sampling, we divide the population into strata, and then produce
one simple random sample per strata. In both cluster sampling and stratified
sampling we split the population into groups; in cluster sampling we use a
single SRS to select groups whereas in stratified sampling we use multiple
SRS's, one for each group.</p>
<p>We can divide our population of 6 individuals into the following strata:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.427ex" height="9.509ex" style="vertical-align: -4.171ex;" viewBox="0 -2298.3 10517 4094.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-147-Title">
<title id="MathJax-SVG-147-Title">
\begin{matrix}
\text{Strata 1:} &amp; \{A,B,C,D\} \\\\
\text{Strata 2:} &amp; \{E,F\}
\end{matrix}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1401)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-74" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1338" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="1839" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2228" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2979" y="0"></use>
 <use xlink:href="#MJMAIN-3A" x="3479" y="0"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-74" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1338" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="1839" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2228" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2979" y="0"></use>
 <use xlink:href="#MJMAIN-3A" x="3479" y="0"></use>
</g>
</g>
<g transform="translate(4747,0)">
<g transform="translate(0,1401)">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1251" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1696" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2455" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="2900" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3661" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="4106" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="4935" y="0"></use>
</g>
<g transform="translate(1237,-1450)">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1265" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="1710" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="2459" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>We use an SRS to select one individual from each strata to produce a sample of
size <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-148-Title">
<title id="MathJax-SVG-148-Title">2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
</g>
</svg></span>. This gives us the following possible samples:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.216ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 29370.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-149-Title">
<title id="MathJax-SVG-149-Title">
\begin{aligned}
(A,E)\quad (A,F) \quad (B,E) \quad (B,F) \quad (C,E) \quad (C,F)
\quad (D,E) \quad (D,F)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1140" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="1585" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2349" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3739" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="4128" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4879" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="5324" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6073" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7463" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="7852" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="8612" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="9057" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9822" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="11211" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="11601" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="12360" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="12805" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13555" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14944" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="15334" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="16094" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="16539" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17304" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="18693" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="19083" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="19843" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="20289" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21038" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="22428" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="22817" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="23646" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="24091" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="24855" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="26245" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="26634" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="27463" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="27908" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="28657" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Again, we can compute the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-150-Title">
<title id="MathJax-SVG-150-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> is in our sample:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.968ex" height="11.509ex" style="vertical-align: -4.869ex; margin-bottom: -0.302ex;" viewBox="0 -2728.8 20222.1 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-151-Title">
<title id="MathJax-SVG-151-Title">
\begin{aligned}
P(A \text{ in sample}) &amp;= P(A \text{ selected from Strata 1}) \\\\
&amp;= \frac{1}{4}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1796)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1729" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="3063" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3898" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6234" y="0"></use>
</g>
</g>
<g transform="translate(6613,0)">
<g transform="translate(0,1796)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="2475" y="0"></use>
<g transform="translate(3225,0)">
 <use xlink:href="#MJMAIN-73" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="644" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="1089" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1367" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="1812" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2256" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2646" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="3090" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="3897" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4203" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4596" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="5096" y="0"></use>
 <use xlink:href="#MJMAIN-53" x="6180" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="6736" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="7126" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="7518" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8019" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="8408" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="9159" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12885" y="0"></use>
</g>
<g transform="translate(0,-1399)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>However:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.074ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5198.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-152-Title">
<title id="MathJax-SVG-152-Title">
\begin{aligned}
P(AB) &amp;= 0
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-42" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2651" y="0"></use>
</g>
</g>
<g transform="translate(3030,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.743ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 750.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-153-Title">
<title id="MathJax-SVG-153-Title">A</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-41" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 759.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-154-Title">
<title id="MathJax-SVG-154-Title">B</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-42" x="0" y="0"></use>
</g>
</svg></span> cannot appear in the same sample.</p>
<p>Like cluster sampling, stratified sampling is also a probability sampling
method that produces different probabilities depending on the stratification of
the population. Note that like this example, the strata do not have to be the
same size. For example, we can stratify the US by occupation, then take samples
from each strata of size proportional to the distribution of occupations in the
US — if only 0.01% of people in the US are statisticians, we can ensure that
0.01% of our sample will be composed of statisticians. A simple random sample
might miss the poor statisticians altogether!</p>
<p>As you may have figured out, stratified sampling can perhaps be called the
proper way to conduct quota sampling. It allows the researcher to ensure that
subgroups of the population are well-represented in the sample without using
human judgement to select the individuals in the sample. This can often result
in less variation in estimation. However, stratified sampling is sometimes more
difficult to accomplish because we sometimes don't know how large each strata
is. In the previous example we have the advantage of the US census, but other
times we are not so fortunate.</p>
<h2 id="Why-Probability-Sampling?">Why Probability Sampling?<a class="anchor-link" href="#Why-Probability-Sampling?">¶</a></h2><p>As we have seen in Data 8, probability sampling enables us to quantify our
uncertainty about an estimation or prediction. It is only through this
precision that we can conduct inference and hypothesis testing. Be wary when
anyone gives you p-values or confidence levels without a proper explanation of
their sampling techniques.</p>
<p>Now that we understand probability sampling let us see how the humble SRS
compares against "big data".</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/02'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SRS-vs.-&quot;Big-Data&quot;">SRS vs. "Big Data"<a class="anchor-link" href="#SRS-vs.-&quot;Big-Data&quot;">¶</a></h2><p>As we have previously mentioned, it is tempting to do away with our long-winded bias concerns by using huge amounts of data. It is true that collecting a census will by definition produce unbiased estimations. Perhaps bias will no be a longer if we simply collect many data points.</p>
<p>Suppose we are pollsters in 2012 trying to predict the popular vote of the US presidential election, where Barack Obama ran against Mitt Romney. Since today we know the exact outcome of the popular vote, we can compare the predictions of a SRS to the predictions of a large non-random dataset, often called <em>administrative datasets</em> since they are often collected as part of some administrative work.</p>
<p>We will compare a SRS of size 400 to a non-random sample of size 60,000,000. Our non-random sample is nearly 150,000 times larger than our SRS! Since there were about 120,000,000 voters in 2012, we can think of our non-random sample as a survey where half of all voters in the US responded (no actual poll has ever surveyed more than 10,000,000 voters).</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">total</span> <span class="o">=</span> <span class="mi">129085410</span>
<span class="n">obama_true_count</span> <span class="o">=</span> <span class="mi">65915795</span>
<span class="n">romney_true_count</span> <span class="o">=</span> <span class="mi">60933504</span>
<span class="n">obama_true</span> <span class="o">=</span> <span class="n">obama_true_count</span> <span class="o">/</span> <span class="n">total</span>
<span class="n">romney_true</span> <span class="o">=</span> <span class="n">romney_true_count</span> <span class="o">/</span> <span class="n">total</span>

<span class="c1"># 1 percent off</span>
<span class="n">obama_big</span> <span class="o">=</span> <span class="n">obama_true</span> <span class="o">-</span> <span class="mf">0.01</span>
<span class="n">romney_big</span> <span class="o">=</span> <span class="n">romney_true</span> <span class="o">+</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here's a plot comparing the proportions of the non-random sample to the true proportions. The bars labeled <code>truth</code> show the true proportions of votes that each candidate received. The bars labeled <code>big</code> show the proportions from our dataset of 60,000,000 voters.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'truth'</span><span class="p">:</span> <span class="p">[</span><span class="n">obama_true</span><span class="p">,</span> <span class="n">romney_true</span><span class="p">],</span>
    <span class="s1">'big'</span><span class="p">:</span> <span class="p">[</span><span class="n">obama_big</span><span class="p">,</span> <span class="n">romney_big</span><span class="p">],</span>
<span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">'Obama'</span><span class="p">,</span> <span class="s1">'Romney'</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'truth'</span><span class="p">,</span> <span class="s1">'big'</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Truth compared to a big non-random dataset'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Candidate'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion of popular vote'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/design_srs_vs_big_data_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that our large dataset is just slightly biased towards the Republican candidate, just as the Gallup Poll was in 1948. To see this effects of this bias, we simulate taking simple random samples of size 400 from the population and large non-random samples of size 60,000,000. We compute the proportion of votes for Obama in each sample and plot the distribution of proportions.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">srs_size</span> <span class="o">=</span> <span class="mi">400</span>
<span class="n">big_size</span> <span class="o">=</span> <span class="mi">60000000</span>
<span class="n">replications</span> <span class="o">=</span> <span class="mi">10000</span>

<span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="n">prop</span><span class="p">,</span> <span class="n">replications</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">prop</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">replications</span><span class="p">)</span> <span class="o">/</span> <span class="n">size</span>

<span class="n">srs_simulations</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">srs_size</span><span class="p">,</span> <span class="n">obama_true</span><span class="p">,</span> <span class="n">replications</span><span class="p">)</span>
<span class="n">big_simulations</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">big_size</span><span class="p">,</span> <span class="n">obama_big</span><span class="p">,</span> <span class="n">replications</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we plot the simulation results and overlay a red line indicating the true proportion of voters that voted for Obama.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bins</span> <span class="o">=</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">srs_simulations</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'srs'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">big_simulations</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'big'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Proportion of Obama Voters for SRS and Big Data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Proportion'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Percent per unit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.47</span><span class="p">,</span> <span class="mf">0.55</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">obama_true</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'truth'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/design_srs_vs_big_data_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, the SRS distribution is spread out but centered around the true population proportion of Obama voters. The distribution created by the large non-random sample, on the other hand, is very narrow but not a single simulated sample produces the true population proportion. If we attempt to create confidence intervals using the non-random sample, none of them will contain the true population proportion. To make matters worse, the confidence interval will be extremely narrow because the sample is so large. We will be very sure of an ultimately incorrect estimation.</p>
<p>In fact, when our sampling method is biased our estimations will often first become <strong>worse</strong> as we collect more data since we will be more certain about an incorrect result. In order to make accurate estimations using an even slightly biased sampling method, the sample must be nearly as large as the population itself, a typically impractical requirement. <strong>The quality of the data matters much more than its size.</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Takeaways">Takeaways<a class="anchor-link" href="#Takeaways">¶</a></h2><p>Before accepting the results of a data analysis, it pays to carefully inspect the quality of the data. In particular, we must ask the following questions:</p>
<ol>
<li>Is the data a census (does it include the entire population of interest)? If so, we can just compute properties of the population directly without having to use inference.</li>
<li>If the data is a sample, how was the sample collected? To properly conduct inference, the sample should have been collected according to a completely described probability sampling method.</li>
<li>What changes were made to the data before producing results? Do any of these changes affect the quality of the data?</li>
</ol>
<p>For the curious reader interested in a deeper comparison between random and large non-random samples, we suggest watching <a href="https://www.youtube.com/watch?v=yz3jOIHLYhU">this lecture by the statistician Xiao-Li Meng</a>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/03'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Working-with-Tabular-Data">Working with Tabular Data<a class="anchor-link" href="#Working-with-Tabular-Data">¶</a></h1><p>Tabular data, like the datasets we have worked with in Data 8, are one of the
most common and useful forms of data for analysis. We introduce tabular data
manipulation using <code>pandas</code>, the standard Python library for working with
tabular data. Although <code>pandas</code>'s syntax is more challenging to use than the
<code>datascience</code> package used in Data 8, <code>pandas</code> provides significant performance
improvements and is the current tool of choice in both industry and academia
for working with tabular data.</p>
<p>It is more important that you understand the types of useful operations on data
than the exact details of <code>pandas</code> syntax. For example, knowing when to use a
group or a join is more useful than knowing how to call the <code>pandas</code> function
to group data. It is relatively easy to look up the function you need once you
know the right operation to use. All of the table manipulations in this chapter
will also appear again in a new syntax when we cover SQL, so it will help you
to understand them now.</p>
<p>Because we will cover only the most important <code>pandas</code> functions in this
textbook, you should bookmark the <a href="http://pandas.pydata.org/pandas-docs/stable/"><code>pandas</code> documentation</a> for reference
when you conduct your own data analyses.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/03'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Getting-Started">Getting Started<a class="anchor-link" href="#Getting-Started">¶</a></h2><p>In each section of this chapter we will work with the Baby Names dataset from Chapter 1. We will pose a question, break the question down into high-level steps, then translate each step into Python code using <code>pandas</code> DataFrames. We begin by importing <code>pandas</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pd is a common shorthand for pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can read in the data using <code>pd.read_csv</code> (<a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html">docs</a>).</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'babynames.csv'</span><span class="p">)</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1891891</th>
<td>Verna</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>1891892</th>
<td>Winnie</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>1891893</th>
<td>Winthrop</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that for the code above to work, the <code>babynames.csv</code> file must be located in the same directory as this notebook. We can check what files are in the current folder by running <code>ls</code> in a notebook cell:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ls</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>babynames.csv                  indexes_slicing_sorting.ipynb
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we use <code>pandas</code> to read in data, we get a DataFrame. A DataFrame is a tabular data structure where each column is labeled (in this case 'Name', 'Sex', 'Count', 'Year') and each row is labeled (in this case 0, 1, 2, ..., 1891893). The Table introduced in Data 8, however, only has labeled columns.</p>
<p>The labels of a DataFrame are called the <em>indexes</em> of the DataFrame and make many data manipulations easier.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Indexes,-Slicing,-and-Sorting">Indexes, Slicing, and Sorting<a class="anchor-link" href="#Indexes,-Slicing,-and-Sorting">¶</a></h2><p>Let's use <code>pandas</code> to answer the following question:</p>
<p><strong>What were the five most popular baby names in 2016?</strong></p>
<h3 id="Breaking-the-Problem-Down">Breaking the Problem Down<a class="anchor-link" href="#Breaking-the-Problem-Down">¶</a></h3><p>We can decompose this question into the following simpler table manipulations:</p>
<ol>
<li>Slice out the rows for the year 2016.</li>
<li>Sort the rows in descending order by Count.</li>
</ol>
<p>Now, we can express these steps in <code>pandas</code>.</p>
<h3 id="Slicing-using-.loc">Slicing using <code>.loc</code><a class="anchor-link" href="#Slicing-using-.loc">¶</a></h3><p>To select subsets of a DataFrame, we use the <code>.loc</code> slicing syntax. The first argument is the label of the row and the second is the label of the column:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1891891</th>
<td>Verna</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>1891892</th>
<td>Winnie</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
<tr>
<th>1891893</th>
<td>Winthrop</td>
<td>M</td>
<td>5</td>
<td>1883</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">]</span> <span class="c1"># Row labeled 1, Column labeled 'Name'</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'Anna'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To slice out multiple rows or columns, we can use <code>:</code>. Note that <code>.loc</code> slicing is inclusive, unlike Python's slicing.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get rows 1 through 5, columns Name through Count inclusive</span>
<span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'Name'</span><span class="p">:</span><span class="s1">'Count'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
</tr>
<tr>
<th>3</th>
<td>Elizabeth</td>
<td>F</td>
<td>2549</td>
</tr>
<tr>
<th>4</th>
<td>Minnie</td>
<td>F</td>
<td>2243</td>
</tr>
<tr>
<th>5</th>
<td>Margaret</td>
<td>F</td>
<td>2142</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will often want a single column from a DataFrame:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">'Year'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          1884
1          1884
2          1884
           ... 
1891891    1883
1891892    1883
1891893    1883
Name: Year, Length: 1891894, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that when we select a single column, we get a <code>pandas</code> Series. A Series is like a one-dimensional NumPy array since we can perform arithmetic on all the elements at once.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">'Year'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          3768
1          3768
2          3768
           ... 
1891891    3766
1891892    3766
1891893    3766
Name: Year, Length: 1891894, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To select out specific columns, we can pass a list into the <code>.loc</code> slice:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This is a DataFrame again</span>
<span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Year'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>1884</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1891891</th>
<td>Verna</td>
<td>1883</td>
</tr>
<tr>
<th>1891892</th>
<td>Winnie</td>
<td>1883</td>
</tr>
<tr>
<th>1891893</th>
<td>Winthrop</td>
<td>1883</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Selecting columns is common, so there's a shorthand.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shorthand for baby.loc[:, 'Name']</span>
<span class="n">baby</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0              Mary
1              Anna
2              Emma
             ...   
1891891       Verna
1891892      Winnie
1891893    Winthrop
Name: Name, Length: 1891894, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shorthand for baby.loc[:, ['Name', 'Count']]</span>
<span class="n">baby</span><span class="p">[[</span><span class="s1">'Name'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Count</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>9217</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>3860</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>2587</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1891891</th>
<td>Verna</td>
<td>5</td>
</tr>
<tr>
<th>1891892</th>
<td>Winnie</td>
<td>5</td>
</tr>
<tr>
<th>1891893</th>
<td>Winthrop</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Slicing-rows-using-a-predicate">Slicing rows using a predicate<a class="anchor-link" href="#Slicing-rows-using-a-predicate">¶</a></h4><p>To slice out the rows with year 2016, we will first create a Series containing <code>True</code> for each row we want to keep and <code>False</code> for each row we want to drop. This is simple because math and boolean operators on Series are applied to each element in the Series.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Series of years</span>
<span class="n">baby</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          1884
1          1884
2          1884
           ... 
1891891    1883
1891892    1883
1891893    1883
Name: Year, Length: 1891894, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compare each year with 2016</span>
<span class="n">baby</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2016</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          False
1          False
2          False
           ...  
1891891    False
1891892    False
1891893    False
Name: Year, Length: 1891894, dtype: bool</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we have this Series of <code>True</code> and <code>False</code>, we can pass it into <code>.loc</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We are slicing rows, so the boolean Series goes in the first</span>
<span class="c1"># argument to .loc</span>
<span class="n">baby_2016</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">baby</span><span class="p">[</span><span class="s1">'Year'</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2016</span><span class="p">,</span> <span class="p">:]</span>
<span class="n">baby_2016</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>1850880</th>
<td>Emma</td>
<td>F</td>
<td>19414</td>
<td>2016</td>
</tr>
<tr>
<th>1850881</th>
<td>Olivia</td>
<td>F</td>
<td>19246</td>
<td>2016</td>
</tr>
<tr>
<th>1850882</th>
<td>Ava</td>
<td>F</td>
<td>16237</td>
<td>2016</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1883745</th>
<td>Zyahir</td>
<td>M</td>
<td>5</td>
<td>2016</td>
</tr>
<tr>
<th>1883746</th>
<td>Zyel</td>
<td>M</td>
<td>5</td>
<td>2016</td>
</tr>
<tr>
<th>1883747</th>
<td>Zylyn</td>
<td>M</td>
<td>5</td>
<td>2016</td>
</tr>
</tbody>
</table>
<p>32868 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sorting-Rows">Sorting Rows<a class="anchor-link" href="#Sorting-Rows">¶</a></h3><p>The next step is the sort the rows in descending order by 'Count'. We can use the <code>sort_values()</code> function.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sorted_2016</span> <span class="o">=</span> <span class="n">baby_2016</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'Count'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">sorted_2016</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>1850880</th>
<td>Emma</td>
<td>F</td>
<td>19414</td>
<td>2016</td>
</tr>
<tr>
<th>1850881</th>
<td>Olivia</td>
<td>F</td>
<td>19246</td>
<td>2016</td>
</tr>
<tr>
<th>1869637</th>
<td>Noah</td>
<td>M</td>
<td>19015</td>
<td>2016</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1868752</th>
<td>Mikaelyn</td>
<td>F</td>
<td>5</td>
<td>2016</td>
</tr>
<tr>
<th>1868751</th>
<td>Miette</td>
<td>F</td>
<td>5</td>
<td>2016</td>
</tr>
<tr>
<th>1883747</th>
<td>Zylyn</td>
<td>M</td>
<td>5</td>
<td>2016</td>
</tr>
</tbody>
</table>
<p>32868 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we will use <code>.iloc</code> to slice out the first five rows of the DataFrame. <code>.iloc</code> works like <code>.loc</code> but takes in numerical indices instead of labels. It does not include the right endpoint in its slices, like Python's list slicing.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the value in the zeroth row, zeroth column</span>
<span class="n">sorted_2016</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'Emma'</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Get the first five rows</span>
<span class="n">sorted_2016</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>1850880</th>
<td>Emma</td>
<td>F</td>
<td>19414</td>
<td>2016</td>
</tr>
<tr>
<th>1850881</th>
<td>Olivia</td>
<td>F</td>
<td>19246</td>
<td>2016</td>
</tr>
<tr>
<th>1869637</th>
<td>Noah</td>
<td>M</td>
<td>19015</td>
<td>2016</td>
</tr>
<tr>
<th>1869638</th>
<td>Liam</td>
<td>M</td>
<td>18138</td>
<td>2016</td>
</tr>
<tr>
<th>1850882</th>
<td>Ava</td>
<td>F</td>
<td>16237</td>
<td>2016</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="In-Conclusion">In Conclusion<a class="anchor-link" href="#In-Conclusion">¶</a></h2><p>We now have the five most popular baby names in 2016 and learned to express the following operations in <code>pandas</code>:</p>
<table>
<thead><tr>
<th>Operation</th>
<th><code>pandas</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Read a CSV file</td>
<td><code>pd.read_csv()</code></td>
</tr>
<tr>
<td>Slicing using labels or indices</td>
<td><code>.loc</code> and <code>.iloc</code></td>
</tr>
<tr>
<td>Slicing rows using a predicate</td>
<td>Use a boolean-valued Series in <code>.loc</code></td>
</tr>
<tr>
<td>Sorting rows</td>
<td><code>.sort_values()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/03'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Grouping-and-Pivoting">Grouping and Pivoting<a class="anchor-link" href="#Grouping-and-Pivoting">¶</a></h2><p>In this section, we will answer the question:</p>
<p><strong>What were the most popular male and female names in each year?</strong></p>
<p>Here's the Baby Names dataset once again:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'babynames.csv'</span><span class="p">)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># the .head() method outputs the first five rows of the DataFrame</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>3</th>
<td>Elizabeth</td>
<td>F</td>
<td>2549</td>
<td>1884</td>
</tr>
<tr>
<th>4</th>
<td>Minnie</td>
<td>F</td>
<td>2243</td>
<td>1884</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Breaking-the-Problem-Down">Breaking the Problem Down<a class="anchor-link" href="#Breaking-the-Problem-Down">¶</a></h3><p>We should first notice that the question in the previous section has similarities to this one; the question in the previous section restricts names to babies born in 2016 whereas this question asks for names in all years.</p>
<p>We once again decompose this problem into simpler table manipulations.</p>
<ol>
<li>Group the <code>baby</code> DataFrame by 'Year' and 'Sex'.</li>
<li>For each group, compute the most popular name.</li>
</ol>
<p>Recognizing which operation is needed for each problem is sometimes tricky. Usually, a convoluted series of steps will signal to you that there might be a simpler way to express what you want. If we didn't immediately recognize that we needed to group, for example, we might write steps like the following:</p>
<ol>
<li>Loop through each unique year.</li>
<li>For each year, loop through each unique sex.</li>
<li>For each unique year and sex, find the most common name.</li>
</ol>
<p>There is almost always a better alternative to looping over a <code>pandas</code> DataFrame. <strong>In particular, looping over unique values of a DataFrame should usually be replaced with a group.</strong></p>
<h3 id="Grouping">Grouping<a class="anchor-link" href="#Grouping">¶</a></h3><p>To group in <code>pandas</code>. we use the <code>.groupby()</code> method.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.core.groupby.DataFrameGroupBy object at 0x1a14e21f60&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>.groupby()</code> returns a strange-looking <code>DataFrameGroupBy</code> object. We can call <code>.agg()</code> on this object with an aggregation function in order to get a familiar output:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The aggregation function takes in a series of values for each group</span>
<span class="c1"># and outputs a single value</span>
<span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span>

<span class="c1"># Count up number of values for each year. This is equivalent to</span>
<span class="c1"># counting the number of rows where each year appears.</span>
<span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1880</th>
<td>2000</td>
<td>2000</td>
<td>2000</td>
</tr>
<tr>
<th>1881</th>
<td>1935</td>
<td>1935</td>
<td>1935</td>
</tr>
<tr>
<th>1882</th>
<td>2127</td>
<td>2127</td>
<td>2127</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2014</th>
<td>33206</td>
<td>33206</td>
<td>33206</td>
</tr>
<tr>
<th>2015</th>
<td>33063</td>
<td>33063</td>
<td>33063</td>
</tr>
<tr>
<th>2016</th>
<td>32868</td>
<td>32868</td>
<td>32868</td>
</tr>
</tbody>
</table>
<p>137 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You might notice that the <code>length</code> function simply calls the <code>len</code> function, so we can simplify the code above.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1880</th>
<td>2000</td>
<td>2000</td>
<td>2000</td>
</tr>
<tr>
<th>1881</th>
<td>1935</td>
<td>1935</td>
<td>1935</td>
</tr>
<tr>
<th>1882</th>
<td>2127</td>
<td>2127</td>
<td>2127</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2014</th>
<td>33206</td>
<td>33206</td>
<td>33206</td>
</tr>
<tr>
<th>2015</th>
<td>33063</td>
<td>33063</td>
<td>33063</td>
</tr>
<tr>
<th>2016</th>
<td>32868</td>
<td>32868</td>
<td>32868</td>
</tr>
</tbody>
</table>
<p>137 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The aggregation is applied to each column of the DataFrame, producing redundant information. We can restrict the output columns by slicing before grouping.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">year_rows</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[[</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Year'</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
<span class="n">year_rows</span>

<span class="c1"># A further shorthand to accomplish the same result:</span>
<span class="c1">#</span>
<span class="c1"># year_counts = baby[['Year', 'Count']].groupby('Year').count()</span>
<span class="c1">#</span>
<span class="c1"># pandas has shorthands for common aggregation functions, including</span>
<span class="c1"># count, sum, and mean.</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1880</th>
<td>2000</td>
</tr>
<tr>
<th>1881</th>
<td>1935</td>
</tr>
<tr>
<th>1882</th>
<td>2127</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>2014</th>
<td>33206</td>
</tr>
<tr>
<th>2015</th>
<td>33063</td>
</tr>
<tr>
<th>2016</th>
<td>32868</td>
</tr>
</tbody>
</table>
<p>137 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the index of the resulting DataFrame now contains the unique years, so we can slice subsets of years using <code>.loc</code> as before:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Every twentieth year starting at 1880</span>
<span class="n">year_rows</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">1880</span><span class="p">:</span><span class="mi">2016</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1880</th>
<td>2000</td>
</tr>
<tr>
<th>1900</th>
<td>3730</td>
</tr>
<tr>
<th>1920</th>
<td>10755</td>
</tr>
<tr>
<th>1940</th>
<td>8961</td>
</tr>
<tr>
<th>1960</th>
<td>11924</td>
</tr>
<tr>
<th>1980</th>
<td>19440</td>
</tr>
<tr>
<th>2000</th>
<td>29764</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping-on-Multiple-Columns">Grouping on Multiple Columns<a class="anchor-link" href="#Grouping-on-Multiple-Columns">¶</a></h3><p>As we've seen in Data 8, we can group on multiple columns to get groups based on unique pairs of values. To do this, pass in a list of column labels into <code>.groupby()</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grouped_counts</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">grouped_counts</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th>Sex</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">1880</th>
<th>F</th>
<td>90992</td>
</tr>
<tr>
<th>M</th>
<td>110491</td>
</tr>
<tr>
<th>1881</th>
<th>F</th>
<td>91953</td>
</tr>
<tr>
<th>...</th>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>2015</th>
<th>M</th>
<td>1907211</td>
</tr>
<tr>
<th rowspan="2" valign="top">2016</th>
<th>F</th>
<td>1756647</td>
</tr>
<tr>
<th>M</th>
<td>1880674</td>
</tr>
</tbody>
</table>
<p>274 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code above computes the total number of babies born for each year and sex. Let's now use grouping by muliple columns to compute the most popular names for each year and sex. Since the data are already sorted in descending order of Count for each year and sex, we can define an aggregation function that returns the first value in each series. (If the data weren't sorted, we can call <code>sort_values()</code> first.)</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The most popular name is simply the first one that appears in the series</span>
<span class="k">def</span> <span class="nf">most_popular</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">series</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">baby_pop</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="n">most_popular</span><span class="p">)</span>
<span class="n">baby_pop</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Name</th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th>Sex</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">1880</th>
<th>F</th>
<td>Mary</td>
<td>7065</td>
</tr>
<tr>
<th>M</th>
<td>John</td>
<td>9655</td>
</tr>
<tr>
<th>1881</th>
<th>F</th>
<td>Mary</td>
<td>6919</td>
</tr>
<tr>
<th>...</th>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2015</th>
<th>M</th>
<td>Noah</td>
<td>19594</td>
</tr>
<tr>
<th rowspan="2" valign="top">2016</th>
<th>F</th>
<td>Emma</td>
<td>19414</td>
</tr>
<tr>
<th>M</th>
<td>Noah</td>
<td>19015</td>
</tr>
</tbody>
</table>
<p>274 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that grouping by multiple columns results in multiple labels for each row. This is called a "multilevel index" and is tricky to work with. The important thing to know is that <code>.loc</code> takes in a tuple for the row index instead of a single value:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby_pop</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2000</span><span class="p">,</span> <span class="s1">'F'</span><span class="p">),</span> <span class="s1">'Name'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'Emily'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>But <code>.iloc</code> behaves the same as usual since it uses indices instead of labels:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby_pop</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">15</span><span class="p">,</span> <span class="p">:]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Name</th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th>Sex</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">1885</th>
<th>F</th>
<td>Mary</td>
<td>9128</td>
</tr>
<tr>
<th>M</th>
<td>John</td>
<td>8756</td>
</tr>
<tr>
<th rowspan="2" valign="top">1886</th>
<th>F</th>
<td>Mary</td>
<td>9889</td>
</tr>
<tr>
<th>M</th>
<td>John</td>
<td>9026</td>
</tr>
<tr>
<th>1887</th>
<th>F</th>
<td>Mary</td>
<td>9888</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Pivoting">Pivoting<a class="anchor-link" href="#Pivoting">¶</a></h3><p><strong>If you group by two columns, you can often use pivot to present your data in a more convenient format.</strong> Using a pivot lets you use one set of grouped labels as the columns of the resulting table.</p>
<p>To pivot, use the <code>pd.pivot_table()</code> function.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">baby</span><span class="p">,</span>
               <span class="n">index</span><span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span>         <span class="c1"># Index for rows</span>
               <span class="n">columns</span><span class="o">=</span><span class="s1">'Sex'</span><span class="p">,</span>        <span class="c1"># Columns</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">'Name'</span><span class="p">,</span>        <span class="c1"># Values in table</span>
               <span class="n">aggfunc</span><span class="o">=</span><span class="n">most_popular</span><span class="p">)</span> <span class="c1"># Aggregation function</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Sex</th>
<th>F</th>
<th>M</th>
</tr>
<tr>
<th>Year</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1880</th>
<td>Mary</td>
<td>John</td>
</tr>
<tr>
<th>1881</th>
<td>Mary</td>
<td>John</td>
</tr>
<tr>
<th>1882</th>
<td>Mary</td>
<td>John</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2014</th>
<td>Emma</td>
<td>Noah</td>
</tr>
<tr>
<th>2015</th>
<td>Emma</td>
<td>Noah</td>
</tr>
<tr>
<th>2016</th>
<td>Emma</td>
<td>Noah</td>
</tr>
</tbody>
</table>
<p>137 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Compare this result to the <code>baby_pop</code> table that we computed using <code>.groupby()</code>. We can see that the <code>Sex</code> index in <code>baby_pop</code> became the columns of the pivot table.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby_pop</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Name</th>
<th>Count</th>
</tr>
<tr>
<th>Year</th>
<th>Sex</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">1880</th>
<th>F</th>
<td>Mary</td>
<td>7065</td>
</tr>
<tr>
<th>M</th>
<td>John</td>
<td>9655</td>
</tr>
<tr>
<th>1881</th>
<th>F</th>
<td>Mary</td>
<td>6919</td>
</tr>
<tr>
<th>...</th>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>2015</th>
<th>M</th>
<td>Noah</td>
<td>19594</td>
</tr>
<tr>
<th rowspan="2" valign="top">2016</th>
<th>F</th>
<td>Emma</td>
<td>19414</td>
</tr>
<tr>
<th>M</th>
<td>Noah</td>
<td>19015</td>
</tr>
</tbody>
</table>
<p>274 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="In-Conclusion">In Conclusion<a class="anchor-link" href="#In-Conclusion">¶</a></h2><p>We now have the most popular baby names for each sex and year in our dataset and learned to express the following operations in <code>pandas</code>:</p>
<table>
<thead><tr>
<th>Operation</th>
<th><code>pandas</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Group</td>
<td><code>df.groupby(label)</code></td>
</tr>
<tr>
<td>Group by multiple columns</td>
<td><code>df.groupby([label1, label2])</code></td>
</tr>
<tr>
<td>Group and aggregate</td>
<td><code>df.groupby(label).agg(func)</code></td>
</tr>
<tr>
<td>Pivot</td>
<td><code>pd.pivot_table()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/03'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">'fivethirtyeight'</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Apply,-Strings,-and-Plotting">Apply, Strings, and Plotting<a class="anchor-link" href="#Apply,-Strings,-and-Plotting">¶</a></h2><p>In this section, we will answer the question:</p>
<p><strong>Can we use the last letter of a name to predict the sex of the baby?</strong></p>
<p>Here's the Baby Names dataset once again:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'babynames.csv'</span><span class="p">)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="c1"># the .head() method outputs the first five rows of the DataFrame</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
</tr>
<tr>
<th>3</th>
<td>Elizabeth</td>
<td>F</td>
<td>2549</td>
<td>1884</td>
</tr>
<tr>
<th>4</th>
<td>Minnie</td>
<td>F</td>
<td>2243</td>
<td>1884</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Breaking-the-Problem-Down">Breaking the Problem Down<a class="anchor-link" href="#Breaking-the-Problem-Down">¶</a></h3><p>Although there are many ways to see whether prediction is possible, we will use plotting in this section. We can decompose this question into two steps:</p>
<ol>
<li>Compute the last letter of each name.</li>
<li>Group by the last letter and sex, aggregating on Count.</li>
<li>Plot the counts for each sex and letter.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Apply">Apply<a class="anchor-link" href="#Apply">¶</a></h3><p><code>pandas</code> Series contain an <code>.apply()</code> method that takes in a function and applies it to each value in the Series.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">len</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          4
1          4
2          4
          ..
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To extract the last letter of each name, we can define our own function to pass into <code>.apply()</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">last_letter</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">string</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">names</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">last_letter</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          y
1          a
2          a
          ..
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="String-Manipulation">String Manipulation<a class="anchor-link" href="#String-Manipulation">¶</a></h3><p>Although <code>.apply()</code> is flexible, it is often faster to use the built-in string manipulation functions in <code>pandas</code> when dealing with text data.</p>
<p><code>pandas</code> provides access to string manipulation functions using the <code>.str</code> attribute of Series.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="n">baby</span><span class="p">[</span><span class="s1">'Name'</span><span class="p">]</span>
<span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          4
1          4
2          4
          ..
1891891    5
1891892    6
1891893    8
Name: Name, Length: 1891894, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can directly slice out the last letter of each name in a similar way.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0          y
1          a
2          a
          ..
1891891    a
1891892    e
1891893    p
Name: Name, Length: 1891894, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We suggest looking at the docs for the full list of string methods (<a href="https://pandas.pydata.org/pandas-docs/stable/text.html">link</a>).</p>
<p>We can now add this column of last letters to our <code>baby</code> DataFrame.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="p">[</span><span class="s1">'Last'</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Sex</th>
<th>Count</th>
<th>Year</th>
<th>Last</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mary</td>
<td>F</td>
<td>9217</td>
<td>1884</td>
<td>y</td>
</tr>
<tr>
<th>1</th>
<td>Anna</td>
<td>F</td>
<td>3860</td>
<td>1884</td>
<td>a</td>
</tr>
<tr>
<th>2</th>
<td>Emma</td>
<td>F</td>
<td>2587</td>
<td>1884</td>
<td>a</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1891891</th>
<td>Verna</td>
<td>M</td>
<td>5</td>
<td>1883</td>
<td>a</td>
</tr>
<tr>
<th>1891892</th>
<td>Winnie</td>
<td>M</td>
<td>5</td>
<td>1883</td>
<td>e</td>
</tr>
<tr>
<th>1891893</th>
<td>Winthrop</td>
<td>M</td>
<td>5</td>
<td>1883</td>
<td>p</td>
</tr>
</tbody>
</table>
<p>1891894 rows × 5 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Grouping">Grouping<a class="anchor-link" href="#Grouping">¶</a></h3><p>To compute the sex distribution for each last letter, we need to group by both Last and Sex.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shorthand for baby.groupby(['Last', 'Sex']).agg(np.sum)</span>
<span class="n">baby</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
<th>Year</th>
</tr>
<tr>
<th>Last</th>
<th>Sex</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">a</th>
<th>F</th>
<td>58079486</td>
<td>915565667</td>
</tr>
<tr>
<th>M</th>
<td>1931630</td>
<td>53566324</td>
</tr>
<tr>
<th>b</th>
<th>F</th>
<td>17376</td>
<td>1092953</td>
</tr>
<tr>
<th>...</th>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>y</th>
<th>M</th>
<td>18569388</td>
<td>114394474</td>
</tr>
<tr>
<th rowspan="2" valign="top">z</th>
<th>F</th>
<td>142023</td>
<td>4268028</td>
</tr>
<tr>
<th>M</th>
<td>120123</td>
<td>9649274</td>
</tr>
</tbody>
</table>
<p>52 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that <code>Year</code> is also summed up since each non-grouped column is passed into the aggregation function. To avoid this, we can select out the desired columns before calling <code>.groupby()</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># When lines get long, you can wrap the entire expression in parentheses</span>
<span class="c1"># and insert newlines before each method call</span>
<span class="n">letter_dist</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">baby</span><span class="p">[[</span><span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'Count'</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'Last'</span><span class="p">,</span> <span class="s1">'Sex'</span><span class="p">])</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="p">)</span>
<span class="n">letter_dist</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>Count</th>
</tr>
<tr>
<th>Last</th>
<th>Sex</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">a</th>
<th>F</th>
<td>58079486</td>
</tr>
<tr>
<th>M</th>
<td>1931630</td>
</tr>
<tr>
<th>b</th>
<th>F</th>
<td>17376</td>
</tr>
<tr>
<th>...</th>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>y</th>
<th>M</th>
<td>18569388</td>
</tr>
<tr>
<th rowspan="2" valign="top">z</th>
<th>F</th>
<td>142023</td>
</tr>
<tr>
<th>M</th>
<td>120123</td>
</tr>
</tbody>
</table>
<p>52 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Plotting">Plotting<a class="anchor-link" href="#Plotting">¶</a></h3><p><code>pandas</code> provides built-in plotting functionality for most basic plots, including bar charts, histograms, line charts, and scatterplots. To make a plot from a DataFrame, use the <code>.plot</code> attribute:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We use the figsize option to make the plot larger</span>
<span class="n">letter_dist</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a17af4780&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/pandas_apply_strings_plotting_20_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although this plot shows the distribution of letters and sexes, the male and female bars are difficult to tell apart. By looking at the <code>pandas</code> docs on plotting (<a href="https://pandas.pydata.org/pandas-docs/stable/visualization.html">link</a>) we learn that <code>pandas</code> plots one group of bars for row column in the DataFrame, showing one differently colored bar for each column. This means that a pivoted version of the <code>letter_dist</code> table will have the right format.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">letter_pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span>
    <span class="n">baby</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="s1">'Last'</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s1">'Sex'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">'Count'</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">'sum'</span>
<span class="p">)</span>
<span class="n">letter_pivot</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Sex</th>
<th>F</th>
<th>M</th>
</tr>
<tr>
<th>Last</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>a</th>
<td>58079486</td>
<td>1931630</td>
</tr>
<tr>
<th>b</th>
<td>17376</td>
<td>1435939</td>
</tr>
<tr>
<th>c</th>
<td>30262</td>
<td>1672407</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>x</th>
<td>37381</td>
<td>644092</td>
</tr>
<tr>
<th>y</th>
<td>24877638</td>
<td>18569388</td>
</tr>
<tr>
<th>z</th>
<td>142023</td>
<td>120123</td>
</tr>
</tbody>
</table>
<p>26 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">letter_pivot</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a17c36978&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/pandas_apply_strings_plotting_23_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that <code>pandas</code> conveniently generates a legend for us as well. However, this is still difficult to interpret. We plot the counts for each letter and sex which causes some bars to appear very long and others to be almost invisible. We should instead plot the proportion of male and female babies within each last letter.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">total_for_each_letter</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span> <span class="o">+</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'M'</span><span class="p">]</span>

<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'F prop'</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'F'</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'M prop'</span><span class="p">]</span> <span class="o">=</span> <span class="n">letter_pivot</span><span class="p">[</span><span class="s1">'M'</span><span class="p">]</span> <span class="o">/</span> <span class="n">total_for_each_letter</span>
<span class="n">letter_pivot</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>Sex</th>
<th>F</th>
<th>M</th>
<th>F prop</th>
<th>M prop</th>
</tr>
<tr>
<th>Last</th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>a</th>
<td>58079486</td>
<td>1931630</td>
<td>0.967812</td>
<td>0.032188</td>
</tr>
<tr>
<th>b</th>
<td>17376</td>
<td>1435939</td>
<td>0.011956</td>
<td>0.988044</td>
</tr>
<tr>
<th>c</th>
<td>30262</td>
<td>1672407</td>
<td>0.017773</td>
<td>0.982227</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>x</th>
<td>37381</td>
<td>644092</td>
<td>0.054853</td>
<td>0.945147</td>
</tr>
<tr>
<th>y</th>
<td>24877638</td>
<td>18569388</td>
<td>0.572597</td>
<td>0.427403</td>
</tr>
<tr>
<th>z</th>
<td>142023</td>
<td>120123</td>
<td>0.541771</td>
<td>0.458229</td>
</tr>
</tbody>
</table>
<p>26 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">letter_pivot</span><span class="p">[[</span><span class="s1">'F prop'</span><span class="p">,</span> <span class="s1">'M prop'</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'M prop'</span><span class="p">)</span> <span class="c1"># Sorting orders the plotted bars</span>
 <span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a18194b70&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/pandas_apply_strings_plotting_26_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="In-Conclusion">In Conclusion<a class="anchor-link" href="#In-Conclusion">¶</a></h2><p>We can see that almost all first names that end in 'p' are male and names that end in 'a' are female! In general, the difference between bar lengths for many letters implies that we can often make a good guess to a person's sex if we just know the last letter of their first name.</p>
<p>We've learned to express the following operations in <code>pandas</code>:</p>
<table>
<thead><tr>
<th>Operation</th>
<th><code>pandas</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Applying a function elementwise</td>
<td><code>series.apply(func)</code></td>
</tr>
<tr>
<td>String manipulation</td>
<td><code>series.str.func()</code></td>
</tr>
<tr>
<td>Plotting</td>
<td><code>df.plot.func()</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/04'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Cleaning">Data Cleaning<a class="anchor-link" href="#Data-Cleaning">¶</a></h1><p>Data come in many formats and vary greatly in usefulness for analysis. Although
we would prefer all our data to come in a tabular format with each value
recorded consistently and accurately, in reality we must carefully check our
data for potential issues that can eventually result in incorrect conclusions.</p>
<p>The term "data cleaning" refers to the process of combing through the data and
deciding how to resolve inconsistencies and missing values. We will discuss
common problems found in datasets and approaches to address them.</p>
<p>Data cleaning has inherent limitations. For example, no amount of data cleaning
will fix a biased sampling process. Before embarking on the sometimes lengthy
process of data cleaning, we must be confident that our data are collected
accurately and with as little bias as possible. Only then can we investigate
the data itself and use data cleaning to resolve issues in the data format or
entry process.</p>
<p>We will introduce data cleaning techniques by working with City of Berkeley
Police Department datasets.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/04'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Investigating-Berkeley-Police-Data">Investigating Berkeley Police Data<a class="anchor-link" href="#Investigating-Berkeley-Police-Data">¶</a></h2><p>We will use the Berkeley Police Department's publicly available datasets to demonstrate data cleaning techniques. We have downloaded the <a href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Calls-for-Service/k2nh-s5h5">Calls for Service dataset</a> and <a href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Stop-Data/6e9j-pj9p">Stops dataset</a>.</p>
<p>We can use the <code>ls</code> shell command with the <code>-lh</code> flags to see more details about the files:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -lh data/
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>total 13936
-rw-r--r--@ 1 sam  staff   979K Aug 29 14:41 Berkeley_PD_-_Calls_for_Service.csv
-rw-r--r--@ 1 sam  staff    81B Aug 29 14:28 cvdow.csv
-rw-r--r--@ 1 sam  staff   5.8M Aug 29 14:41 stops.json
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The command above shows the data files and their file sizes. This is especially useful because we now know the files are small enough to load into memory. As a rule of thumb, it is usually safe to load a file into memory that is around one fourth of the total memory capacity of the computer. For example, if a computer has 4GB of RAM we should be able to load a 1GB CSV file in <code>pandas</code>. To handle larger datasets we will need additional computational tools that we will cover later in this book.</p>
<p>Notice the use of the exclamation point before <code>ls</code>. This tells Jupyter that the next line of code is a shell command, not a Python expression. We can run any available shell command in Jupyter using <code>!</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The `wc` shell command shows us how many lines each file has.</span>
<span class="c1"># We can see that the `stops.json` file has the most lines (29852).</span>
<span class="o">!</span>wc -l data/*
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>   16497 data/Berkeley_PD_-_Calls_for_Service.csv
       8 data/cvdow.csv
   29852 data/stops.json
   46357 total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Understanding-the-Data-Generation">Understanding the Data Generation<a class="anchor-link" href="#Understanding-the-Data-Generation">¶</a></h3><p>We will state important questions you should ask of all datasets before data cleaning or processing. These questions are related to how the data were generated, so data cleaning will usually <strong>not</strong> be able to resolve issues that arise here.</p>
<p><strong>What do the data contain?</strong> The website for the Calls for Service data states that the dataset describes "crime incidents (not criminal reports) within the last 180 days". Further reading reveals that "not all calls for police service are included (e.g. Animal Bite)".</p>
<p>The website for the Stops data states that the dataset contains data on all "vehicle detentions (including bicycles) and pedestrian detentions (up to five persons)" since January 26, 2015.</p>
<p><strong>Are the data a census?</strong> This depends on our population of interest. For example, if we are interested in calls for service within the last 180 days for crime incidents then the Calls dataset is a census. However, if we are interested in calls for service within the last 10 years the dataset is clearly not a census. We can make similar statements about the Stops dataset since the data collection started on January 26, 2015.</p>
<p><strong>If the data form a sample, is it a probability sample?</strong> If we are investigating a period of time that the data do not have entries for, the data do not form a probability sample since there is no randomness involved in the data collection process — we have all data for certain time periods but no data for others.</p>
<p><strong>What limitations will this data have on our conclusions?</strong> Although we will ask this question at each step of our data processing, we can already see that our data impose important limitations. The most important limitation is that we cannot make unbiased estimations for time periods not covered by our datasets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleaning-The-Calls-Dataset">Cleaning The Calls Dataset<a class="anchor-link" href="#Cleaning-The-Calls-Dataset">¶</a></h2><p>Let's now clean the Calls dataset. The <code>head</code> shell command prints the first five lines of the file.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head data/Berkeley_PD_-_Calls_for_Service.csv
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>CASENO,OFFENSE,EVENTDT,EVENTTM,CVLEGEND,CVDOW,InDbDate,Block_Location,BLKADDR,City,State
17091420,BURGLARY AUTO,07/23/2017 12:00:00 AM,06:00,BURGLARY - VEHICLE,0,08/29/2017 08:28:05 AM,"2500 LE CONTE AVE
Berkeley, CA
(37.876965, -122.260544)",2500 LE CONTE AVE,Berkeley,CA
17020462,THEFT FROM PERSON,04/13/2017 12:00:00 AM,08:45,LARCENY,4,08/29/2017 08:28:00 AM,"2200 SHATTUCK AVE
Berkeley, CA
(37.869363, -122.268028)",2200 SHATTUCK AVE,Berkeley,CA
17050275,BURGLARY AUTO,08/24/2017 12:00:00 AM,18:30,BURGLARY - VEHICLE,4,08/29/2017 08:28:06 AM,"200 UNIVERSITY AVE
Berkeley, CA
(37.865491, -122.310065)",200 UNIVERSITY AVE,Berkeley,CA
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears to be a comma-separated values (CSV) file, though it's hard to tell whether the entire file is formatted properly. We can use <code>pd.read_csv</code> to read in the file as a DataFrame. If <code>pd.read_csv</code> errors, we will have to dig deeper and manually resolve formatting issues. Fortunately, <code>pd.read_csv</code> successfully returns a DataFrame:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/Berkeley_PD_-_Calls_for_Service.csv'</span><span class="p">)</span>
<span class="n">calls</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>Block_Location</th>
<th>BLKADDR</th>
<th>City</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
<td>2500 LE CONTE AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>1</th>
<td>17020462</td>
<td>THEFT FROM PERSON</td>
<td>04/13/2017 12:00:00 AM</td>
<td>08:45</td>
<td>...</td>
<td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
<td>2200 SHATTUCK AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>2</th>
<td>17050275</td>
<td>BURGLARY AUTO</td>
<td>08/24/2017 12:00:00 AM</td>
<td>18:30</td>
<td>...</td>
<td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
<td>200 UNIVERSITY AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>5505</th>
<td>17018126</td>
<td>DISTURBANCE</td>
<td>04/01/2017 12:00:00 AM</td>
<td>12:22</td>
<td>...</td>
<td>1600 FAIRVIEW ST\nBerkeley, CA\n(37.850001, -1...</td>
<td>1600 FAIRVIEW ST</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>5506</th>
<td>17090665</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>04/01/2017 12:00:00 AM</td>
<td>12:00</td>
<td>...</td>
<td>2000 DELAWARE ST\nBerkeley, CA\n(37.874489, -1...</td>
<td>2000 DELAWARE ST</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>5507</th>
<td>17049700</td>
<td>SEXUAL ASSAULT MISD.</td>
<td>08/22/2017 12:00:00 AM</td>
<td>20:02</td>
<td>...</td>
<td>2400 TELEGRAPH AVE\nBerkeley, CA\n(37.866761, ...</td>
<td>2400 TELEGRAPH AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
</tbody>
</table>
<p>5508 rows × 11 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can define a function to show different slices of the data and then interact with it:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">df_interact</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(5508 rows, 11 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Based on the output above, the resulting DataFrame looks reasonably well-formed since the columns are properly named and the data in each column seems to be entered consistently. What data does each column contain? We can look at the dataset website:</p>
<table>
<thead><tr>
<th>Column</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>CASENO</td>
<td>Case Number</td>
<td>Number</td>
</tr>
<tr>
<td>OFFENSE</td>
<td>Offense Type</td>
<td>Plain Text</td>
</tr>
<tr>
<td>EVENTDT</td>
<td>Date Event Occurred</td>
<td>Date &amp; Time</td>
</tr>
<tr>
<td>EVENTTM</td>
<td>Time Event Occurred</td>
<td>Plain Text</td>
</tr>
<tr>
<td>CVLEGEND</td>
<td>Description of Event</td>
<td>Plain Text</td>
</tr>
<tr>
<td>CVDOW</td>
<td>Day of Week Event Occurred</td>
<td>Number</td>
</tr>
<tr>
<td>InDbDate</td>
<td>Date dataset was updated in the portal</td>
<td>Date &amp; Time</td>
</tr>
<tr>
<td>Block_Location</td>
<td>Block level address of event</td>
<td>Location</td>
</tr>
<tr>
<td>BLKADDR</td>
<td></td>
<td>Plain Text</td>
</tr>
<tr>
<td>City</td>
<td></td>
<td>Plain Text</td>
</tr>
<tr>
<td>State</td>
<td></td>
<td>Plain Text</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the surface the data looks easy to work with. However, before starting data analysis we must answer the following questions:</p>
<ol>
<li><strong>Are there missing values in the dataset?</strong> This question is important because missing values can represent many different things. For example, missing addresses could mean that locations were removed to protect anonymity, or that some respondents chose not to answer a survey question, or that a recording device broke.</li>
<li><strong>Are there any missing values that were filled in (e.g. a 999 for unknown age or 12:00am for unknown date)?</strong> These will clearly impact analysis if we ignore them.</li>
<li><strong>Which parts of the data were entered by a human?</strong> As we will soon see, human-entered data is filled with inconsistencies and mispellings.</li>
</ol>
<p>Although there are plenty more checks to go through, these three will suffice for many cases. See the <a href="https://github.com/Quartz/bad-data-guide">Quartz bad data guide</a> for a more complete list of checks.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-missing-values?">Are there missing values?<a class="anchor-link" href="#Are-there-missing-values?">¶</a></h3><p>This is a simple check in <code>pandas</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># True if row contains at least one null value</span>
<span class="n">null_rows</span> <span class="o">=</span> <span class="n">calls</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">calls</span><span class="p">[</span><span class="n">null_rows</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>Block_Location</th>
<th>BLKADDR</th>
<th>City</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<th>116</th>
<td>17014831</td>
<td>BURGLARY AUTO</td>
<td>03/16/2017 12:00:00 AM</td>
<td>22:00</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>478</th>
<td>17042511</td>
<td>BURGLARY AUTO</td>
<td>07/20/2017 12:00:00 AM</td>
<td>16:00</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>486</th>
<td>17022572</td>
<td>VEHICLE STOLEN</td>
<td>04/22/2017 12:00:00 AM</td>
<td>21:00</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>4945</th>
<td>17091287</td>
<td>VANDALISM</td>
<td>07/01/2017 12:00:00 AM</td>
<td>08:00</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>4947</th>
<td>17038382</td>
<td>BURGLARY RESIDENTIAL</td>
<td>06/30/2017 12:00:00 AM</td>
<td>15:00</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>5167</th>
<td>17091632</td>
<td>VANDALISM</td>
<td>08/15/2017 12:00:00 AM</td>
<td>23:30</td>
<td>...</td>
<td>Berkeley, CA\n(37.869058, -122.270455)</td>
<td>NaN</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
</tbody>
</table>
<p>27 rows × 11 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like 27 calls didn't have a recorded address in BLKADDR. Unfortunately, the data description isn't very clear on how the locations were recorded. We know that all of these calls were made for events in Berkeley, so we can likely assume that the addresses for these calls were originally somewhere in Berkeley.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-any-missing-values-that-were-filled-in?">Are there any missing values that were filled in?<a class="anchor-link" href="#Are-there-any-missing-values-that-were-filled-in?">¶</a></h3><p>From the missing value check above we can see that the Block_Location column has Berkeley, CA recorded if the location was missing.</p>
<p>In addition, an inspection of the <code>calls</code> table shows us that the EVENTDT column has the correct dates but records 12am for all of its times. Instead, the times are in the EVENTTM column.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Show the first 7 rows of the table again for reference</span>
<span class="n">calls</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>Block_Location</th>
<th>BLKADDR</th>
<th>City</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
<td>2500 LE CONTE AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>1</th>
<td>17020462</td>
<td>THEFT FROM PERSON</td>
<td>04/13/2017 12:00:00 AM</td>
<td>08:45</td>
<td>...</td>
<td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
<td>2200 SHATTUCK AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>2</th>
<td>17050275</td>
<td>BURGLARY AUTO</td>
<td>08/24/2017 12:00:00 AM</td>
<td>18:30</td>
<td>...</td>
<td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
<td>200 UNIVERSITY AVE</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>3</th>
<td>17019145</td>
<td>GUN/WEAPON</td>
<td>04/06/2017 12:00:00 AM</td>
<td>17:30</td>
<td>...</td>
<td>1900 SEVENTH ST\nBerkeley, CA\n(37.869318, -12...</td>
<td>1900 SEVENTH ST</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>4</th>
<td>17044993</td>
<td>VEHICLE STOLEN</td>
<td>08/01/2017 12:00:00 AM</td>
<td>18:00</td>
<td>...</td>
<td>100 PARKSIDE DR\nBerkeley, CA\n(37.854247, -12...</td>
<td>100 PARKSIDE DR</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>5</th>
<td>17037319</td>
<td>BURGLARY RESIDENTIAL</td>
<td>06/28/2017 12:00:00 AM</td>
<td>12:00</td>
<td>...</td>
<td>1500 PRINCE ST\nBerkeley, CA\n(37.851503, -122...</td>
<td>1500 PRINCE ST</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
<tr>
<th>6</th>
<td>17030791</td>
<td>BURGLARY RESIDENTIAL</td>
<td>05/30/2017 12:00:00 AM</td>
<td>08:45</td>
<td>...</td>
<td>300 MENLO PL\nBerkeley, CA\n</td>
<td>300 MENLO PL</td>
<td>Berkeley</td>
<td>CA</td>
</tr>
</tbody>
</table>
<p>7 rows × 11 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a data cleaning step, we want to merge the EVENTDT and EVENTTM columns to record both date and time in one field. If we define a function that takes in a DF and returns a new DF, we can later use <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pipe.html"><code>pd.pipe</code></a> to apply all transformations in one go.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">combine_event_datetimes</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="n">combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
        <span class="c1"># Combine date and time strings</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">'EVENTDT'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s1">' '</span> <span class="o">+</span> <span class="n">calls</span><span class="p">[</span><span class="s1">'EVENTTM'</span><span class="p">],</span>
        <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">EVENTDTTM</span><span class="o">=</span><span class="n">combined</span><span class="p">)</span>

<span class="c1"># To peek at the result without mutating the calls DF:</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>BLKADDR</th>
<th>City</th>
<th>State</th>
<th>EVENTDTTM</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>2500 LE CONTE AVE</td>
<td>Berkeley</td>
<td>CA</td>
<td>2017-07-23 06:00:00</td>
</tr>
<tr>
<th>1</th>
<td>17020462</td>
<td>THEFT FROM PERSON</td>
<td>04/13/2017 12:00:00 AM</td>
<td>08:45</td>
<td>...</td>
<td>2200 SHATTUCK AVE</td>
<td>Berkeley</td>
<td>CA</td>
<td>2017-04-13 08:45:00</td>
</tr>
</tbody>
</table>
<p>2 rows × 12 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Which-parts-of-the-data-were-entered-by-a-human?">Which parts of the data were entered by a human?<a class="anchor-link" href="#Which-parts-of-the-data-were-entered-by-a-human?">¶</a></h3><p>It looks like most of the data columns are machine-recorded, including the date, time, day of week, and location of the event.</p>
<p>In addition, the OFFENSE and CVLEGEND columns appear to contain consistent values. We can check the unique values in each column to see if anything was misspelled:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">'OFFENSE'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array(['BURGLARY AUTO', 'THEFT FROM PERSON', 'GUN/WEAPON',
       'VEHICLE STOLEN', 'BURGLARY RESIDENTIAL', 'VANDALISM',
       'DISTURBANCE', 'THEFT MISD. (UNDER $950)', 'THEFT FROM AUTO',
       'DOMESTIC VIOLENCE', 'THEFT FELONY (OVER $950)', 'ALCOHOL OFFENSE',
       'MISSING JUVENILE', 'ROBBERY', 'IDENTITY THEFT',
       'ASSAULT/BATTERY MISD.', '2ND RESPONSE', 'BRANDISHING',
       'MISSING ADULT', 'NARCOTICS', 'FRAUD/FORGERY',
       'ASSAULT/BATTERY FEL.', 'BURGLARY COMMERCIAL', 'MUNICIPAL CODE',
       'ARSON', 'SEXUAL ASSAULT FEL.', 'VEHICLE RECOVERED',
       'SEXUAL ASSAULT MISD.', 'KIDNAPPING', 'VICE', 'HOMICIDE'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">'CVLEGEND'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array(['BURGLARY - VEHICLE', 'LARCENY', 'WEAPONS OFFENSE',
       'MOTOR VEHICLE THEFT', 'BURGLARY - RESIDENTIAL', 'VANDALISM',
       'DISORDERLY CONDUCT', 'LARCENY - FROM VEHICLE', 'FAMILY OFFENSE',
       'LIQUOR LAW VIOLATION', 'MISSING PERSON', 'ROBBERY', 'FRAUD',
       'ASSAULT', 'NOISE VIOLATION', 'DRUG VIOLATION',
       'BURGLARY - COMMERCIAL', 'ALL OTHER OFFENSES', 'ARSON', 'SEX CRIME',
       'RECOVERED VEHICLE', 'KIDNAPPING', 'HOMICIDE'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since each value in these columns appears to be spelled correctly, we won't have to perform any corrections on these columns.</p>
<p>We also check the BLKADDR column for inconsistencies and find that sometimes an address is recorded (e.g. 2500 LE CONTE AVE) but other times a cross street is recorded (e.g. ALLSTON WAY &amp; FIFTH ST). This suggests that a human entered this data in and this column will be difficult to use for analysis. Fortunately we can use the latitude and longitude of the event instead of the street address.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">'BLKADDR'</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5001</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0            2500 LE CONTE AVE
5001    ALLSTON WAY &amp; FIFTH ST
Name: BLKADDR, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Final-Touchups">Final Touchups<a class="anchor-link" href="#Final-Touchups">¶</a></h3><p>This dataset seems almost ready for analysis. The Block_Location column seems to contain strings that record address, latitude, and longitude. We will want to separate the latitude and longitude for easier use.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">split_lat_lon</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">'Block_Location'</span><span class="p">]</span>
        <span class="c1"># Get coords from string</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Remove parens from coords</span>
        <span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Split latitude and longitude</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">', '</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">'Latitude'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">'Longitude'</span><span class="p">})</span>
    <span class="p">)</span>

<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>City</th>
<th>State</th>
<th>Latitude</th>
<th>Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>Berkeley</td>
<td>CA</td>
<td>37.876965</td>
<td>-122.260544</td>
</tr>
<tr>
<th>1</th>
<td>17020462</td>
<td>THEFT FROM PERSON</td>
<td>04/13/2017 12:00:00 AM</td>
<td>08:45</td>
<td>...</td>
<td>Berkeley</td>
<td>CA</td>
<td>37.869363</td>
<td>-122.268028</td>
</tr>
</tbody>
</table>
<p>2 rows × 13 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we can match the day of week number with its weekday:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This DF contains the day for each number in CVDOW</span>
<span class="n">day_of_week</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cvdow.csv'</span><span class="p">)</span>
<span class="n">day_of_week</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CVDOW</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Sunday</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>Monday</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>Tuesday</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>Wednesday</td>
</tr>
<tr>
<th>4</th>
<td>4</td>
<td>Thursday</td>
</tr>
<tr>
<th>5</th>
<td>5</td>
<td>Friday</td>
</tr>
<tr>
<th>6</th>
<td>6</td>
<td>Saturday</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">match_weekday</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">day_of_week</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'CVDOW'</span><span class="p">)</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>BLKADDR</th>
<th>City</th>
<th>State</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>2500 LE CONTE AVE</td>
<td>Berkeley</td>
<td>CA</td>
<td>Sunday</td>
</tr>
<tr>
<th>1</th>
<td>17038302</td>
<td>BURGLARY AUTO</td>
<td>07/02/2017 12:00:00 AM</td>
<td>22:00</td>
<td>...</td>
<td>BOWDITCH STREET &amp; CHANNING WAY</td>
<td>Berkeley</td>
<td>CA</td>
<td>Sunday</td>
</tr>
</tbody>
</table>
<p>2 rows × 12 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll drop columns we no longer need:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">drop_unneeded_cols</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'CVDOW'</span><span class="p">,</span> <span class="s1">'InDbDate'</span><span class="p">,</span> <span class="s1">'Block_Location'</span><span class="p">,</span> <span class="s1">'City'</span><span class="p">,</span>
                               <span class="s1">'State'</span><span class="p">,</span> <span class="s1">'EVENTDT'</span><span class="p">,</span> <span class="s1">'EVENTTM'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we'll pipe the <code>calls</code> DF through all the functions we've defined:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_unneeded_cols</span><span class="p">))</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">calls_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(5508 rows, 8 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Calls dataset is now ready for further data analysis. In the next section, we will clean the Stops dataset.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Save data to CSV for other chapters</span>
<span class="c1"># calls_final.to_csv('../ch5/data/calls.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/04'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cleaning-The-Stops-Dataset">Cleaning The Stops Dataset<a class="anchor-link" href="#Cleaning-The-Stops-Dataset">¶</a></h2><p>The Stops dataset (<a href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Stop-Data/6e9j-pj9p">webpage</a>) records police stops of pedestrians and vehicles. Let's prepare it for further analysis.</p>
<p>We can use the <code>head</code> command to display the first few lines of the file.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head data/stops.json
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>{
  "meta" : {
    "view" : {
      "id" : "6e9j-pj9p",
      "name" : "Berkeley PD - Stop Data",
      "attribution" : "Berkeley Police Department",
      "averageRating" : 0,
      "category" : "Public Safety",
      "createdAt" : 1444171604,
      "description" : "This data was extracted from the Department’s Public Safety Server and covers the data beginning January 26, 2015.  On January 26, 2015 the department began collecting data pursuant to General Order B-4 (issued December 31, 2014).  Under that order, officers were required to provide certain data after making all vehicle detentions (including bicycles) and pedestrian detentions (up to five persons).  This data set lists stops by police in the categories of traffic, suspicious vehicle, pedestrian and bicycle stops.  Incident number, date and time, location and disposition codes are also listed in this data.\r\n\r\nAddress data has been changed from a specific address, where applicable, and listed as the block where the incident occurred.  Disposition codes were entered by officers who made the stop.  These codes included the person(s) race, gender, age (range), reason for the stop, enforcement action taken, and whether or not a search was conducted.\r\n\r\nThe officers of the Berkeley Police Department are prohibited from biased based policing, which is defined as any police-initiated action that relies on the race, ethnicity, or national origin rather than the behavior of an individual or information that leads the police to a particular individual who has been identified as being engaged in criminal activity.",
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>stops.json</code> file is clearly not a CSV file. In this case, the file contains data in the JSON (JavaScript Object Notation) format, a commonly used data format where data is recorded in a dictionary format. Python's <a href="https://docs.python.org/3/library/json.html"><code>json</code> module</a> makes reading in this file as a dictionary simple.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>

<span class="c1"># Note that this could cause our computer to run out of memory if the file</span>
<span class="c1"># is large. In this case, we've verified that the file is small enough to</span>
<span class="c1"># read in beforehand.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'data/stops.json'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">stops_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

<span class="n">stops_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>dict_keys(['meta', 'data'])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that <code>stops_dict</code> is a Python dictionary, so displaying it will display the entire dataset in the notebook. This could cause the browser to crash, so we only display the keys of the dictionary above. To peek at the data without potentially crashing the browser, we can print the dictionary to a string and only output some of the first characters of the string.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pformat</span>

<span class="k">def</span> <span class="nf">print_dict</span><span class="p">(</span><span class="n">dictionary</span><span class="p">,</span> <span class="n">num_chars</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">pformat</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)[:</span><span class="n">num_chars</span><span class="p">])</span>

<span class="n">print_dict</span><span class="p">(</span><span class="n">stops_dict</span><span class="p">[</span><span class="s1">'meta'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>{'view': {'attribution': 'Berkeley Police Department',
          'averageRating': 0,
          'category': 'Public Safety',
          'columns': [{'dataTypeName': 'meta_data',
                       'fieldName': ':sid',
                       'flags': ['hidden'],
                       'format': {},
                       'id': -1,
                       'name': 'sid',
                       'position': 0,
                       'renderTypeName': 'meta_data'},
                      {'dataTypeName': 'meta_data',
                       'fieldName': ':id',
                       'flags': ['hidden'],
                       'format': {},
                       'id': -1,
                       'name': 'id',
                       'position': 0,
                       'renderTypeName': 'meta_data'},
                      {'dataTypeName': 'meta_data',
                       'fieldName': ':position',
                       'flags': ['hidden'],
                       'format': {},
              
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">print_dict</span><span class="p">(</span><span class="n">stops_dict</span><span class="p">[</span><span class="s1">'data'</span><span class="p">],</span> <span class="n">num_chars</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>[[1,
  '29A1B912-A0A9-4431-ADC9-FB375809C32E',
  1,
  1444146408,
  '932858',
  1444146408,
  '932858',
  None,
  '2015-00004825',
  '2015-01-26T00:10:00',
  'SAN PABLO AVE / MARIN AVE',
  'T',
  'M',
  None,
  None],
 [2,
  '1644D161-1113-4C4F-BB2E-BF780E7AE73E',
  2,
  1444146408,
  '932858',
  14
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can likely deduce that the <code>'meta'</code> key in the dictionary contains a description of the data and its columns and the <code>'data'</code> contains a list of data rows. We can use this information to initialize a DataFrame.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Load the data from JSON and assign column titles</span>
<span class="n">stops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">stops_dict</span><span class="p">[</span><span class="s1">'data'</span><span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">c</span><span class="p">[</span><span class="s1">'name'</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">stops_dict</span><span class="p">[</span><span class="s1">'meta'</span><span class="p">][</span><span class="s1">'view'</span><span class="p">][</span><span class="s1">'columns'</span><span class="p">]])</span>

<span class="n">stops</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sid</th>
<th>id</th>
<th>position</th>
<th>created_at</th>
<th>...</th>
<th>Incident Type</th>
<th>Dispositions</th>
<th>Location - Latitude</th>
<th>Location - Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>29A1B912-A0A9-4431-ADC9-FB375809C32E</td>
<td>1</td>
<td>1444146408</td>
<td>...</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>1</th>
<td>2</td>
<td>1644D161-1113-4C4F-BB2E-BF780E7AE73E</td>
<td>2</td>
<td>1444146408</td>
<td>...</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>2</th>
<td>3</td>
<td>5338ABAB-1C96-488D-B55F-6A47AC505872</td>
<td>3</td>
<td>1444146408</td>
<td>...</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29205</th>
<td>31079</td>
<td>C2B606ED-7872-4B0B-BC9B-4EF45149F34B</td>
<td>31079</td>
<td>1496269085</td>
<td>...</td>
<td>T</td>
<td>BM2TWN;</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>29206</th>
<td>31080</td>
<td>8FADF18D-7FE9-441D-8709-7BFEABDACA7A</td>
<td>31080</td>
<td>1496269085</td>
<td>...</td>
<td>T</td>
<td>HM4TCS;</td>
<td>37.8698757000001</td>
<td>-122.286550846</td>
</tr>
<tr>
<th>29207</th>
<td>31081</td>
<td>F60BD2A4-8C47-4BE7-B1C6-4934BE9DF838</td>
<td>31081</td>
<td>1496269085</td>
<td>...</td>
<td>1194</td>
<td>AR;</td>
<td>37.867207539</td>
<td>-122.256529377</td>
</tr>
</tbody>
</table>
<p>29208 rows × 15 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Prints column names</span>
<span class="n">stops</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Index(['sid', 'id', 'position', 'created_at', 'created_meta', 'updated_at',
       'updated_meta', 'meta', 'Incident Number', 'Call Date/Time', 'Location',
       'Incident Type', 'Dispositions', 'Location - Latitude',
       'Location - Longitude'],
      dtype='object')</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The website contains documentation about the following columns:</p>
<table>
<thead><tr>
<th>Column</th>
<th>Description</th>
<th>Type</th>
</tr>
</thead>
<tbody>
<tr>
<td>Incident Number</td>
<td>Number of incident created by Computer Aided Dispatch (CAD) program</td>
<td>Plain Text</td>
</tr>
<tr>
<td>Call Date/Time</td>
<td>Date and time of the incident/stop</td>
<td>Date &amp; Time</td>
</tr>
<tr>
<td>Location</td>
<td>General location of the incident/stop</td>
<td>Plain Text</td>
</tr>
<tr>
<td>Incident Type</td>
<td>This is the occurred incident type created in the CAD program. A code signifies a traffic stop (T), suspicious vehicle stop (1196), pedestrian stop (1194) and bicycle stop (1194B).</td>
<td>Plain Text</td>
</tr>
<tr>
<td>Dispositions</td>
<td>Ordered in the following sequence: 1st Character = Race, as follows: A (Asian) B (Black) H (Hispanic) O (Other) W (White) 2nd Character = Gender, as follows: F (Female) M (Male) 3rd Character = Age Range, as follows: 1 (Less than 18) 2 (18-29) 3 (30-39), 4 (Greater than 40) 4th Character = Reason, as follows: I (Investigation) T (Traffic) R (Reasonable Suspicion) K (Probation/Parole) W (Wanted) 5th Character = Enforcement, as follows: A (Arrest) C (Citation) O (Other) W (Warning) 6th Character = Car Search, as follows: S (Search) N (No Search) Additional dispositions may also appear. They are: P - Primary case report M - MDT narrative only AR - Arrest report only (no case report submitted) IN - Incident report FC - Field Card CO - Collision investigation report MH - Emergency Psychiatric Evaluation TOW - Impounded vehicle 0 or 00000 – Officer made a stop of more than five persons</td>
<td>Plain Text</td>
</tr>
<tr>
<td>Location - Latitude</td>
<td>General latitude of the call. This data is only uploaded after January 2017</td>
<td>Number</td>
</tr>
<tr>
<td>Location - Longitude</td>
<td>General longitude of the call. This data is only uploaded after January 2017.</td>
<td>Number</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the website doesn't contain descriptions for the first 8 columns of the <code>stops</code> table. Since these columns appear to contain metadata that we're not interested in analyzing this time, we drop them from the table.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">columns_to_drop</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'sid'</span><span class="p">,</span> <span class="s1">'id'</span><span class="p">,</span> <span class="s1">'position'</span><span class="p">,</span> <span class="s1">'created_at'</span><span class="p">,</span> <span class="s1">'created_meta'</span><span class="p">,</span>
                   <span class="s1">'updated_at'</span><span class="p">,</span> <span class="s1">'updated_meta'</span><span class="p">,</span> <span class="s1">'meta'</span><span class="p">]</span>

<span class="c1"># This function takes in a DF and returns a DF so we can use it for .pipe</span>
<span class="k">def</span> <span class="nf">drop_unneeded_cols</span><span class="p">(</span><span class="n">stops</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">stops</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">columns_to_drop</span><span class="p">)</span>

<span class="n">stops</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_unneeded_cols</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Incident Number</th>
<th>Call Date/Time</th>
<th>Location</th>
<th>Incident Type</th>
<th>Dispositions</th>
<th>Location - Latitude</th>
<th>Location - Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2015-00004825</td>
<td>2015-01-26T00:10:00</td>
<td>SAN PABLO AVE / MARIN AVE</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>1</th>
<td>2015-00004829</td>
<td>2015-01-26T00:50:00</td>
<td>SAN PABLO AVE / CHANNING WAY</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>2</th>
<td>2015-00004831</td>
<td>2015-01-26T01:03:00</td>
<td>UNIVERSITY AVE / NINTH ST</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29205</th>
<td>2017-00024245</td>
<td>2017-04-30T22:59:26</td>
<td>UNIVERSITY AVE/6TH ST</td>
<td>T</td>
<td>BM2TWN;</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>29206</th>
<td>2017-00024250</td>
<td>2017-04-30T23:19:27</td>
<td>UNIVERSITY AVE /  WEST ST</td>
<td>T</td>
<td>HM4TCS;</td>
<td>37.8698757000001</td>
<td>-122.286550846</td>
</tr>
<tr>
<th>29207</th>
<td>2017-00024254</td>
<td>2017-04-30T23:38:34</td>
<td>CHANNING WAY /  BOWDITCH ST</td>
<td>1194</td>
<td>AR;</td>
<td>37.867207539</td>
<td>-122.256529377</td>
</tr>
</tbody>
</table>
<p>29208 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As with the Calls dataset, we will answer the following three questions about the Stops dataset:</p>
<ol>
<li>Are there missing values in the dataset?</li>
<li>Are there any missing values that were filled in (e.g. a 999 for unknown age or 12:00am for unknown date)?</li>
<li>Which parts of the data were entered by a human?</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-missing-values?">Are there missing values?<a class="anchor-link" href="#Are-there-missing-values?">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can clearly see that there are many missing latitude and longitudes. The data description states that these two columns are only filled in after Jan 2017.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># True if row contains at least one null value</span>
<span class="n">null_rows</span> <span class="o">=</span> <span class="n">stops</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">stops</span><span class="p">[</span><span class="n">null_rows</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Incident Number</th>
<th>Call Date/Time</th>
<th>Location</th>
<th>Incident Type</th>
<th>Dispositions</th>
<th>Location - Latitude</th>
<th>Location - Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2015-00004825</td>
<td>2015-01-26T00:10:00</td>
<td>SAN PABLO AVE / MARIN AVE</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>1</th>
<td>2015-00004829</td>
<td>2015-01-26T00:50:00</td>
<td>SAN PABLO AVE / CHANNING WAY</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>2</th>
<td>2015-00004831</td>
<td>2015-01-26T01:03:00</td>
<td>UNIVERSITY AVE / NINTH ST</td>
<td>T</td>
<td>M</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29078</th>
<td>2017-00023764</td>
<td>2017-04-29T01:59:36</td>
<td>2180 M L KING JR WAY</td>
<td>1194</td>
<td>BM4IWN;</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>29180</th>
<td>2017-00024132</td>
<td>2017-04-30T12:54:23</td>
<td>6TH/UNI</td>
<td>1194</td>
<td>M;</td>
<td>None</td>
<td>None</td>
</tr>
<tr>
<th>29205</th>
<td>2017-00024245</td>
<td>2017-04-30T22:59:26</td>
<td>UNIVERSITY AVE/6TH ST</td>
<td>T</td>
<td>BM2TWN;</td>
<td>None</td>
<td>None</td>
</tr>
</tbody>
</table>
<p>25067 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can check the other columns for missing values:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># True if row contains at least one null value without checking</span>
<span class="c1"># the latitude and longitude columns</span>
<span class="n">null_rows</span> <span class="o">=</span> <span class="n">stops</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">df_interact</span><span class="p">(</span><span class="n">stops</span><span class="p">[</span><span class="n">null_rows</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(63 rows, 7 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By browsing through the table above, we can see that all other missing values are in the Dispositions column. Unfortunately, we do not know from the data description why these Dispositions might be missing. Since only there are only 63 missing values compared to 25,000 rows in the original table, we can proceed with analysis while being mindful that these missing values could impact results.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Are-there-any-missing-values-that-were-filled-in?">Are there any missing values that were filled in?<a class="anchor-link" href="#Are-there-any-missing-values-that-were-filled-in?">¶</a></h3><p>It doesn't seem like any previously missing values were filled in for us. Unlike in the Calls dataset where the date and time were in separate columns, the Call Date/Time column in the Stops dataset contains both date and time.</p>
<h3 id="Which-parts-of-the-data-were-entered-by-a-human?">Which parts of the data were entered by a human?<a class="anchor-link" href="#Which-parts-of-the-data-were-entered-by-a-human?">¶</a></h3><p>As with the Calls dataset, it looks like most of the columns in this dataset were recorded by a machine or were a category selected by a human (e.g. Incident Type).</p>
<p>However, the Location column doesn't have consistently entered values. Sure enough, we spot some typos in the data:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stops</span><span class="p">[</span><span class="s1">'Location'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>2200 BLOCK SHATTUCK AVE            229
37.8693028530001~-122.272234021    213
UNIVERSITY AVE / SAN PABLO AVE     202
                                  ... 
VALLEY ST / DWIGHT WAY               1
COLLEGE AVE / SIXTY-THIRD ST         1
GRIZZLY PEAK BLVD / MARIN AVE        1
Name: Location, Length: 6393, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What a mess! It looks like sometimes an address was entered, sometimes a cross-street, and other times a latitude-longitude pair. Unfortunately, we don't have very complete latitude-longitude data to use in place of this column. We may have to manually clean this column if we want to use locations for future analysis.</p>
<p>We can also check the Dispositions column:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dispositions</span> <span class="o">=</span> <span class="n">stops</span><span class="p">[</span><span class="s1">'Dispositions'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>

<span class="c1"># Outputs a slider to pan through the unique Dispositions in</span>
<span class="c1"># order of how often they appear</span>
<span class="n">interact</span><span class="p">(</span><span class="k">lambda</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">:</span> <span class="n">dispositions</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span><span class="o">+</span><span class="mi">7</span><span class="p">],</span>
         <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">dispositions</span><span class="p">),</span> <span class="mi">7</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;function __main__.&lt;lambda&gt;&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Dispositions columns also contains inconsistencies. For example, some dispositions start with a space, some end with a semicolon, and some contain multiple entries. The variety of values suggests that this field contains human-entered values and should be treated with caution.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Strange values...</span>
<span class="n">dispositions</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">266</span><span class="p">,</span> <span class="mi">1027</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>M           1683
M;           238
 M           176
HF4TWN;       14
 OM4KWS        1
Name: Dispositions, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In addition, the most common disposition is <code>M</code> which isn't a permitted first character in the Dispositions column. This could mean that the format of the column changed over time or that officers are allowed to enter in the disposition without matching the format in the data description. In any case, the column will be challenging to work with.</p>
<p>We can take some simple steps to clean the Dispositions column by removing leading and trailing whitespace, removing trailing semi-colons, and replacing the remaining semi-colons with commas.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">clean_dispositions</span><span class="p">(</span><span class="n">stops</span><span class="p">):</span>
    <span class="n">cleaned</span> <span class="o">=</span> <span class="p">(</span><span class="n">stops</span><span class="p">[</span><span class="s1">'Dispositions'</span><span class="p">]</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">';'</span><span class="p">)</span>
               <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">';'</span><span class="p">,</span> <span class="s1">','</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">stops</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">Dispositions</span><span class="o">=</span><span class="n">cleaned</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, we can now pipe the <code>stops</code> DF through the cleaning functions we've defined:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stops_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">stops</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_unneeded_cols</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">clean_dispositions</span><span class="p">))</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">stops_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(29208 rows, 7 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h2><p>As these two datasets have shown, data cleaning can often be both difficult and tedious. Cleaning 100% of the data often takes too long, but not cleaning the data at all results in faulty conclusions; we have to weigh our options and strike a balance each time we encounter a new dataset.</p>
<p>The decisions made during data cleaning impact all future analyses. For example, we chose not to clean the Location column of the Stops dataset so we should treat that column with caution. Each decision made during data cleaning should be carefully documented for future reference, preferably in a notebook so that both code and explanations appear together.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Save data to CSV for other chapters</span>
<span class="c1"># stops_final.to_csv('../ch5/data/stops.csv', index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Exporatory-Data-Analysis">Exporatory Data Analysis<a class="anchor-link" href="#Exporatory-Data-Analysis">¶</a></h1><blockquote><p>Exploratory data analysis is an attitude, a state of flexibility, a
willingness to look for those things that we believe are not there, as well
as those we believe to be there.</p>
<p>— <a href="https://en.wikipedia.org/wiki/John_Tukey">John Tukey</a></p>
</blockquote>
<p>In Exploratory Data Analysis (EDA), the third step of the data science
lifecycle, we summarize, visualize, and transform the data in order to
understand it more deeply. In particular, through EDA we identify potential
issues in the data and discover trends that inform further analyses.</p>
<p>We seek to understand the following properties about our data:</p>
<ol>
<li>Structure: the format of our data file.</li>
<li>Granularity: how fine or coarse each row and column is.</li>
<li>Scope: how (in)complete our data are.</li>
<li>Temporality: how the data are situation in time.</li>
<li>Faithfulness: how well the data captures "reality".</li>
</ol>
<p>Although we introduce data cleaning and EDA separately to help organize this
book, in practice you will often switch between the two. For example,
visualizing a column may show misformatted values that you should use data
cleaning techniques to process. With this in mind, we return to the Berkeley
Police Department datasets for exploration.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">display</span><span class="p">,</span> <span class="n">HTML</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">display_two</span><span class="p">(</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">):</span>
    <span class="sd">'''Displays two DFs side-by-side.'''</span>
    <span class="n">display</span><span class="p">(</span>
        <span class="n">HTML</span><span class="p">(</span><span class="s1">'&lt;div style="display: flex;"&gt;'</span>
                 <span class="s1">'</span><span class="si">{}</span><span class="s1">'</span>
                 <span class="s1">'&lt;div style="width: 20px;"&gt;&lt;/div&gt;'</span>
                 <span class="s1">'</span><span class="si">{}</span><span class="s1">'</span>
             <span class="s1">'&lt;/div&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">(),</span> <span class="n">df2</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()))</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Structure">Structure<a class="anchor-link" href="#Structure">¶</a></h2><p>The structure of a dataset refers to the "shape" of the data files. At a basic level, this refers to the format that the data are entered in. For example, we saw that the Calls dataset is a comma-separated values file:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>head data/Berkeley_PD_-_Calls_for_Service.csv
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>CASENO,OFFENSE,EVENTDT,EVENTTM,CVLEGEND,CVDOW,InDbDate,Block_Location,BLKADDR,City,State
17091420,BURGLARY AUTO,07/23/2017 12:00:00 AM,06:00,BURGLARY - VEHICLE,0,08/29/2017 08:28:05 AM,"2500 LE CONTE AVE
Berkeley, CA
(37.876965, -122.260544)",2500 LE CONTE AVE,Berkeley,CA
17020462,THEFT FROM PERSON,04/13/2017 12:00:00 AM,08:45,LARCENY,4,08/29/2017 08:28:00 AM,"2200 SHATTUCK AVE
Berkeley, CA
(37.869363, -122.268028)",2200 SHATTUCK AVE,Berkeley,CA
17050275,BURGLARY AUTO,08/24/2017 12:00:00 AM,18:30,BURGLARY - VEHICLE,4,08/29/2017 08:28:06 AM,"200 UNIVERSITY AVE
Berkeley, CA
(37.865491, -122.310065)",200 UNIVERSITY AVE,Berkeley,CA
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Stops dataset, on the other hand, is a JSON (JavaScript Object Notation) file.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Show first and last 5 lines of file</span>
<span class="o">!</span>head -n <span class="m">5</span> data/stops.json
<span class="o">!</span><span class="nb">echo</span> <span class="s1">'...'</span>
<span class="o">!</span>tail -n <span class="m">5</span> data/stops.json
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>{
  "meta" : {
    "view" : {
      "id" : "6e9j-pj9p",
      "name" : "Berkeley PD - Stop Data",
...
, [ 31079, "C2B606ED-7872-4B0B-BC9B-4EF45149F34B", 31079, 1496269085, "932858", 1496269085, "932858", null, "2017-00024245", "2017-04-30T22:59:26", " UNIVERSITY AVE/6TH ST", "T", "BM2TWN; ", null, null ]
, [ 31080, "8FADF18D-7FE9-441D-8709-7BFEABDACA7A", 31080, 1496269085, "932858", 1496269085, "932858", null, "2017-00024250", "2017-04-30T23:19:27", " UNIVERSITY AVE /  WEST ST", "T", "HM4TCS; ", "37.8698757000001", "-122.286550846" ]
, [ 31081, "F60BD2A4-8C47-4BE7-B1C6-4934BE9DF838", 31081, 1496269085, "932858", 1496269085, "932858", null, "2017-00024254", "2017-04-30T23:38:34", " CHANNING WAY /  BOWDITCH ST", "1194", "AR; ", "37.867207539", "-122.256529377" ]
 ]
}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of course, there are many other types of data formats. Here is a list of the most common formats:</p>
<ul>
<li>Comma-Separated Values (CSV) and Tab-Separated Values (TSV). These files contain tabular data delimited by either a comma for CSV or a tab character (<code>\t</code>) for TSV. These files are typically easy to work with because the data are entered in a similar format to DataFrames.</li>
<li>JavaScript Object Notation (JSON). These files contain data in a nested dictionary format. Typically we have to read in the entire file as a Python dict and then figure out how to extract fields for a DataFrame from the dict.</li>
<li><p>eXtensible Markup Language (XML) or HyperText Markup Language (HTML). These files also contain data in a nested format, for example:</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
  <span class="nt">&lt;note&gt;</span>
    <span class="nt">&lt;to&gt;</span>Tove<span class="nt">&lt;/to&gt;</span>
    <span class="nt">&lt;from&gt;</span>Jani<span class="nt">&lt;/from&gt;</span>
    <span class="nt">&lt;heading&gt;</span>Reminder<span class="nt">&lt;/heading&gt;</span>
    <span class="nt">&lt;body&gt;</span>Don't forget me this weekend!<span class="nt">&lt;/body&gt;</span>
  <span class="nt">&lt;/note&gt;</span>
</pre></div>
<p>In a later chapter we will use XPath to extract data from these types of files.</p>
</li>
<li><p>Log data. Many applications will output some data as they run in an unstructured text format, for example:</p>
<pre><code>  2005-03-23 23:47:11,663 - sa - INFO - creating an instance of aux_module.Aux
  2005-03-23 23:47:11,665 - sa.aux.Aux - INFO - creating an instance of Aux
  2005-03-23 23:47:11,665 - sa - INFO - created an instance of aux_module.Aux
  2005-03-23 23:47:11,668 - sa - INFO - calling aux_module.Aux.do_something
  2005-03-23 23:47:11,668 - sa.aux.Aux - INFO - doing something</code></pre>
<p>In a later chapter we will use Regular Expressions to extract data from these types of files.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Joins">Joins<a class="anchor-link" href="#Joins">¶</a></h2><p>Data will often be split across multiple tables. For example, one table can describe some people's personal information while another will contain their emails:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">people</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">"Joey"</span><span class="p">,</span>      <span class="s2">"blue"</span><span class="p">,</span>    <span class="mi">42</span><span class="p">,</span>  <span class="s2">"M"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Weiwei"</span><span class="p">,</span>    <span class="s2">"blue"</span><span class="p">,</span>    <span class="mi">50</span><span class="p">,</span>  <span class="s2">"F"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Joey"</span><span class="p">,</span>      <span class="s2">"green"</span><span class="p">,</span>    <span class="mi">8</span><span class="p">,</span>  <span class="s2">"M"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Karina"</span><span class="p">,</span>    <span class="s2">"green"</span><span class="p">,</span>    <span class="mi">7</span><span class="p">,</span>  <span class="s2">"F"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Nhi"</span><span class="p">,</span>       <span class="s2">"blue"</span><span class="p">,</span>     <span class="mi">3</span><span class="p">,</span>  <span class="s2">"F"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Sam"</span><span class="p">,</span>       <span class="s2">"pink"</span><span class="p">,</span>   <span class="o">-</span><span class="mi">42</span><span class="p">,</span>  <span class="s2">"M"</span><span class="p">]],</span> 
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Name"</span><span class="p">,</span> <span class="s2">"Color"</span><span class="p">,</span> <span class="s2">"Number"</span><span class="p">,</span> <span class="s2">"Sex"</span><span class="p">])</span>

<span class="n">people</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Color</th>
<th>Number</th>
<th>Sex</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Joey</td>
<td>blue</td>
<td>42</td>
<td>M</td>
</tr>
<tr>
<th>1</th>
<td>Weiwei</td>
<td>blue</td>
<td>50</td>
<td>F</td>
</tr>
<tr>
<th>2</th>
<td>Joey</td>
<td>green</td>
<td>8</td>
<td>M</td>
</tr>
<tr>
<th>3</th>
<td>Karina</td>
<td>green</td>
<td>7</td>
<td>F</td>
</tr>
<tr>
<th>4</th>
<td>Fernando</td>
<td>pink</td>
<td>-9</td>
<td>M</td>
</tr>
<tr>
<th>5</th>
<td>Nhi</td>
<td>blue</td>
<td>3</td>
<td>F</td>
</tr>
<tr>
<th>6</th>
<td>Sam</td>
<td>pink</td>
<td>-42</td>
<td>M</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">email</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[[</span><span class="s2">"Deb"</span><span class="p">,</span>  <span class="s2">"deborah_nolan@berkeley.edu"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Sam"</span><span class="p">,</span>  <span class="s2">"samlau95@berkeley.edu"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"John"</span><span class="p">,</span> <span class="s2">"doe@nope.com"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Joey"</span><span class="p">,</span> <span class="s2">"jegonzal@cs.berkeley.edu"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Weiwei"</span><span class="p">,</span> <span class="s2">"weiwzhang@berkeley.edu"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Weiwei"</span><span class="p">,</span> <span class="s2">"weiwzhang+123@berkeley.edu"</span><span class="p">],</span>
     <span class="p">[</span><span class="s2">"Karina"</span><span class="p">,</span> <span class="s2">"kgoot@berkeley.edu"</span><span class="p">]],</span> 
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"User Name"</span><span class="p">,</span> <span class="s2">"Email"</span><span class="p">])</span>

<span class="n">email</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>User Name</th>
<th>Email</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Deb</td>
<td>deborah_nolan@berkeley.edu</td>
</tr>
<tr>
<th>1</th>
<td>Sam</td>
<td>samlau95@berkeley.edu</td>
</tr>
<tr>
<th>2</th>
<td>John</td>
<td>doe@nope.com</td>
</tr>
<tr>
<th>3</th>
<td>Joey</td>
<td>jegonzal@cs.berkeley.edu</td>
</tr>
<tr>
<th>4</th>
<td>Weiwei</td>
<td>weiwzhang@berkeley.edu</td>
</tr>
<tr>
<th>5</th>
<td>Weiwei</td>
<td>weiwzhang+123@berkeley.edu</td>
</tr>
<tr>
<th>6</th>
<td>Karina</td>
<td>kgoot@berkeley.edu</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To match up each person with his or her email, we can join the two tables on the columns that contain the usernames. We must then decide what to do about people that appear in one table but not the other. For example, Fernando appears in the <code>people</code> table but not the <code>email</code> table. We have several types of joins for each strategy of matching missing values. One of the more common joins is the <em>inner join</em>, where any row that doesn't have a match is dropped in the final result:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Fernando, Nhi, Deb, and John don't appear</span>
<span class="n">people</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'inner'</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">'Name'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'User Name'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Name</th>
<th>Color</th>
<th>Number</th>
<th>Sex</th>
<th>User Name</th>
<th>Email</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Joey</td>
<td>blue</td>
<td>42</td>
<td>M</td>
<td>Joey</td>
<td>jegonzal@cs.berkeley.edu</td>
</tr>
<tr>
<th>1</th>
<td>Joey</td>
<td>green</td>
<td>8</td>
<td>M</td>
<td>Joey</td>
<td>jegonzal@cs.berkeley.edu</td>
</tr>
<tr>
<th>2</th>
<td>Weiwei</td>
<td>blue</td>
<td>50</td>
<td>F</td>
<td>Weiwei</td>
<td>weiwzhang@berkeley.edu</td>
</tr>
<tr>
<th>3</th>
<td>Weiwei</td>
<td>blue</td>
<td>50</td>
<td>F</td>
<td>Weiwei</td>
<td>weiwzhang+123@berkeley.edu</td>
</tr>
<tr>
<th>4</th>
<td>Karina</td>
<td>green</td>
<td>7</td>
<td>F</td>
<td>Karina</td>
<td>kgoot@berkeley.edu</td>
</tr>
<tr>
<th>5</th>
<td>Sam</td>
<td>pink</td>
<td>-42</td>
<td>M</td>
<td>Sam</td>
<td>samlau95@berkeley.edu</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are four basic joins that we use most often: inner, full (sometimes called "outer"), left, and right joins. Below is a diagram to show the difference between these types of joins.</p>
<p><img alt="joins" src="https://github.com/DS-100/textbook/raw/master/assets/joins.png"></p>
<p>Use the dropdown menu below to show the result of the four different types of joins on the <code>people</code> and <code>email</code> tables. Notice which rows contain NaN values for outer, left, and right joins.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">join_demo</span><span class="p">(</span><span class="n">join_type</span><span class="p">):</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'people and email tables:'</span><span class="p">))</span>
    <span class="n">display_two</span><span class="p">(</span><span class="n">people</span><span class="p">,</span> <span class="n">email</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'&lt;br&gt;'</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">HTML</span><span class="p">(</span><span class="s1">'Joined table:'</span><span class="p">))</span>
    <span class="n">display</span><span class="p">(</span><span class="n">people</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">email</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">join_type</span><span class="p">,</span>
                         <span class="n">left_on</span><span class="o">=</span><span class="s1">'Name'</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">'User Name'</span><span class="p">))</span>
    
<span class="n">interact</span><span class="p">(</span><span class="n">join_demo</span><span class="p">,</span> <span class="n">join_type</span><span class="o">=</span><span class="p">[</span><span class="s1">'inner'</span><span class="p">,</span> <span class="s1">'outer'</span><span class="p">,</span> <span class="s1">'left'</span><span class="p">,</span> <span class="s1">'right'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Structure-Checklist">Structure Checklist<a class="anchor-link" href="#Structure-Checklist">¶</a></h2><p>You should have answers to the following questions after looking at the structure of your datasets. We will answer them for the Calls and Stops datasets.</p>
<p><strong>Are the data in a standard format or encoding?</strong></p>
<p>Standard formats include:</p>
<ul>
<li>Tabular data: CSV, TSV, Excel, SQL</li>
<li>Nested data: JSON, XML</li>
</ul>
<p>The Calls dataset came in the CSV format while the Stops dataset came in the JSON format.</p>
<p><strong>Are the data organized in records (e.g. rows)? If not, can we define records by parsing the data?</strong></p>
<p>The Calls dataset came in rows; we extracted records from the Stops dataset.</p>
<p><strong>Are the data nested? If so, can we reasonably unnest the data?</strong></p>
<p>The Calls dataset wasn't nested; we didn't have to work too hard to unnest data from the Stops dataset.</p>
<p><strong>Do the data reference other data? If so, can we join the data?</strong></p>
<p>The Calls dataset references the day of week table. Joining those two tables gives us the day of week for each incident in the dataset. The Stops dataset had no obvious references.</p>
<p><strong>What are the fields (e.g. columns) in each record? What is the type of each column?</strong></p>
<p>The fields for the Calls and Stops datasets are described in the Data Cleaning sections for each dataset.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Granularity">Granularity<a class="anchor-link" href="#Granularity">¶</a></h2><p>The granularity of your data is what each record in your data represents. For example, in the Calls dataset each record represents a single case of a police call.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/calls.csv'</span><span class="p">)</span>
<span class="n">calls</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>CVLEGEND</th>
<th>BLKADDR</th>
<th>EVENTDTTM</th>
<th>Latitude</th>
<th>Longitude</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>BURGLARY - VEHICLE</td>
<td>2500 LE CONTE AVE</td>
<td>2017-07-23 06:00:00</td>
<td>37.876965</td>
<td>-122.260544</td>
<td>Sunday</td>
</tr>
<tr>
<th>1</th>
<td>17038302</td>
<td>BURGLARY AUTO</td>
<td>BURGLARY - VEHICLE</td>
<td>BOWDITCH STREET &amp; CHANNING WAY</td>
<td>2017-07-02 22:00:00</td>
<td>37.867209</td>
<td>-122.256554</td>
<td>Sunday</td>
</tr>
<tr>
<th>2</th>
<td>17049346</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>LARCENY</td>
<td>2900 CHANNING WAY</td>
<td>2017-08-20 23:20:00</td>
<td>37.867948</td>
<td>-122.250664</td>
<td>Sunday</td>
</tr>
<tr>
<th>3</th>
<td>17091319</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>LARCENY</td>
<td>2100 RUSSELL ST</td>
<td>2017-07-09 04:15:00</td>
<td>37.856719</td>
<td>-122.266672</td>
<td>Sunday</td>
</tr>
<tr>
<th>4</th>
<td>17044238</td>
<td>DISTURBANCE</td>
<td>DISORDERLY CONDUCT</td>
<td>TELEGRAPH AVENUE &amp; DURANT AVE</td>
<td>2017-07-30 01:16:00</td>
<td>37.867816</td>
<td>-122.258994</td>
<td>Sunday</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the Stops dataset, each record represents a single incident of a police stop.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">stops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/stops.csv'</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stops</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Incident Number</th>
<th>Call Date/Time</th>
<th>Location</th>
<th>Incident Type</th>
<th>Dispositions</th>
<th>Location - Latitude</th>
<th>Location - Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2015-00004825</td>
<td>2015-01-26 00:10:00</td>
<td>SAN PABLO AVE / MARIN AVE</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2015-00004829</td>
<td>2015-01-26 00:50:00</td>
<td>SAN PABLO AVE / CHANNING WAY</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2015-00004831</td>
<td>2015-01-26 01:03:00</td>
<td>UNIVERSITY AVE / NINTH ST</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>2015-00004848</td>
<td>2015-01-26 07:16:00</td>
<td>2000 BLOCK BERKELEY WAY</td>
<td>1194</td>
<td>BM4ICN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2015-00004849</td>
<td>2015-01-26 07:43:00</td>
<td>1700 BLOCK SAN PABLO AVE</td>
<td>1194</td>
<td>BM4ICN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On the other hand, we could have received the Stops data in the following format:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="p">(</span><span class="n">stops</span>
 <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">stops</span><span class="p">[</span><span class="s1">'Call Date/Time'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
 <span class="o">.</span><span class="n">size</span><span class="p">()</span>
 <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">'Num Incidents'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Num Incidents</th>
</tr>
<tr>
<th>Call Date/Time</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>2015-01-26</th>
<td>46</td>
</tr>
<tr>
<th>2015-01-27</th>
<td>57</td>
</tr>
<tr>
<th>2015-01-28</th>
<td>56</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>2017-04-28</th>
<td>82</td>
</tr>
<tr>
<th>2017-04-29</th>
<td>86</td>
</tr>
<tr>
<th>2017-04-30</th>
<td>59</td>
</tr>
</tbody>
</table>
<p>825 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, each record in the table corresponds to a single date instead of a single incident. We would describe this table as having a coarser granularity than the one above. It's important to know the granularity of your data because it determines what kind of analyses you can perform. Generally speaking, too fine of a granularity is better than too coarse; while we can use grouping and pivoting to change a fine granularity to a coarse one, we have few tools to go from coarse to fine.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Granularity-Checklist">Granularity Checklist<a class="anchor-link" href="#Granularity-Checklist">¶</a></h2><p>You should have answers to the following questions after looking at the granularity of your datasets. We will answer them for the Calls and Stops datasets.</p>
<p><strong>What does a record represent?</strong></p>
<p>In the Calls dataset, each record represents a single case of a police call. In the Stops dataset, each record represents a single incident of a police stop.</p>
<p><strong>Do all records capture granularity at the same level? (Sometimes a table will contain summary rows.)</strong></p>
<p>Yes, for both Calls and Stops datasets.</p>
<p><strong>If the data were aggregated, how was the aggregation performed? Sampling and averaging are are common aggregations.</strong></p>
<p>No aggregations were performed as far as we can tell for the datasets. We do keep in mind that in both datasets, the location is entered as a block location instead of a specific address.</p>
<p><strong>What kinds of aggregations can we perform on the data?</strong></p>
<p>For example, it's often useful to aggregate individual people to demographic groups or individual events to totals across time.</p>
<p>In this case, we can aggregate across various granularities of date or time. For example, we can find the most common hour of day for incidents with aggregation. We might also be able to aggregate across event locations to find the regions of Berkeley with the most incidents.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/calls.csv'</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">'EVENTDTTM'</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">stops</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/stops.csv'</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Scope">Scope<a class="anchor-link" href="#Scope">¶</a></h2><p>The scope of the dataset refers to the coverage of the dataset in relation to what we are interested in analyzing. We seek to answer the following question about our data scope:</p>
<p><strong>Does the data cover the topic of interest?</strong></p>
<p>For example, the Calls and Stops datasets contain call and stop incidents made in Berkeley. If we are interested in crime incidents in the state of California, however, these datasets will be too limited in scope.</p>
<p>In general, larger scope is more useful than smaller scope since we can filter larger scope down to a smaller scope but often can't go from smaller scope to larger scope. For example, if we had a dataset of police stops in the United States we could subset the dataset to investigate Berkeley.</p>
<p>Keep in mind that scope is a broad term not always used to describe geographic location. For example, it can also refer to time coverage — the Calls dataset only contains data for a 180 day period.</p>
<p>We will often address the scope of the dataset during the investigation of the data generation process and confirm the dataset's scope during EDA. Let's confirm the geographic and time scope of the Calls dataset.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>CVLEGEND</th>
<th>BLKADDR</th>
<th>EVENTDTTM</th>
<th>Latitude</th>
<th>Longitude</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>BURGLARY - VEHICLE</td>
<td>2500 LE CONTE AVE</td>
<td>2017-07-23 06:00:00</td>
<td>37.876965</td>
<td>-122.260544</td>
<td>Sunday</td>
</tr>
<tr>
<th>1</th>
<td>17038302</td>
<td>BURGLARY AUTO</td>
<td>BURGLARY - VEHICLE</td>
<td>BOWDITCH STREET &amp; CHANNING WAY</td>
<td>2017-07-02 22:00:00</td>
<td>37.867209</td>
<td>-122.256554</td>
<td>Sunday</td>
</tr>
<tr>
<th>2</th>
<td>17049346</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>LARCENY</td>
<td>2900 CHANNING WAY</td>
<td>2017-08-20 23:20:00</td>
<td>37.867948</td>
<td>-122.250664</td>
<td>Sunday</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>5505</th>
<td>17021604</td>
<td>IDENTITY THEFT</td>
<td>FRAUD</td>
<td>100 MONTROSE RD</td>
<td>2017-03-31 00:00:00</td>
<td>37.896218</td>
<td>-122.270671</td>
<td>Friday</td>
</tr>
<tr>
<th>5506</th>
<td>17033201</td>
<td>DISTURBANCE</td>
<td>DISORDERLY CONDUCT</td>
<td>2300 COLLEGE AVE</td>
<td>2017-06-09 22:34:00</td>
<td>37.868957</td>
<td>-122.254552</td>
<td>Friday</td>
</tr>
<tr>
<th>5507</th>
<td>17047247</td>
<td>BURGLARY AUTO</td>
<td>BURGLARY - VEHICLE</td>
<td>UNIVERSITY AVENUE &amp; CHESTNUT ST</td>
<td>2017-08-11 20:00:00</td>
<td>37.869679</td>
<td>-122.288038</td>
<td>Friday</td>
</tr>
</tbody>
</table>
<p>5508 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shows earliest and latest dates in calls</span>
<span class="n">calls</span><span class="p">[</span><span class="s1">'EVENTDTTM'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>1384    2017-03-02
1264    2017-03-02
1408    2017-03-02
           ...    
3516    2017-08-28
3409    2017-08-28
3631    2017-08-28
Name: EVENTDTTM, Length: 5508, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">'EVENTDTTM'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">-</span> <span class="n">calls</span><span class="p">[</span><span class="s1">'EVENTDTTM'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>datetime.timedelta(179)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The table contains data for a time period of 179 days which is close enough to the 180 day time period in the data description that we can suppose there were no calls on either April 14st, 2017 or August 29, 2017.</p>
<p>To check the geographic scope, we can use a map:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">folium</span> <span class="c1"># Use the Folium Javascript Map Library</span>
<span class="kn">import</span> <span class="nn">folium.plugins</span>

<span class="n">SF_COORDINATES</span> <span class="o">=</span> <span class="p">(</span><span class="mf">37.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.28</span><span class="p">)</span>
<span class="n">sf_map</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">SF_COORDINATES</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">locs</span> <span class="o">=</span> <span class="n">calls</span><span class="p">[[</span><span class="s1">'Latitude'</span><span class="p">,</span> <span class="s1">'Longitude'</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">HeatMap</span><span class="p">(</span><span class="n">locs</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">radius</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">sf_map</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe allowfullscreen="" mozallowfullscreen="" src="data:text/html;charset=utf-8;base64,PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIgLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhd2dpdC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfMDYwNTVhNWUyZmVhNGM3ZTk3ZGMyNzQwZGI1NmM0NTIgewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vbGVhZmxldC5naXRodWIuaW8vTGVhZmxldC5oZWF0L2Rpc3QvbGVhZmxldC1oZWF0LmpzIj48L3NjcmlwdD4KPC9oZWFkPgo8Ym9keT4gICAgCiAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF8wNjA1NWE1ZTJmZWE0YzdlOTdkYzI3NDBkYjU2YzQ1MiIgPjwvZGl2PgogICAgICAgIAo8L2JvZHk+CjxzY3JpcHQ+ICAgIAogICAgCgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBib3VuZHMgPSBudWxsOwogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXBfMDYwNTVhNWUyZmVhNGM3ZTk3ZGMyNzQwZGI1NmM0NTIgPSBMLm1hcCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXBfMDYwNTVhNWUyZmVhNGM3ZTk3ZGMyNzQwZGI1NmM0NTInLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NlbnRlcjogWzM3Ljg3LC0xMjIuMjhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JsZENvcHlKdW1wOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyczogTC5DUlMuRVBTRzM4NTcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciB0aWxlX2xheWVyXzM2NzcwODI5ZDdmYzQ0ZTU4MmJiZWQ3MTgwNjQ2NzdmID0gTC50aWxlTGF5ZXIoCiAgICAgICAgICAgICAgICAnaHR0cHM6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLAogICAgICAgICAgICAgICAgewogICJhdHRyaWJ1dGlvbiI6IG51bGwsCiAgImRldGVjdFJldGluYSI6IGZhbHNlLAogICJtYXhab29tIjogMTgsCiAgIm1pblpvb20iOiAxLAogICJub1dyYXAiOiBmYWxzZSwKICAic3ViZG9tYWlucyI6ICJhYmMiCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzA2MDU1YTVlMmZlYTRjN2U5N2RjMjc0MGRiNTZjNDUyKTsKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgaGVhdF9tYXBfYTMzOTgxZmU4MWRhNDQ4OWE2MWNjYTk4MzhmZGNjMzIgPSBMLmhlYXRMYXllcigKICAgICAgICAgICAgICAgIFtbMzcuODc2OTY1MDAwMDAwMDA2LCAtMTIyLjI2MDU0NF0sIFszNy44NjcyMDksIC0xMjIuMjU2NTU0MDAwMDAwMDFdLCBbMzcuODY3OTQ4LCAtMTIyLjI1MDY2Mzk5OTk5OTk5XSwgWzM3Ljg1NjcxOSwgLTEyMi4yNjY2NzJdLCBbMzcuODY3ODE2LCAtMTIyLjI1ODk5NF0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODUzMDg1LCAtMTIyLjI4MTM2OF0sIFszNy44NjMwNDUsIC0xMjIuMzE3MzQ4XSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODY0MjM4LCAtMTIyLjI2NTI2Mjk5OTk5OTk5XSwgWzM3Ljg3NjA0NSwgLTEyMi4yNjAzMzYwMDAwMDAwMV0sIFszNy44Njk1MjQsIC0xMjIuMjc5NjVdLCBbMzcuODY4NzIyLCAtMTIyLjI1OTEyM10sIFszNy44ODU3NTIwMDAwMDAwMDQsIC0xMjIuMjc4MDVdLCBbMzcuODY0NTYsIC0xMjIuMjY5OTU0XSwgWzM3Ljg4NTUyNSwgLTEyMi4yNTQ0MDVdLCBbMzcuODYwNzMyLCAtMTIyLjI5MTM2ODk5OTk5OTk5XSwgWzM3Ljg2NzEwNiwgLTEyMi4yODYwNTQwMDAwMDAwMV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODY4MjgxLCAtMTIyLjMwMDEwMl0sIFszNy44ODMyODUsIC0xMjIuMjc0MTQ0OTk5OTk5OTldLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg2OTU0NSwgLTEyMi4yNTI1NzddLCBbMzcuODYwMjI1LCAtMTIyLjI2OTQ1M10sIFszNy44NTQzNTgwMDAwMDAwMDUsIC0xMjIuMjUyNzg0XSwgWzM3Ljg2NDg3MiwgLTEyMi4yNzQ1ODcwMDAwMDAwMV0sIFszNy44NjMzMSwgLTEyMi4zMTYxMTI5OTk5OTk5OV0sIFszNy44NjU4NjgsIC0xMjIuMjUxNTk1XSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NTQxMzcsIC0xMjIuMjUxMDA3XSwgWzM3Ljg2NzIyMSwgLTEyMi4yNjM1MzFdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjcyOTA5OTk5OTk5OTQsIC0xMjIuMjcwMjQ0OTk5OTk5OTldLCBbMzcuODU3NjQ3LCAtMTIyLjI3MzE0NV0sIFszNy44NzAwNTM5OTk5OTk5OTYsIC0xMjIuMjg0MjYzXSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NzA5MTEsIC0xMjIuMjg5Njg0MDAwMDAwMDFdLCBbMzcuODY5Njg1LCAtMTIyLjI3MjgwNDAwMDAwMDAxXSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44ODA5MjIsIC0xMjIuMzAzMTE0OTk5OTk5OTldLCBbMzcuODcxODI4LCAtMTIyLjI3MDUxNTk5OTk5OTk5XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODkxMjE0LCAtMTIyLjI4MjE1ODAwMDAwMDAxXSwgWzM3Ljg1NTc5OCwgLTEyMi4yNTI3MDddLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NzUyMTgsIC0xMjIuMjk0MDUyMDAwMDAwMDFdLCBbMzcuODg4MDcxOTk5OTk5OTk0LCAtMTIyLjI3MjM0Mzk5OTk5OTk5XSwgWzM3Ljg3MDU4MywgLTEyMi4yNjU5NTZdLCBbMzcuODgwOTIyLCAtMTIyLjMwMzExNDk5OTk5OTk5XSwgWzM3Ljg2MzU2NDAwMDAwMDAwNCwgLTEyMi4yOTUxMzUwMDAwMDAwMl0sIFszNy44NzA0MTY5OTk5OTk5OTYsIC0xMjIuMjkyNDg1MDAwMDAwMDFdLCBbMzcuODYyMzc5LCAtMTIyLjI1MDA1NF0sIFszNy44NzI2OTA5OTk5OTk5OTYsIC0xMjIuMjcwNzQwOTk5OTk5OTldLCBbMzcuODYxNjUzMDAwMDAwMDA0LCAtMTIyLjI3ODUyOV0sIFszNy44Njc5NzE5OTk5OTk5OTUsIC0xMjIuMjYzNjk5XSwgWzM3Ljg3Mjg0NywgLTEyMi4yODIzMTI5OTk5OTk5OV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg3OTk5NjAwMDAwMDAwNiwgLTEyMi4yOTY4OTNdLCBbMzcuODcxMzExLCAtMTIyLjI4MTk3ODAwMDAwMDAxXSwgWzM3Ljg1ODg1NiwgLTEyMi4yNzE1OTJdLCBbMzcuODY4NDE3LCAtMTIyLjMwMjUzOV0sIFszNy44ODA3ODYsIC0xMjIuMzAzMDY3XSwgWzM3Ljg2Nzk0OCwgLTEyMi4yNTA2NjM5OTk5OTk5OV0sIFszNy44NzQyNTEsIC0xMjIuMjgwMjAzXSwgWzM3Ljg5MDcxNiwgLTEyMi4yNjgyOTldLCBbMzcuODcyMTc1LCAtMTIyLjI2NzgzNV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODcyMTA2LCAtMTIyLjI2ODQwNV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODc2MzA3MDAwMDAwMDA0LCAtMTIyLjI2ODkyM10sIFszNy44NjY3MzksIC0xMjIuMjY3Mjk5XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NjMyOTIsIC0xMjIuMjU2MjkzXSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NjM1OTc5OTk5OTk5OTYsIC0xMjIuMjUzNjkzXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NTI0MjIsIC0xMjIuMjc4NTcxXSwgWzM3Ljg3MzMyNywgLTEyMi4yNzMyMTRdLCBbMzcuODY3ODcxLCAtMTIyLjI2NTY1XSwgWzM3Ljg2NjI2NTAwMDAwMDAwNiwgLTEyMi4zMDU1OTE5OTk5OTk5OV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1NTY3MSwgLTEyMi4yNjI0NjEwMDAwMDAwMl0sIFszNy44Nzc3MTUsIC0xMjIuMzA5NjE4XSwgWzM3Ljg2MzkzNCwgLTEyMi4yNTAyNjJdLCBbMzcuODUwODk5LCAtMTIyLjI3NjE3NF0sIFszNy44NjgxMDMwMDAwMDAwMDUsIC0xMjIuMjU2NzJdLCBbMzcuODY5NjI1LCAtMTIyLjI2NTg5Ml0sIFszNy44NjM5MzgsIC0xMjIuMjUzNzM1XSwgWzM3Ljg1NzQ1MiwgLTEyMi4yNTk1NDhdLCBbMzcuODUxOTI4LCAtMTIyLjI3NDAxNjk5OTk5OTk5XSwgWzM3Ljg3MDg2NywgLTEyMi4yNzA2MzUwMDAwMDAwMV0sIFszNy44ODI4NiwgLTEyMi4yOTc4NDhdLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTY3OTIsIC0xMjIuMjc5ODQ1XSwgWzM3Ljg1NzM4NywgLTEyMi4yNjE1MzZdLCBbMzcuODcwMDUzOTk5OTk5OTk2LCAtMTIyLjI4NDI2M10sIFszNy44NjE5OTA5OTk5OTk5OTYsIC0xMjIuMjk0Mzk0XSwgWzM3Ljg2Njk1LCAtMTIyLjI4Njk4NF0sIFszNy44NzA5MTEsIC0xMjIuMjg5Njg0MDAwMDAwMDFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2NzMxNywgLTEyMi4yOTM5ODJdLCBbMzcuODk0NDgzLCAtMTIyLjI3NjA4NTAwMDAwMDAxXSwgWzM3Ljg3MDI4NywgLTEyMi4zMTYyMzc5OTk5OTk5OF0sIFszNy44ODM3OTA5OTk5OTk5OTUsIC0xMjIuMjQ5NzA5MDAwMDAwMDFdLCBbMzcuODU4ODg4LCAtMTIyLjI2NDEzN10sIFszNy44NTE3NywgLTEyMi4yNzY0ODg5OTk5OTk5OF0sIFszNy45MDIwNTksIC0xMjIuMjY1Mjk0XSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODUwMzQ1MDAwMDAwMDA0LCAtMTIyLjI3MDkxMTAwMDAwMDAxXSwgWzM3Ljg1MzEsIC0xMjIuMjY2MTMxXSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg4MTUyNSwgLTEyMi4yNjk5NzRdLCBbMzcuODU5ODg5LCAtMTIyLjI3ODE2N10sIFszNy44ODAyMjcwMDAwMDAwMDUsIC0xMjIuMjY5MzZdLCBbMzcuODc2NjQ0LCAtMTIyLjI5OTM1NDAwMDAwMDAxXSwgWzM3Ljg3NDIzNywgLTEyMi4yNzMwNTJdLCBbMzcuODUwMzY3LCAtMTIyLjI3MjgwN10sIFszNy44NTE2NTMwMDAwMDAwMDYsIC0xMjIuMjg5MTk0XSwgWzM3Ljg4MTIwMTAwMDAwMDAwNCwgLTEyMi4yOTA5OF0sIFszNy44NTU0MzUsIC0xMjIuMjU5ODQxXSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODY3ODM1LCAtMTIyLjI5MTY0NDk5OTk5OTk5XSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NjcyMjEsIC0xMjIuMjYzNTMxXSwgWzM3Ljg2NzAyNiwgLTEyMi4yOTk3MzcwMDAwMDAwMV0sIFszNy44Nzc3MTUsIC0xMjIuMzA5NjE4XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NTIyNTcsIC0xMjIuMjg2MTA3XSwgWzM3Ljg4MzAwOSwgLTEyMi4yNjUwOTM5OTk5OTk5OV0sIFszNy44NzM2NzgwMDAwMDAwMDUsIC0xMjIuMjY5NzY0OTk5OTk5OTldLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg1NTgzMiwgLTEyMi4yNzIzNjldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg1MDM0NTAwMDAwMDAwNCwgLTEyMi4yNzA5MTEwMDAwMDAwMV0sIFszNy44NjI0OTEsIC0xMjIuMjY0Nl0sIFszNy44NzcxNTMsIC0xMjIuMjk2OTA1MDAwMDAwMDFdLCBbMzcuODg3OTYxLCAtMTIyLjI2OTgyMTk5OTk5OTk5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3ODMxMiwgLTEyMi4zMDY1NDI5OTk5OTk5OV0sIFszNy44NzAzMDgsIC0xMjIuMjY4MDVdLCBbMzcuODY2OTUsIC0xMjIuMjg2OTg0XSwgWzM3Ljg2NzYwMSwgLTEyMi4yNjc3MTc5OTk5OTk5OV0sIFszNy44NzUxMTMsIC0xMjIuMjczNDEyOTk5OTk5OTldLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODUzNTUzOTk5OTk5OTk1LCAtMTIyLjI3NjkyNV0sIFszNy44ODMyMjQsIC0xMjIuMjU2NDY0XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NTA4OTksIC0xMjIuMjc2MTc0XSwgWzM3Ljg3MDIxMywgLTEyMi4yOTM3NDldLCBbMzcuODc2ODgxLCAtMTIyLjI2NjY2NTk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODgyMzUzLCAtMTIyLjI2NzEzNjAwMDAwMDAxXSwgWzM3Ljg2OTgzOSwgLTEyMi4yNTIzNjVdLCBbMzcuODU0NDQyLCAtMTIyLjI3NzEwN10sIFszNy44NTkxMDIsIC0xMjIuMjkwMTYyOTk5OTk5OTldLCBbMzcuODkwOTQ1LCAtMTIyLjI3MTEyNl0sIFszNy44NjY5NjksIC0xMjIuMjY1NTNdLCBbMzcuODcxMjQ2LCAtMTIyLjI3NDk5MDk5OTk5OTk5XSwgWzM3Ljg3ODYyOSwgLTEyMi4yNjA4ODNdLCBbMzcuODUyMjExLCAtMTIyLjI4NjMzNl0sIFszNy44NjEyNjUsIC0xMjIuMjY2OThdLCBbMzcuODY5MzEyLCAtMTIyLjI1NDMxNF0sIFszNy44NzEyNDYsIC0xMjIuMjc0OTkwOTk5OTk5OTldLCBbMzcuODYyNDYyLCAtMTIyLjI5MjE0OV0sIFszNy44NTkzMTksIC0xMjIuMjg5MDddLCBbMzcuODczMzUxLCAtMTIyLjMwNTM3NF0sIFszNy44ODIwNjcsIC0xMjIuMjk2MzkyXSwgWzM3Ljg5NjY4OCwgLTEyMi4yNzQ1NjAwMDAwMDAwMV0sIFszNy44NjU3OTA5OTk5OTk5OTQsIC0xMjIuMjY3NTEwMDAwMDAwMDJdLCBbMzcuODc1MjUzLCAtMTIyLjI5NDA2MjAwMDAwMDAxXSwgWzM3Ljg4MjUyOTk5OTk5OTk5NiwgLTEyMi4yODAyMTddLCBbMzcuODcxNTQ0LCAtMTIyLjI3MjcxNF0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg2OTQ0OCwgLTEyMi4yODE3ODNdLCBbMzcuODc0OTMsIC0xMjIuMzAxMTQ3XSwgWzM3Ljg2MTYwNCwgLTEyMi4yNjQzNjZdLCBbMzcuODYxNjYxLCAtMTIyLjI1NjE2OV0sIFszNy44ODA3MzQwMDAwMDAwMDQsIC0xMjIuMjY1MzU5XSwgWzM3Ljg2OTUyNCwgLTEyMi4yNzk2NV0sIFszNy44OTEzNjgsIC0xMjIuMjc5MjU3XSwgWzM3Ljg4OTUwNywgLTEyMi4yODE2Njk5OTk5OTk5OV0sIFszNy44NzA0MTY5OTk5OTk5OTYsIC0xMjIuMjkyNDg1MDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NjkyLCAtMTIyLjI2OTMwODAwMDAwMDAxXSwgWzM3Ljg3MTcyLCAtMTIyLjI3MTM3MV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg4NjM3LCAtMTIyLjI2NDMzOTk5OTk5OTk5XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODY3ODE2LCAtMTIyLjI1ODk5NF0sIFszNy44Njg0MjQsIC0xMjIuMjYxNDUxXSwgWzM3Ljg1NjA3ODAwMDAwMDAwNCwgLTEyMi4yNzkzMTFdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy45MDQzMzEsIC0xMjIuMjY5NTEyXSwgWzM3Ljg1ODUyNSwgLTEyMi4yNjY5MDZdLCBbMzcuODc3ODkxLCAtMTIyLjI5OTQxOV0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg3ODk2MywgLTEyMi4yOTM0NDZdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODU5ODg5LCAtMTIyLjI3ODE2N10sIFszNy44NjQ4NzIsIC0xMjIuMjc0NTg3MDAwMDAwMDFdLCBbMzcuODU0ODgsIC0xMjIuMjY5MDc5XSwgWzM3Ljg2NzcwOCwgLTEyMi4yNTA4MDFdLCBbMzcuODY4MzU1LCAtMTIyLjI3NDk1M10sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg3MDYyNywgLTEyMi4yNzk3NjVdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44ODA3MTgsIC0xMjIuMzA0MTQ0OTk5OTk5OTldLCBbMzcuODU3OTkzLCAtMTIyLjI2Mzk2NDk5OTk5OTk4XSwgWzM3Ljg1NDYxMiwgLTEyMi4yODExNzhdLCBbMzcuODcwOTExLCAtMTIyLjI4OTY4NDAwMDAwMDAxXSwgWzM3Ljg2Mjc2MywgLTEyMi4yNjI2MzldLCBbMzcuODc4NjI5LCAtMTIyLjI2MDg4M10sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY0ODI2LCAtMTIyLjI2MDcxOV0sIFszNy44NzA5MTEsIC0xMjIuMjg5Njg0MDAwMDAwMDFdLCBbMzcuODY4NjQxLCAtMTIyLjI5NDE1XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44Njk2NTIsIC0xMjIuMjY1ODgyXSwgWzM3Ljg4MzIwMjAwMDAwMDAwNCwgLTEyMi4yNTE5NzgwMDAwMDAwMV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODU0NzQ2OTk5OTk5OTk2LCAtMTIyLjI4MDM2MTAwMDAwMDAxXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg4MDkwMiwgLTEyMi4yODc3NTcwMDAwMDAwMV0sIFszNy44NTM1NTM5OTk5OTk5OTUsIC0xMjIuMjc2OTI1XSwgWzM3Ljg3MjY5MDk5OTk5OTk5NiwgLTEyMi4yNzA3NDA5OTk5OTk5OV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODcxNzQzLCAtMTIyLjI3MTg3OF0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2NTEyMSwgLTEyMi4yNTg0NTVdLCBbMzcuODY5MDU3LCAtMTIyLjI3MDQ2Mjk5OTk5OTk5XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NzE3MTMsIC0xMjIuMjgyMTg1MDAwMDAwMDFdLCBbMzcuODU4NDU1LCAtMTIyLjI5MzM3NF0sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODc4MTEyLCAtMTIyLjI2OTExMzk5OTk5OTk5XSwgWzM3Ljg2NzYwMSwgLTEyMi4yNjc3MTc5OTk5OTk5OV0sIFszNy44NjE4NjQwMDAwMDAwMDQsIC0xMjIuMjYyNDU0XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjcyNzEsIC0xMjIuMjk4NjgyXSwgWzM3Ljg4NDA3MSwgLTEyMi4yNzkzMTAwMDAwMDAwMV0sIFszNy44NTIxMzcsIC0xMjIuMjg2NzMyXSwgWzM3Ljg1NTI5NCwgLTEyMi4yOTI0NzVdLCBbMzcuODY1MTQwOTk5OTk5OTk0LCAtMTIyLjI2NTQ0MV0sIFszNy44NjIxODQsIC0xMjIuMjkzNTE3XSwgWzM3Ljg2NjIzMSwgLTEyMi4yOTEyOTldLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NjkwODQsIC0xMjIuMjk5MjQ1XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44Njc4NTIsIC0xMjIuMjc5NDcyXSwgWzM3Ljg3OTE2Njk5OTk5OTk5NSwgLTEyMi4yNzk0NzkwMDAwMDAwMV0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1NTY4NDAwMDAwMDAwNCwgLTEyMi4yNjM0OTA5OTk5OTk5OV0sIFszNy44NTQ4OCwgLTEyMi4yNjkwNzldLCBbMzcuODYzMjkyLCAtMTIyLjI1NjI5M10sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2NjcsIC0xMjIuMjY3NjE0XSwgWzM3Ljg3Nzk1MSwgLTEyMi4yNzEzOTVdLCBbMzcuODUzOTIxLCAtMTIyLjI1MjQyMl0sIFszNy44NjQ1NiwgLTEyMi4yNjk5NTRdLCBbMzcuODYwNjg2LCAtMTIyLjI3ODMzNzAwMDAwMDAxXSwgWzM3Ljg3ODI3NiwgLTEyMi4yNzAyNzE5OTk5OTk5OV0sIFszNy44Njc3MTcsIC0xMjIuMjQ5OTAxXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODgwMjI3MDAwMDAwMDA1LCAtMTIyLjI2OTM2XSwgWzM3Ljg2MTUxMSwgLTEyMi4yOTY4MTAwMDAwMDAwMV0sIFszNy44NjAzNjYsIC0xMjIuMjY2ODAyXSwgWzM3Ljg3ODczNywgLTEyMi4zMDQ0MzQwMDAwMDAwMV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3LjkwMDY0MSwgLTEyMi4yNjkxODFdLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg1MzMxNiwgLTEyMi4yNzg3Mzc5OTk5OTk5OV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODcwMDExLCAtMTIyLjMxNzldLCBbMzcuODc1MDk4LCAtMTIyLjI5OTk2N10sIFszNy44NTUwMjYsIC0xMjIuMjY2NDc1XSwgWzM3Ljg2NzU0NjAwMDAwMDAwNCwgLTEyMi4yNTE5NjddLCBbMzcuODY3MjkwOTk5OTk5OTk0LCAtMTIyLjI3MDI0NDk5OTk5OTk5XSwgWzM3Ljg2OTM5LCAtMTIyLjI2Nzg4MzAwMDAwMDAxXSwgWzM3Ljg2NzMwMSwgLTEyMi4yNTU3NzddLCBbMzcuODc2ODgxLCAtMTIyLjI2NjY2NTk5OTk5OTk5XSwgWzM3Ljg2MTYwNCwgLTEyMi4yNjQzNjZdLCBbMzcuODY5MzE4LCAtMTIyLjI5Njk4NDAwMDAwMDAxXSwgWzM3Ljg4MDAyMSwgLTEyMi4yOTgwOTA5OTk5OTk5OV0sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODY3ODE2LCAtMTIyLjI1ODk5NF0sIFszNy44NjkxMzcsIC0xMjIuMjUwOTA4MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NjYyMzEsIC0xMjIuMjkxMjk5XSwgWzM3Ljg1NjAyMywgLTEyMi4yNzk2ODNdLCBbMzcuODYyNDYyLCAtMTIyLjI5MjE0OV0sIFszNy44NjE1NzMsIC0xMjIuMjU3NDUyXSwgWzM3Ljg3NTUzMSwgLTEyMi4zMDQ4NTVdLCBbMzcuODUzMDg1LCAtMTIyLjI5MzgzMjAwMDAwMDAxXSwgWzM3Ljg3MDMwOCwgLTEyMi4yNjgwNV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Njc1MTMsIC0xMjIuMjgxMTY0OTk5OTk5OTldLCBbMzcuODY1NDIsIC0xMjIuMjU2MThdLCBbMzcuODY3ODEyLCAtMTIyLjI1MTY5N10sIFszNy44NzI2OTA5OTk5OTk5OTYsIC0xMjIuMjcwNzQwOTk5OTk5OTldLCBbMzcuODgxNzg4LCAtMTIyLjI3MDY3OF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg3MTMyMywgLTEyMi4yNjcyMjJdLCBbMzcuODY3NjY4LCAtMTIyLjI2MDEwOTAwMDAwMDAxXSwgWzM3Ljg2MjQ5MSwgLTEyMi4yNjQ2XSwgWzM3Ljg2MzgzOSwgLTEyMi4yODEzOTA5OTk5OTk5OV0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODcwMjEzLCAtMTIyLjI5Mzc0OV0sIFszNy44NjcwMjYsIC0xMjIuMjk5NzM3MDAwMDAwMDFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2MzQ0MywgLTEyMi4yNTYzMDRdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg3MDU2MiwgLTEyMi4zMTQ1MDNdLCBbMzcuODg3NDk4LCAtMTIyLjMwNTMwNF0sIFszNy44OTg1MjQsIC0xMjIuMjY3MTI5XSwgWzM3Ljg4MTM2NiwgLTEyMi4yODk2ODc5OTk5OTk5OF0sIFszNy44NjU4NDksIC0xMjIuMjU5OTc3XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44Nzc4Mjk5OTk5OTk5OTYsIC0xMjIuMjk5NzIzXSwgWzM3Ljg1MjgyMTk5OTk5OTk5NiwgLTEyMi4yOTE2NzddLCBbMzcuODY3OTMsIC0xMjIuMjUxNzk4XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODU3NTAyMDAwMDAwMDA0LCAtMTIyLjI5MDg0NDk5OTk5OTk5XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44NjQ0MTEsIC0xMjIuMjkwNzA1XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODcyMTc1LCAtMTIyLjI2NzgzNV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODc3NTI4MDAwMDAwMDA1LCAtMTIyLjI3NTk1NjAwMDAwMDAxXSwgWzM3Ljg0OTYwOSwgLTEyMi4yODIwMDAwMDAwMDAwMV0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODg0NzMyLCAtMTIyLjI4MDkxOF0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODUxNzcsIC0xMjIuMjc2NDg4OTk5OTk5OThdLCBbMzcuODU4OTAzMDAwMDAwMDA1LCAtMTIyLjI0Mzk3Ml0sIFszNy44NjI1NDIsIC0xMjIuMjkwMTA0XSwgWzM3Ljg3MDYyNywgLTEyMi4yNzk3NjVdLCBbMzcuODcxMjcxLCAtMTIyLjI5NTAxNDk5OTk5OTk5XSwgWzM3Ljg3MjIzMSwgLTEyMi4yOTY3N10sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODc2OTYzLCAtMTIyLjI2NTU5MDk5OTk5OTk5XSwgWzM3Ljg2NjU1ODAwMDAwMDAwNSwgLTEyMi4yOTAwMTVdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODYzNjc5LCAtMTIyLjI2OTYzXSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NTU2ODQwMDAwMDAwMDQsIC0xMjIuMjYzNDkwOTk5OTk5OTldLCBbMzcuODY1ODI2LCAtMTIyLjI2NzI0Mzk5OTk5OTk5XSwgWzM3Ljg2NDg5NywgLTEyMi4yODg2NzE5OTk5OTk5OV0sIFszNy44Njc3MTcsIC0xMjIuMjQ5OTAxXSwgWzM3Ljg2MDM2NiwgLTEyMi4yNjY4MDJdLCBbMzcuODY3MjEyLCAtMTIyLjI4MTczODk5OTk5OTk5XSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44Njg4NzgsIC0xMjIuMzAwMjg0XSwgWzM3Ljg1NTM4OSwgLTEyMi4yNjQ1NTJdLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NTQ4OTAwMDAwMDAwMDUsIC0xMjIuMjUyNTYzOTk5OTk5OTldLCBbMzcuODU4MTMyLCAtMTIyLjI3NzU5NDk5OTk5OTk5XSwgWzM3Ljg2NzI1OTAwMDAwMDAwNCwgLTEyMi4yNjMyNF0sIFszNy44NjYyNTMsIC0xMjIuMjk5NDgzMDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NTI2ODMsIC0xMjIuMjc2NTU2XSwgWzM3Ljg2MzMxLCAtMTIyLjMxNjExMjk5OTk5OTk5XSwgWzM3Ljg4MDI0LCAtMTIyLjMwNjM4NzAwMDAwMDAyXSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NTMzMTYsIC0xMjIuMjc4NzM3OTk5OTk5OTldLCBbMzcuODczODY1LCAtMTIyLjMwMDc3N10sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44ODI5ODUsIC0xMjIuMjYxNjE0OTk5OTk5OTldLCBbMzcuODY4OTE1LCAtMTIyLjI5MzMyMl0sIFszNy44ODA1NjQsIC0xMjIuMzA0ODk2XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg4Mjg0NiwgLTEyMi4yNzQyM10sIFszNy44NzA4NjcsIC0xMjIuMjcwNjM1MDAwMDAwMDFdLCBbMzcuODY0ODk0LCAtMTIyLjI2NzQwMl0sIFszNy44Njc5MjYwMDAwMDAwMDQsIC0xMjIuMjk3NjYzOTk5OTk5OThdLCBbMzcuODY4MzY1OTk5OTk5OTk1LCAtMTIyLjI5NTUwODAwMDAwMDAxXSwgWzM3Ljg2NjI1MywgLTEyMi4yOTk0ODMwMDAwMDAwMV0sIFszNy44ODgwMjMsIC0xMjIuMjUzNTExXSwgWzM3Ljg4MzA3ODAwMDAwMDAwNSwgLTEyMi4yNjE2Mzk5OTk5OTk5OV0sIFszNy44ODA1NjQsIC0xMjIuMzA0ODk2XSwgWzM3Ljg4MTAwNCwgLTEyMi4yODMyMjVdLCBbMzcuODgwMDc1LCAtMTIyLjI3MDQ3Nl0sIFszNy44NjkwNTcsIC0xMjIuMjcwNDYyOTk5OTk5OTldLCBbMzcuODY3MzczLCAtMTIyLjI0OTUxNDk5OTk5OTk5XSwgWzM3Ljg1OTU1NywgLTEyMi4yOTczM10sIFszNy44Njc1ODMsIC0xMjIuMjY3ODQ0XSwgWzM3Ljg2OTIsIC0xMjIuMjY5MzA4MDAwMDAwMDFdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODY3ODcxLCAtMTIyLjI2NTY1XSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NzgyNzQsIC0xMjIuMjk3NTU2XSwgWzM3Ljg3NjU0OSwgLTEyMi4yOTA4OTldLCBbMzcuODU4ODY3LCAtMTIyLjI3ODk5MTk5OTk5OTk5XSwgWzM3Ljg2NjUyNCwgLTEyMi4yOTgxMzk5OTk5OTk5OV0sIFszNy44NjExNDQsIC0xMjIuMjk4NzQxOTk5OTk5OTldLCBbMzcuODU1Njg0MDAwMDAwMDA0LCAtMTIyLjI2MzQ5MDk5OTk5OTk5XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44Njc4NzEsIC0xMjIuMjY1NjVdLCBbMzcuODgyMTM1LCAtMTIyLjI2NzIzODk5OTk5OTk5XSwgWzM3Ljg3NjU5NCwgLTEyMi4yNjg5NTZdLCBbMzcuODY1ODE1OTk5OTk5OTk1LCAtMTIyLjI4MTYwMV0sIFszNy44NjYwNzQsIC0xMjIuMjYzMzFdLCBbMzcuODY1NDY2LCAtMTIyLjI3MDA1XSwgWzM3Ljg3MjcyNSwgLTEyMi4yNzc3MjkwMDAwMDAwMV0sIFszNy44NzkzMzMsIC0xMjIuMjc0OTY3OTk5OTk5OTldLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODcwMDUzOTk5OTk5OTk2LCAtMTIyLjI4NDI2M10sIFszNy44NzU1MzEsIC0xMjIuMzA0ODU1XSwgWzM3Ljg4OTAxNjk5OTk5OTk5NiwgLTEyMi4yNzIzODg5OTk5OTk5OV0sIFszNy44Njc5MjYwMDAwMDAwMDQsIC0xMjIuMjk3NjYzOTk5OTk5OThdLCBbMzcuODU2MTMyLCAtMTIyLjI3MTI5MTk5OTk5OTk5XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODQ4NTM0LCAtMTIyLjI3Mjk5OV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg4Njc3MiwgLTEyMi4yODI1MjRdLCBbMzcuODYyNzYzLCAtMTIyLjI2MjYzOV0sIFszNy44NzYzMzksIC0xMjIuMjg1MDEyMDAwMDAwMDFdLCBbMzcuODczNzQ1LCAtMTIyLjI2OTc3NV0sIFszNy44NjkwNTcsIC0xMjIuMjcwNDYyOTk5OTk5OTldLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg3MDc5MywgLTEyMi4yOTc0OTZdLCBbMzcuODY5NjUyLCAtMTIyLjI2NTg4Ml0sIFszNy44NjYyNjUwMDAwMDAwMDYsIC0xMjIuMzA1NTkxOTk5OTk5OTldLCBbMzcuODUyMywgLTEyMi4yNzAwNDY5OTk5OTk5OV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg1NDA1LCAtMTIyLjIzNjQyOV0sIFszNy44ODAyNjYsIC0xMjIuMjY5MDMyMDAwMDAwMDFdLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NzA5MDk5OTk5OTk5OTUsIC0xMjIuMjY1OTkzXSwgWzM3Ljg2MzM3Mjk5OTk5OTk5NiwgLTEyMi4yOTY4OTNdLCBbMzcuODU4MTY1LCAtMTIyLjI1NTY4NzAwMDAwMDAxXSwgWzM3Ljg2OTA1NywgLTEyMi4yNzA0NjI5OTk5OTk5OV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODU0MTg2LCAtMTIyLjI3OTE1NzAwMDAwMDAxXSwgWzM3Ljg4MDAyMSwgLTEyMi4yOTgwOTA5OTk5OTk5OV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg5OTI2NCwgLTEyMi4yNjUxMDgwMDAwMDAwMV0sIFszNy44NzA1NjIsIC0xMjIuMzE0NTAzXSwgWzM3Ljg3MDQsIC0xMjIuMjkyNjQ0XSwgWzM3Ljg3MjQzNDk5OTk5OTk5NiwgLTEyMi4yNzk5ODc5OTk5OTk5OV0sIFszNy44NTgwNDcsIC0xMjIuMjQ1MzA2XSwgWzM3Ljg4MjMzNywgLTEyMi4yNjcyNjIwMDAwMDAwMl0sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODc0MjUxLCAtMTIyLjI4MDIwM10sIFszNy44NTMwODUsIC0xMjIuMjkzODMyMDAwMDAwMDFdLCBbMzcuODU1MDI2LCAtMTIyLjI2NjQ3NV0sIFszNy44NzAzOSwgLTEyMi4yODgxMV0sIFszNy44NTI0MjIsIC0xMjIuMjc4NTcxXSwgWzM3Ljg2MTA3ODAwMDAwMDAwNiwgLTEyMi4yODk2MzIwMDAwMDAwMV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg2OTA0MDk5OTk5OTk5NiwgLTEyMi4yOTIyMDRdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2NzI5MDk5OTk5OTk5NCwgLTEyMi4yNzAyNDQ5OTk5OTk5OV0sIFszNy44NjEwODEsIC0xMjIuMjc1OTg0MDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg2NzQxMSwgLTEyMi4yODE1NzkwMDAwMDAwMV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODUwMzQ1MDAwMDAwMDA0LCAtMTIyLjI3MDkxMTAwMDAwMDAxXSwgWzM3Ljg3OTU1OCwgLTEyMi4yOTU1NzldLCBbMzcuODY4MjgxLCAtMTIyLjMwMDEwMl0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44NjAyNjQsIC0xMjIuMjgyODY3XSwgWzM3Ljg0NzkwODAwMDAwMDAwNCwgLTEyMi4yNzc2ODVdLCBbMzcuODcxOSwgLTEyMi4yNjgzODg5OTk5OTk5OF0sIFszNy44ODEyMDEwMDAwMDAwMDQsIC0xMjIuMjkwOThdLCBbMzcuODU3Nzg4LCAtMTIyLjI0OTc1NDAwMDAwMDAxXSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44NzA0MTY5OTk5OTk5OTYsIC0xMjIuMjkyNDg1MDAwMDAwMDFdLCBbMzcuODY3NzE3LCAtMTIyLjI0OTkwMV0sIFszNy44Njc3MTcsIC0xMjIuMjQ5OTAxXSwgWzM3Ljg1MzI3NSwgLTEyMi4yNzkwNzhdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NTM1NTM5OTk5OTk5OTUsIC0xMjIuMjc2OTI1XSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NTQyMTUsIC0xMjIuMjY5MTY3XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NzY0MjgwMDAwMDAwMDQsIC0xMjIuMjkxNzM2MDAwMDAwMDFdLCBbMzcuODY3NjQzLCAtMTIyLjI4MDY0M10sIFszNy44NTUyOTI5OTk5OTk5OTYsIC0xMjIuMjY2NTAyXSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODUwMzQ1MDAwMDAwMDA0LCAtMTIyLjI3MDkxMTAwMDAwMDAxXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NDg4MzQwMDAwMDAwMDQsIC0xMjIuMjc3ODk5XSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg1MDQyNCwgLTEyMi4yOTYwMzFdLCBbMzcuODgzMjAyMDAwMDAwMDA0LCAtMTIyLjI1MTk3ODAwMDAwMDAxXSwgWzM3Ljg1NTU5NSwgLTEyMi4yMzk2MDRdLCBbMzcuODU3NjczOTk5OTk5OTk2LCAtMTIyLjI1OTQzNDAwMDAwMDAxXSwgWzM3Ljg4MDAyNywgLTEyMi4yNzk5NzZdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTY5NjgsIC0xMjIuMjc5NTQ0XSwgWzM3Ljg1OTg1MjAwMDAwMDAwNCwgLTEyMi4yNDkyODk5OTk5OTk5OV0sIFszNy44NjY5NSwgLTEyMi4yODY5ODRdLCBbMzcuODc3NjYzLCAtMTIyLjI3NDgzMV0sIFszNy44NjUxNDA5OTk5OTk5OTQsIC0xMjIuMjY1NDQxXSwgWzM3LjkwMTU5NjAwMDAwMDAwNSwgLTEyMi4yNzAxODddLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NTM3MzgsIC0xMjIuMjUxNjYzXSwgWzM3Ljg2MTU1MywgLTEyMi4yOTY1OTldLCBbMzcuODc2ODgxLCAtMTIyLjI2NjY2NTk5OTk5OTk5XSwgWzM3Ljg3NjA0NSwgLTEyMi4yNjAzMzYwMDAwMDAwMV0sIFszNy44NTU3ODQsIC0xMjIuMjcxMjU1MDAwMDAwMDFdLCBbMzcuODU4OTAzMDAwMDAwMDA1LCAtMTIyLjI0Mzk3Ml0sIFszNy44ODE0NDUsIC0xMjIuMjc0MDc3XSwgWzM3Ljg1MDg5OSwgLTEyMi4yNzYxNzRdLCBbMzcuODU5MTk1LCAtMTIyLjI2MTkxNDk5OTk5OTk5XSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3MDkxMSwgLTEyMi4yODk2ODQwMDAwMDAwMV0sIFszNy44NjM5NTksIC0xMjIuMjY3NDMyXSwgWzM3Ljg1NTAyNiwgLTEyMi4yNjY0NzVdLCBbMzcuODcwOTcxOTk5OTk5OTk1LCAtMTIyLjI4ODE4NTAwMDAwMDAxXSwgWzM3Ljg3MjY5MDk5OTk5OTk5NiwgLTEyMi4yNzA3NDA5OTk5OTk5OV0sIFszNy44NzYzMDcwMDAwMDAwMDQsIC0xMjIuMjY4OTIzXSwgWzM3Ljg1MTMzOSwgLTEyMi4yODYzNDldLCBbMzcuODc1OTY2LCAtMTIyLjMwNDk4NzAwMDAwMDAxXSwgWzM3Ljg3MzIwMSwgLTEyMi4yNjc0NDRdLCBbMzcuODY3NjAxLCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3LjkwNDMzMSwgLTEyMi4yNjk1MTJdLCBbMzcuODc4NTUyLCAtMTIyLjI2Njg0Mzk5OTk5OTk5XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44NTg3NTksIC0xMjIuMjQ4NTIxXSwgWzM3Ljg3NzE1MywgLTEyMi4yOTY5MDUwMDAwMDAwMV0sIFszNy44NjIyMDIsIC0xMjIuMjgxMDI2XSwgWzM3Ljg4MDgsIC0xMjIuMjk0MDM2XSwgWzM3Ljg5MTIxNCwgLTEyMi4yODIxNTgwMDAwMDAwMV0sIFszNy44NTE2NTMwMDAwMDAwMDYsIC0xMjIuMjg5MTk0XSwgWzM3Ljg3OTE2NSwgLTEyMi4zMDIzMDVdLCBbMzcuODgwOCwgLTEyMi4yOTQwMzZdLCBbMzcuODY4OTEzLCAtMTIyLjI4NjA4XSwgWzM3Ljg2MzMxLCAtMTIyLjMxNjExMjk5OTk5OTk5XSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg1NDkxLCAtMTIyLjI2ODY2Nl0sIFszNy44ODIxMzUsIC0xMjIuMjY3MjM4OTk5OTk5OTldLCBbMzcuOTA0MzU0OTk5OTk5OTk1LCAtMTIyLjI3MDI2Mjk5OTk5OTk5XSwgWzM3Ljg3MzQ1NSwgLTEyMi4yOTM0NjVdLCBbMzcuODczMTk0LCAtMTIyLjMwNDA3XSwgWzM3Ljg1OTI1OSwgLTEyMi4yNzU3ODcwMDAwMDAwMV0sIFszNy44OTk3NjgsIC0xMjIuMjc5Nzk0XSwgWzM3Ljg3MDYwMywgLTEyMi4yNzA2MTIwMDAwMDAwMV0sIFszNy44NjgyNzI5OTk5OTk5OTUsIC0xMjIuMjk1OTYyOTk5OTk5OTldLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjkzMTIsIC0xMjIuMjU0MzE0XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44OTU0MTMsIC0xMjIuMjU4Njc0XSwgWzM3Ljg5MTM2OCwgLTEyMi4yNzkyNTddLCBbMzcuODUxNjUzMDAwMDAwMDA2LCAtMTIyLjI4OTE5NF0sIFszNy44NjM1MjE5OTk5OTk5OTYsIC0xMjIuMjU0OTkxOTk5OTk5OTldLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg3NjE4NiwgLTEyMi4zMDE1OF0sIFszNy44Nzg3MzcsIC0xMjIuMzA0NDM0MDAwMDAwMDFdLCBbMzcuODUzNTUzOTk5OTk5OTk1LCAtMTIyLjI3NjkyNV0sIFszNy44NzgxMjQsIC0xMjIuMjcxNDFdLCBbMzcuODYzOTc3LCAtMTIyLjI2NzMwN10sIFszNy44Nzk2OTAwMDAwMDAwMDQsIC0xMjIuMjk5NzEyOTk5OTk5OThdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjY5ODEsIC0xMjIuMzAyMDgzMDAwMDAwMDFdLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NzIxMDYsIC0xMjIuMjY4NDA1XSwgWzM3Ljg2OTgzOSwgLTEyMi4yNTIzNjVdLCBbMzcuODc0MDk0LCAtMTIyLjI5OTY0OV0sIFszNy44NzM0NTUsIC0xMjIuMjkzNDY1XSwgWzM3Ljg2NjYyMiwgLTEyMi4yNjEwOF0sIFszNy44NTkyNTksIC0xMjIuMjc1Nzg3MDAwMDAwMDFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3MDIxMywgLTEyMi4yOTM3NDldLCBbMzcuODUwMzY3LCAtMTIyLjI3MjgwN10sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NjY1OTQsIC0xMjIuMjg3OTQ0XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg2NTIwMjAwMDAwMDAwNCwgLTEyMi4yNTc3OTVdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjQ4MjYsIC0xMjIuMjYwNzE5XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44Njc5MDYsIC0xMjIuMjc5NDI4XSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODkyODI0LCAtMTIyLjI3MjcxNjk5OTk5OTk5XSwgWzM3Ljg2NjMyNzAwMDAwMDAwNSwgLTEyMi4yNjMzNTkwMDAwMDAwMV0sIFszNy44NzA2MzkwMDAwMDAwMDQsIC0xMjIuMjcyNDY3OTk5OTk5OTldLCBbMzcuODU3MTcsIC0xMjIuMjUyMjA5MDAwMDAwMDFdLCBbMzcuODUyMDY2LCAtMTIyLjI3Mjk5NF0sIFszNy44NzI0NywgLTEyMi4yNzMwMjFdLCBbMzcuODUzMzE2LCAtMTIyLjI3ODczNzk5OTk5OTk5XSwgWzM3Ljg4Mzk3MywgLTEyMi4yNjYzMjNdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NTIxNzQsIC0xMjIuMjY3ODI0XSwgWzM3Ljg2ODM1NSwgLTEyMi4yNzQ5NTNdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg3MDIzNiwgLTEyMi4yOTI1OTA5OTk5OTk5OV0sIFszNy44NjY5NjksIC0xMjIuMjY1NTNdLCBbMzcuODYyODQ0LCAtMTIyLjI5ODM2OF0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg2MzM1MzAwMDAwMDAwNCwgLTEyMi4yNzIwOTddLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NzQ4NDQsIC0xMjIuMjgyNTUyXSwgWzM3Ljg4Njc3MiwgLTEyMi4yODI1MjRdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NjU1MDEsIC0xMjIuMjY5Nzc0XSwgWzM3Ljg3Mzk3NiwgLTEyMi4yODIyNTddLCBbMzcuODY5MTg2LCAtMTIyLjI4Mzk0M10sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODYwMjI1LCAtMTIyLjI2OTQ1M10sIFszNy44Njc0OTA5OTk5OTk5OTQsIC0xMjIuMjU0MDU0MDAwMDAwMDFdLCBbMzcuODYyNTYyLCAtMTIyLjI2MjU5OF0sIFszNy44NjM3NzI5OTk5OTk5OTUsIC0xMjIuMjgzMDM0MDAwMDAwMDFdLCBbMzcuODU0Mjg2LCAtMTIyLjI3MTAxNDk5OTk5OTk5XSwgWzM3Ljg2MjQ1NiwgLTEyMi4yNjQ4NTEwMDAwMDAwMV0sIFszNy44NzQxODIsIC0xMjIuMjY1OTM3MDAwMDAwMDFdLCBbMzcuODYyMTg0LCAtMTIyLjI5MzUxN10sIFszNy44NTQ5MSwgLTEyMi4yNjg2NjZdLCBbMzcuODc5OTA1LCAtMTIyLjI4NTI3M10sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg2NTE0OSwgLTEyMi4yNTY0ODddLCBbMzcuODYzMzEsIC0xMjIuMzE2MTEyOTk5OTk5OTldLCBbMzcuODc4NDYxLCAtMTIyLjMwNTc4Nzk5OTk5OTk5XSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3MDYyNywgLTEyMi4yNzk3NjVdLCBbMzcuODY3NjAxLCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3Ljg4OTM5OSwgLTEyMi4yNjI1OTM5OTk5OTk5OV0sIFszNy44NTE1MDMsIC0xMjIuMjc4NTE3OTk5OTk5OTldLCBbMzcuODYzNjI1LCAtMTIyLjI4NDE1NV0sIFszNy44Njc4MzUsIC0xMjIuMjkxNjQ0OTk5OTk5OTldLCBbMzcuODgwNTY0LCAtMTIyLjMwNDg5Nl0sIFszNy44NjE4MjIsIC0xMjIuMjcxOTI2MDAwMDAwMDFdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NTg4NjcsIC0xMjIuMjc4OTkxOTk5OTk5OTldLCBbMzcuODY1ODc1LCAtMTIyLjI5MzUyM10sIFszNy44NzY4ODEsIC0xMjIuMjY2NjY1OTk5OTk5OTldLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg2OTMxOCwgLTEyMi4yOTY5ODQwMDAwMDAwMV0sIFszNy44NjAxNzIsIC0xMjIuMjgyODQ3XSwgWzM3Ljg1NDUzNTk5OTk5OTk5NiwgLTEyMi4yNjY0MDNdLCBbMzcuODU4NDM5MDAwMDAwMDA0LCAtMTIyLjI2NzU2OTk5OTk5OTk5XSwgWzM3Ljg1MzIyMTAwMDAwMDAwNSwgLTEyMi4yODA4MzJdLCBbMzcuODU1NTg0LCAtMTIyLjIzODQ3NF0sIFszNy44NzM5MjEsIC0xMjIuMjc1NTc3XSwgWzM3Ljg3NDA5NTAwMDAwMDAwNCwgLTEyMi4yODg1NDE5OTk5OTk5OV0sIFszNy44NjcwMjYsIC0xMjIuMjk5NzM3MDAwMDAwMDFdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NTY3MDUsIC0xMjIuMjkwMzE0OTk5OTk5OTldLCBbMzcuODYxNjQ1LCAtMTIyLjI1MzUwODAwMDAwMDAxXSwgWzM3Ljg1OTg1NCwgLTEyMi4yNTU4MDddLCBbMzcuODU1NjkyLCAtMTIyLjI4MTI1OV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg2NjUwOCwgLTEyMi4yNjEwNTcwMDAwMDAwMV0sIFszNy44NjQzMzMsIC0xMjIuMjc4NzkyXSwgWzM3Ljg3MjQ3LCAtMTIyLjI3OTcxNzk5OTk5OTk5XSwgWzM3Ljg3Njk3OCwgLTEyMi4yNzM2MTIwMDAwMDAwMV0sIFszNy44Njg5MTMsIC0xMjIuMjg2MDhdLCBbMzcuODcxNDYxLCAtMTIyLjI3MDcwNl0sIFszNy44NzI1NDUsIC0xMjIuMjk4MDQyOTk5OTk5OTldLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44ODA5MjIsIC0xMjIuMzAzMTE0OTk5OTk5OTldLCBbMzcuODgyNzAxMDAwMDAwMDA0LCAtMTIyLjI3NDIxNDk5OTk5OTk4XSwgWzM3Ljg5MjYyNSwgLTEyMi4yNjg0Mzg5OTk5OTk5OV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg2Njc2MSwgLTEyMi4yNTg3NzldLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODYwNjU5OTk5OTk5OTk2LCAtMTIyLjI1MzQwNzAwMDAwMDAxXSwgWzM3Ljg1NTI5Mjk5OTk5OTk5NiwgLTEyMi4yNjY1MDJdLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NTk5ODgsIC0xMjIuMjUzMzM4OTk5OTk5OThdLCBbMzcuODU1LCAtMTIyLjI3NzIwMl0sIFszNy44NjgyNzI5OTk5OTk5OTUsIC0xMjIuMjk1OTYyOTk5OTk5OTldLCBbMzcuODUxNzcsIC0xMjIuMjc2NDg4OTk5OTk5OThdLCBbMzcuODQ5NzQ3LCAtMTIyLjI3NzkwNzAwMDAwMDAxXSwgWzM3Ljg2NTIwMjAwMDAwMDAwNCwgLTEyMi4yNTc3OTVdLCBbMzcuODc2Mzg2LCAtMTIyLjI4NTAxN10sIFszNy44Njc5MDYsIC0xMjIuMjc5NDI4XSwgWzM3Ljg4OTY1ODAwMDAwMDAwNCwgLTEyMi4yNzAxMzddLCBbMzcuODg0MzQsIC0xMjIuMjYyNjg1XSwgWzM3Ljg5NDY3NjAwMDAwMDAwNCwgLTEyMi4yODU1NjI5OTk5OTk5OF0sIFszNy44NjkzOSwgLTEyMi4yNjc4ODMwMDAwMDAwMV0sIFszNy44NzUwODQsIC0xMjIuMjY2NDYzOTk5OTk5OThdLCBbMzcuODczMjUsIC0xMjIuMjkzNTU4XSwgWzM3Ljg2NDUzNSwgLTEyMi4yNjI5OTNdLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NjI0OSwgLTEyMi4yOTEyMzk5OTk5OTk5OV0sIFszNy44NzY4ODEsIC0xMjIuMjY2NjY1OTk5OTk5OTldLCBbMzcuODU2NzkyLCAtMTIyLjI3OTg0NV0sIFszNy44Nzc3OTMsIC0xMjIuMjYwNzA5XSwgWzM3Ljg4MzYyLCAtMTIyLjI2OTczNDAwMDAwMDAxXSwgWzM3Ljg3MTU5MywgLTEyMi4yNzk4NzkwMDAwMDAwMV0sIFszNy44ODE1MjUsIC0xMjIuMjY5OTc0XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NTAwMDEsIC0xMjIuMjc1OTYyOTk5OTk5OTldLCBbMzcuODk5NjAyLCAtMTIyLjI3MTEwMl0sIFszNy44NTc3NzYsIC0xMjIuMjg2NTc2XSwgWzM3Ljg2ODQ0Njk5OTk5OTk5NiwgLTEyMi4yNjEyNjc5OTk5OTk5OV0sIFszNy44NjU1MzQ5OTk5OTk5OTQsIC0xMjIuMjU1MjM1MDAwMDAwMDFdLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg2MzA3MTk5OTk5OTk5NSwgLTEyMi4yNjAzNTJdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NzY1OTQsIC0xMjIuMjY4OTU2XSwgWzM3Ljg3MzAyNCwgLTEyMi4yOTQ2NTJdLCBbMzcuODY1NzExLCAtMTIyLjI1Mzg4OTk5OTk5OTk4XSwgWzM3Ljg2NjU4MSwgLTEyMi4yNzAxNzldLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44Njg2NjMsIC0xMjIuMzAxMzI1XSwgWzM3Ljg4MDg5MywgLTEyMi4yODkzMjNdLCBbMzcuODY5MiwgLTEyMi4yNjkzMDgwMDAwMDAwMV0sIFszNy44NTk1MjgwMDAwMDAwMDUsIC0xMjIuMjU5MjYwMDAwMDAwMDFdLCBbMzcuODU5NDE1OTk5OTk5OTk2LCAtMTIyLjI4MTg0NDk5OTk5OTk5XSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODY4MTY0LCAtMTIyLjI1NjMxMzk5OTk5OTk5XSwgWzM3Ljg2ODg3OCwgLTEyMi4zMDAyODRdLCBbMzcuODY3MjEyLCAtMTIyLjI4MTczODk5OTk5OTk5XSwgWzM3Ljg1MjYsIC0xMjIuMjg5NzE0OTk5OTk5OTldLCBbMzcuODY3NTQ2MDAwMDAwMDA0LCAtMTIyLjI1MTk2N10sIFszNy44NTkzMDksIC0xMjIuMjU5MjkwOTk5OTk5OTldLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NjQ4MjYsIC0xMjIuMjYwNzE5XSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NjgxNDAwMDAwMDAwMDQsIC0xMjIuMjYzNzM2MDAwMDAwMDFdLCBbMzcuODY3ODE2LCAtMTIyLjI1ODk5NF0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NzMzNDMsIC0xMjIuMjgwMDg2MDAwMDAwMDFdLCBbMzcuODUxNTIxMDAwMDAwMDA1LCAtMTIyLjI4NTQ5XSwgWzM3Ljg2NzAyNiwgLTEyMi4yOTk3MzcwMDAwMDAwMV0sIFszNy44OTU4NDksIC0xMjIuMjYzNDI4XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODU4NTE4LCAtMTIyLjI1MjY1MzAwMDAwMDAxXSwgWzM3Ljg2Mjc2MywgLTEyMi4yNjI2MzldLCBbMzcuODc2ODgxLCAtMTIyLjI2NjY2NTk5OTk5OTk5XSwgWzM3Ljg2Nzk3MTk5OTk5OTk5NSwgLTEyMi4yNjM2OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODQ3NDQ2MDAwMDAwMDA1LCAtMTIyLjI4MTE0NTk5OTk5OTk5XSwgWzM3Ljg3MDU4MywgLTEyMi4yNjU5NTZdLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy44NjQ4MjYsIC0xMjIuMjYwNzE5XSwgWzM3Ljg4MDU2NCwgLTEyMi4zMDQ4OTZdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NjI3NjMsIC0xMjIuMjYyNjM5XSwgWzM3Ljg4MDU2NCwgLTEyMi4zMDQ4OTZdLCBbMzcuODY4NjE1OTk5OTk5OTk2LCAtMTIyLjI4ODM2NDk5OTk5OTk4XSwgWzM3Ljg2NjQyNjAwMDAwMDAwNCwgLTEyMi4yNjk3NjIwMDAwMDAwMV0sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODk0MjMzLCAtMTIyLjI2MDU1Ml0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg2NTg2OCwgLTEyMi4yNTE1OTVdLCBbMzcuODQ3ODM4LCAtMTIyLjI3NTc0MV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODczODY1LCAtMTIyLjMwMDc3N10sIFszNy44NzQ1MzcsIC0xMjIuMjYzODYyMDAwMDAwMDJdLCBbMzcuODcyNDcsIC0xMjIuMjc5NzE3OTk5OTk5OTldLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy44NjgxNjQsIC0xMjIuMjU2MzEzOTk5OTk5OTldLCBbMzcuODY4NTc0LCAtMTIyLjI3MDQxNDk5OTk5OTk5XSwgWzM3Ljg3NjMwNzAwMDAwMDAwNCwgLTEyMi4yNjg5MjNdLCBbMzcuODUxMzI0LCAtMTIyLjI3Mjg3M10sIFszNy44NjY1MDgsIC0xMjIuMjYxMDU3MDAwMDAwMDFdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg1NTc0OCwgLTEyMi4yOTAyODEwMDAwMDAwMV0sIFszNy44NzUzOTEsIC0xMjIuMjcxMTQwOTk5OTk5OTldLCBbMzcuODY3NTQ2MDAwMDAwMDA0LCAtMTIyLjI1MTk2N10sIFszNy44NTY3NTUsIC0xMjIuMjU1MjQ4XSwgWzM3Ljg3NzgyOTk5OTk5OTk5NiwgLTEyMi4yOTk3MjNdLCBbMzcuODc1MjQwOTk5OTk5OTk1LCAtMTIyLjI3MjM3XSwgWzM3Ljg1OTYxNCwgLTEyMi4yODAyNjc5OTk5OTk5OV0sIFszNy44NjI1NjIsIC0xMjIuMjYyNTk4XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44ODExNDEsIC0xMjIuMjc1MTc3XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODYzMDk5LCAtMTIyLjI4ODI1NV0sIFszNy44NjM2NTIsIC0xMjIuMjY5ODQzXSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44NjE2NTMwMDAwMDAwMDQsIC0xMjIuMjc4NTI5XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjIxMTgsIC0xMjIuMjUzMzhdLCBbMzcuODUyMjExLCAtMTIyLjI4NjMzNl0sIFszNy44Njg4NzgsIC0xMjIuMzAwMjg0XSwgWzM3Ljg1NDQyNywgLTEyMi4yNzAwMDYwMDAwMDAwMV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44Njc5MywgLTEyMi4yNTE3OThdLCBbMzcuODYzNjc5LCAtMTIyLjI2OTYzXSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY0OTA4LCAtMTIyLjI2NzI4ODk5OTk5OTk5XSwgWzM3Ljg1ODUyNSwgLTEyMi4yNjY5MDZdLCBbMzcuODY4MTk5LCAtMTIyLjI2MzI1M10sIFszNy44NTM1NTM5OTk5OTk5OTUsIC0xMjIuMjc2OTI1XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NTUyNSwgLTEyMi4yNzcxMjZdLCBbMzcuODgzODIsIC0xMjIuMjk2OTUyXSwgWzM3Ljg1MjEzNiwgLTEyMi4yNzM2OTQ5OTk5OTk5OV0sIFszNy44NTU2NTksIC0xMjIuMjU2Mzk1XSwgWzM3Ljg3NTE4OSwgLTEyMi4yOTQxNzYwMDAwMDAwMV0sIFszNy44NzYxNzQsIC0xMjIuMjg3MDU0XSwgWzM3Ljg3MzAxNywgLTEyMi4yODg0MjJdLCBbMzcuODU2NTk1LCAtMTIyLjI3NTA2Mzk5OTk5OTk5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzE0NjEsIC0xMjIuMjcwNzA2XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODY3MDI2LCAtMTIyLjI5OTczNzAwMDAwMDAxXSwgWzM3Ljg3MDg0LCAtMTIyLjI4OTY3ODAwMDAwMDAxXSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY4MzM0MDAwMDAwMDA0LCAtMTIyLjMwMzc1M10sIFszNy44NzAzMDgsIC0xMjIuMjY4MDVdLCBbMzcuODY2MDM3LCAtMTIyLjI2NTYxNzk5OTk5OTk5XSwgWzM3Ljg2NTc3MiwgLTEyMi4yNjc2NDI5OTk5OTk5OV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44Nzc5NTEsIC0xMjIuMjcxMzk1XSwgWzM3Ljg3OTY5MDAwMDAwMDAwNCwgLTEyMi4yOTk3MTI5OTk5OTk5OF0sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODIxNTMzLCAtMTIyLjI3Njc0MDk5OTk5OTk5XSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NjAyMjUsIC0xMjIuMjY5NDUzXSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NTUxMDYsIC0xMjIuMjkyNDE5OTk5OTk5OTldLCBbMzcuODUxMDg5LCAtMTIyLjI4MDk1XSwgWzM3Ljg1MDYyLCAtMTIyLjI3ODMxMjk5OTk5OTk4XSwgWzM3Ljg1NjMxOSwgLTEyMi4yOTI4MThdLCBbMzcuODc5NzA4LCAtMTIyLjI5Nzk5NV0sIFszNy44NTI5NTYsIC0xMjIuMjY2MTk1XSwgWzM3Ljg3MDIxOSwgLTEyMi4yNzM5OTM5OTk5OTk5OV0sIFszNy44NTI2MTgsIC0xMjIuMjgzNjc3XSwgWzM3Ljg1MzQ2MywgLTEyMi4yOTE5ODJdLCBbMzcuODc5Njg5LCAtMTIyLjI3MTYxMzk5OTk5OTk5XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NzQwOTUwMDAwMDAwMDQsIC0xMjIuMjg4NTQxOTk5OTk5OTldLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NjU0NDMsIC0xMjIuMjYzMTg4OTk5OTk5OThdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44ODAyMjcwMDAwMDAwMDUsIC0xMjIuMjY5MzZdLCBbMzcuODc1NTI1LCAtMTIyLjI1NjgxMzk5OTk5OTk5XSwgWzM3Ljg4MDk3MSwgLTEyMi4zMDY2MjZdLCBbMzcuODU3Njk0LCAtMTIyLjI4MTYyOF0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg2MDM4NiwgLTEyMi4yNzM3MjVdLCBbMzcuODU3ODY5LCAtMTIyLjI0ODM5OF0sIFszNy44ODYyNDE5OTk5OTk5OTYsIC0xMjIuMjY1NDE1OTk5OTk5OTldLCBbMzcuODYxNzM4LCAtMTIyLjI5NTY2Mzk5OTk5OTk5XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODU0ODgsIC0xMjIuMjY5MDc5XSwgWzM3Ljg2NDM0NjAwMDAwMDAwNSwgLTEyMi4yOTE4NDNdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzgwMjM5OTk5OTk5OTYsIC0xMjIuMzA3OThdLCBbMzcuOTAzMjUyLCAtMTIyLjI2NzQ1NjAwMDAwMDAxXSwgWzM3Ljg2MzA5OSwgLTEyMi4yODgyNTVdLCBbMzcuODgzODIsIC0xMjIuMjk2OTUyXSwgWzM3Ljg1MTk0NCwgLTEyMi4yODM0ODk5OTk5OTk5OV0sIFszNy44ODM2MiwgLTEyMi4yNjk3MzQwMDAwMDAwMV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44ODAzNzYsIC0xMjIuMjY4MTgzMDAwMDAwMDFdLCBbMzcuODY1MTQ5LCAtMTIyLjI1NjQ4N10sIFszNy44NzMwMTcsIC0xMjIuMjc1NDgxXSwgWzM3Ljg2NjI2NTAwMDAwMDAwNiwgLTEyMi4yNzgxNjIwMDAwMDAwMV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY3NzE3LCAtMTIyLjI0OTkwMV0sIFszNy44NDgzNTcsIC0xMjIuMjgxNTIxXSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODU0MDEyLCAtMTIyLjI1MTI0Mjk5OTk5OTk5XSwgWzM3Ljg3MTE3MTAwMDAwMDAwNCwgLTEyMi4yNjc3MTc5OTk5OTk5OV0sIFszNy44Njg2MTU5OTk5OTk5OTYsIC0xMjIuMjg4MzY0OTk5OTk5OThdLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy45MDQxNTQsIC0xMjIuMjcyNjYyMDAwMDAwMDFdLCBbMzcuODY4NjQxLCAtMTIyLjI5NDE1XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44OTM2OTYwMDAwMDAwMDYsIC0xMjIuMjgxMTA1MDAwMDAwMDFdLCBbMzcuODY2NjIyLCAtMTIyLjI2MTA4XSwgWzM3Ljg2MzY3OSwgLTEyMi4yNjk2M10sIFszNy44Njg5NTcsIC0xMjIuMjU0NTUyXSwgWzM3Ljg1NjExMSwgLTEyMi4yNjAyNDhdLCBbMzcuODk1ODQ5LCAtMTIyLjI2MzQyOF0sIFszNy44ODM0MDcsIC0xMjIuMjczMTU0XSwgWzM3Ljg3NDE0NSwgLTEyMi4yNjYyMjVdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg1MTI1NSwgLTEyMi4yOTI1MDkwMDAwMDAwMV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODU4ODkyLCAtMTIyLjI5MTI3XSwgWzM3Ljg2NjI2NTAwMDAwMDAwNiwgLTEyMi4zMDU1OTE5OTk5OTk5OV0sIFszNy44NjY3NjEsIC0xMjIuMjU4Nzc5XSwgWzM3Ljg4MDkyMiwgLTEyMi4zMDMxMTQ5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NjQ2OTIsIC0xMjIuMjk0MzI1XSwgWzM3Ljg2Mzg5MywgLTEyMi4yNTE0MjE5OTk5OTk5OV0sIFszNy44NTk4NDYwMDAwMDAwMDUsIC0xMjIuMjUzMzI1XSwgWzM3Ljg1ODUyNSwgLTEyMi4yNjY5MDZdLCBbMzcuODY3MjA5LCAtMTIyLjI1NjU1NDAwMDAwMDAxXSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NzIxNjYsIC0xMjIuMjc1MzcxOTk5OTk5OTldLCBbMzcuODYxNTcxMDAwMDAwMDA1LCAtMTIyLjI3MTcyMl0sIFszNy44NTQ2Mjg5OTk5OTk5OTYsIC0xMjIuMjY5MTYwMDAwMDAwMDFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2ODU3NCwgLTEyMi4yNzA0MTQ5OTk5OTk5OV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2NTM3Mzk5OTk5OTk5NiwgLTEyMi4yNTY1MTFdLCBbMzcuODczNjA3LCAtMTIyLjI3MDkwM10sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NjcyMTIsIC0xMjIuMjgxNzM4OTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2MjE2OSwgLTEyMi4yNjcwODQwMDAwMDAwMV0sIFszNy44OTE4MjcsIC0xMjIuMjc1MDk0XSwgWzM3Ljg2NTc5NywgLTEyMi4yNTI3NDA5OTk5OTk5OV0sIFszNy44NzM5MDkwMDAwMDAwMDUsIC0xMjIuMjY4MjMzMDAwMDAwMDFdLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NjE1MTEsIC0xMjIuMjk2ODEwMDAwMDAwMDFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3ODM3Mjk5OTk5OTk5NiwgLTEyMi4yNjI5MDJdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44Nzc5NTEsIC0xMjIuMjcxMzk1XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjkzNDMsIC0xMjIuMjUwMDQ3OTk5OTk5OTldLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg1MzU1Mzk5OTk5OTk5NSwgLTEyMi4yNzY5MjVdLCBbMzcuODY5MiwgLTEyMi4yNjkzMDgwMDAwMDAwMV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg2NDIzOCwgLTEyMi4yNjUyNjI5OTk5OTk5OV0sIFszNy44NjgyNzI5OTk5OTk5OTUsIC0xMjIuMjk1OTYyOTk5OTk5OTldLCBbMzcuODQ5MDUsIC0xMjIuMjY5MDk4XSwgWzM3Ljg4MDA3NSwgLTEyMi4yNzA0NzZdLCBbMzcuODYzOTc3LCAtMTIyLjI2NzMwN10sIFszNy44NzAwNTM5OTk5OTk5OTYsIC0xMjIuMjg0MjYzXSwgWzM3Ljg2NzUzMywgLTEyMi4yOTE3MTldLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg3NjYxNSwgLTEyMi4yOTEzOTNdLCBbMzcuODczMjUsIC0xMjIuMjkzNTU4XSwgWzM3Ljg2OTkyMTAwMDAwMDAwNSwgLTEyMi4yOTQ4MjVdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1MzU4MSwgLTEyMi4yMzU5MDFdLCBbMzcuODYzOTU5LCAtMTIyLjI2NzQzMl0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODY1MTM0MDAwMDAwMDA1LCAtMTIyLjI1ODMzMTAwMDAwMDAxXSwgWzM3Ljg3MTcxNiwgLTEyMi4yNTI3OTU5OTk5OTk5OV0sIFszNy44NjkzMzIsIC0xMjIuMjUwMTg5OTk5OTk5OTldLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44ODAwMjcsIC0xMjIuMjc5OTc2XSwgWzM3Ljg2Njc2MSwgLTEyMi4yNTg3NzldLCBbMzcuODUwNDM0LCAtMTIyLjI3MjYwNzAwMDAwMDAxXSwgWzM3Ljg2MTY2NDAwMDAwMDAwNSwgLTEyMi4yNDg3Nl0sIFszNy44NDkwNSwgLTEyMi4yNjkwOThdLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy44NzY3OTEsIC0xMjIuMjgwNDcyXSwgWzM3Ljg2Mzk3NywgLTEyMi4yNjczMDddLCBbMzcuODUxMjU1LCAtMTIyLjI5MjUwOTAwMDAwMDAxXSwgWzM3Ljg4MDIyNzAwMDAwMDAwNSwgLTEyMi4yNjkzNl0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODY1Nzk1LCAtMTIyLjI4MDQzOTk5OTk5OTk4XSwgWzM3Ljg4NDU3NywgLTEyMi4yODEyMzZdLCBbMzcuODc0MDk1MDAwMDAwMDA0LCAtMTIyLjI4ODU0MTk5OTk5OTk5XSwgWzM3Ljg3NjE4NiwgLTEyMi4zMDE1OF0sIFszNy44NTk0OCwgLTEyMi4yNjY2ODg5OTk5OTk5OV0sIFszNy44ODE2MTIsIC0xMjIuMjgxODg1XSwgWzM3Ljg2NTQ0MywgLTEyMi4yNjMxODg5OTk5OTk5OF0sIFszNy44OTAyNzQsIC0xMjIuMjYwNzkzOTk5OTk5OTldLCBbMzcuODU1OTY0LCAtMTIyLjI4MzExMzk5OTk5OTk4XSwgWzM3Ljg1NjExMSwgLTEyMi4yNjAyNDhdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NTExMDcsIC0xMjIuMjgzMjM5OTk5OTk5OTldLCBbMzcuODU1MDExLCAtMTIyLjI2MzM3Nl0sIFszNy44NTc3OTE5OTk5OTk5OTYsIC0xMjIuMjU4NTM3MDAwMDAwMDJdLCBbMzcuODYzNTY0MDAwMDAwMDA0LCAtMTIyLjI5NTEzNTAwMDAwMDAyXSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg1MTY1MzAwMDAwMDAwNiwgLTEyMi4yODkxOTRdLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NjIxODksIC0xMjIuMjU5OTFdLCBbMzcuODg2OTU1LCAtMTIyLjI0OTIyXSwgWzM3Ljg2OTk4NiwgLTEyMi4yODQ4MDVdLCBbMzcuODU0MTM3LCAtMTIyLjI1MTAwN10sIFszNy45MDE4NzksIC0xMjIuMjY3MTQxOTk5OTk5OTldLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg3NjQwMywgLTEyMi4yOTQ0MjddLCBbMzcuODYyNDYyLCAtMTIyLjI5MjE0OV0sIFszNy44ODAyMjcwMDAwMDAwMDUsIC0xMjIuMjY5MzZdLCBbMzcuODU5OTg4LCAtMTIyLjI1MzMzODk5OTk5OTk4XSwgWzM3Ljg2NzIwOSwgLTEyMi4yNTY1NTQwMDAwMDAwMV0sIFszNy44Nzg0MjMsIC0xMjIuMjY5MDIzXSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODUzMzE2LCAtMTIyLjI3ODczNzk5OTk5OTk5XSwgWzM3Ljg1ODEwOTk5OTk5OTk5NiwgLTEyMi4yNzc3ODc5OTk5OTk5OV0sIFszNy44NzI4MzEsIC0xMjIuMjY5NjM2XSwgWzM3Ljg3MjQzMSwgLTEyMi4yOTgwMDcwMDAwMDAwMV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODU0MTE2LCAtMTIyLjI4NDExMzk5OTk5OTk5XSwgWzM3Ljg2NzcyMywgLTEyMi4yOTg0MDZdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2NzgxNiwgLTEyMi4yNTg5OTRdLCBbMzcuODgwNTY0LCAtMTIyLjMwNDg5Nl0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODcxNDIsIC0xMjIuMzAzNTMyXSwgWzM3Ljg2Mjg3NzAwMDAwMDAwNSwgLTEyMi4yOTAwNTUwMDAwMDAwMV0sIFszNy44ODIwMjQsIC0xMjIuMjk3NTZdLCBbMzcuODk2Njg4LCAtMTIyLjI3NDU2MDAwMDAwMDAxXSwgWzM3Ljg4MDQ2OCwgLTEyMi4yOTU4NzZdLCBbMzcuODc0NDg5MDAwMDAwMDA0LCAtMTIyLjI3MTA3Ml0sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODY2NywgLTEyMi4yNjc2MTRdLCBbMzcuODc5MzYzLCAtMTIyLjMwMTM0MV0sIFszNy44NzgxMTIsIC0xMjIuMjY5MTEzOTk5OTk5OTldLCBbMzcuODgwMjY2LCAtMTIyLjI2OTAzMjAwMDAwMDAxXSwgWzM3Ljg5ODEzNDk5OTk5OTk5NiwgLTEyMi4yODYyNTYwMDAwMDAwMV0sIFszNy44Nzg0MDcsIC0xMjIuMjY3OTYyMDAwMDAwMDFdLCBbMzcuODY5MDU3LCAtMTIyLjI3MDQ2Mjk5OTk5OTk5XSwgWzM3Ljg1ODE2NSwgLTEyMi4yNTU2ODcwMDAwMDAwMV0sIFszNy44NTM0ODUsIC0xMjIuMjcyMDkzXSwgWzM3Ljg1OTg0NjAwMDAwMDAwNSwgLTEyMi4yNTMzMjVdLCBbMzcuODc3ODI5OTk5OTk5OTk2LCAtMTIyLjI5OTcyM10sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg1OTk4OCwgLTEyMi4yNTMzMzg5OTk5OTk5OF0sIFszNy44NjU0MiwgLTEyMi4yNTYxOF0sIFszNy44ODEyMTUwMDAwMDAwMDUsIC0xMjIuMjkxNDldLCBbMzcuODYyODc3MDAwMDAwMDA1LCAtMTIyLjI5MDA1NTAwMDAwMDAxXSwgWzM3Ljg2ODI3Mjk5OTk5OTk5NSwgLTEyMi4yOTU5NjI5OTk5OTk5OV0sIFszNy44NjYxNzQsIC0xMjIuMjY0NTRdLCBbMzcuODczNjM5MDAwMDAwMDA0LCAtMTIyLjI3MDYzOTk5OTk5OTk5XSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODYzMjQwOTk5OTk5OTk1LCAtMTIyLjI4NjE3Nl0sIFszNy44NjAxMTYsIC0xMjIuMjkxNjYwMDAwMDAwMDFdLCBbMzcuODkwOTI4LCAtMTIyLjI4NzI1MV0sIFszNy44NTk4NDYwMDAwMDAwMDUsIC0xMjIuMjUzMzI1XSwgWzM3Ljg1ODUxOCwgLTEyMi4yODg2NjVdLCBbMzcuODc5NTcxLCAtMTIyLjMwMDI5Nl0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODYwMTg5LCAtMTIyLjI5NDA0OF0sIFszNy44NjQ1MzUsIC0xMjIuMjYyOTkzXSwgWzM3Ljg2MTU5MSwgLTEyMi4yNTQ3MzYwMDAwMDAwMV0sIFszNy44NzY1OTUsIC0xMjIuMjY3Nzg5XSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NTA1NDEsIC0xMjIuMjg2MDM3MDAwMDAwMDFdLCBbMzcuODc3ODcxOTk5OTk5OTk2LCAtMTIyLjI4NTg0NF0sIFszNy44NzAyODcsIC0xMjIuMzE2MjM3OTk5OTk5OThdLCBbMzcuODczNDUzOTk5OTk5OTk1LCAtMTIyLjI3MjA4OTk5OTk5OTk5XSwgWzM3Ljg1NjEzMiwgLTEyMi4yNzEyOTE5OTk5OTk5OV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY1NTAxLCAtMTIyLjI2OTc3NF0sIFszNy44NjMyOTIsIC0xMjIuMjU2MjkzXSwgWzM3Ljg2Mzk1OSwgLTEyMi4yNjc0MzJdLCBbMzcuODY3MjA5LCAtMTIyLjI1NjU1NDAwMDAwMDAxXSwgWzM3Ljg1NjExMSwgLTEyMi4yNjAyNDhdLCBbMzcuODYzNTIxOTk5OTk5OTk2LCAtMTIyLjI1NDk5MTk5OTk5OTk5XSwgWzM3Ljg2NDcwMTAwMDAwMDAwNCwgLTEyMi4yNjA2OTI5OTk5OTk5OV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg2ODk1NywgLTEyMi4yNTQ1NTJdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NjM4MTEsIC0xMjIuMjY3NDEyMDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg4MTAwNCwgLTEyMi4yODMyMjVdLCBbMzcuODcxNTQ0LCAtMTIyLjI3MjcxNF0sIFszNy44NjI4MDIsIC0xMjIuMjk3MjI4XSwgWzM3Ljg2MTY3MiwgLTEyMi4yNTU5OTE5OTk5OTk5OV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg3NzQ4MiwgLTEyMi4yNTYxMDkwMDAwMDAwMV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44OTk3NjgsIC0xMjIuMjc5Nzk0XSwgWzM3Ljg4MTI1MywgLTEyMi4zMDA4MzVdLCBbMzcuODY4OTU3LCAtMTIyLjI1NDU1Ml0sIFszNy44NjI0OTEsIC0xMjIuMjY0Nl0sIFszNy44OTkyNzgsIC0xMjIuMjgzMjIyXSwgWzM3Ljg4MDc4NiwgLTEyMi4zMDMwNjddLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg1ODE2NSwgLTEyMi4yNTU2ODcwMDAwMDAwMV0sIFszNy44Nzk3MDgsIC0xMjIuMjk3OTk1XSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NjY0MjYwMDAwMDAwMDQsIC0xMjIuMjY5NzYyMDAwMDAwMDFdLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg1NDkxLCAtMTIyLjI2ODY2Nl0sIFszNy44ODc4Nzk5OTk5OTk5OTYsIC0xMjIuMjcyMzM2MDAwMDAwMDFdLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg1MTUyMTAwMDAwMDAwNSwgLTEyMi4yODU0OV0sIFszNy44NjUxNDksIC0xMjIuMjU2NDg3XSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODY4MTA4LCAtMTIyLjI3NzIyMl0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NjkxMzcsIC0xMjIuMjUwOTA4MDAwMDAwMDFdLCBbMzcuODIxNTMzLCAtMTIyLjI3Njc0MDk5OTk5OTk5XSwgWzM3Ljg2NDkwOCwgLTEyMi4yNjcyODg5OTk5OTk5OV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzU5NTUsIC0xMjIuMjk0NDIxXSwgWzM3Ljg2NzM4MzAwMDAwMDAwNCwgLTEyMi4yOTM5Mzc5OTk5OTk5OF0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44ODQyNTcsIC0xMjIuMjYyNjM2MDAwMDAwMDFdLCBbMzcuODc1NjQyLCAtMTIyLjMwMTM5Mjk5OTk5OTk5XSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODY5MTE4LCAtMTIyLjI4NzQwNDAwMDAwMDAxXSwgWzM3Ljg1MDg5OSwgLTEyMi4yNzYxNzRdLCBbMzcuODU0MTg2LCAtMTIyLjI3OTE1NzAwMDAwMDAxXSwgWzM3Ljg3NjA0NSwgLTEyMi4yNjAzMzYwMDAwMDAwMV0sIFszNy44NTI2LCAtMTIyLjI4OTcxNDk5OTk5OTk5XSwgWzM3Ljg3ODczNCwgLTEyMi4yODk2NTNdLCBbMzcuODY4MTk5LCAtMTIyLjI2MzI1M10sIFszNy44NjIwODUsIC0xMjIuMjgxMTc1XSwgWzM3Ljg3NTg3LCAtMTIyLjI2MTc3N10sIFszNy44NjY5MzUsIC0xMjIuMjY1NzcyXSwgWzM3Ljg4OTk1NSwgLTEyMi4yNjE3NjJdLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg3MDg2NywgLTEyMi4yNzA2MzUwMDAwMDAwMV0sIFszNy44Njg3NDcsIC0xMjIuMjg3MzQyXSwgWzM3Ljg3ODQwNywgLTEyMi4yNjkxNF0sIFszNy44NjgxOTksIC0xMjIuMjYzMjUzXSwgWzM3Ljg2NjkzNSwgLTEyMi4yNjU3NzJdLCBbMzcuODYzMTMsIC0xMjIuMjk2MTEwMDAwMDAwMDFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2OTI4NCwgLTEyMi4yNTQ1NTYwMDAwMDAwMV0sIFszNy44NzEyNDYsIC0xMjIuMjc0OTkwOTk5OTk5OTldLCBbMzcuODYyOTI3LCAtMTIyLjI1ODc4NF0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODc4MTEyLCAtMTIyLjI2OTExMzk5OTk5OTk5XSwgWzM3Ljg3Nzk1MSwgLTEyMi4yNzEzOTVdLCBbMzcuODczMDE3LCAtMTIyLjI3NTQ4MV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg2NzMwNzAwMDAwMDAwNCwgLTEyMi4zMDA0NjhdLCBbMzcuODUxMDE3LCAtMTIyLjI5MTA4Nzk5OTk5OTk5XSwgWzM3Ljg2NjA1NCwgLTEyMi4yOTIzOTFdLCBbMzcuODUyMTM3LCAtMTIyLjI4NjczMl0sIFszNy44Nzg2MjksIC0xMjIuMjYwODgzXSwgWzM3Ljg3MDI4NywgLTEyMi4zMTYyMzc5OTk5OTk5OF0sIFszNy44NjY5MTksIC0xMjIuMjU4ODEyXSwgWzM3Ljg2OTI4NCwgLTEyMi4yNTQ1NTYwMDAwMDAwMV0sIFszNy44NTUyOTI5OTk5OTk5OTYsIC0xMjIuMjY2NTAyXSwgWzM3Ljg3MDMwOCwgLTEyMi4yNjgwNV0sIFszNy44ODA5Njc5OTk5OTk5OTYsIC0xMjIuMjU2MjczXSwgWzM3Ljg2OTM5LCAtMTIyLjI2Nzg4MzAwMDAwMDAxXSwgWzM3Ljg3MTMxMSwgLTEyMi4yODE5NzgwMDAwMDAwMV0sIFszNy44NjM4MTEsIC0xMjIuMjY3NDEyMDAwMDAwMDFdLCBbMzcuODU5NDgsIC0xMjIuMjY2Njg4OTk5OTk5OTldLCBbMzcuODc5OTk2MDAwMDAwMDA2LCAtMTIyLjI5Njg5M10sIFszNy44NzQ4NzE5OTk5OTk5OTYsIC0xMjIuMjgyMzU5MDAwMDAwMDFdLCBbMzcuODY2OTE5LCAtMTIyLjI1ODgxMl0sIFszNy44NjY2MjIsIC0xMjIuMjYxMDhdLCBbMzcuODcyNDY4LCAtMTIyLjI4NjkwMl0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY1MTIxLCAtMTIyLjI1ODQ1NV0sIFszNy44NzMyNSwgLTEyMi4yOTM1NThdLCBbMzcuODc3OTUxLCAtMTIyLjI3MTM5NV0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODY4MTk0LCAtMTIyLjI3NjA2M10sIFszNy44Njc1NDYwMDAwMDAwMDQsIC0xMjIuMjUxOTY3XSwgWzM3Ljg2MTg0MywgLTEyMi4yNjk2NDRdLCBbMzcuODY1MTQwOTk5OTk5OTk0LCAtMTIyLjI2NTQ0MV0sIFszNy44NjI3NzcsIC0xMjIuMjc2NTcwOTk5OTk5OTldLCBbMzcuODgwNzg2LCAtMTIyLjMwMzA2N10sIFszNy44NTQ5LCAtMTIyLjI3OTQ1XSwgWzM3Ljg1Mjc0MDAwMDAwMDAwNCwgLTEyMi4yODM3MTEwMDAwMDAwMV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODQ5NTEyLCAtMTIyLjI3MjY3MV0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODg3OTc3LCAtMTIyLjI1NjVdLCBbMzcuODY1MjksIC0xMjIuMjY0MzYzOTk5OTk5OTldLCBbMzcuODc3NzE1LCAtMTIyLjMwOTYxOF0sIFszNy44NzgxMTIsIC0xMjIuMjY5MTEzOTk5OTk5OTldLCBbMzcuODY3NTY2LCAtMTIyLjI2NTk0OF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg3ODAyMzk5OTk5OTk5NiwgLTEyMi4zMDc5OF0sIFszNy44NzYwMTgsIC0xMjIuMjczNTE3XSwgWzM3Ljg2MzkzOCwgLTEyMi4yNTM3MzVdLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODYzMDQ1LCAtMTIyLjMxNzM0OF0sIFszNy44NjQ1MzUsIC0xMjIuMjYyOTkzXSwgWzM3Ljg3MDYwMywgLTEyMi4yNzA2MTIwMDAwMDAwMV0sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODcyMTU4LCAtMTIyLjI4MjA2NTk5OTk5OTk5XSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODYyMTE4LCAtMTIyLjI1MzM4XSwgWzM3Ljg1NDc4NywgLTEyMi4yODAxMTc5OTk5OTk5OV0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg4MTQzMywgLTEyMi4yNzI5MjFdLCBbMzcuODcwMDUzOTk5OTk5OTk2LCAtMTIyLjI4NDI2M10sIFszNy44NjcwMjYsIC0xMjIuMjk5NzM3MDAwMDAwMDFdLCBbMzcuODYyNTE2LCAtMTIyLjI3ODUzXSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44OTk4MTIsIC0xMjIuMjc1MjczXSwgWzM3Ljg3NzMyMywgLTEyMi4yNjQyNzNdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg3NDIzNywgLTEyMi4yNzMwNTJdLCBbMzcuODU1ODE1LCAtMTIyLjI4MDQxM10sIFszNy44Njc0OTA5OTk5OTk5OTQsIC0xMjIuMjU0MDU0MDAwMDAwMDFdLCBbMzcuODYzODExLCAtMTIyLjI2NzQxMjAwMDAwMDAxXSwgWzM3Ljg3MDM0NjAwMDAwMDAwNSwgLTEyMi4yNjc3OTU5OTk5OTk5OV0sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODY5MDU3LCAtMTIyLjI3MDQ2Mjk5OTk5OTk5XSwgWzM3Ljg4NTc3NiwgLTEyMi4yNjc2NzA5OTk5OTk5OV0sIFszNy44NTAzNDUwMDAwMDAwMDQsIC0xMjIuMjcwOTExMDAwMDAwMDFdLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg3Nzk1MSwgLTEyMi4yNzEzOTVdLCBbMzcuODU1Njc4MDAwMDAwMDA1LCAtMTIyLjI3NDQyOV0sIFszNy44Nzg0OTksIC0xMjIuMjk2NDE1XSwgWzM3Ljg2MjM5MywgLTEyMi4yNDg4NTFdLCBbMzcuODYxNjcyLCAtMTIyLjI1NTk5MTk5OTk5OTk5XSwgWzM3Ljg2MTU3MTAwMDAwMDAwNSwgLTEyMi4yNzE3MjJdLCBbMzcuODcwOTExLCAtMTIyLjI4OTY4NDAwMDAwMDAxXSwgWzM3Ljg4Nzg0MywgLTEyMi4yNzAwMTEwMDAwMDAwMV0sIFszNy44ODcxLCAtMTIyLjI1MTMyMDk5OTk5OTk5XSwgWzM3Ljg5NDc0Njk5OTk5OTk5NSwgLTEyMi4yODcwMDUwMDAwMDAwMV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODU1MDI2LCAtMTIyLjI2NjQ3NV0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODczMzI3LCAtMTIyLjI3MzIxNF0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg2MDIyNSwgLTEyMi4yNjk0NTNdLCBbMzcuODY1MTIxLCAtMTIyLjI1ODQ1NV0sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODYyNTE2LCAtMTIyLjI3ODUzXSwgWzM3Ljg3NDY1LCAtMTIyLjMwMzIxNTk5OTk5OTk5XSwgWzM3Ljg4MzYyLCAtMTIyLjI2OTczNDAwMDAwMDAxXSwgWzM3Ljg3NTY1NzAwMDAwMDAwNCwgLTEyMi4yODg3MjcwMDAwMDAwMV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODU2ODIzLCAtMTIyLjI4ODI1N10sIFszNy44Njc1ODMsIC0xMjIuMjY3ODQ0XSwgWzM3Ljg1NzUwMjAwMDAwMDAwNCwgLTEyMi4yOTA4NDQ5OTk5OTk5OV0sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODU3MTcsIC0xMjIuMjUyMjA5MDAwMDAwMDFdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg3MzM1MSwgLTEyMi4yODcyNzRdLCBbMzcuODU0MDEyLCAtMTIyLjI1MTI0Mjk5OTk5OTk5XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44Nzc5NTEsIC0xMjIuMjcxMzk1XSwgWzM3Ljg2NTcyODk5OTk5OTk5NSwgLTEyMi4yNjA5MDNdLCBbMzcuODYwMjY1MDAwMDAwMDA1LCAtMTIyLjI4OTIxMjk5OTk5OTk5XSwgWzM3Ljg2ODQxNywgLTEyMi4zMDI1MzldLCBbMzcuODc4NDExLCAtMTIyLjMwNjA0MV0sIFszNy44NzM2MDcsIC0xMjIuMjcwOTAzXSwgWzM3Ljg2MjA0NiwgLTEyMi4yNzUzNzRdLCBbMzcuODg1OTM0MDAwMDAwMDA2LCAtMTIyLjI2NzY5MDk5OTk5OTk5XSwgWzM3Ljg2NjI1MywgLTEyMi4yOTk0ODMwMDAwMDAwMV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg1NDU2NSwgLTEyMi4yODE0NjZdLCBbMzcuODc4MTEyLCAtMTIyLjI2OTExMzk5OTk5OTk5XSwgWzM3Ljg1MjM3OSwgLTEyMi4yNjYxMTg5OTk5OTk5OV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg2Mjg3NzAwMDAwMDAwNSwgLTEyMi4yOTAwNTUwMDAwMDAwMV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg3MjY5MDk5OTk5OTk5NiwgLTEyMi4yNzA3NDA5OTk5OTk5OV0sIFszNy44NTU3OTMsIC0xMjIuMjgxNDkzXSwgWzM3Ljg5MTMzMiwgLTEyMi4yNzk5NzVdLCBbMzcuODgwNDY4LCAtMTIyLjI5NTg3Nl0sIFszNy44NzExNzEwMDAwMDAwMDQsIC0xMjIuMjY3NzE3OTk5OTk5OTldLCBbMzcuODgwMDI0LCAtMTIyLjI2MTM3N10sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY4MzY1OTk5OTk5OTk1LCAtMTIyLjI5NTUwODAwMDAwMDAxXSwgWzM3Ljg2NTIwMjAwMDAwMDAwNCwgLTEyMi4yNTc3OTVdLCBbMzcuODU1OTUzLCAtMTIyLjIzNjQ3NV0sIFszNy44NzkzMzUsIC0xMjIuMzAxMzMyXSwgWzM3Ljg3ODczNCwgLTEyMi4yODk2NTNdLCBbMzcuODY5Njg1LCAtMTIyLjI3MjgwNDAwMDAwMDAxXSwgWzM3Ljg3MTU0NCwgLTEyMi4yNzI3MTRdLCBbMzcuODY5MzE4LCAtMTIyLjI5Njk4NDAwMDAwMDAxXSwgWzM3Ljg1NjE5NSwgLTEyMi4yODgwNTNdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NzAzOTMsIC0xMjIuMjk5NTMyMDAwMDAwMDFdLCBbMzcuODY0Mzk3LCAtMTIyLjI3NjgzNV0sIFszNy44NTg2NDYsIC0xMjIuMjkyMzkxOTk5OTk5OTldLCBbMzcuODY5MDU3LCAtMTIyLjI3MDQ2Mjk5OTk5OTk5XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODYyNzYzLCAtMTIyLjI2MjYzOV0sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODY1OTg0MDAwMDAwMDA1LCAtMTIyLjI5MzI4ODk5OTk5OTk5XSwgWzM3Ljg2MzM2OSwgLTEyMi4yNTc2MjJdLCBbMzcuODc4Mjc1LCAtMTIyLjI4ODMwNl0sIFszNy44NjQzMzUsIC0xMjIuMjg2NDI5XSwgWzM3Ljg2MTM0MDk5OTk5OTk5NiwgLTEyMi4yODc2NzldLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg1NzM4NywgLTEyMi4yNjE1MzZdLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NjQ5MjUsIC0xMjIuMjczNDM2XSwgWzM3Ljg2MTU5MSwgLTEyMi4yNTQ3MzYwMDAwMDAwMV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjM1MjE5OTk5OTk5OTYsIC0xMjIuMjU0OTkxOTk5OTk5OTldLCBbMzcuODYzNjU5MDAwMDAwMDA2LCAtMTIyLjI5MDMwNzAwMDAwMDAxXSwgWzM3Ljg2MDM2NiwgLTEyMi4yNjY4MDJdLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NTEzMzksIC0xMjIuMjg2MzQ5XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODU1NzkyLCAtMTIyLjI0NzE0Ml0sIFszNy44NzQwOTUwMDAwMDAwMDQsIC0xMjIuMjg4NTQxOTk5OTk5OTldLCBbMzcuODY1NDY2LCAtMTIyLjI3MDA1XSwgWzM3Ljg2OTA4NCwgLTEyMi4yOTkyNDVdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjYzMjcwMDAwMDAwMDUsIC0xMjIuMjYzMzU5MDAwMDAwMDFdLCBbMzcuODYwNTUxLCAtMTIyLjI2NDUxMTAwMDAwMDAxXSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODY0ODI2LCAtMTIyLjI2MDcxOV0sIFszNy44ODkzOTksIC0xMjIuMjYyNTkzOTk5OTk5OTldLCBbMzcuODg1ODU5LCAtMTIyLjI3MjQ2MV0sIFszNy44Nzg3MjE5OTk5OTk5OTYsIC0xMjIuMjk1MzEyMDAwMDAwMDFdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODU5OTg4LCAtMTIyLjI1MzMzODk5OTk5OTk4XSwgWzM3Ljg2ODY0MSwgLTEyMi4yOTQxNV0sIFszNy44NzM2MzkwMDAwMDAwMDQsIC0xMjIuMjcwNjM5OTk5OTk5OTldLCBbMzcuODYyMTg5LCAtMTIyLjI1OTkxXSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44Njc1MzMsIC0xMjIuMjkxNzE5XSwgWzM3Ljg2NjEzNSwgLTEyMi4yNzkxMTU5OTk5OTk5OV0sIFszNy44NTY5NDc5OTk5OTk5OTYsIC0xMjIuMjkzMDEzOTk5OTk5OTldLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NzA4NjcsIC0xMjIuMjcwNjM1MDAwMDAwMDFdLCBbMzcuODc3OTUxLCAtMTIyLjI3MTM5NV0sIFszNy44NzE3NTYsIC0xMjIuMjc5OV0sIFszNy44NDk0MzEsIC0xMjIuMjc4MTczOTk5OTk5OTldLCBbMzcuODgzNjIsIC0xMjIuMjY5NzM0MDAwMDAwMDFdLCBbMzcuODgyMzUzLCAtMTIyLjI2NzEzNjAwMDAwMDAxXSwgWzM3Ljg5NTk3MiwgLTEyMi4yNTU3OTA5OTk5OTk5OV0sIFszNy44NzI0NywgLTEyMi4yNzMwMjFdLCBbMzcuODYyNzYzLCAtMTIyLjI2MjYzOV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NjY5ODEsIC0xMjIuMzAyMDgzMDAwMDAwMDFdLCBbMzcuODQ3NjgyLCAtMTIyLjI3OTM4MV0sIFszNy44OTI1MzIsIC0xMjIuMjU2MzUyXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY2Njk2MDAwMDAwMDA1LCAtMTIyLjI3NDc1NzAwMDAwMDAxXSwgWzM3Ljg2NTE0OSwgLTEyMi4yNTY0ODddLCBbMzcuODU0OTgxLCAtMTIyLjI1NzU5MTk5OTk5OTk5XSwgWzM3Ljg1NTY3ODAwMDAwMDAwNSwgLTEyMi4yNzQ0MjldLCBbMzcuODY1MTM0MDAwMDAwMDA1LCAtMTIyLjI1ODMzMTAwMDAwMDAxXSwgWzM3Ljg3ODM3Mjk5OTk5OTk5NiwgLTEyMi4yNjI5MDJdLCBbMzcuODUyMTM3LCAtMTIyLjI4NjczMl0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NTQyNDY5OTk5OTk5OTQsIC0xMjIuMjQzNzVdLCBbMzcuODc1MzkxLCAtMTIyLjI3MTE0MDk5OTk5OTk5XSwgWzM3Ljg1NTI5Mjk5OTk5OTk5NiwgLTEyMi4yNjY1MDJdLCBbMzcuODUyMTc0LCAtMTIyLjI2NzgyNF0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg3MzkwOTAwMDAwMDAwNSwgLTEyMi4yNjgyMzMwMDAwMDAwMV0sIFszNy44NzEzMTEsIC0xMjIuMjgxOTc4MDAwMDAwMDFdLCBbMzcuODgzNjIsIC0xMjIuMjY5NzM0MDAwMDAwMDFdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg2NjAyNSwgLTEyMi4yNTg2MjNdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjE2NDUsIC0xMjIuMjUzNTA4MDAwMDAwMDFdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3LjkwMjc0Nzk5OTk5OTk5NSwgLTEyMi4yNjk2NDE5OTk5OTk5OV0sIFszNy44NTIyMDksIC0xMjIuMjkxNTE0OTk5OTk5OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjA5MjYsIC0xMjIuMjY5NTMyMDAwMDAwMDFdLCBbMzcuODc1MzkxLCAtMTIyLjI3MTE0MDk5OTk5OTk5XSwgWzM3Ljg3OTY5MDAwMDAwMDAwNCwgLTEyMi4yOTk3MTI5OTk5OTk5OF0sIFszNy44NDgxNTIsIC0xMjIuMjc1ODA3XSwgWzM3Ljg2Njk2Njk5OTk5OTk5NSwgLTEyMi4yODY4Mzc5OTk5OTk5OV0sIFszNy44NzU3NzksIC0xMjIuMjgzNDddLCBbMzcuODU5MDA2LCAtMTIyLjI3Nzg3NF0sIFszNy44NzM5MjEsIC0xMjIuMjc1NTc3XSwgWzM3Ljg2MTY1MzAwMDAwMDAwNCwgLTEyMi4yNzg1MjldLCBbMzcuODY4MzUyLCAtMTIyLjI1NDQ1OTAwMDAwMDAxXSwgWzM3Ljg2NzMzNiwgLTEyMi4yNjk4NzZdLCBbMzcuODgyOTcxOTk5OTk5OTk1LCAtMTIyLjI5NTY1NjAwMDAwMDAxXSwgWzM3Ljg3NTMyNCwgLTEyMi4yOTIyNjc5OTk5OTk5OV0sIFszNy44ODE2MDIsIC0xMjIuMjg2MzMyXSwgWzM3Ljg1MTQ3NywgLTEyMi4yNzg2NTFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3MjcwNiwgLTEyMi4yODU3MzIwMDAwMDAwMV0sIFszNy44ODIyMTcsIC0xMjIuMzAyMjI2XSwgWzM3Ljg2NjMxMDk5OTk5OTk5NiwgLTEyMi4yNTYzNjEwMDAwMDAwMV0sIFszNy44OTAzNjYsIC0xMjIuMjY2OTk4XSwgWzM3Ljg2OTEzNywgLTEyMi4yNTA5MDgwMDAwMDAwMV0sIFszNy44NjMwNDUsIC0xMjIuMzE3MzQ4XSwgWzM3Ljg1MjgyMTk5OTk5OTk5NiwgLTEyMi4yOTE2NzddLCBbMzcuODU1NjUxLCAtMTIyLjI1NTAwNjAwMDAwMDAxXSwgWzM3Ljg4NjkwNiwgLTEyMi4yNzkwMzc5OTk5OTk5OV0sIFszNy44NTYxOTUsIC0xMjIuMjg4MDUzXSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODcyNDcxOTk5OTk5OTk1LCAtMTIyLjI2NjE2Mzk5OTk5OTk5XSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODc0NzgxLCAtMTIyLjI2ODc1OF0sIFszNy44OTY2ODgsIC0xMjIuMjc0NTYwMDAwMDAwMDFdLCBbMzcuODUyOTU2LCAtMTIyLjI2NjE5NV0sIFszNy44NjgzNTIsIC0xMjIuMjU0NDU5MDAwMDAwMDFdLCBbMzcuODY1MzQ5LCAtMTIyLjI4Mzc2OTk5OTk5OTk5XSwgWzM3Ljg1NTcyMSwgLTEyMi4yNTU5XSwgWzM3Ljg0OTM3NiwgLTEyMi4yOTQ5NTJdLCBbMzcuODY2NzM5LCAtMTIyLjI2NzI5OV0sIFszNy44NzkxODgsIC0xMjIuMjc2MTA3MDAwMDAwMDFdLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NzU1MSwgLTEyMi4yOTE0MjM5OTk5OTk5OV0sIFszNy44NjMxMjYsIC0xMjIuMjg4MDYzXSwgWzM3Ljg3OTY4OSwgLTEyMi4yNzE2MTM5OTk5OTk5OV0sIFszNy44NzU5ODMwMDAwMDAwMDUsIC0xMjIuMjY0MTI1XSwgWzM3Ljg3NjQyODAwMDAwMDAwNCwgLTEyMi4yOTE3MzYwMDAwMDAwMV0sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg2Njg0MiwgLTEyMi4yNzM2Nl0sIFszNy44NTU2NTEsIC0xMjIuMjU1MDA2MDAwMDAwMDFdLCBbMzcuODY3ODMxLCAtMTIyLjI2NTg1ODAwMDAwMDAxXSwgWzM3Ljg1MTE3NiwgLTEyMi4yNTMwOTZdLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44ODM0MDcsIC0xMjIuMjczMTU0XSwgWzM3Ljg3NzUyODAwMDAwMDAwNSwgLTEyMi4yNzU5NTYwMDAwMDAwMV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODU2MDYzLCAtMTIyLjI1Mjk1MjAwMDAwMDAxXSwgWzM3Ljg2Mjc3NywgLTEyMi4yNzY1NzA5OTk5OTk5OV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2NzcxNywgLTEyMi4yNDk5MDFdLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NzY3OTEsIC0xMjIuMjgwNDcyXSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODgyMDI0LCAtMTIyLjI5NzU2XSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODU4NDM5MDAwMDAwMDA0LCAtMTIyLjI2NzU2OTk5OTk5OTk5XSwgWzM3Ljg2MjU2MiwgLTEyMi4yNjI1OThdLCBbMzcuODY3MTIxOTk5OTk5OTk1LCAtMTIyLjI5ODYzOV0sIFszNy44NzU4NywgLTEyMi4yNjE3NzddLCBbMzcuODU2NzE5LCAtMTIyLjI2NjY3Ml0sIFszNy44NzgxNzMsIC0xMjIuMjY0MzU5MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NjM2NDYsIC0xMjIuMjYyODIyXSwgWzM3Ljg1ODg5MiwgLTEyMi4yOTEyN10sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODY3NjAxLCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODc5OTA5OTk5OTk5OTk1LCAtMTIyLjI1NzI2OTk5OTk5OTk5XSwgWzM3Ljg3NTQyNjAwMDAwMDAwNCwgLTEyMi4yNzgwNTddLCBbMzcuODYzMjcxOTk5OTk5OTk1LCAtMTIyLjI1ODY1Nl0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODYzMzEsIC0xMjIuMzE2MTEyOTk5OTk5OTldLCBbMzcuODYzMjQwOTk5OTk5OTk1LCAtMTIyLjI4NjE3Nl0sIFszNy44Nzc5ODMsIC0xMjIuMjcyNTU4XSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NjY5NzYsIC0xMjIuMzAyNTEwMDAwMDAwMDFdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg2NzkyNjAwMDAwMDAwNCwgLTEyMi4yOTc2NjM5OTk5OTk5OF0sIFszNy44NTE1MjEwMDAwMDAwMDUsIC0xMjIuMjg1NDldLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg3MTMzNiwgLTEyMi4yODY0MzNdLCBbMzcuODY1MTcxOTk5OTk5OTk0LCAtMTIyLjMxMTE1NV0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODU5ODU0LCAtMTIyLjI1NTgwN10sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44NzA5NzE5OTk5OTk5OTUsIC0xMjIuMjg4MTg1MDAwMDAwMDFdLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODYzNTk3OTk5OTk5OTk2LCAtMTIyLjI1MzY5M10sIFszNy44Nzc4MzUsIC0xMjIuMjYwMzU0XSwgWzM3Ljg2ODM1MiwgLTEyMi4yNTQ0NTkwMDAwMDAwMV0sIFszNy44NjU4MjYsIC0xMjIuMjY3MjQzOTk5OTk5OTldLCBbMzcuODY5Mzg1LCAtMTIyLjI4OTUzXSwgWzM3Ljg2NTg0OSwgLTEyMi4yNTk5NzddLCBbMzcuODg3OTYxLCAtMTIyLjI2OTgyMTk5OTk5OTk5XSwgWzM3Ljg3NDE3NywgLTEyMi4yOTczNjQ5OTk5OTk5OV0sIFszNy44NjgzNTIsIC0xMjIuMjU0NDU5MDAwMDAwMDFdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg2NDQ2MywgLTEyMi4yNzA2NzNdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg2MTY0NSwgLTEyMi4yNTM1MDgwMDAwMDAwMV0sIFszNy44NjYyNTMsIC0xMjIuMjk5NDgzMDAwMDAwMDFdLCBbMzcuODc0ODMzLCAtMTIyLjMwMjIxNTk5OTk5OTk5XSwgWzM3Ljg4OTk5ODk5OTk5OTk5NiwgLTEyMi4yNzI0NTZdLCBbMzcuODcxNDIsIC0xMjIuMzAzNTMyXSwgWzM3Ljg1MTAxNywgLTEyMi4yOTEwODc5OTk5OTk5OV0sIFszNy44NjgxNjQsIC0xMjIuMjU2MzEzOTk5OTk5OTldLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODcxNzQzLCAtMTIyLjI3MTg3OF0sIFszNy44NjgyODEsIC0xMjIuMzAwMTAyXSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg4MDc4NiwgLTEyMi4zMDMwNjddLCBbMzcuODc4NDA3LCAtMTIyLjI2Nzk2MjAwMDAwMDAxXSwgWzM3Ljg1ODg1NiwgLTEyMi4yNzE1OTJdLCBbMzcuODcyNTQxOTk5OTk5OTk2LCAtMTIyLjI3MTk3OF0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODgwNTE5LCAtMTIyLjI2NzA1MV0sIFszNy44Nzk5OTYwMDAwMDAwMDYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg3NTE2NiwgLTEyMi4yODAxMjVdLCBbMzcuODUyMDY2LCAtMTIyLjI3Mjk5NF0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg4MzYyLCAtMTIyLjI2OTczNDAwMDAwMDAxXSwgWzM3Ljg3NTg3LCAtMTIyLjI2MTc3N10sIFszNy44NzAyMTksIC0xMjIuMjczOTkzOTk5OTk5OTldLCBbMzcuODU2MTk1LCAtMTIyLjI4ODA1M10sIFszNy44NjM4OTMsIC0xMjIuMjUxNDIxOTk5OTk5OTldLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44NTg5MzMsIC0xMjIuMjY2OTVdLCBbMzcuODgyNDU3LCAtMTIyLjI5NTQ2NF0sIFszNy44NzczOTMsIC0xMjIuMzAxOTE4XSwgWzM3Ljg1OTYxNCwgLTEyMi4yODAyNjc5OTk5OTk5OV0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODU3NDM3LCAtMTIyLjI2ODI2Mjk5OTk5OTk5XSwgWzM3Ljg2Mjc3NywgLTEyMi4yNzY1NzA5OTk5OTk5OV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg1MzY2NSwgLTEyMi4yNTI3MTVdLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44NzQzMTksIC0xMjIuMjk4NjA0XSwgWzM3Ljg3MDUyNiwgLTEyMi4yODE0NTJdLCBbMzcuODY4MzUyLCAtMTIyLjI1NDQ1OTAwMDAwMDAxXSwgWzM3Ljg3MjQ3LCAtMTIyLjI3OTcxNzk5OTk5OTk5XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NTYxOTUsIC0xMjIuMjg4MDUzXSwgWzM3Ljg2NzcxNywgLTEyMi4yNDk5MDFdLCBbMzcuODcyNjkwOTk5OTk5OTk2LCAtMTIyLjI3MDc0MDk5OTk5OTk5XSwgWzM3Ljg4ODcwMiwgLTEyMi4yNjM3MV0sIFszNy44NjMzNzI5OTk5OTk5OTYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg3NDU3NSwgLTEyMi4yODQ3OTZdLCBbMzcuOTAxMzg0LCAtMTIyLjI3Njc4MzAwMDAwMDAxXSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODYzMzUzMDAwMDAwMDA0LCAtMTIyLjI2NTA1MzAwMDAwMDAxXSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg3MjY5MDk5OTk5OTk5NiwgLTEyMi4yNzA3NDA5OTk5OTk5OV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODYyODQ0LCAtMTIyLjI5ODM2OF0sIFszNy44NjY1OTQsIC0xMjIuMjg3OTQ0XSwgWzM3Ljg2NjMyNzAwMDAwMDAwNSwgLTEyMi4yNjMzNTkwMDAwMDAwMV0sIFszNy44OTEzMzIsIC0xMjIuMjc5OTc1XSwgWzM3Ljg2NjU4MSwgLTEyMi4yNzAxNzldLCBbMzcuODk3MzkzLCAtMTIyLjI4MTE1XSwgWzM3Ljg1OTgwMiwgLTEyMi4yNjcxNzddLCBbMzcuODcxNjg5LCAtMTIyLjI5Mjg5OF0sIFszNy44Njg5NTcsIC0xMjIuMjU0NTUyXSwgWzM3Ljg2ODE5OSwgLTEyMi4yNjMyNTNdLCBbMzcuODU1MTk5LCAtMTIyLjI1OTc2OF0sIFszNy44NjA2ODcsIC0xMjIuMjY0NTRdLCBbMzcuODU4NDU1LCAtMTIyLjI5MzM3NF0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy45MDM0NCwgLTEyMi4yNjM2NjIwMDAwMDAwMV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODc4ODY0LCAtMTIyLjI2NTcxNzk5OTk5OTk5XSwgWzM3Ljg2MjE3OCwgLTEyMi4yODEyMDRdLCBbMzcuODUzMSwgLTEyMi4yNjYxMzFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTk4OCwgLTEyMi4yNTAxNzZdLCBbMzcuODg1NjgzLCAtMTIyLjMwODExMzk5OTk5OTk5XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODkwMjc0LCAtMTIyLjI2MDc5Mzk5OTk5OTk5XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg3MzQ1NSwgLTEyMi4yOTM0NjVdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NjgxNjQsIC0xMjIuMjcwMzYyOTk5OTk5OTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg2NzI1OTAwMDAwMDAwNCwgLTEyMi4yNjMyNF0sIFszNy44NjY4NDIsIC0xMjIuMjczNjZdLCBbMzcuODgwNDU4MDAwMDAwMDA0LCAtMTIyLjI2MTI5M10sIFszNy44NTc3NDMsIC0xMjIuMjg4NTQ1XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44NTY5MDIwMDAwMDAwMDUsIC0xMjIuMjYxMjM2MDAwMDAwMDFdLCBbMzcuODcxNTQsIC0xMjIuMzAwMDQ0XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NjY5MTksIC0xMjIuMjU4ODEyXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NjczMTcsIC0xMjIuMjkzOTgyXSwgWzM3Ljg2OTIsIC0xMjIuMjY5MzA4MDAwMDAwMDFdLCBbMzcuODUzNTc2MDAwMDAwMDA0LCAtMTIyLjI4NzIwMjAwMDAwMDAxXSwgWzM3Ljg2NTc5MDk5OTk5OTk5NCwgLTEyMi4yNjc1MTAwMDAwMDAwMl0sIFszNy44NjU5LCAtMTIyLjI1MTA5NDk5OTk5OTk5XSwgWzM3Ljg2NTgyNiwgLTEyMi4yNjcyNDM5OTk5OTk5OV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NzIxMDQsIC0xMjIuMjg5ODEyMDAwMDAwMDFdLCBbMzcuODYyMTg0LCAtMTIyLjI5MzUxN10sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg3MzM1MSwgLTEyMi4yODcyNzRdLCBbMzcuODc4NjQ0LCAtMTIyLjMwMzQzMl0sIFszNy44NzIyMDk5OTk5OTk5OTUsIC0xMjIuMjY3NTQ2XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY1NzQ3OTk5OTk5OTk2LCAtMTIyLjI1MzM5Nl0sIFszNy44NTgxNjUsIC0xMjIuMjU1Njg3MDAwMDAwMDFdLCBbMzcuODY4MzUyLCAtMTIyLjI1NDQ1OTAwMDAwMDAxXSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODU1NzQ4LCAtMTIyLjI5MDI4MTAwMDAwMDAxXSwgWzM3Ljg3MTI3MSwgLTEyMi4yOTUwMTQ5OTk5OTk5OV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg2NDUzNSwgLTEyMi4yNjI5OTNdLCBbMzcuODY4NzA2LCAtMTIyLjI2NjI3OV0sIFszNy44NzAxNDUsIC0xMjIuMjc2Mjg3MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTMxLCAtMTIyLjI2NjEzMV0sIFszNy44Njc2MDEsIC0xMjIuMjY3NzE3OTk5OTk5OTldLCBbMzcuODU0MTg2LCAtMTIyLjI3OTE1NzAwMDAwMDAxXSwgWzM3Ljg3MDUzOCwgLTEyMi4yOTc0MDddLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg0ODQ1MzAwMDAwMDAwNiwgLTEyMi4yNzM2MDcwMDAwMDAwMV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg3NTE4OSwgLTEyMi4yOTQxNzYwMDAwMDAwMV0sIFszNy44NjU4MTU5OTk5OTk5OTUsIC0xMjIuMjgxNjAxXSwgWzM3Ljg3NzIzMiwgLTEyMi4yNzEyNDRdLCBbMzcuOTAyNjU3LCAtMTIyLjI3NzQ0Mjk5OTk5OTk5XSwgWzM3Ljg4NDA3MSwgLTEyMi4yNzkzMTAwMDAwMDAwMV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODU4NDU1LCAtMTIyLjI5MzM3NF0sIFszNy44NjAxMDUsIC0xMjIuMjYxOTAxXSwgWzM3Ljg2NzExNywgLTEyMi4yODM2NDA5OTk5OTk5OV0sIFszNy44OTgwMjQsIC0xMjIuMjY5OTE2OTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODU1NzQ4LCAtMTIyLjI5MDI4MTAwMDAwMDAxXSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2NzcxNywgLTEyMi4yNDk5MDFdLCBbMzcuODY1MTM0MDAwMDAwMDA1LCAtMTIyLjI1ODMzMTAwMDAwMDAxXSwgWzM3Ljg4MTQzMywgLTEyMi4yNzI5MjFdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg1NjEyMSwgLTEyMi4yNjg3NjAwMDAwMDAwMV0sIFszNy44NzE1OTMsIC0xMjIuMjc5ODc5MDAwMDAwMDFdLCBbMzcuODY4MTQwMDAwMDAwMDA0LCAtMTIyLjI2MzczNjAwMDAwMDAxXSwgWzM3Ljg1OTg1NCwgLTEyMi4yNTU4MDddLCBbMzcuODczMDg5LCAtMTIyLjMwNDYxNl0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg2NjcsIC0xMjIuMjY3NjE0XSwgWzM3Ljg1OTQ4LCAtMTIyLjI2NjY4ODk5OTk5OTk5XSwgWzM3Ljg3ODExMiwgLTEyMi4yNjkxMTM5OTk5OTk5OV0sIFszNy44NzM2MDcsIC0xMjIuMjcwOTAzXSwgWzM3Ljg2NDE1NCwgLTEyMi4yOTMwNDA5OTk5OTk5OV0sIFszNy44NTYxMzQwMDAwMDAwMDQsIC0xMjIuMjcwMTk4XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY4ODQ1LCAtMTIyLjI5MjEzOTk5OTk5OTk5XSwgWzM3Ljg2NzM3MywgLTEyMi4yNDk1MTQ5OTk5OTk5OV0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODczNjM5MDAwMDAwMDA0LCAtMTIyLjI3MDYzOTk5OTk5OTk5XSwgWzM3Ljg5OTI3OCwgLTEyMi4yODMyMjJdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY0NTkxLCAtMTIyLjI3Njg1NV0sIFszNy44NTc2MzcsIC0xMjIuMjY2ODAzXSwgWzM3Ljg2MDc3LCAtMTIyLjI4NTMyMjk5OTk5OTk5XSwgWzM3Ljg1NTA1MzAwMDAwMDAwNSwgLTEyMi4yODY1NzcwMDAwMDAwMV0sIFszNy44NjE2NDUsIC0xMjIuMjUzNTA4MDAwMDAwMDFdLCBbMzcuODQ4MTUyLCAtMTIyLjI3NTgwN10sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg1NzQ2MywgLTEyMi4yMzgwMzJdLCBbMzcuODU0NjEyLCAtMTIyLjI4MTE3OF0sIFszNy44NTk5ODgsIC0xMjIuMjUzMzM4OTk5OTk5OThdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1MzIzMiwgLTEyMi4yODA0OTI5OTk5OTk5OV0sIFszNy44MjE1MzMsIC0xMjIuMjc2NzQwOTk5OTk5OTldLCBbMzcuODYxNTkxLCAtMTIyLjI1NDczNjAwMDAwMDAxXSwgWzM3Ljg3Njg4MSwgLTEyMi4yNjY2NjU5OTk5OTk5OV0sIFszNy44Njk2MjUsIC0xMjIuMjY1ODkyXSwgWzM3Ljg4MjA1LCAtMTIyLjI2OTQ1NDAwMDAwMDAxXSwgWzM3Ljg4MDIyNzAwMDAwMDAwNSwgLTEyMi4yNjkzNl0sIFszNy44NjUyMDQ5OTk5OTk5OTYsIC0xMjIuMjcyMDI3MDAwMDAwMDFdLCBbMzcuODU4NTE4LCAtMTIyLjI1MjY1MzAwMDAwMDAxXSwgWzM3Ljg2MTI2NSwgLTEyMi4yNjY5OF0sIFszNy44NTQ2MTIsIC0xMjIuMjgxMTc4XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODcyNjkwOTk5OTk5OTk2LCAtMTIyLjI3MDc0MDk5OTk5OTk5XSwgWzM3Ljg2NjkxOSwgLTEyMi4yNTg4MTJdLCBbMzcuODU0Mjg2LCAtMTIyLjI3MTAxNDk5OTk5OTk5XSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg2MzA3MTk5OTk5OTk5NSwgLTEyMi4yNjAzNTJdLCBbMzcuODY5NDQ4LCAtMTIyLjI4MTc4M10sIFszNy44NjE2NTMwMDAwMDAwMDQsIC0xMjIuMjc4NTI5XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NjkzMzIsIC0xMjIuMjUwMTg5OTk5OTk5OTldLCBbMzcuODczMTk0LCAtMTIyLjMwNDA3XSwgWzM3Ljg2MjU2MiwgLTEyMi4yNjI1OThdLCBbMzcuODgwNDY2OTk5OTk5OTk2LCAtMTIyLjI3ODY5XSwgWzM3Ljg2NTcwMywgLTEyMi4yOTQ2MzNdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44Nzc3MTUsIC0xMjIuMzA5NjE4XSwgWzM3Ljg5OTk3NiwgLTEyMi4yNzk2MDVdLCBbMzcuODQ3NjgyLCAtMTIyLjI3OTM4MV0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODY4ODc4LCAtMTIyLjMwMDI4NF0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg3MTQwMiwgLTEyMi4yOTI5NjVdLCBbMzcuODcwNTgzLCAtMTIyLjI2NTk1Nl0sIFszNy44NjUyMDQ5OTk5OTk5OTYsIC0xMjIuMjcyMDI3MDAwMDAwMDFdLCBbMzcuODY1NTAxLCAtMTIyLjI2OTc3NF0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODg2NDIzLCAtMTIyLjI1MTkxOV0sIFszNy44NTQwOTEsIC0xMjIuMjU2MTMyMDAwMDAwMDFdLCBbMzcuODcwOTQ4LCAtMTIyLjI3NzMzXSwgWzM3Ljg1NDg4LCAtMTIyLjI2OTA3OV0sIFszNy44NTM1NTIsIC0xMjIuMjY4Mjg2XSwgWzM3Ljg2NTIwNDk5OTk5OTk5NiwgLTEyMi4yNzIwMjcwMDAwMDAwMV0sIFszNy44ODE2MzYsIC0xMjIuMjUyMzI4XSwgWzM3Ljg3OTMzNSwgLTEyMi4zMDEzMzJdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44ODAyNCwgLTEyMi4zMDYzODcwMDAwMDAwMl0sIFszNy44Nzg4MTksIC0xMjIuMjkwOTkzXSwgWzM3Ljg1Mzg3NSwgLTEyMi4yNjAwNDhdLCBbMzcuODcxODE4LCAtMTIyLjI3MDU5NV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODg3MjIxMDAwMDAwMDA0LCAtMTIyLjI3NTgzNjAwMDAwMDAxXSwgWzM3Ljg2ODY0MSwgLTEyMi4yOTQxNV0sIFszNy44NTE3NywgLTEyMi4yNzY0ODg5OTk5OTk5OF0sIFszNy44Njg0MTcsIC0xMjIuMzAyNTM5XSwgWzM3Ljg1NDI3NCwgLTEyMi4yODMxODk5OTk5OTk5OV0sIFszNy44NzkzMzUsIC0xMjIuMzAxMzMyXSwgWzM3Ljg1Mzg3NSwgLTEyMi4yNjAwNDhdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44Nzc2MjMsIC0xMjIuMzAwNzhdLCBbMzcuODgxNDMzLCAtMTIyLjI3MjkyMV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg5MzA2Njk5OTk5OTk5NSwgLTEyMi4yNTM0OTVdLCBbMzcuODc5MzM1LCAtMTIyLjMwMTMzMl0sIFszNy44ODA3MTgsIC0xMjIuMzA0MTQ0OTk5OTk5OTldLCBbMzcuODY0NTYsIC0xMjIuMjY5OTU0XSwgWzM3Ljg3ODEyNCwgLTEyMi4yNzE0MV0sIFszNy44NTg2NzI5OTk5OTk5OTYsIC0xMjIuMjczMzY0OTk5OTk5OThdLCBbMzcuODU1NTQ0LCAtMTIyLjI2NDU2M10sIFszNy44NzY2NDQsIC0xMjIuMjk5MzU0MDAwMDAwMDFdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg4MDAyNywgLTEyMi4yNzk5NzZdLCBbMzcuODY1ODY4LCAtMTIyLjI1MTU5NV0sIFszNy44NjUxMjEsIC0xMjIuMjU4NDU1XSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NzcyMzIsIC0xMjIuMjcxMjQ0XSwgWzM3Ljg1ODQ1NSwgLTEyMi4yOTMzNzRdLCBbMzcuODcwNzkzLCAtMTIyLjI5NzQ5Nl0sIFszNy45MDI2NDYwMDAwMDAwMDQsIC0xMjIuMjY0NDU2MDAwMDAwMDFdLCBbMzcuODcwMzkzLCAtMTIyLjI5OTUzMjAwMDAwMDAxXSwgWzM3Ljg3NDg3MTk5OTk5OTk5NiwgLTEyMi4yODIzNTkwMDAwMDAwMV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODU1NzIxLCAtMTIyLjI1NTldLCBbMzcuODc5MzM1LCAtMTIyLjMwMTMzMl0sIFszNy44NjM4MjQsIC0xMjIuMjUyNTc1XSwgWzM3Ljg2NjYyMiwgLTEyMi4yNjEwOF0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg3NTc3OSwgLTEyMi4yODM0N10sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg0NzkwODAwMDAwMDAwNCwgLTEyMi4yNzc2ODVdLCBbMzcuODY2NTkyLCAtMTIyLjI5NzIyNl0sIFszNy44NzA2MzkwMDAwMDAwMDQsIC0xMjIuMjcyNDY3OTk5OTk5OTldLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NzUyMTgsIC0xMjIuMjk0MDUyMDAwMDAwMDFdLCBbMzcuODg3MSwgLTEyMi4yNTEzMjA5OTk5OTk5OV0sIFszNy44ODIwMjQsIC0xMjIuMjk3NTZdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg3OTkwOTk5OTk5OTk5NSwgLTEyMi4yNTcyNjk5OTk5OTk5OV0sIFszNy44NjM1MjE5OTk5OTk5OTYsIC0xMjIuMjU0OTkxOTk5OTk5OTldLCBbMzcuODU2MTIxLCAtMTIyLjI2ODc2MDAwMDAwMDAxXSwgWzM3Ljg5OTYyOCwgLTEyMi4yNjA3Mzg5OTk5OTk5OV0sIFszNy44NTc3MDcsIC0xMjIuMjM5ODU4MDAwMDAwMDFdLCBbMzcuODkwMzY2LCAtMTIyLjI2Njk5OF0sIFszNy44NTUzODksIC0xMjIuMjY0NTUyXSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg3NDg2NywgLTEyMi4yNjM2ODg5OTk5OTk5OV0sIFszNy44NjgxNjEsIC0xMjIuMjkxNzUxXSwgWzM3Ljg1MDM0NTAwMDAwMDAwNCwgLTEyMi4yNzA5MTEwMDAwMDAwMV0sIFszNy44NjM5MzgsIC0xMjIuMjUzNzM1XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44Njc1MzMsIC0xMjIuMjkxNzE5XSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODY5MTM3LCAtMTIyLjI1MDkwODAwMDAwMDAxXSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODczMjUsIC0xMjIuMjkzNTU4XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44Njg5MTMsIC0xMjIuMjg2MDhdLCBbMzcuODU5MzA5LCAtMTIyLjI1OTI5MDk5OTk5OTk5XSwgWzM3Ljg3MTMyMywgLTEyMi4yNjcyMjJdLCBbMzcuODY1NDY2LCAtMTIyLjI3MDA1XSwgWzM3Ljg4NTQ4LCAtMTIyLjI3MTNdLCBbMzcuODY5NTc4MDAwMDAwMDA0LCAtMTIyLjI4MDgzODk5OTk5OTk5XSwgWzM3Ljg1NTEwNiwgLTEyMi4yOTI0MTk5OTk5OTk5OV0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg4MjQ5NywgLTEyMi4yOTQ1NzZdLCBbMzcuODU4OTkzLCAtMTIyLjI0NDU3NF0sIFszNy44NjEwODEsIC0xMjIuMjc1OTg0MDAwMDAwMDFdLCBbMzcuODcxODI4LCAtMTIyLjI3MDUxNTk5OTk5OTk5XSwgWzM3Ljg5NDg0MywgLTEyMi4yNjg0MjVdLCBbMzcuODQ5NzQ3LCAtMTIyLjI3NzkwNzAwMDAwMDAxXSwgWzM3Ljg0NzkwODAwMDAwMDAwNCwgLTEyMi4yNzc2ODVdLCBbMzcuODc3NzE1LCAtMTIyLjMwOTYxOF0sIFszNy44Njk5ODYsIC0xMjIuMjg0ODA1XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODY2NTY4LCAtMTIyLjI1NDA4NF0sIFszNy44NjA5NywgLTEyMi4yNjIyNzNdLCBbMzcuODY4ODc4LCAtMTIyLjMwMDI4NF0sIFszNy44NTM1NzYwMDAwMDAwMDQsIC0xMjIuMjg3MjAyMDAwMDAwMDFdLCBbMzcuODczMzI3LCAtMTIyLjI3MzIxNF0sIFszNy44NjczMzYsIC0xMjIuMjY5ODc2XSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44NjgxMDgsIC0xMjIuMjc3MjIyXSwgWzM3Ljg4ODc4NCwgLTEyMi4yNjY2OTldLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NTQxMzcsIC0xMjIuMjUxMDA3XSwgWzM3Ljg2MjE4NCwgLTEyMi4yOTM1MTddLCBbMzcuODcyNDc1LCAtMTIyLjI4NjgxMTAwMDAwMDAxXSwgWzM3Ljg2NjU2OCwgLTEyMi4yNTQwODRdLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44MjE1MzMsIC0xMjIuMjc2NzQwOTk5OTk5OTldLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44OTQ3MjEwMDAwMDAwMDQsIC0xMjIuMjg2NDE2OTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg4NDY0NCwgLTEyMi4yODAwOTZdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg1NDksIC0xMjIuMjc5NDVdLCBbMzcuODY1NDQzLCAtMTIyLjI2MzE4ODk5OTk5OTk4XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy45MDE4NzksIC0xMjIuMjY3MTQxOTk5OTk5OTldLCBbMzcuODY3NzA4LCAtMTIyLjI1MDgwMV0sIFszNy44NTc3NTQsIC0xMjIuMjg5NzM3MDAwMDAwMDJdLCBbMzcuODY3MzM2LCAtMTIyLjI2OTg3Nl0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODYzOTM4LCAtMTIyLjI1MzczNV0sIFszNy44ODgwNzE5OTk5OTk5OTQsIC0xMjIuMjcyMzQzOTk5OTk5OTldLCBbMzcuODk3ODE5LCAtMTIyLjI1NjQ0NV0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg3Njg4MSwgLTEyMi4yNjY2NjU5OTk5OTk5OV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODU5MTk1LCAtMTIyLjI2MTkxNDk5OTk5OTk5XSwgWzM3Ljg3OTMzNSwgLTEyMi4zMDEzMzJdLCBbMzcuODgwMjI3MDAwMDAwMDA1LCAtMTIyLjI2OTM2XSwgWzM3Ljg3NTQyNjAwMDAwMDAwNCwgLTEyMi4yNzgwNTddLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODcyNzc2LCAtMTIyLjI4NDQ4XSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODkxOTU3LCAtMTIyLjI3NDEzMTAwMDAwMDAxXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg4MDIyNzAwMDAwMDAwNSwgLTEyMi4yNjkzNl0sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg2MzUyMTk5OTk5OTk5NiwgLTEyMi4yNTQ5OTE5OTk5OTk5OV0sIFszNy44NTQ0NDIsIC0xMjIuMjc3MTA3XSwgWzM3Ljg3MDI4NywgLTEyMi4zMTYyMzc5OTk5OTk5OF0sIFszNy44NTc3NzYsIC0xMjIuMjg2NTc2XSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg3ODU1MiwgLTEyMi4yNjY4NDM5OTk5OTk5OV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NjUxNDksIC0xMjIuMjU2NDg3XSwgWzM3Ljg3NTU1MzAwMDAwMDAwNCwgLTEyMi4yOTA1NDldLCBbMzcuODU2ODc3MDAwMDAwMDA0LCAtMTIyLjI2NDgyNl0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44OTAzNjYsIC0xMjIuMjY2OTk4XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44OTg3NDcsIC0xMjIuMjY2MTA5MDAwMDAwMDFdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg3MDkxMSwgLTEyMi4yODk2ODQwMDAwMDAwMV0sIFszNy44Njg1OTA5OTk5OTk5OTUsIC0xMjIuMjk0MzkzXSwgWzM3Ljg0NzQ0NjAwMDAwMDAwNSwgLTEyMi4yODExNDU5OTk5OTk5OV0sIFszNy44NjkwNDA5OTk5OTk5OTYsIC0xMjIuMjkyMjA0XSwgWzM3Ljg1MTkyOCwgLTEyMi4yNzQwMTY5OTk5OTk5OV0sIFszNy44NjYwMjUsIC0xMjIuMjU4NjIzXSwgWzM3Ljg2MzM1MzAwMDAwMDAwNCwgLTEyMi4yNzIwOTddLCBbMzcuODc1NzM4LCAtMTIyLjI3NTYwNzAwMDAwMDAxXSwgWzM3Ljg2OTQ4OCwgLTEyMi4yODk1MjE5OTk5OTk5OV0sIFszNy44ODkzOTksIC0xMjIuMjYyNTkzOTk5OTk5OTldLCBbMzcuODY5OTczLCAtMTIyLjI3MDU1NzAwMDAwMDAxXSwgWzM3Ljg2NTE0MDk5OTk5OTk5NCwgLTEyMi4yNjU0NDFdLCBbMzcuODYxNTExLCAtMTIyLjI5NjgxMDAwMDAwMDAxXSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODY2MDI1LCAtMTIyLjI1ODYyM10sIFszNy44NTQ4OCwgLTEyMi4yNjkwNzldLCBbMzcuODY5MzEyLCAtMTIyLjI1NDMxNF0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3MDIzMSwgLTEyMi4yOTk2MjRdLCBbMzcuODkzMjA5MDAwMDAwMDA2LCAtMTIyLjI2NzYxMjAwMDAwMDAxXSwgWzM3Ljg2NzcyMywgLTEyMi4yOTg0MDZdLCBbMzcuODY4NzIyLCAtMTIyLjI1OTEyM10sIFszNy44NjQ2OTIsIC0xMjIuMjk0MzI1XSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NTg1MjUsIC0xMjIuMjY2OTA2XSwgWzM3Ljg2NzIwOSwgLTEyMi4yNTY1NTQwMDAwMDAwMV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1ODQ0Nzk5OTk5OTk5NiwgLTEyMi4yODIzMDhdLCBbMzcuODU3NDUyLCAtMTIyLjI1OTU0OF0sIFszNy44NjY3LCAtMTIyLjI2NzYxNF0sIFszNy44Njg2NTUsIC0xMjIuMjg4MDYzOTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODU5MzA5LCAtMTIyLjI1OTI5MDk5OTk5OTk5XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODYyNzgxLCAtMTIyLjI2OTM3Nl0sIFszNy44NTQwMjEsIC0xMjIuMjczMjA3MDAwMDAwMDFdLCBbMzcuODU3MzE2LCAtMTIyLjI2OTE1NjAwMDAwMDAxXSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODU3MTcsIC0xMjIuMjUyMjA5MDAwMDAwMDFdLCBbMzcuODYzNTIxOTk5OTk5OTk2LCAtMTIyLjI1NDk5MTk5OTk5OTk5XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODY2OTM1OTk5OTk5OTk1LCAtMTIyLjI5NjIxOF0sIFszNy44ODU1NTksIC0xMjIuMjU4NDg1MDAwMDAwMDFdLCBbMzcuODc2MDQ1LCAtMTIyLjI2MDMzNjAwMDAwMDAxXSwgWzM3Ljg1ODgxNCwgLTEyMi4yOTAwNzJdLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NDkwNSwgLTEyMi4yNjkwOThdLCBbMzcuODc3MTk2MDAwMDAwMDA1LCAtMTIyLjMwMjk4Nl0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODUzMzM0OTk5OTk5OTk0LCAtMTIyLjI3Njg4XSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODQ4MjcsIC0xMjIuMjcxNzg3OTk5OTk5OTldLCBbMzcuODc3NjM1OTk5OTk5OTk1LCAtMTIyLjI2NDMyM10sIFszNy44NjM5NjMsIC0xMjIuMjYwNTQ1OTk5OTk5OTldLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44NTg4NjcsIC0xMjIuMjc4OTkxOTk5OTk5OTldLCBbMzcuODU3ODU2LCAtMTIyLjI3OTcyMV0sIFszNy44NzAzMDgsIC0xMjIuMjY4MDVdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODY4MDA4LCAtMTIyLjI0MjMwNF0sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODQ4MTUyLCAtMTIyLjI3NTgwN10sIFszNy44NjU5NDUsIC0xMjIuMjUwNDcwOTk5OTk5OTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NzE1NDQsIC0xMjIuMjcyNzE0XSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODk0ODQzLCAtMTIyLjI2ODQyNV0sIFszNy44NjM3NTgwMDAwMDAwMDQsIC0xMjIuMjk1MDUzXSwgWzM3Ljg3NjMwNzAwMDAwMDAwNCwgLTEyMi4yNjg5MjNdLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44ODc3NDcsIC0xMjIuMjY0NTEzOTk5OTk5OTldLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NzQ1ODEsIC0xMjIuMjc3NzQ0XSwgWzM3Ljg2ODQyNCwgLTEyMi4yNjE0NTFdLCBbMzcuODg1NTU5LCAtMTIyLjI1ODQ4NTAwMDAwMDAxXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg4MTIwMTAwMDAwMDAwNCwgLTEyMi4yOTA5OF0sIFszNy44NjA3OTYsIC0xMjIuMjg1MTEyMDAwMDAwMDFdLCBbMzcuODY4MzM0MDAwMDAwMDA0LCAtMTIyLjMwMzc1M10sIFszNy44NTIxNzQsIC0xMjIuMjY3ODI0XSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44NDg1MzQsIC0xMjIuMjcyOTk5XSwgWzM3Ljg4NDI3LCAtMTIyLjI3NjczNzAwMDAwMDAxXSwgWzM3Ljg1Njc1NSwgLTEyMi4yNTUyNDhdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44Njg3MDYsIC0xMjIuMjY2Mjc5XSwgWzM3Ljg2NDkyNSwgLTEyMi4yNzM0MzZdLCBbMzcuODUyODIxOTk5OTk5OTk2LCAtMTIyLjI5MTY3N10sIFszNy44NjczMzYsIC0xMjIuMjY5ODc2XSwgWzM3Ljg1NjU5NSwgLTEyMi4yNzUwNjM5OTk5OTk5OV0sIFszNy44OTk5NzYsIC0xMjIuMjc5NjA1XSwgWzM3Ljg3NjQyODAwMDAwMDAwNCwgLTEyMi4yOTE3MzYwMDAwMDAwMV0sIFszNy44NjYzMzUsIC0xMjIuMzA1MzgzXSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44NTM2NDQsIC0xMjIuMjYyMDQ2XSwgWzM3Ljg4MjA2NywgLTEyMi4yOTYzOTJdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg5MDkyOCwgLTEyMi4yODcyNTFdLCBbMzcuODU0NTY1LCAtMTIyLjI4MTQ2Nl0sIFszNy44ODUyNjcsIC0xMjIuMjU5NTM1MDAwMDAwMDFdLCBbMzcuODU5MzEsIC0xMjIuMjczNDk1XSwgWzM3Ljg1NDksIC0xMjIuMjc5NDVdLCBbMzcuODc0NTgxLCAtMTIyLjI3Nzc0NF0sIFszNy44NzAzOTYsIC0xMjIuMjgxNTg1XSwgWzM3Ljg3MjU5OSwgLTEyMi4zMDM4ODg5OTk5OTk5OF0sIFszNy44ODA4NTksIC0xMjIuMjg3Nzc0XSwgWzM3Ljg1NTgyNCwgLTEyMi4yNTUwMl0sIFszNy44NjYwMjUsIC0xMjIuMjU4NjIzXSwgWzM3Ljg4MDgzNTk5OTk5OTk5NSwgLTEyMi4yOTQwNDhdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg0OTQzMSwgLTEyMi4yNzgxNzM5OTk5OTk5OV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg4MDY1MjAwMDAwMDAwNSwgLTEyMi4yODMxODFdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODgwOTIyLCAtMTIyLjMwMzExNDk5OTk5OTk5XSwgWzM3Ljg2NjkzNSwgLTEyMi4yNjU3NzJdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NTcwOTksIC0xMjIuMjYzNzg1MDAwMDAwMDFdLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44Njc5NzE5OTk5OTk5OTUsIC0xMjIuMjYzNjk5XSwgWzM3Ljg3MjU5OSwgLTEyMi4zMDM4ODg5OTk5OTk5OF0sIFszNy44NjM4MTEsIC0xMjIuMjY3NDEyMDAwMDAwMDFdLCBbMzcuODY3MjEyLCAtMTIyLjI4MTczODk5OTk5OTk5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU5NTU3LCAtMTIyLjI5NzMzXSwgWzM3Ljg3MTYwNywgLTEyMi4yODQzMzYwMDAwMDAwMV0sIFszNy44NjUxNDksIC0xMjIuMjU2NDg3XSwgWzM3Ljg2NTAzNCwgLTEyMi4yOTc5Mzg5OTk5OTk5OV0sIFszNy44NzM0NTM5OTk5OTk5OTUsIC0xMjIuMjcyMDg5OTk5OTk5OTldLCBbMzcuODY5OTkzLCAtMTIyLjI5NDc3NF0sIFszNy44NTUsIC0xMjIuMjc3MjAyXSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NzEyNzEsIC0xMjIuMjk1MDE0OTk5OTk5OTldLCBbMzcuODcxNTQsIC0xMjIuMzAwMDQ0XSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg3MDg4MSwgLTEyMi4yODQzOTldLCBbMzcuODYwMjY0LCAtMTIyLjI4Mjg2N10sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg3ODgyNywgLTEyMi4yNzM3NjM5OTk5OTk5OV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODY5ODM5LCAtMTIyLjI1MjM2NV0sIFszNy44NjQ3MTQsIC0xMjIuMjc0NTcxOTk5OTk5OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjUxNzE5OTk5OTk5OTQsIC0xMjIuMzExMTU1XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3NDEwNywgLTEyMi4yODExMDkwMDAwMDAwMV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY0ODk3LCAtMTIyLjI4ODY3MTk5OTk5OTk5XSwgWzM3Ljg3MDQxNjk5OTk5OTk5NiwgLTEyMi4yOTI0ODUwMDAwMDAwMV0sIFszNy44NTk4MDIsIC0xMjIuMjY3MTc3XSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODU4ODg4LCAtMTIyLjI2NDEzN10sIFszNy44NTM0ODUsIC0xMjIuMjcyMDkzXSwgWzM3Ljg2ODU5NSwgLTEyMi4yNzM4MzVdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg1ODM1NiwgLTEyMi4yNTMxNzldLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NjQ1MzUsIC0xMjIuMjYyOTkzXSwgWzM3Ljg1NzQ1MiwgLTEyMi4yNTk1NDhdLCBbMzcuODY0OTA4LCAtMTIyLjI2NzI4ODk5OTk5OTk5XSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjM2NzksIC0xMjIuMjY5NjNdLCBbMzcuODU0MjQ2OTk5OTk5OTk0LCAtMTIyLjI0Mzc1XSwgWzM3Ljg2Njk1LCAtMTIyLjI4Njk4NF0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODU2MDcyOTk5OTk5OTk1LCAtMTIyLjI5MjczNTAwMDAwMDAxXSwgWzM3Ljg3ODI3NCwgLTEyMi4yOTc1NTZdLCBbMzcuODcyMTA0LCAtMTIyLjI4OTgxMjAwMDAwMDAxXSwgWzM3Ljg4MDM3NiwgLTEyMi4yNjgxODMwMDAwMDAwMV0sIFszNy44NTQ4OCwgLTEyMi4yNjkwNzldLCBbMzcuODUzMjMyLCAtMTIyLjI4MDQ5Mjk5OTk5OTk5XSwgWzM3Ljg1ODUyNSwgLTEyMi4yNjY5MDZdLCBbMzcuODY0MjU3LCAtMTIyLjI4NjQxMjk5OTk5OTk4XSwgWzM3Ljg2NzMxNywgLTEyMi4yOTM5ODJdLCBbMzcuODUwMzQ1MDAwMDAwMDA0LCAtMTIyLjI3MDkxMTAwMDAwMDAxXSwgWzM3Ljg0OTMyMSwgLTEyMi4yNzk3N10sIFszNy44NzY4ODEsIC0xMjIuMjY2NjY1OTk5OTk5OTldLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzA0MTY5OTk5OTk5OTYsIC0xMjIuMjkyNDg1MDAwMDAwMDFdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NjYzMTA5OTk5OTk5OTYsIC0xMjIuMjU2MzYxMDAwMDAwMDFdLCBbMzcuODYzMTU3LCAtMTIyLjI4MzE4NV0sIFszNy44ODI5NTcsIC0xMjIuMjg5NDU4MDAwMDAwMDFdLCBbMzcuODgyMjE3LCAtMTIyLjMwMjIyNl0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODY4MjA2LCAtMTIyLjI3NzIzMjAwMDAwMDAxXSwgWzM3Ljg1NDkxLCAtMTIyLjI2ODY2Nl0sIFszNy44Njk2ODUsIC0xMjIuMjcyODA0MDAwMDAwMDFdLCBbMzcuODY0MjU4LCAtMTIyLjI3MjIwMjAwMDAwMDAxXSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODU3NDUyLCAtMTIyLjI1OTU0OF0sIFszNy44NTA1NDEsIC0xMjIuMjg2MDM3MDAwMDAwMDFdLCBbMzcuODY5MiwgLTEyMi4yNjkzMDgwMDAwMDAwMV0sIFszNy44NjIxMDk5OTk5OTk5OTQsIC0xMjIuMjUzNTUxXSwgWzM3Ljg5OTgxMiwgLTEyMi4yNzUyNzNdLCBbMzcuODU5MzY3LCAtMTIyLjI5MTQyMV0sIFszNy44NDk3NDcsIC0xMjIuMjc3OTA3MDAwMDAwMDFdLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg2ODcyMiwgLTEyMi4yNTkxMjNdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg2Njc2MSwgLTEyMi4yNTg3NzldLCBbMzcuODUxNTAzLCAtMTIyLjI3ODUxNzk5OTk5OTk5XSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODYxNTczLCAtMTIyLjI1NzQ1Ml0sIFszNy44NjU0NjYsIC0xMjIuMjcwMDVdLCBbMzcuODc3MzkzLCAtMTIyLjMwMTkxOF0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg1OSwgLTEyMi4yNDQzMTc5OTk5OTk5OV0sIFszNy44NjMyOTIsIC0xMjIuMjU2MjkzXSwgWzM3Ljg1OTQ4LCAtMTIyLjI2NjY4ODk5OTk5OTk5XSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NjkzMTIsIC0xMjIuMjU0MzE0XSwgWzM3Ljg5MTU5NCwgLTEyMi4yNjQ4ODMwMDAwMDAwMV0sIFszNy44Nzc3MTUsIC0xMjIuMzA5NjE4XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODU1OTUzLCAtMTIyLjIzNjQ3NV0sIFszNy44NzUxMTMsIC0xMjIuMjczNDEyOTk5OTk5OTldLCBbMzcuODY5NjkwOTk5OTk5OTk2LCAtMTIyLjI3ODQ4OTk5OTk5OTk5XSwgWzM3Ljg3NjI5Njk5OTk5OTk5NCwgLTEyMi4yNzEyMzk5OTk5OTk5OV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg5MTUxNTAwMDAwMDAwNSwgLTEyMi4yNzAwMzg5OTk5OTk5OF0sIFszNy44NjUxNDksIC0xMjIuMjU2NDg3XSwgWzM3Ljg1Mzg2MSwgLTEyMi4yNjU5OF0sIFszNy44OTg2NDUsIC0xMjIuMjgwNTkzXSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44NTc3ODcsIC0xMjIuMjU3MDEyOTk5OTk5OTldLCBbMzcuODk0NDk0LCAtMTIyLjI2NTUyMDk5OTk5OTk5XSwgWzM3Ljg2NTIwMjAwMDAwMDAwNCwgLTEyMi4yNTc3OTVdLCBbMzcuODQ5NDMxLCAtMTIyLjI3ODE3Mzk5OTk5OTk5XSwgWzM3Ljg1MzY2NSwgLTEyMi4yNTI3MTVdLCBbMzcuODUzMjE4LCAtMTIyLjI1ODA3Nl0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg1MTUyMTAwMDAwMDAwNSwgLTEyMi4yODU0OV0sIFszNy44NjgxOTksIC0xMjIuMjYzMjUzXSwgWzM3Ljg2ODcyMiwgLTEyMi4yNTkxMjNdLCBbMzcuODY2MTM1LCAtMTIyLjI3OTExNTk5OTk5OTk5XSwgWzM3Ljg2NDM5NywgLTEyMi4yNzY4MzVdLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODUyNTI5LCAtMTIyLjI0NzI1NTAwMDAwMDAxXSwgWzM3Ljg2MzA3MTk5OTk5OTk5NSwgLTEyMi4yNjAzNTJdLCBbMzcuODY4NDQ2OTk5OTk5OTk2LCAtMTIyLjI2MTI2Nzk5OTk5OTk5XSwgWzM3Ljg2MzY0NiwgLTEyMi4yNjI4MjJdLCBbMzcuODc2MTg2LCAtMTIyLjMwMTU4XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODU1Mzg5LCAtMTIyLjI2NDU1Ml0sIFszNy44NzI3MjUsIC0xMjIuMjc3NzI5MDAwMDAwMDFdLCBbMzcuODcyNjkwOTk5OTk5OTk2LCAtMTIyLjI3MDc0MDk5OTk5OTk5XSwgWzM3Ljg1MzkwMSwgLTEyMi4yODU0MzFdLCBbMzcuODkyMTUyLCAtMTIyLjI2OTIxMTAwMDAwMDAxXSwgWzM3Ljg4NjMzLCAtMTIyLjI3NTM1OTAwMDAwMDAxXSwgWzM3Ljg2NTc3MiwgLTEyMi4yNjc2NDI5OTk5OTk5OV0sIFszNy44NjgxOTksIC0xMjIuMjYzMjUzXSwgWzM3Ljg2MTY0NSwgLTEyMi4yNTM1MDgwMDAwMDAwMV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg1MjIxMSwgLTEyMi4yODYzMzZdLCBbMzcuODU1MDI1LCAtMTIyLjI2MTA4NDAwMDAwMDAxXSwgWzM3Ljg3NjQyODAwMDAwMDAwNCwgLTEyMi4yOTE3MzYwMDAwMDAwMV0sIFszNy44NjA4NTgsIC0xMjIuMjkwNzMzXSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NTk2NzUsIC0xMjIuMjY3MTczXSwgWzM3Ljg3NTMyNCwgLTEyMi4yOTIyNjc5OTk5OTk5OV0sIFszNy44Nzk3MDgsIC0xMjIuMjk3OTk1XSwgWzM3Ljg4NTA1MTAwMDAwMDAwNCwgLTEyMi4yNzQyODc5OTk5OTk5OF0sIFszNy44NjUxMjEsIC0xMjIuMjU4NDU1XSwgWzM3Ljg1MjY4MywgLTEyMi4yNzY1NTZdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44OTA2NTEsIC0xMjIuMjU4MzMxMDAwMDAwMDFdLCBbMzcuODUyMjM2LCAtMTIyLjI3Mjg1Nl0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg1MTI1NSwgLTEyMi4yOTI1MDkwMDAwMDAwMV0sIFszNy44NjU3NzIsIC0xMjIuMjY3NjQyOTk5OTk5OTldLCBbMzcuODU4NDI3LCAtMTIyLjI4MjQ4NTAwMDAwMDAxXSwgWzM3Ljg2NjkxOSwgLTEyMi4yNTg4MTJdLCBbMzcuODcxNzQzLCAtMTIyLjI3MTg3OF0sIFszNy44NzAzOTYsIC0xMjIuMjgxNTg1XSwgWzM3Ljg1MTMyNCwgLTEyMi4yNzI4NzNdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NzMyNSwgLTEyMi4yOTM1NThdLCBbMzcuODcxNDAyLCAtMTIyLjI5Mjk2NV0sIFszNy44NjY1NDYsIC0xMjIuMjQyNzc0XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODc3NDE3LCAtMTIyLjMwMDcxMjk5OTk5OTk5XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODg4NzgsIC0xMjIuMjY3NjU5MDAwMDAwMDFdLCBbMzcuODY1ODE1OTk5OTk5OTk1LCAtMTIyLjI4MTYwMV0sIFszNy44NjgyODEsIC0xMjIuMzAwMTAyXSwgWzM3Ljg2MzUyMTk5OTk5OTk5NiwgLTEyMi4yNTQ5OTE5OTk5OTk5OV0sIFszNy44NDgyNywgLTEyMi4yNzE3ODc5OTk5OTk5OV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NTE5MjEwMDAwMDAwMDQsIC0xMjIuMjY5ODEyOTk5OTk5OThdLCBbMzcuODU2NTcyLCAtMTIyLjI3NTI0MV0sIFszNy44NjMwNDUsIC0xMjIuMzE3MzQ4XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44NzQzNTk5OTk5OTk5OTYsIC0xMjIuMjk4Mzg3XSwgWzM3Ljg4Nzc0NywgLTEyMi4yNjQ1MTM5OTk5OTk5OV0sIFszNy44OTA5NzcsIC0xMjIuMjU5NzQ1XSwgWzM3Ljg4MzI4NSwgLTEyMi4yNzQxNDQ5OTk5OTk5OV0sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODgzODIsIC0xMjIuMjk2OTUyXSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy45MDEyMTUsIC0xMjIuMjY2Mjk3XSwgWzM3Ljg2ODM1MiwgLTEyMi4yNTQ0NTkwMDAwMDAwMV0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44Njc2NDMsIC0xMjIuMjgwNjQzXSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2NzU2NiwgLTEyMi4yNjU5NDhdLCBbMzcuODY1NDQzLCAtMTIyLjI2MzE4ODk5OTk5OTk4XSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODYzMzc4OTk5OTk5OTk1LCAtMTIyLjI4NDkzOTk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY4MjgxLCAtMTIyLjMwMDEwMl0sIFszNy45MDI3NDc5OTk5OTk5OTUsIC0xMjIuMjY5NjQxOTk5OTk5OTldLCBbMzcuODYzMTU3LCAtMTIyLjI4MzE4NV0sIFszNy44NjYyNTMsIC0xMjIuMjk5NDgzMDAwMDAwMDFdLCBbMzcuODg1NjUzMDAwMDAwMDA1LCAtMTIyLjI2OTk1M10sIFszNy44Njc0ODIsIC0xMjIuMjU0MjUzXSwgWzM3Ljg1MDAwNDk5OTk5OTk5NiwgLTEyMi4yODAyNTYwMDAwMDAwMV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODcxMjQ2LCAtMTIyLjI3NDk5MDk5OTk5OTk5XSwgWzM3Ljg1Nzc0MywgLTEyMi4yODg1NDVdLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg3MjkwNywgLTEyMi4yNjY5NzVdLCBbMzcuODcwMDUzOTk5OTk5OTk2LCAtMTIyLjI4NDI2M10sIFszNy44NjMyOTIsIC0xMjIuMjU2MjkzXSwgWzM3Ljg5MDY1MSwgLTEyMi4yNTgzMzEwMDAwMDAwMV0sIFszNy44Nzc1MjgwMDAwMDAwMDUsIC0xMjIuMjc1OTU2MDAwMDAwMDFdLCBbMzcuODYzMzUzMDAwMDAwMDA0LCAtMTIyLjI3MjA5N10sIFszNy44NzY5NjMsIC0xMjIuMjY1NTkwOTk5OTk5OTldLCBbMzcuODc1Nzk2LCAtMTIyLjI4MjQ3N10sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg2NzIyMSwgLTEyMi4yNjM1MzFdLCBbMzcuODU0MTM3LCAtMTIyLjI1MTAwN10sIFszNy44NTEwMTcsIC0xMjIuMjkxMDg3OTk5OTk5OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NDgyNywgLTEyMi4yNzE3ODc5OTk5OTk5OV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODU0NDQyLCAtMTIyLjI3NzEwN10sIFszNy44ODg4MTYsIC0xMjIuMjgxMTQ1XSwgWzM3Ljg5NDU5Nzk5OTk5OTk5NSwgLTEyMi4yODI1MjNdLCBbMzcuODU5OTg4LCAtMTIyLjI1MzMzODk5OTk5OTk4XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODc2MzA3MDAwMDAwMDA0LCAtMTIyLjI2ODkyM10sIFszNy44NjUxMzQwMDAwMDAwMDUsIC0xMjIuMjU4MzMxMDAwMDAwMDFdLCBbMzcuODU4NTI1LCAtMTIyLjI2NjkwNl0sIFszNy44ODM1Mjg5OTk5OTk5OTYsIC0xMjIuMjU5ODg0MDAwMDAwMDFdLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg4MzYyLCAtMTIyLjI2OTczNDAwMDAwMDAxXSwgWzM3Ljg1NjExMSwgLTEyMi4yNjAyNDhdLCBbMzcuODY1NDQzLCAtMTIyLjI2MzE4ODk5OTk5OTk4XSwgWzM3Ljg2NzIyMSwgLTEyMi4yNjM1MzFdLCBbMzcuODgzNDA0LCAtMTIyLjI2MzQzODk5OTk5OTk5XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODgwNTY0LCAtMTIyLjMwNDg5Nl0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Nzc4NiwgLTEyMi4yOTg1NjVdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg1MTk1MSwgLTEyMi4yODY2NzddLCBbMzcuODUyOTQ2LCAtMTIyLjI5NDUxNDk5OTk5OTk5XSwgWzM3Ljg2MzgyNCwgLTEyMi4yODIyODIwMDAwMDAwMV0sIFszNy44NTYxMzQwMDAwMDAwMDQsIC0xMjIuMjcwMTk4XSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODc3OTUxLCAtMTIyLjI3MTM5NV0sIFszNy44Njg1NzQsIC0xMjIuMjcwNDE0OTk5OTk5OTldLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44NzY0MjgwMDAwMDAwMDQsIC0xMjIuMjkxNzM2MDAwMDAwMDFdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NjEwODEsIC0xMjIuMjc1OTg0MDAwMDAwMDFdLCBbMzcuODczNjA3LCAtMTIyLjI3MDkwM10sIFszNy44NzYwODQwMDAwMDAwMDYsIC0xMjIuMjgwMTA1XSwgWzM3Ljg2MjQ3MSwgLTEyMi4yNzE5MDRdLCBbMzcuODU1OTUzLCAtMTIyLjIzNjQ3NV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44NzE0NjEsIC0xMjIuMjcwNzA2XSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODYxNTUzLCAtMTIyLjI5NjU5OV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODY4MTI0LCAtMTIyLjI2Mzg1N10sIFszNy44NTg3NTksIC0xMjIuMjQ4NTIxXSwgWzM3Ljg2OTc2NCwgLTEyMi4yODY1NV0sIFszNy44NzY2NzMsIC0xMjIuMjgyNzQyXSwgWzM3Ljg3NzgyOTk5OTk5OTk5NiwgLTEyMi4yOTk3MjNdLCBbMzcuODc3MSwgLTEyMi4yOTcxNzA5OTk5OTk5OV0sIFszNy44NDg2MDYsIC0xMjIuMjc5NTg3OTk5OTk5OTldLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjI3NzcsIC0xMjIuMjc2NTcwOTk5OTk5OTldLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg1MTY5ODk5OTk5OTk5NiwgLTEyMi4yNzY1NDZdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2NDU5MSwgLTEyMi4yNzY4NTVdLCBbMzcuODcxMTgxLCAtMTIyLjI5NTIxMTAwMDAwMDAxXSwgWzM3Ljg1ODM1NiwgLTEyMi4yNTMxNzldLCBbMzcuODYxNTQwOTk5OTk5OTk1LCAtMTIyLjI1MTE1NjAwMDAwMDAxXSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjIzMTYsIC0xMjIuMjQ1OTQ4XSwgWzM3Ljg1NDA1LCAtMTIyLjIzNjQyOV0sIFszNy44NzAxNTIwMDAwMDAwMDQsIC0xMjIuMzAwNzA1MDAwMDAwMDFdLCBbMzcuODU3NzQzLCAtMTIyLjI4ODU0NV0sIFszNy44NzA5MDk5OTk5OTk5OTUsIC0xMjIuMjY1OTkzXSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44Njg3MjIsIC0xMjIuMjU5MTIzXSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODU5NjgsIC0xMjIuMjU1Nzk1OTk5OTk5OTldLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NTk1MzksIC0xMjIuMjU5MTcxOTk5OTk5OTldLCBbMzcuODU1NTc2LCAtMTIyLjI4MjE1MzAwMDAwMDAxXSwgWzM3Ljg2NzM3MywgLTEyMi4yNDk1MTQ5OTk5OTk5OV0sIFszNy44ODI1MjYsIC0xMjIuMjgyMTMxXSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44NjU3NzIsIC0xMjIuMjY3NjQyOTk5OTk5OTldLCBbMzcuODc2NTk1LCAtMTIyLjI2Nzc4OV0sIFszNy44NTQyMTUsIC0xMjIuMjY5MTY3XSwgWzM3Ljg1MDY4MSwgLTEyMi4yNzA2MTldLCBbMzcuODkwMzY2LCAtMTIyLjI2Njk5OF0sIFszNy44NTU0MzUsIC0xMjIuMjU5ODQxXSwgWzM3Ljg3ODA1MSwgLTEyMi4yODUyMjE5OTk5OTk5OV0sIFszNy44NTQ5LCAtMTIyLjI3OTQ1XSwgWzM3Ljg3MTU0NCwgLTEyMi4yNzI3MTRdLCBbMzcuODYzOTc3LCAtMTIyLjI2NzMwN10sIFszNy44NjU0MiwgLTEyMi4yNTYxOF0sIFszNy44NjY3LCAtMTIyLjI2NzYxNF0sIFszNy44NjYyODgsIC0xMjIuMjk4MzQ0XSwgWzM3LjkwNDIyNCwgLTEyMi4yNzI2OTRdLCBbMzcuODcwMzA4LCAtMTIyLjI2ODA1XSwgWzM3Ljg2Nzk3MTk5OTk5OTk5NSwgLTEyMi4yNjM2OTldLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NjI3ODEsIC0xMjIuMjY5Mzc2XSwgWzM3Ljg3MDYwMywgLTEyMi4yNzA2MTIwMDAwMDAwMV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODgwNTE5LCAtMTIyLjI2NzA1MV0sIFszNy44NzYwNDUsIC0xMjIuMjYwMzM2MDAwMDAwMDFdLCBbMzcuODc4MTE0MDAwMDAwMDA0LCAtMTIyLjI4MDYzNF0sIFszNy44NjExNDQsIC0xMjIuMjk4NzQxOTk5OTk5OTldLCBbMzcuODkzODI5LCAtMTIyLjI2NjI0OV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODg3OTYxLCAtMTIyLjI2OTgyMTk5OTk5OTk5XSwgWzM3Ljg2MDkyNiwgLTEyMi4yNjk1MzIwMDAwMDAwMV0sIFszNy44Nzk2Nzg5OTk5OTk5OTYsIC0xMjIuMjczNjM3OTk5OTk5OTldLCBbMzcuODczNjYxLCAtMTIyLjMwMTgzMV0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44OTIxNTIsIC0xMjIuMjY5MjExMDAwMDAwMDFdLCBbMzcuODgxNzc2LCAtMTIyLjI2MDQyMV0sIFszNy44NjgyODEsIC0xMjIuMzAwMTAyXSwgWzM3Ljg5OTgxMiwgLTEyMi4yNzUyNzNdLCBbMzcuODc0MzU5OTk5OTk5OTk2LCAtMTIyLjI5ODM4N10sIFszNy44NjYyNTMsIC0xMjIuMjk5NDgzMDAwMDAwMDFdLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg3NjA4NDAwMDAwMDAwNiwgLTEyMi4yODAxMDVdLCBbMzcuODg5NTA3LCAtMTIyLjI4MTY2OTk5OTk5OTk5XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg4MTAwNCwgLTEyMi4yODMyMjVdLCBbMzcuODY3ODcxLCAtMTIyLjI2NTY1XSwgWzM3Ljg4NDMxNCwgLTEyMi4yNDY4M10sIFszNy44NTk4MDIsIC0xMjIuMjY3MTc3XSwgWzM3Ljg2NzI3MSwgLTEyMi4yOTg2ODJdLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODczMDI0LCAtMTIyLjI5NDY1Ml0sIFszNy44NzY1OTUsIC0xMjIuMjY3Nzg5XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODc5NjQ3OTk5OTk5OTk2LCAtMTIyLjI1NzddLCBbMzcuODY0ODM2LCAtMTIyLjI5OTAyNF0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NjgxNjEsIC0xMjIuMjkxNzUxXSwgWzM3Ljg2OTEzNywgLTEyMi4yNTA5MDgwMDAwMDAwMV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg2ODU3NCwgLTEyMi4yNzA0MTQ5OTk5OTk5OV0sIFszNy44NTEyNjMsIC0xMjIuMjUyNDc3XSwgWzM3Ljg2Mzc1ODAwMDAwMDAwNCwgLTEyMi4yOTUwNTNdLCBbMzcuODc5MzM1LCAtMTIyLjMwMTMzMl0sIFszNy44NzM5MjEsIC0xMjIuMjc1NTc3XSwgWzM3Ljg1NTUwOTAwMDAwMDAwNSwgLTEyMi4yOTEzNjc5OTk5OTk5OV0sIFszNy44NTkyNTksIC0xMjIuMjc1Nzg3MDAwMDAwMDFdLCBbMzcuODc2Mjk2OTk5OTk5OTk0LCAtMTIyLjI3MTIzOTk5OTk5OTk5XSwgWzM3Ljg3OTcwOCwgLTEyMi4yOTc5OTVdLCBbMzcuODcxNDYxLCAtMTIyLjI3MDcwNl0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODY3MjA5LCAtMTIyLjI1NjU1NDAwMDAwMDAxXSwgWzM3Ljg1ODg5MiwgLTEyMi4yOTEyN10sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg1NjEzNDAwMDAwMDAwNCwgLTEyMi4yNzAxOThdLCBbMzcuODgxNjAyLCAtMTIyLjI4NjMzMl0sIFszNy44Nzg0MTEsIC0xMjIuMzA2MDQxXSwgWzM3Ljg2NTEzNDAwMDAwMDAwNSwgLTEyMi4yNTgzMzEwMDAwMDAwMV0sIFszNy44NjczMzYsIC0xMjIuMjY5ODc2XSwgWzM3Ljg1MTc3LCAtMTIyLjI3NjQ4ODk5OTk5OTk4XSwgWzM3Ljg1MzEsIC0xMjIuMjY2MTMxXSwgWzM3Ljg2NTc5MywgLTEyMi4zMDE3NzkwMDAwMDAwMV0sIFszNy44NTUzODksIC0xMjIuMjY0NTUyXSwgWzM3Ljg2OTU3ODAwMDAwMDAwNCwgLTEyMi4yODA4Mzg5OTk5OTk5OV0sIFszNy44ODYzNywgLTEyMi4yNjQzMzk5OTk5OTk5OV0sIFszNy44NzQ3ODEsIC0xMjIuMjY4NzU4XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODY1MzczOTk5OTk5OTk2LCAtMTIyLjI1NjUxMV0sIFszNy44NjMyNDA5OTk5OTk5OTUsIC0xMjIuMjg3MjI3XSwgWzM3Ljg2NzcyMywgLTEyMi4yOTg0MDZdLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODY4NzIyLCAtMTIyLjI1OTEyM10sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg2NjkzNTk5OTk5OTk5NSwgLTEyMi4yOTYyMThdLCBbMzcuODUwODA5MDAwMDAwMDA1LCAtMTIyLjI5MTA0MTk5OTk5OTk5XSwgWzM3Ljg4MDI2NiwgLTEyMi4yNjkwMzIwMDAwMDAwMV0sIFszNy44NjgyNzI5OTk5OTk5OTUsIC0xMjIuMjk1OTYyOTk5OTk5OTldLCBbMzcuODY2NzM5LCAtMTIyLjI2NzI5OV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg2NDY3NywgLTEyMi4yOTAyOTJdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NzkxMjksIC0xMjIuMzAyNDc4MDAwMDAwMDFdLCBbMzcuODYxNjc3LCAtMTIyLjI2NzE2XSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44Nzg0MTEsIC0xMjIuMzA2MDQxXSwgWzM3Ljg2NzMzNiwgLTEyMi4yNjk4NzZdLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44NTczNiwgLTEyMi4yOTA4MDQwMDAwMDAwMV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg3NTUzMSwgLTEyMi4zMDQ4NTVdLCBbMzcuODYxODg3LCAtMTIyLjI2MjI5MTk5OTk5OTk5XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODQ3ODM4LCAtMTIyLjI3NTc0MV0sIFszNy44NjgyODEsIC0xMjIuMzAwMTAyXSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODU3Njk0LCAtMTIyLjI4MTYyOF0sIFszNy44NTQ4OCwgLTEyMi4yNjkwNzldLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NTk4MDIsIC0xMjIuMjY3MTc3XSwgWzM3Ljg2NjQ3MTk5OTk5OTk5NSwgLTEyMi4yOTg0MDMwMDAwMDAwMV0sIFszNy44NTIxNTQ5OTk5OTk5OTYsIC0xMjIuMjg2NjEwMDAwMDAwMDFdLCBbMzcuODY3NjY4LCAtMTIyLjI2MDEwOTAwMDAwMDAxXSwgWzM3Ljg1ODM5MTk5OTk5OTk5NSwgLTEyMi4yNzU0MjFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2Mzk3NywgLTEyMi4yNjczMDddLCBbMzcuODcwMjM2LCAtMTIyLjI5MjU5MDk5OTk5OTk5XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjkzOSwgLTEyMi4yNjc4ODMwMDAwMDAwMV0sIFszNy44NjU1MzQ5OTk5OTk5OTQsIC0xMjIuMjU1MjM1MDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NTA1NSwgLTEyMi4yODU5ODYwMDAwMDAwMV0sIFszNy44ODg3ODQsIC0xMjIuMjY2Njk5XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NTEwMzgsIC0xMjIuMjUyNDQ4XSwgWzM3Ljg3MDkyNCwgLTEyMi4yNzc1MTc5OTk5OTk5OV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODU5Njc1LCAtMTIyLjI2NzE3M10sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY4NjU1LCAtMTIyLjI4ODA2Mzk5OTk5OTk5XSwgWzM3Ljg4ODI0MSwgLTEyMi4yNTA4NzVdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NzM3MzksIC0xMjIuMjc1NTU3XSwgWzM3Ljg3MDIxMywgLTEyMi4yOTM3NDldLCBbMzcuODc4MTE0MDAwMDAwMDA0LCAtMTIyLjI4MDYzNF0sIFszNy44NTY4NDgsIC0xMjIuMjg4MTIyXSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44NTU1MDkwMDAwMDAwMDUsIC0xMjIuMjkxMzY3OTk5OTk5OTldLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg2NTg0OSwgLTEyMi4yNTk5NzddLCBbMzcuODY2MjY1MDAwMDAwMDA2LCAtMTIyLjMwNTU5MTk5OTk5OTk5XSwgWzM3Ljg1NzcwNywgLTEyMi4yMzk4NTgwMDAwMDAwMV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODQ5MDk5LCAtMTIyLjI3NTkzMjAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NzE2NjY5OTk5OTk5OTUsIC0xMjIuMjcxNzhdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg2Mjg3NzAwMDAwMDAwNSwgLTEyMi4yOTAwNTUwMDAwMDAwMV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg2ODMwOCwgLTEyMi4yOTU3OTRdLCBbMzcuODUxNjUzMDAwMDAwMDA2LCAtMTIyLjI4OTE5NF0sIFszNy44ODgxMiwgLTEyMi4yNzYzMTldLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44ODEwMDQsIC0xMjIuMjgzMjI1XSwgWzM3Ljg1NjcxOSwgLTEyMi4yNjY2NzJdLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODU0MjE1LCAtMTIyLjI2OTE2N10sIFszNy44NjY5MzUsIC0xMjIuMjY1NzcyXSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODUxMDM4LCAtMTIyLjI1MjQ0OF0sIFszNy44Nzk5OTYwMDAwMDAwMDYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg1OTg4OSwgLTEyMi4yNzgxNjddLCBbMzcuODIxNTMzLCAtMTIyLjI3Njc0MDk5OTk5OTk5XSwgWzM3Ljg1NTEwNiwgLTEyMi4yOTI0MTk5OTk5OTk5OV0sIFszNy44NjYwMjUsIC0xMjIuMjU4NjIzXSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44NTk1MzksIC0xMjIuMjU5MTcxOTk5OTk5OTldLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg1MzczOCwgLTEyMi4yNTE2NjNdLCBbMzcuODY1MTQ5LCAtMTIyLjI1NjQ4N10sIFszNy44NjY4MDMwMDAwMDAwMDQsIC0xMjIuMjUxODQ3XSwgWzM3Ljg2NTg2OCwgLTEyMi4yNTE1OTVdLCBbMzcuODgwMDIxLCAtMTIyLjI5ODA5MDk5OTk5OTk5XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjE1OTEsIC0xMjIuMjU0NzM2MDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NDg3NTIwMDAwMDAwMDUsIC0xMjIuMjcxMzMxXSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg1NDYxMiwgLTEyMi4yODExNzhdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY4NzQ3LCAtMTIyLjI4NzM0Ml0sIFszNy44NTQ5ODEsIC0xMjIuMjU3NTkxOTk5OTk5OTldLCBbMzcuODc0NTgxLCAtMTIyLjI3Nzc0NF0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg2MzY0NiwgLTEyMi4yNjI4MjJdLCBbMzcuODYzNTIxOTk5OTk5OTk2LCAtMTIyLjI1NDk5MTk5OTk5OTk5XSwgWzM3Ljg1ODg1NiwgLTEyMi4yNzE1OTJdLCBbMzcuODgyMDI0LCAtMTIyLjI5NzU2XSwgWzM3Ljg1NzQ5NSwgLTEyMi4yNzUyNTZdLCBbMzcuODYzMzEsIC0xMjIuMzE2MTEyOTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg1MjIxMSwgLTEyMi4yODYzMzZdLCBbMzcuODYzMzY5LCAtMTIyLjI1NzYyMl0sIFszNy44NTk4MDQsIC0xMjIuMjgyNzcyXSwgWzM3Ljg2NDI1OCwgLTEyMi4yNzIyMDIwMDAwMDAwMV0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg3MjQ3LCAtMTIyLjI3MzAyMV0sIFszNy44NzAyODcsIC0xMjIuMzE2MjM3OTk5OTk5OThdLCBbMzcuODY3MzAxLCAtMTIyLjI1NTc3N10sIFszNy44NjMyNzE5OTk5OTk5OTUsIC0xMjIuMjU4NjU2XSwgWzM3Ljg2NTM1NSwgLTEyMi4yNjM4NjZdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44NTg0ODMsIC0xMjIuMjUzMTkwOTk5OTk5OTldLCBbMzcuODc2MDg0OTk5OTk5OTk2LCAtMTIyLjMwNjEzNzk5OTk5OTk5XSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODYwNzY4LCAtMTIyLjI3ODI0OV0sIFszNy44NjkyLCAtMTIyLjI2OTMwODAwMDAwMDAxXSwgWzM3Ljg1ODQ1NSwgLTEyMi4yOTMzNzRdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODk3NzMxLCAtMTIyLjI3MTc1OV0sIFszNy44OTM2OTYwMDAwMDAwMDYsIC0xMjIuMjgxMTA1MDAwMDAwMDFdLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44ODI0OTA5OTk5OTk5OTUsIC0xMjIuMjYyNTkwOTk5OTk5OTldLCBbMzcuODgyMjExLCAtMTIyLjI5NDQ4Nl0sIFszNy44NjQ3MDEwMDAwMDAwMDQsIC0xMjIuMjYwNjkyOTk5OTk5OTldLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODU3OTUxLCAtMTIyLjI3MTQ5Mzk5OTk5OTk5XSwgWzM3Ljg2OTEzNywgLTEyMi4yNTA5MDgwMDAwMDAwMV0sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg2OTA4NCwgLTEyMi4yOTkyNDVdLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg1ODQ4MywgLTEyMi4yNTMxOTA5OTk5OTk5OV0sIFszNy44Nzg5MTIsIC0xMjIuMjgyOTU5XSwgWzM3Ljg1OTgwMiwgLTEyMi4yNjcxNzddLCBbMzcuODY5Mzg1LCAtMTIyLjI4OTUzXSwgWzM3Ljg3NTUxLCAtMTIyLjI5MTQyMzk5OTk5OTk5XSwgWzM3Ljg2NzUzMywgLTEyMi4yOTE3MTldLCBbMzcuODU1ODMsIC0xMjIuMjczMzg5OTk5OTk5OTldLCBbMzcuODgyOTU3LCAtMTIyLjI4OTQ1ODAwMDAwMDAxXSwgWzM3Ljg3Nzk1MSwgLTEyMi4yNzEzOTVdLCBbMzcuODczMjUsIC0xMjIuMjkzNTU4XSwgWzM3Ljg0OTUxMiwgLTEyMi4yNzI2NzFdLCBbMzcuODQ5MDk5LCAtMTIyLjI3NTkzMjAwMDAwMDAxXSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg0ODc1MjAwMDAwMDAwNSwgLTEyMi4yNzEzMzFdLCBbMzcuODY2NjIyLCAtMTIyLjI2MTA4XSwgWzM3Ljg3MjkwNywgLTEyMi4yNjY5NzVdLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3MzMyNywgLTEyMi4yNzMyMTRdLCBbMzcuODUzNTEsIC0xMjIuMjYzMDc2XSwgWzM3Ljg2NDkwOCwgLTEyMi4yNjcyODg5OTk5OTk5OV0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg3NDg3MTk5OTk5OTk5NiwgLTEyMi4yODIzNTkwMDAwMDAwMV0sIFszNy44NTgzNTYsIC0xMjIuMjUzMTc5XSwgWzM3Ljg3Njg5NywgLTEyMi4yODg2OF0sIFszNy44NjQ3MTQsIC0xMjIuMjc0NTcxOTk5OTk5OTldLCBbMzcuODY2OTUsIC0xMjIuMjg2OTg0XSwgWzM3Ljg3NDg2NywgLTEyMi4yNjM2ODg5OTk5OTk5OV0sIFszNy44NjIzOTMsIC0xMjIuMjQ4ODUxXSwgWzM3Ljg3MzMyNywgLTEyMi4yNzMyMTRdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg1NDg5MDAwMDAwMDAwNSwgLTEyMi4yNTI1NjM5OTk5OTk5OV0sIFszNy44NTgzNTYsIC0xMjIuMjUzMTc5XSwgWzM3Ljg2NDg5NywgLTEyMi4yODg2NzE5OTk5OTk5OV0sIFszNy44NzExNjIsIC0xMjIuMjc2NTA3MDAwMDAwMDFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3NjA0NSwgLTEyMi4yNjAzMzYwMDAwMDAwMV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg2OTEzNywgLTEyMi4yNTA5MDgwMDAwMDAwMV0sIFszNy44NjEyNjUsIC0xMjIuMjY2OThdLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44ODM3MjUsIC0xMjIuMjY3NTIxXSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODgxMTQyLCAtMTIyLjMwMTkxXSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODcxNDAyLCAtMTIyLjI5Mjk2NV0sIFszNy44OTAzNjYsIC0xMjIuMjY2OTk4XSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg3MzYzOTAwMDAwMDAwNCwgLTEyMi4yNzA2Mzk5OTk5OTk5OV0sIFszNy44NjU1NDYsIC0xMjIuMjgzNzgwMDAwMDAwMDFdLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjQxNDQsIC0xMjIuMjgwMjU3XSwgWzM3Ljg3Mzg4NDk5OTk5OTk5NCwgLTEyMi4yNjYzMzJdLCBbMzcuODY3NjY4LCAtMTIyLjI2MDEwOTAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NzEwMTMsIC0xMjIuMjk2MzY1OTk5OTk5OTldLCBbMzcuODc1MTY2LCAtMTIyLjI4MDEyNV0sIFszNy44ODM0MDcsIC0xMjIuMjczMTU0XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY3OTcxOTk5OTk5OTk1LCAtMTIyLjI2MzY5OV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODc3OTUxLCAtMTIyLjI3MTM5NV0sIFszNy44NzE4MTgsIC0xMjIuMjcwNTk1XSwgWzM3Ljg4MjA2NywgLTEyMi4yOTYzOTJdLCBbMzcuODY1NDQzLCAtMTIyLjI2MzE4ODk5OTk5OTk4XSwgWzM3Ljg1MDM0NTAwMDAwMDAwNCwgLTEyMi4yNzA5MTEwMDAwMDAwMV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NTQ4NTcsIC0xMjIuMjYyMzEzOTk5OTk5OTldLCBbMzcuODc1OTYzLCAtMTIyLjI5NjUyMV0sIFszNy44NzQxNzQsIC0xMjIuMzAxOTk5XSwgWzM3Ljg2NTI2NCwgLTEyMi4yOTY3ODk5OTk5OTk5OV0sIFszNy44Njg0MTcsIC0xMjIuMzAyNTM5XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY4NzIyLCAtMTIyLjI1OTEyM10sIFszNy44NjE1MTEsIC0xMjIuMjk2ODEwMDAwMDAwMDFdLCBbMzcuODUxNTAzLCAtMTIyLjI3ODUxNzk5OTk5OTk5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODkxNzQyLCAtMTIyLjI3NjEwNF0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODU1OTY0LCAtMTIyLjI4MzExMzk5OTk5OTk4XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjgwMDgsIC0xMjIuMjQyMzA0XSwgWzM3Ljg2NjkzNTk5OTk5OTk5NSwgLTEyMi4yOTYyMThdLCBbMzcuODY4OTU3LCAtMTIyLjI1NDU1Ml0sIFszNy44NjczMTcsIC0xMjIuMjkzOTgyXSwgWzM3Ljg4MzQwNCwgLTEyMi4yNjM0Mzg5OTk5OTk5OV0sIFszNy44NjU0MzksIC0xMjIuMjk1NzM2XSwgWzM3Ljg2Njk2OSwgLTEyMi4yNjU1M10sIFszNy44NzM4ODQ5OTk5OTk5OTQsIC0xMjIuMjY2MzMyXSwgWzM3Ljg2MTU0MDk5OTk5OTk5NSwgLTEyMi4yNTExNTYwMDAwMDAwMV0sIFszNy44NzUwNjMsIC0xMjIuMjY1NDc0XSwgWzM3Ljg2MjA4NSwgLTEyMi4yODExNzVdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NjYzMjcwMDAwMDAwMDUsIC0xMjIuMjYzMzU5MDAwMDAwMDFdLCBbMzcuODU4NDgzLCAtMTIyLjI1MzE5MDk5OTk5OTk5XSwgWzM3LjkwMjc0Nzk5OTk5OTk5NSwgLTEyMi4yNjk2NDE5OTk5OTk5OV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODczNjM5MDAwMDAwMDA0LCAtMTIyLjI3MDYzOTk5OTk5OTk5XSwgWzM3Ljg2MzY3OSwgLTEyMi4yNjk2M10sIFszNy44NjE1OTEsIC0xMjIuMjU0NzM2MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODYwNTQ5LCAtMTIyLjI4Njk2OV0sIFszNy44OTMxNDgsIC0xMjIuMjc0ODA5XSwgWzM3Ljg1OTU5MDAwMDAwMDAwNCwgLTEyMi4yODcwMTAwMDAwMDAwMV0sIFszNy44Njc5MDYsIC0xMjIuMjc5NDI4XSwgWzM3Ljg2NDUzNSwgLTEyMi4yNjI5OTNdLCBbMzcuODYxMTA3MDAwMDAwMDA0LCAtMTIyLjI4OTQ4NTAwMDAwMDAxXSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg3MjU2MywgLTEyMi4yODQ2NDhdLCBbMzcuODc2NTU2LCAtMTIyLjI1NTg3NV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODY1ODY4LCAtMTIyLjI1MTU5NV0sIFszNy44NjQ1MzUsIC0xMjIuMjYyOTkzXSwgWzM3Ljg2MDU0OSwgLTEyMi4yODY5NjldLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NjQzMDEsIC0xMjIuMjc5MTE4XSwgWzM3Ljg2Njk2OSwgLTEyMi4yNjU1M10sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODY1OTQ1LCAtMTIyLjI1MDQ3MDk5OTk5OTk5XSwgWzM3Ljg2MzM1MzAwMDAwMDAwNCwgLTEyMi4yNzIwOTddLCBbMzcuODU2MDIzLCAtMTIyLjI3OTY4M10sIFszNy44NTM4OTYsIC0xMjIuMjUyNzM4OTk5OTk5OTldLCBbMzcuODY2NTk0LCAtMTIyLjI4Nzk0NF0sIFszNy44NzU2NjU5OTk5OTk5OTUsIC0xMjIuMjU1Njc2XSwgWzM3Ljg1OTA0NiwgLTEyMi4yODQ2OTZdLCBbMzcuODU5MzgxLCAtMTIyLjI5ODIzMV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg3MjEyNSwgLTEyMi4yODk2Mzk5OTk5OTk5OV0sIFszNy44NTM3MzgsIC0xMjIuMjUxNjYzXSwgWzM3Ljg2NjkxOSwgLTEyMi4yNTg4MTJdLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44OTcsIC0xMjIuMjYxNjc0XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44ODE3NzYsIC0xMjIuMjYwNDIxXSwgWzM3Ljg4MDAyNywgLTEyMi4yNzk5NzZdLCBbMzcuODgxMTMsIC0xMjIuMjc2Mzg5XSwgWzM3Ljg0ODYwNiwgLTEyMi4yNzk1ODc5OTk5OTk5OV0sIFszNy44NzE1NDQsIC0xMjIuMjcyNzE0XSwgWzM3Ljg3MzMyNywgLTEyMi4yNzMyMTRdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTU4MywgLTEyMi4yNzMzODk5OTk5OTk5OV0sIFszNy44NzM2MjcsIC0xMjIuMjc3ODM0MDAwMDAwMDFdLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NTU5MzQ5OTk5OTk5OTUsIC0xMjIuMjUwNTc5XSwgWzM3Ljg2ODg0NSwgLTEyMi4yOTIxMzk5OTk5OTk5OV0sIFszNy44NzI5ODkwMDAwMDAwMDQsIC0xMjIuMjY4NTMyMDAwMDAwMDFdLCBbMzcuODU0ODgsIC0xMjIuMjY5MDc5XSwgWzM3Ljg3MTU0NCwgLTEyMi4yNzI3MTRdLCBbMzcuODY2MzEwOTk5OTk5OTk2LCAtMTIyLjI1NjM2MTAwMDAwMDAxXSwgWzM3Ljg3NzYzNTk5OTk5OTk5NSwgLTEyMi4yNjQzMjNdLCBbMzcuODY5MiwgLTEyMi4yNjkzMDgwMDAwMDAwMV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODgwMjQsIC0xMjIuMzA2Mzg3MDAwMDAwMDJdLCBbMzcuODc0ODY3LCAtMTIyLjI2MzY4ODk5OTk5OTk5XSwgWzM3Ljg3NDIzNywgLTEyMi4yNzMwNTJdLCBbMzcuODc2MjUxLCAtMTIyLjI2MjQ1MzAwMDAwMDAxXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NzkwMDM5OTk5OTk5OTUsIC0xMjIuMjc5Mzg0MDAwMDAwMDFdLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NjgxNjQsIC0xMjIuMjU2MzEzOTk5OTk5OTldLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44Njc1MTMsIC0xMjIuMjgxMTY0OTk5OTk5OTldLCBbMzcuODc5Nzk5LCAtMTIyLjI5OTE4NzAwMDAwMDAyXSwgWzM3Ljg1OTEwMiwgLTEyMi4yOTAxNjI5OTk5OTk5OV0sIFszNy44ODQ2NDQsIC0xMjIuMjgwMDk2XSwgWzM3Ljg2Mzc3Mjk5OTk5OTk5NSwgLTEyMi4yODMwMzQwMDAwMDAwMV0sIFszNy44NjkwNDA5OTk5OTk5OTYsIC0xMjIuMjkyMjA0XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODc1MTQyLCAtMTIyLjI4MDMxMzk5OTk5OTk5XSwgWzM3Ljg2NzU0NjAwMDAwMDAwNCwgLTEyMi4yNTE5NjddLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NjM1OTc5OTk5OTk5OTYsIC0xMjIuMjUzNjkzXSwgWzM3Ljg5NjU5OCwgLTEyMi4yODcwMzk5OTk5OTk5OV0sIFszNy44NjQ3OTUsIC0xMjIuMjk3ODYyOTk5OTk5OTldLCBbMzcuODY5Mzg1LCAtMTIyLjI4OTUzXSwgWzM3Ljg5MDA4LCAtMTIyLjI2MDUwNl0sIFszNy44NjQ3MTQsIC0xMjIuMjc0NTcxOTk5OTk5OTldLCBbMzcuODYzNzU4MDAwMDAwMDA0LCAtMTIyLjI5NTA1M10sIFszNy44NTg4OTIsIC0xMjIuMjkxMjddLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NTcwNTQsIC0xMjIuMjcxMzkyOTk5OTk5OTldLCBbMzcuODUxMDE3LCAtMTIyLjI5MTA4Nzk5OTk5OTk5XSwgWzM3Ljg2NzI5MDk5OTk5OTk5NCwgLTEyMi4yNzAyNDQ5OTk5OTk5OV0sIFszNy44NTU5NTMsIC0xMjIuMjM2NDc1XSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODU3MDU0LCAtMTIyLjI3MTM5Mjk5OTk5OTk5XSwgWzM3Ljg4MDAyNywgLTEyMi4yNzk5NzZdLCBbMzcuODc4MTEyLCAtMTIyLjI2OTExMzk5OTk5OTk5XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODY0MTczLCAtMTIyLjI1ODYxNTk5OTk5OTk5XSwgWzM3Ljg3MTI2OCwgLTEyMi4zMDEwNl0sIFszNy44Njk2ODUsIC0xMjIuMjcyODA0MDAwMDAwMDFdLCBbMzcuODczOTc2LCAtMTIyLjI4MjI1N10sIFszNy44Nzg2ODQsIC0xMjIuMjk3NjgxMDAwMDAwMDFdLCBbMzcuODgxMDA0LCAtMTIyLjI4MzIyNV0sIFszNy44ODM1NTUsIC0xMjIuMjcyMDM2MDAwMDAwMDFdLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg2MzEyNiwgLTEyMi4yODgwNjNdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NzU1MSwgLTEyMi4yOTE0MjM5OTk5OTk5OV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODc1MzI0LCAtMTIyLjI5MjI2Nzk5OTk5OTk5XSwgWzM3Ljg1NjEzMiwgLTEyMi4yNzEyOTE5OTk5OTk5OV0sIFszNy45MDA4MTMsIC0xMjIuMjc3MDc0XSwgWzM3Ljg1Njc1NSwgLTEyMi4yNTUyNDhdLCBbMzcuODYxNjc3LCAtMTIyLjI2NzE2XSwgWzM3Ljg2NTUzNDk5OTk5OTk5NCwgLTEyMi4yNTUyMzUwMDAwMDAwMV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODg4Nzg0LCAtMTIyLjI2NjY5OV0sIFszNy44NDgxNTIsIC0xMjIuMjc1ODA3XSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODY4NTc0LCAtMTIyLjI3MDQxNDk5OTk5OTk5XSwgWzM3Ljg2NzAyNiwgLTEyMi4yOTk3MzcwMDAwMDAwMV0sIFszNy44NjM2NDYsIC0xMjIuMjYyODIyXSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NTk4NDYwMDAwMDAwMDUsIC0xMjIuMjUzMzI1XSwgWzM3Ljg1MjIxMSwgLTEyMi4yODYzMzZdLCBbMzcuODcxNTQ0LCAtMTIyLjI3MjcxNF0sIFszNy44Nzk5OTYwMDAwMDAwMDYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg2NzU2NiwgLTEyMi4yNjU5NDhdLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODc3OTUxLCAtMTIyLjI3MTM5NV0sIFszNy44NjQ4OTQsIC0xMjIuMjY3NDAyXSwgWzM3Ljg1NDUzNTk5OTk5OTk5NiwgLTEyMi4yNjY0MDNdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44ODMxMDMwMDAwMDAwMDYsIC0xMjIuMjc1NDA0MDAwMDAwMDFdLCBbMzcuODkyODA0LCAtMTIyLjI4NTY5Nl0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NTU5NTMsIC0xMjIuMjM2NDc1XSwgWzM3Ljg2NTg5NSwgLTEyMi4yNTk2MjVdLCBbMzcuODY0Nzk1LCAtMTIyLjI5Nzg2Mjk5OTk5OTk5XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NzIxNjYsIC0xMjIuMjc1MzcxOTk5OTk5OTldLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODY3MzI2LCAtMTIyLjI2NzY4NzAwMDAwMDAxXSwgWzM3Ljg2NjkzNTk5OTk5OTk5NSwgLTEyMi4yOTYyMThdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODY0Mzk3LCAtMTIyLjI3NjgzNV0sIFszNy44OTEzNjgsIC0xMjIuMjc5MjU3XSwgWzM3Ljg2NTIwMjAwMDAwMDAwNCwgLTEyMi4yNTc3OTVdLCBbMzcuODU2NzE5LCAtMTIyLjI2NjY3Ml0sIFszNy44NjA3NjgsIC0xMjIuMjc4MjQ5XSwgWzM3Ljg1ODQ0Nzk5OTk5OTk5NiwgLTEyMi4yODIzMDhdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NzA4NjcsIC0xMjIuMjcwNjM1MDAwMDAwMDFdLCBbMzcuODY3NjAxLCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjAxMDQsIC0xMjIuMjg5MzIxXSwgWzM3Ljg3Mjk4OTAwMDAwMDAwNCwgLTEyMi4yNjg1MzIwMDAwMDAwMV0sIFszNy44NzAzOTMsIC0xMjIuMjk5NTMyMDAwMDAwMDFdLCBbMzcuODUyMTU0OTk5OTk5OTk2LCAtMTIyLjI4NjYxMDAwMDAwMDAxXSwgWzM3Ljg4MDMzNDAwMDAwMDAwNSwgLTEyMi4yNzYyN10sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODk0NzAyLCAtMTIyLjI3NTA1M10sIFszNy44NzgwNTEsIC0xMjIuMjg1MjIxOTk5OTk5OTldLCBbMzcuODU1MTA2LCAtMTIyLjI5MjQxOTk5OTk5OTk5XSwgWzM3Ljg2OTM5LCAtMTIyLjI2Nzg4MzAwMDAwMDAxXSwgWzM3Ljg2NjI2NTAwMDAwMDAwNiwgLTEyMi4zMDU1OTE5OTk5OTk5OV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44OTA5MjgsIC0xMjIuMjg3MjUxXSwgWzM3Ljg3Njk2NTAwMDAwMDAwNiwgLTEyMi4yNjA1NDRdLCBbMzcuODg0MzQsIC0xMjIuMjYyNjg1XSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODYxNjcyLCAtMTIyLjI1NTk5MTk5OTk5OTk5XSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODU0ODkwMDAwMDAwMDA1LCAtMTIyLjI1MjU2Mzk5OTk5OTk5XSwgWzM3Ljg1OTQ4LCAtMTIyLjI2NjY4ODk5OTk5OTk5XSwgWzM3Ljg2NTM3Mzk5OTk5OTk5NiwgLTEyMi4yNTY1MTFdLCBbMzcuODY3ODcxLCAtMTIyLjI2NTY1XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44Njc4MzEsIC0xMjIuMjY1ODU4MDAwMDAwMDFdLCBbMzcuODcwMjM2LCAtMTIyLjI5MjU5MDk5OTk5OTk5XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODY3MzA3MDAwMDAwMDA0LCAtMTIyLjMwMDQ2OF0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3MTI2OCwgLTEyMi4zMDEwNl0sIFszNy44NTg0NTUsIC0xMjIuMjkzMzc0XSwgWzM3Ljg1NjcxOSwgLTEyMi4yNjY2NzJdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg2NjUxMywgLTEyMi4yNzQ3NF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg1NDksIC0xMjIuMjc5NDVdLCBbMzcuODY4MTk5LCAtMTIyLjI2MzI1M10sIFszNy44NTA0MzQsIC0xMjIuMjcyNjA3MDAwMDAwMDFdLCBbMzcuODY1NzQ3OTk5OTk5OTk2LCAtMTIyLjI1MzM5Nl0sIFszNy44NTY0MDQsIC0xMjIuMjU4MDIzXSwgWzM3Ljg2MDYwNSwgLTEyMi4yNDcyNDU5OTk5OTk5OV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1MTUyNCwgLTEyMi4yNTA1ODYwMDAwMDAwMV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODY0MDc5LCAtMTIyLjI2NjUwOTAwMDAwMDAxXSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NjEyNjUsIC0xMjIuMjY2OThdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg2NzcwOCwgLTEyMi4yNTA4MDFdLCBbMzcuODUzNjAzLCAtMTIyLjI4Mzk2MV0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODgxMTQyLCAtMTIyLjMwMTkxXSwgWzM3LjgyMTUzMywgLTEyMi4yNzY3NDA5OTk5OTk5OV0sIFszNy44NzQ1NTM5OTk5OTk5OTYsIC0xMjIuMjk2MzE5XSwgWzM3Ljg1ODA0MywgLTEyMi4yODg2NDJdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg3ODE3MywgLTEyMi4yNjQzNTkwMDAwMDAwMV0sIFszNy44ODQ2NDQsIC0xMjIuMjgwMDk2XSwgWzM3Ljg1MDM2NywgLTEyMi4yNzI4MDddLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg4MDUxOSwgLTEyMi4yNjcwNTFdLCBbMzcuODQ4MTUyLCAtMTIyLjI3NTgwN10sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODc4OTk3LCAtMTIyLjI2NDYwNzAwMDAwMDAxXSwgWzM3Ljg2MTA3ODAwMDAwMDAwNiwgLTEyMi4yODk2MzIwMDAwMDAwMV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODgwODkzLCAtMTIyLjI4OTMyM10sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44Nzg5MTIsIC0xMjIuMjgyOTU5XSwgWzM3Ljg2NzUzMywgLTEyMi4yOTE3MTldLCBbMzcuODgxNDMzLCAtMTIyLjI3MjkyMV0sIFszNy44NTM4NzUsIC0xMjIuMjYwMDQ4XSwgWzM3Ljg5MDY1MSwgLTEyMi4yNTgzMzEwMDAwMDAwMV0sIFszNy44NTA0MjQsIC0xMjIuMjk2MDMxXSwgWzM3Ljg1OTc1OTk5OTk5OTk5NCwgLTEyMi4yNTcwMzRdLCBbMzcuODY4NTkwOTk5OTk5OTk1LCAtMTIyLjI5NDM5M10sIFszNy44NTMyMDMsIC0xMjIuMjc5NjQyXSwgWzM3Ljg3MjQ2OCwgLTEyMi4yODY5MDJdLCBbMzcuODY5OTIxMDAwMDAwMDA1LCAtMTIyLjI5NDgyNV0sIFszNy44NjM5NzcsIC0xMjIuMjY3MzA3XSwgWzM3Ljg3ODAyMzk5OTk5OTk5NiwgLTEyMi4zMDc5OF0sIFszNy44ODM4MiwgLTEyMi4yOTY5NTJdLCBbMzcuODY0OTI1LCAtMTIyLjI3MzQzNl0sIFszNy44NzAwNTM5OTk5OTk5OTYsIC0xMjIuMjg0MjYzXSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NDg1MzQsIC0xMjIuMjcyOTk5XSwgWzM3Ljg3MjEwNCwgLTEyMi4yODk4MTIwMDAwMDAwMV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODU1NTIzLCAtMTIyLjI2NjUyOV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1NTE5OSwgLTEyMi4yNTk3NjhdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg2ODE2NCwgLTEyMi4yNTYzMTM5OTk5OTk5OV0sIFszNy44NTEwMTcsIC0xMjIuMjkxMDg3OTk5OTk5OTldLCBbMzcuODY4Nzg0OTk5OTk5OTk1LCAtMTIyLjI3MjcwMV0sIFszNy44ODAzNzYsIC0xMjIuMjY4MTgzMDAwMDAwMDFdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy45MDQzMzEsIC0xMjIuMjY5NTEyXSwgWzM3Ljg3MDU5MTk5OTk5OTk5NSwgLTEyMi4yODY2MTI5OTk5OTk5OV0sIFszNy44ODM5NzMsIC0xMjIuMjY2MzIzXSwgWzM3Ljg5MTQ0MSwgLTEyMi4yNzcwNzhdLCBbMzcuODc0NzkzLCAtMTIyLjI2ODYzOV0sIFszNy44NTQ5LCAtMTIyLjI3OTQ1XSwgWzM3Ljg2NjQyNjAwMDAwMDAwNCwgLTEyMi4yNjk3NjIwMDAwMDAwMV0sIFszNy44NzI0OTksIC0xMjIuMjg2NjMyMDAwMDAwMDFdLCBbMzcuODcyNDg1LCAtMTIyLjI2NjAwMV0sIFszNy44NzAzMDgsIC0xMjIuMjY4MDVdLCBbMzcuODU3MDk5LCAtMTIyLjI2Mzc4NTAwMDAwMDAxXSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODczMDQsIC0xMjIuMjg5NjU5MDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg2NzcyMywgLTEyMi4yOTg0MDZdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODUxMDM4LCAtMTIyLjI1MjQ0OF0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44Nzk2Nzg5OTk5OTk5OTYsIC0xMjIuMjczNjM3OTk5OTk5OTldLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NzQ4MjcsIC0xMjIuMjc1Njk2XSwgWzM3Ljg3NDAwMjAwMDAwMDAwNCwgLTEyMi4yNjc0ODc5OTk5OTk5OV0sIFszNy44Njg1NzQsIC0xMjIuMjcwNDE0OTk5OTk5OTldLCBbMzcuODUxOTUzLCAtMTIyLjI3MDE4Ml0sIFszNy44NjMwNDUsIC0xMjIuMzE3MzQ4XSwgWzM3Ljg1MzM4NiwgLTEyMi4yNjM5NzNdLCBbMzcuODY4NjgyLCAtMTIyLjI3MjY5MV0sIFszNy44Njc2NjgsIC0xMjIuMjYwMTA5MDAwMDAwMDFdLCBbMzcuODY4NTkwOTk5OTk5OTk1LCAtMTIyLjI5NDM5M10sIFszNy44NzMyMDEsIC0xMjIuMjY3NDQ0XSwgWzM3Ljg2MTU1MywgLTEyMi4yOTY1OTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg5MDM2NiwgLTEyMi4yNjY5OThdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NzMwMjQsIC0xMjIuMjk0NjUyXSwgWzM3Ljg3NTg3LCAtMTIyLjI2MTc3N10sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODg5NjU4MDAwMDAwMDA0LCAtMTIyLjI3MDEzN10sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODc1NzM4LCAtMTIyLjI3NTYwNzAwMDAwMDAxXSwgWzM3Ljg2MjM5MywgLTEyMi4yNDg4NTFdLCBbMzcuODgwNTE5LCAtMTIyLjI2NzA1MV0sIFszNy44NTU3OTgsIC0xMjIuMjUyNzA3XSwgWzM3Ljg2Mzk2MywgLTEyMi4yNjA1NDU5OTk5OTk5OV0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODU3Nzg3LCAtMTIyLjI1NzAxMjk5OTk5OTk5XSwgWzM3Ljg3ODQsIC0xMjIuMjk2MzgzXSwgWzM3Ljg3MDYwMywgLTEyMi4yNzA2MTIwMDAwMDAwMV0sIFszNy44NTU2NzgwMDAwMDAwMDUsIC0xMjIuMjc0NDI5XSwgWzM3Ljg3MjkwNywgLTEyMi4yNjY5NzVdLCBbMzcuODcwMjg5LCAtMTIyLjI5ODQzMDAwMDAwMDAxXSwgWzM3Ljg1Mjk0NiwgLTEyMi4yOTQ1MTQ5OTk5OTk5OV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODYxMTI5LCAtMTIyLjI3Mzg3OTAwMDAwMDAxXSwgWzM3Ljg3MTM4OCwgLTEyMi4yOTQxMDRdLCBbMzcuODU1Mjk0LCAtMTIyLjI5MjQ3NV0sIFszNy44NzM2MjcsIC0xMjIuMjc3ODM0MDAwMDAwMDFdLCBbMzcuODc2MzU3LCAtMTIyLjI4NTE4ODk5OTk5OTk5XSwgWzM3Ljg5NDcwOTAwMDAwMDAwNiwgLTEyMi4yNTk0OTFdLCBbMzcuODgwMjYyLCAtMTIyLjI5NTgwOV0sIFszNy44NzYzMDcwMDAwMDAwMDQsIC0xMjIuMjY4OTIzXSwgWzM3Ljg3Njk2MywgLTEyMi4yNjU1OTA5OTk5OTk5OV0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg2NjQyNjAwMDAwMDAwNCwgLTEyMi4yNjk3NjIwMDAwMDAwMV0sIFszNy44NjY1MDgsIC0xMjIuMjYxMDU3MDAwMDAwMDFdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjczODMwMDAwMDAwMDQsIC0xMjIuMjkzOTM3OTk5OTk5OThdLCBbMzcuODkwOTQ1LCAtMTIyLjI3MTEyNl0sIFszNy44NTE1MDMsIC0xMjIuMjc4NTE3OTk5OTk5OTldLCBbMzcuODcxNTkzLCAtMTIyLjI3OTg3OTAwMDAwMDAxXSwgWzM3Ljg1MzE2NTk5OTk5OTk5NSwgLTEyMi4yNTg1NTcwMDAwMDAwMV0sIFszNy44ODExMzgsIC0xMjIuMjg4NzVdLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg1ODczMiwgLTEyMi4yODAwODRdLCBbMzcuODc5MzM1LCAtMTIyLjMwMTMzMl0sIFszNy44NzMxOTQsIC0xMjIuMzA0MDddLCBbMzcuODcwODgxLCAtMTIyLjI4NDM5OV0sIFszNy44ODE1MjUsIC0xMjIuMjY5OTc0XSwgWzM3Ljg1MDM2NywgLTEyMi4yNzI4MDddLCBbMzcuODU0MDAyLCAtMTIyLjI0ODU4NzAwMDAwMDAxXSwgWzM3Ljg2NDkwOCwgLTEyMi4yNjcyODg5OTk5OTk5OV0sIFszNy44NTYwMjMsIC0xMjIuMjc5NjgzXSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NTM3MjI5OTk5OTk5OTUsIC0xMjIuMjU5OTc1XSwgWzM3Ljg2NjYyMiwgLTEyMi4yNjEwOF0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODg0OTI1LCAtMTIyLjI0ODQ5N10sIFszNy44NDc2ODIsIC0xMjIuMjc5MzgxXSwgWzM3Ljg3NDM1MTAwMDAwMDAwNCwgLTEyMi4yNzIxOTY5OTk5OTk5OV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODk1MDk5LCAtMTIyLjI3MDQ5Mjk5OTk5OTk5XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NzA1OTE5OTk5OTk5OTUsIC0xMjIuMjg2NjEyOTk5OTk5OTldLCBbMzcuODY3MDMxLCAtMTIyLjI2NTAzODk5OTk5OTk5XSwgWzM3Ljg2ODI3Mjk5OTk5OTk5NSwgLTEyMi4yOTU5NjI5OTk5OTk5OV0sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg2MTUxMSwgLTEyMi4yOTY4MTAwMDAwMDAwMV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODY2MDI1LCAtMTIyLjI1ODYyM10sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODY5OTczLCAtMTIyLjI3MDU1NzAwMDAwMDAxXSwgWzM3Ljg3MTMyMywgLTEyMi4yNjcyMjJdLCBbMzcuODkzMjEzLCAtMTIyLjI4MDQzNjAwMDAwMDAxXSwgWzM3Ljg0NzQ0NjAwMDAwMDAwNSwgLTEyMi4yODExNDU5OTk5OTk5OV0sIFszNy44NjE2NzIsIC0xMjIuMjU1OTkxOTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODc2OTYzLCAtMTIyLjI2NTU5MDk5OTk5OTk5XSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODczMjUsIC0xMjIuMjkzNTU4XSwgWzM3Ljg1OTMxLCAtMTIyLjI3MzQ5NV0sIFszNy44ODIwNSwgLTEyMi4yNjk0NTQwMDAwMDAwMV0sIFszNy44NjQxNzMsIC0xMjIuMjU4NjE1OTk5OTk5OTldLCBbMzcuODY5Mzg1LCAtMTIyLjI4OTUzXSwgWzM3Ljg1MDU0MSwgLTEyMi4yODYwMzcwMDAwMDAwMV0sIFszNy44NTkzNjQsIC0xMjIuMjg4OTEzOTk5OTk5OTldLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg4NTc1MjAwMDAwMDAwNCwgLTEyMi4yNzgwNV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg2NzY2OCwgLTEyMi4yNjAxMDkwMDAwMDAwMV0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODY3NTg5LCAtMTIyLjI5NzU1MzAwMDAwMDAxXSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjA5MjYsIC0xMjIuMjY5NTMyMDAwMDAwMDFdLCBbMzcuODYyMDc4MDAwMDAwMDA0LCAtMTIyLjI0Mzg5OV0sIFszNy44ODAzNzYsIC0xMjIuMjY4MTgzMDAwMDAwMDFdLCBbMzcuODcyMTc1LCAtMTIyLjI2NzgzNV0sIFszNy44ODA3ODYsIC0xMjIuMzAzMDY3XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjAyNjUwMDAwMDAwMDUsIC0xMjIuMjg5MjEyOTk5OTk5OTldLCBbMzcuODc1MDYzLCAtMTIyLjI2NTQ3NF0sIFszNy44NjE1NzMsIC0xMjIuMjU3NDUyXSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODcxMjcxLCAtMTIyLjI5NTAxNDk5OTk5OTk5XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NzMwNTUsIC0xMjIuMjgyMzM3MDAwMDAwMDFdLCBbMzcuODYzOTU5LCAtMTIyLjI2NzQzMl0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg1MzYwMywgLTEyMi4yODM5NjFdLCBbMzcuODc4NDg5LCAtMTIyLjI4MDUyM10sIFszNy44Nzc0MTcsIC0xMjIuMzAwNzEyOTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3OTk5NjAwMDAwMDAwNiwgLTEyMi4yOTY4OTNdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTg4NjcsIC0xMjIuMjc4OTkxOTk5OTk5OTldLCBbMzcuODU1MjkyOTk5OTk5OTk2LCAtMTIyLjI2NjUwMl0sIFszNy44NTgzNTYsIC0xMjIuMjUzMTc5XSwgWzM3Ljg4MTUyNSwgLTEyMi4yNjk5NzRdLCBbMzcuODYxNjcyLCAtMTIyLjI1NTk5MTk5OTk5OTk5XSwgWzM3Ljg4NzIyMTAwMDAwMDAwNCwgLTEyMi4yNzU4MzYwMDAwMDAwMV0sIFszNy44NTUxMDYsIC0xMjIuMjkyNDE5OTk5OTk5OTldLCBbMzcuODc4MDAyLCAtMTIyLjI1NzAxNjk5OTk5OTk5XSwgWzM3Ljg1ODIxNDAwMDAwMDAwNCwgLTEyMi4yNjkyNTIwMDAwMDAwMV0sIFszNy44NTI4MjE5OTk5OTk5OTYsIC0xMjIuMjkxNjc3XSwgWzM3Ljg2Njk2OSwgLTEyMi4yNjU1M10sIFszNy44NjE3NDQsIC0xMjIuMjU0ODczXSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2NTc3MiwgLTEyMi4yNjc2NDI5OTk5OTk5OV0sIFszNy44NzU1MzEsIC0xMjIuMzA0ODU1XSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NjQ1MzUsIC0xMjIuMjYyOTkzXSwgWzM3Ljg3NjI5Njk5OTk5OTk5NCwgLTEyMi4yNzEyMzk5OTk5OTk5OV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODU0MTM3LCAtMTIyLjI1MTAwN10sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2NzI1OTAwMDAwMDAwNCwgLTEyMi4yNjMyNF0sIFszNy44NzAyODcsIC0xMjIuMzE2MjM3OTk5OTk5OThdLCBbMzcuODcxNDIsIC0xMjIuMzAzNTMyXSwgWzM3Ljg4MDkyMiwgLTEyMi4zMDMxMTQ5OTk5OTk5OV0sIFszNy44NjU3NDc5OTk5OTk5OTYsIC0xMjIuMjUzMzk2XSwgWzM3Ljg3MTgxOCwgLTEyMi4yNzA1OTVdLCBbMzcuODU0Mjc0LCAtMTIyLjI4MzE4OTk5OTk5OTk5XSwgWzM3Ljg1MTk1MSwgLTEyMi4yODY2NzddLCBbMzcuODcxNDIsIC0xMjIuMzAzNTMyXSwgWzM3Ljg2NjkxOSwgLTEyMi4yNTg4MTJdLCBbMzcuODYwNTA3LCAtMTIyLjI4MDQ0Nl0sIFszNy44ODAyNjYsIC0xMjIuMjY5MDMyMDAwMDAwMDFdLCBbMzcuODcwNjUyLCAtMTIyLjI3OTU4MDAwMDAwMDAxXSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODQ4ODM0MDAwMDAwMDA0LCAtMTIyLjI3Nzg5OV0sIFszNy44NzIxNTgsIC0xMjIuMjgyMDY1OTk5OTk5OTldLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44Njk0MjMsIC0xMjIuMjgxOTUxXSwgWzM3Ljg2MjIyNSwgLTEyMi4yNzM4OTVdLCBbMzcuODYxNjcyLCAtMTIyLjI1NTk5MTk5OTk5OTk5XSwgWzM3Ljg1ODA0NywgLTEyMi4yNDUzMDZdLCBbMzcuODYwNzQ1LCAtMTIyLjI3MDk2XSwgWzM3Ljg4NTg4LCAtMTIyLjI1MzM1OV0sIFszNy44NjEwODEsIC0xMjIuMjc1OTg0MDAwMDAwMDFdLCBbMzcuODczOTIxLCAtMTIyLjI3NTU3N10sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NTIxNTQ5OTk5OTk5OTYsIC0xMjIuMjg2NjEwMDAwMDAwMDFdLCBbMzcuODY5MTY0MDAwMDAwMDA1LCAtMTIyLjI1MjEzMl0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg2NTk0NSwgLTEyMi4yNTA0NzA5OTk5OTk5OV0sIFszNy44NTIwNjYsIC0xMjIuMjcyOTk0XSwgWzM3Ljg1NTY1MSwgLTEyMi4yNTUwMDYwMDAwMDAwMV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg5MjYxMiwgLTEyMi4yNTgzMDZdLCBbMzcuODYxNTczLCAtMTIyLjI1NzQ1Ml0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjkyLCAtMTIyLjI2OTMwODAwMDAwMDAxXSwgWzM3Ljg2NzgxNiwgLTEyMi4yNTg5OTRdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg1MTAxNywgLTEyMi4yOTEwODc5OTk5OTk5OV0sIFszNy44NzE0MDIsIC0xMjIuMjkyOTY1XSwgWzM3Ljg3MjcwNiwgLTEyMi4yODU3MzIwMDAwMDAwMV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODY0NDExLCAtMTIyLjI5MDcwNV0sIFszNy44NzgxMjQsIC0xMjIuMjcxNDFdLCBbMzcuODY2OTM1OTk5OTk5OTk1LCAtMTIyLjI5NjIxOF0sIFszNy44NTI4MjE5OTk5OTk5OTYsIC0xMjIuMjkxNjc3XSwgWzM3Ljg4MDk2Nzk5OTk5OTk5NiwgLTEyMi4yNTYyNzNdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NjQ4MjYsIC0xMjIuMjYwNzE5XSwgWzM3Ljg3NzE5NjAwMDAwMDAwNSwgLTEyMi4zMDI5ODZdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg2NzYwMSwgLTEyMi4yNjc3MTc5OTk5OTk5OV0sIFszNy44NTcxNywgLTEyMi4yNTIyMDkwMDAwMDAwMV0sIFszNy44NjY1OTIsIC0xMjIuMjk3MjI2XSwgWzM3Ljg3MDkwOTk5OTk5OTk5NSwgLTEyMi4yNjU5OTNdLCBbMzcuODc5Nzg3LCAtMTIyLjI3Mjc0NV0sIFszNy44NTg5MDIsIC0xMjIuMjc3OTcxOTk5OTk5OTldLCBbMzcuODU1NjcxLCAtMTIyLjI2MjQ2MTAwMDAwMDAyXSwgWzM3Ljg1NDg4LCAtMTIyLjI2OTA3OV0sIFszNy44ODI0NjEsIC0xMjIuMjY1MDI2XSwgWzM3Ljg3MDM5MywgLTEyMi4yOTk1MzIwMDAwMDAwMV0sIFszNy44Nzk3MDgsIC0xMjIuMjk3OTk1XSwgWzM3Ljg3MDIzNiwgLTEyMi4yOTI1OTA5OTk5OTk5OV0sIFszNy44NTQwNSwgLTEyMi4yMzY0MjldLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg2Njk3LCAtMTIyLjI4Nl0sIFszNy44ODExNDEsIC0xMjIuMjc1MTc3XSwgWzM3Ljg1OTI1OSwgLTEyMi4yNzU3ODcwMDAwMDAwMV0sIFszNy44NzMzMjcsIC0xMjIuMjczMjE0XSwgWzM3Ljg3MzcyMywgLTEyMi4yOTk1MzIwMDAwMDAwMV0sIFszNy44NjgyMDYsIC0xMjIuMjc3MjMyMDAwMDAwMDFdLCBbMzcuODgwODM1OTk5OTk5OTk1LCAtMTIyLjI5NDA0OF0sIFszNy44NjgxNDAwMDAwMDAwMDQsIC0xMjIuMjYzNzM2MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTE3NywgLTEyMi4yNzY0ODg5OTk5OTk5OF0sIFszNy44Njk2OTA5OTk5OTk5OTYsIC0xMjIuMjc4NDg5OTk5OTk5OTldLCBbMzcuODcxMzE4LCAtMTIyLjI3NTI3OF0sIFszNy44NTk2OCwgLTEyMi4yNTU3OTU5OTk5OTk5OV0sIFszNy44NzgyNzUsIC0xMjIuMjg4MzA2XSwgWzM3Ljg2Nzg1MiwgLTEyMi4yNTg2OTldLCBbMzcuODc5MjcsIC0xMjIuMjYwOTg5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODgxNDMzLCAtMTIyLjI3MjkyMV0sIFszNy44NjU4MDk5OTk5OTk5OTYsIC0xMjIuMzAxNzA3MDAwMDAwMDFdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NTU0MzUsIC0xMjIuMjU5ODQxXSwgWzM3Ljg2NzcxNywgLTEyMi4yNDk5MDFdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3ODQ4OSwgLTEyMi4yODA1MjNdLCBbMzcuODU0ODkwMDAwMDAwMDA1LCAtMTIyLjI1MjU2Mzk5OTk5OTk5XSwgWzM3Ljg0OTY2MSwgLTEyMi4yOTIyNzNdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg4MTAwNCwgLTEyMi4yODMyMjVdLCBbMzcuODY5OTczLCAtMTIyLjI3MDU1NzAwMDAwMDAxXSwgWzM3Ljg4MTQ5MywgLTEyMi4yOTA4NjM5OTk5OTk5OF0sIFszNy44NzA1ODMsIC0xMjIuMjY1OTU2XSwgWzM3Ljg3MjQ3LCAtMTIyLjI3MzAyMV0sIFszNy44NTMyODkwMDAwMDAwMDQsIC0xMjIuMjc4OTQxOTk5OTk5OTldLCBbMzcuODY3NzE3LCAtMTIyLjI0OTkwMV0sIFszNy44NzU3MDgsIC0xMjIuMjg5N10sIFszNy45MDE1OTY5OTk5OTk5OTUsIC0xMjIuMjcwMTcwOTk5OTk5OTldLCBbMzcuODY3ODE2LCAtMTIyLjI1ODk5NF0sIFszNy44NTQ0NDAwMDAwMDAwMDQsIC0xMjIuMjk2NjE4OTk5OTk5OTldLCBbMzcuODU1NzkyLCAtMTIyLjI0NzE0Ml0sIFszNy44NTM2NjUsIC0xMjIuMjUyNzE1XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44Njk2NDIsIC0xMjIuMjg3NDkxOTk5OTk5OTldLCBbMzcuODU5NDgsIC0xMjIuMjY2Njg4OTk5OTk5OTldLCBbMzcuODc0NDI3MDAwMDAwMDA0LCAtMTIyLjI4NTkzNzk5OTk5OTk5XSwgWzM3Ljg1NzcwNywgLTEyMi4yMzk4NTgwMDAwMDAwMV0sIFszNy44NzA2MjcsIC0xMjIuMjc5NzY1XSwgWzM3Ljg2NTk0NSwgLTEyMi4yNTA0NzA5OTk5OTk5OV0sIFszNy44NjM4MTEsIC0xMjIuMjY3NDEyMDAwMDAwMDFdLCBbMzcuODYzOTM4LCAtMTIyLjI1MzczNV0sIFszNy44NzU3OTYsIC0xMjIuMjgyNDc3XSwgWzM3Ljg2NzYzOTAwMDAwMDAwNCwgLTEyMi4yOTg3ODJdLCBbMzcuODg1NzA1LCAtMTIyLjI3Mjc5Ml0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg3Mjk5MTk5OTk5OTk5NiwgLTEyMi4yOTU4MDFdLCBbMzcuODczMzQ2MDAwMDAwMDA1LCAtMTIyLjI2NjI3Nl0sIFszNy44OTEzNjgsIC0xMjIuMjc5MjU3XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODgwMjI3MDAwMDAwMDA1LCAtMTIyLjI2OTM2XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NjE2MDQsIC0xMjIuMjY0MzY2XSwgWzM3Ljg4MjAxNiwgLTEyMi4yODEyNzA5OTk5OTk5OV0sIFszNy44NTczMzIsIC0xMjIuMjg5NTk4XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44ODQzMTQsIC0xMjIuMjQ2ODNdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg3MDE1MjAwMDAwMDAwNCwgLTEyMi4zMDA3MDUwMDAwMDAwMV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODU5NTI4MDAwMDAwMDA1LCAtMTIyLjI1OTI2MDAwMDAwMDAxXSwgWzM3Ljg2ODE5OSwgLTEyMi4yNjMyNTNdLCBbMzcuODYzOTU5LCAtMTIyLjI2NzQzMl0sIFszNy44NTc0NjgsIC0xMjIuMjgzNDE4XSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODU5NTk1LCAtMTIyLjI4MDQxNTk5OTk5OTk5XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NTE5NDQsIC0xMjIuMjgzNDg5OTk5OTk5OTldLCBbMzcuODgwMDc1LCAtMTIyLjI3MDQ3Nl0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2Mjk2NSwgLTEyMi4yNzQzNjEwMDAwMDAwMV0sIFszNy44OTE4NjcsIC0xMjIuMjcyMDQzXSwgWzM3Ljg2ODEwMzAwMDAwMDAwNSwgLTEyMi4yNTY3Ml0sIFszNy44NjI4NzcwMDAwMDAwMDUsIC0xMjIuMjkwMDU1MDAwMDAwMDFdLCBbMzcuODY5NjQyLCAtMTIyLjI4NzQ5MTk5OTk5OTk5XSwgWzM3Ljg2OTY5MDk5OTk5OTk5NiwgLTEyMi4yNzg0ODk5OTk5OTk5OV0sIFszNy44NTc2NzM5OTk5OTk5OTYsIC0xMjIuMjU5NDM0MDAwMDAwMDFdLCBbMzcuODUzNTc2MDAwMDAwMDA0LCAtMTIyLjI4NzIwMjAwMDAwMDAxXSwgWzM3Ljg2Njc2MSwgLTEyMi4yNTg3NzldLCBbMzcuODYzNjQ2LCAtMTIyLjI2MjgyMl0sIFszNy44NzE1NDQsIC0xMjIuMjcyNzE0XSwgWzM3Ljg1NTA2NSwgLTEyMi4yNDk5MzcwMDAwMDAwMl0sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44NTY4NjksIC0xMjIuMjcyOTc3XSwgWzM3Ljg3MTI2OCwgLTEyMi4zMDEwNl0sIFszNy44NTEyNTUsIC0xMjIuMjkyNTA5MDAwMDAwMDFdLCBbMzcuODU5OCwgLTEyMi4yNjQzNTFdLCBbMzcuODcwOTcxOTk5OTk5OTk1LCAtMTIyLjI4ODE4NTAwMDAwMDAxXSwgWzM3Ljg4MDUxOSwgLTEyMi4yNjcwNTFdLCBbMzcuODY5OTQ0LCAtMTIyLjMwMDYzNjAwMDAwMDAxXSwgWzM3Ljg2NTE0MDk5OTk5OTk5NCwgLTEyMi4yNjU0NDFdLCBbMzcuODg0MzE0LCAtMTIyLjI0NjgzXSwgWzM3Ljg1NzY3MSwgLTEyMi4yODE4OTQ5OTk5OTk5OV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY3NDgyLCAtMTIyLjI1NDI1M10sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODcwNzkzLCAtMTIyLjI5NzQ5Nl0sIFszNy44Njk1OTQsIC0xMjIuMzAyOTJdLCBbMzcuODU4MzIsIC0xMjIuMjU0NDE1XSwgWzM3Ljg0OTM3NiwgLTEyMi4yOTQ5NTJdLCBbMzcuODY5MzksIC0xMjIuMjY3ODgzMDAwMDAwMDFdLCBbMzcuODY4NDQ2OTk5OTk5OTk2LCAtMTIyLjI2MTI2Nzk5OTk5OTk5XSwgWzM3Ljg3NzE5NjAwMDAwMDAwNSwgLTEyMi4zMDI5ODZdLCBbMzcuOTAxMzg0LCAtMTIyLjI3Njc4MzAwMDAwMDAxXSwgWzM3Ljg3MzkyMSwgLTEyMi4yNzU1NzddLCBbMzcuODYxMTA3MDAwMDAwMDA0LCAtMTIyLjI4OTQ4NTAwMDAwMDAxXSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NTEyNTUsIC0xMjIuMjkyNTA5MDAwMDAwMDFdLCBbMzcuODY3NzIzLCAtMTIyLjI5ODQwNl0sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg2OTY0MDAwMDAwMDAwNCwgLTEyMi4yOTU5MzNdLCBbMzcuODUzOTI5LCAtMTIyLjI4OTY3OV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODU4NjI4LCAtMTIyLjI1MDc4MzAwMDAwMDAxXSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg2NTE0OSwgLTEyMi4yNTY0ODddLCBbMzcuODgwNDkzLCAtMTIyLjI5NTc0Njk5OTk5OTk5XSwgWzM3Ljg1MjIxMSwgLTEyMi4yODYzMzZdLCBbMzcuODU5OTg4LCAtMTIyLjI1MzMzODk5OTk5OTk4XSwgWzM3LjgyMTUzMywgLTEyMi4yNzY3NDA5OTk5OTk5OV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg1MDM0NTAwMDAwMDAwNCwgLTEyMi4yNzA5MTEwMDAwMDAwMV0sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NDc4MzgsIC0xMjIuMjc1NzQxXSwgWzM3Ljg5NTExOSwgLTEyMi4yNjEzODldLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44NzY5NjMsIC0xMjIuMjY1NTkwOTk5OTk5OTldLCBbMzcuODkwMzY2LCAtMTIyLjI2Njk5OF0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODU1OTY0LCAtMTIyLjI4MzExMzk5OTk5OTk4XSwgWzM3Ljg2ODQ0Njk5OTk5OTk5NiwgLTEyMi4yNjEyNjc5OTk5OTk5OV0sIFszNy44NjIyMDIsIC0xMjIuMjgxMDI2XSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODU4ODkyLCAtMTIyLjI5MTI3XSwgWzM3Ljg3MTQyLCAtMTIyLjMwMzUzMl0sIFszNy44NTM2MDMsIC0xMjIuMjgzOTYxXSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODcxODE4LCAtMTIyLjI3MDU5NV0sIFszNy44NjE2NDUsIC0xMjIuMjUzNTA4MDAwMDAwMDFdLCBbMzcuODcwMjMxLCAtMTIyLjI5OTYyNF0sIFszNy44NjQ4MzYsIC0xMjIuMjk5MDI0XSwgWzM3Ljg3MDkwOTk5OTk5OTk5NSwgLTEyMi4yNjU5OTNdLCBbMzcuODU1NTkzLCAtMTIyLjI4MzAzODk5OTk5OTk5XSwgWzM3Ljg2NzI1OTAwMDAwMDAwNCwgLTEyMi4yNjMyNF0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg4NjQyMywgLTEyMi4yNTE5MTldLCBbMzcuODgwMjY2LCAtMTIyLjI2OTAzMjAwMDAwMDAxXSwgWzM3Ljg3OTMzNSwgLTEyMi4zMDEzMzJdLCBbMzcuODY4NjY2OTk5OTk5OTk1LCAtMTIyLjMxMzY1NjAwMDAwMDAxXSwgWzM3Ljg5OTI3OCwgLTEyMi4yODMyMjJdLCBbMzcuODgwMzc2LCAtMTIyLjI2ODE4MzAwMDAwMDAxXSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44Nzc1MjgwMDAwMDAwMDUsIC0xMjIuMjc1OTU2MDAwMDAwMDFdLCBbMzcuODg4NzAyLCAtMTIyLjI2MzcxXSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY3NjAxLCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3Ljg2NjkzNTk5OTk5OTk5NSwgLTEyMi4yOTYyMThdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2OTIsIC0xMjIuMjY5MzA4MDAwMDAwMDFdLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODY1NDIsIC0xMjIuMjU2MThdLCBbMzcuODgxMTQyLCAtMTIyLjMwMTkxXSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NTQ0NDI5OTk5OTk5OTYsIC0xMjIuMjk2NjA0XSwgWzM3Ljg1NTEwNiwgLTEyMi4yOTI0MTk5OTk5OTk5OV0sIFszNy44NjkxMzcsIC0xMjIuMjUwOTA4MDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NjQ1NiwgLTEyMi4yNjk5NTRdLCBbMzcuODU2MDIzLCAtMTIyLjI3OTY4M10sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODU1Njc4MDAwMDAwMDA1LCAtMTIyLjI3NDQyOV0sIFszNy44ODE2MzYsIC0xMjIuMjUyMzI4XSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODY4OTU3LCAtMTIyLjI1NDU1Ml0sIFszNy44NTEwMTcsIC0xMjIuMjkxMDg3OTk5OTk5OTldLCBbMzcuODYzMDkyLCAtMTIyLjI3NDEyNV0sIFszNy44NjkxMzcsIC0xMjIuMjUwOTA4MDAwMDAwMDFdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2OTA2NywgLTEyMi4yOTIwNDI5OTk5OTk5OV0sIFszNy44NjM2NDYsIC0xMjIuMjYyODIyXSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODcyNDk5LCAtMTIyLjI4NjYzMjAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NjU3NzIsIC0xMjIuMjY3NjQyOTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg5MjgwNCwgLTEyMi4yODU2OTZdLCBbMzcuODY0ODk0LCAtMTIyLjI2NzQwMl0sIFszNy44NjU5NDUsIC0xMjIuMjUwNDcwOTk5OTk5OTldLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg2NTEzNDAwMDAwMDAwNSwgLTEyMi4yNTgzMzEwMDAwMDAwMV0sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODUwODk5LCAtMTIyLjI3NjE3NF0sIFszNy44NjE2NzIsIC0xMjIuMjU1OTkxOTk5OTk5OTldLCBbMzcuODcyNDcsIC0xMjIuMjc5NzE3OTk5OTk5OTldLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg2OTA1NywgLTEyMi4yNzA0NjI5OTk5OTk5OV0sIFszNy44NjczODMwMDAwMDAwMDQsIC0xMjIuMjkzOTM3OTk5OTk5OThdLCBbMzcuODYwMTA1LCAtMTIyLjI2MTkwMV0sIFszNy44ODYzNywgLTEyMi4yNjQzMzk5OTk5OTk5OV0sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODc3ODc4LCAtMTIyLjI3OTc2Ml0sIFszNy44NTQyODYsIC0xMjIuMjcxMDE0OTk5OTk5OTldLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg2NDI1OCwgLTEyMi4yNzIyMDIwMDAwMDAwMV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODg5Mzc5LCAtMTIyLjI2ODkxOV0sIFszNy44ODAwMjcsIC0xMjIuMjc5OTc2XSwgWzM3Ljg2ODYsIC0xMjIuMjg5Mzg1MDAwMDAwMDFdLCBbMzcuODk5ODEyLCAtMTIyLjI3NTI3M10sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg3MTY4OSwgLTEyMi4yOTI4OThdLCBbMzcuODU3NDk1LCAtMTIyLjI3NTI1Nl0sIFszNy44NzM4NjUsIC0xMjIuMjY4NjQwOTk5OTk5OTldLCBbMzcuODc2NDI4MDAwMDAwMDA0LCAtMTIyLjI5MTczNjAwMDAwMDAxXSwgWzM3Ljg1OTE5NSwgLTEyMi4yNjE5MTQ5OTk5OTk5OV0sIFszNy44NjkwMzEsIC0xMjIuMjU2NjExXSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2NzMzNiwgLTEyMi4yNjk4NzZdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44OTY0NjUsIC0xMjIuMjg1MTddLCBbMzcuODk1NDEzLCAtMTIyLjI1ODY3NF0sIFszNy44Njg0NDY5OTk5OTk5OTYsIC0xMjIuMjYxMjY3OTk5OTk5OTldLCBbMzcuODQ3NDQ2MDAwMDAwMDA1LCAtMTIyLjI4MTE0NTk5OTk5OTk5XSwgWzM3Ljg2MTY3MiwgLTEyMi4yNTU5OTE5OTk5OTk5OV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg3NTEzMiwgLTEyMi4yOTMxMDNdLCBbMzcuODYzMDcxOTk5OTk5OTk1LCAtMTIyLjI2MDM1Ml0sIFszNy44Njc4MzEsIC0xMjIuMjY1ODU4MDAwMDAwMDFdLCBbMzcuODU3NTkyLCAtMTIyLjI2OTE4Nl0sIFszNy44NzkyNTkwMDAwMDAwMDUsIC0xMjIuMjgxODYyMDAwMDAwMDJdLCBbMzcuODYzMzY5LCAtMTIyLjI1NzYyMl0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg2MTYwNCwgLTEyMi4yNjQzNjZdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg4Mzc4LCAtMTIyLjI1NTQ3NV0sIFszNy44OTQ4NDMsIC0xMjIuMjY4NDI1XSwgWzM3Ljg3ODQsIC0xMjIuMjk2MzgzXSwgWzM3Ljg3MDg2NywgLTEyMi4yNzA2MzUwMDAwMDAwMV0sIFszNy44NTk4LCAtMTIyLjI2NDM1MV0sIFszNy44NzAyMzYsIC0xMjIuMjkyNTkwOTk5OTk5OTldLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2NDEwOSwgLTEyMi4yOTI5NDhdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44Nzk5OTYwMDAwMDAwMDYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NzQyNTEsIC0xMjIuMjgwMjAzXSwgWzM3Ljg2Mjc2MywgLTEyMi4yNjI2MzldLCBbMzcuODYzOTU5LCAtMTIyLjI2NzQzMl0sIFszNy44NzA5NzE5OTk5OTk5OTUsIC0xMjIuMjg4MTg1MDAwMDAwMDFdLCBbMzcuODcxNjA3LCAtMTIyLjI4NDMzNjAwMDAwMDAxXSwgWzM3Ljg5NzMyMTk5OTk5OTk5NiwgLTEyMi4yODIzNzZdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NTc0NTIsIC0xMjIuMjU5NTQ4XSwgWzM3Ljg1NTc5MiwgLTEyMi4yNDcxNDJdLCBbMzcuODcyNzI1LCAtMTIyLjI3NzcyOTAwMDAwMDAxXSwgWzM3Ljg1MzU1MiwgLTEyMi4yNjgyODZdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg4MjAxNiwgLTEyMi4yODEyNzA5OTk5OTk5OV0sIFszNy44NjU3NzIsIC0xMjIuMjY3NjQyOTk5OTk5OTldLCBbMzcuODY5OTczLCAtMTIyLjI3MDU1NzAwMDAwMDAxXSwgWzM3Ljg1MjIxMSwgLTEyMi4yODYzMzZdLCBbMzcuODUwNjIsIC0xMjIuMjc4MzEyOTk5OTk5OThdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44ODEwMDQsIC0xMjIuMjgzMjI1XSwgWzM3Ljg3MzA0LCAtMTIyLjI4OTY1OTAwMDAwMDAxXSwgWzM3Ljg3MzA0LCAtMTIyLjI4OTY1OTAwMDAwMDAxXSwgWzM3Ljg3ODQwNywgLTEyMi4yNjkxNF0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODY3NzA4LCAtMTIyLjI1MDgwMV0sIFszNy44ODEyNDMsIC0xMjIuMjg5MTkxOTk5OTk5OTldLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODk0NTM1OTk5OTk5OTk1LCAtMTIyLjI3MjA1Nl0sIFszNy44ODAyMjcwMDAwMDAwMDUsIC0xMjIuMjY5MzZdLCBbMzcuODYwMTg5LCAtMTIyLjI5NDA0OF0sIFszNy44OTc1OSwgLTEyMi4yNjA3ODQwMDAwMDAwMl0sIFszNy44Njg0MTcsIC0xMjIuMzAyNTM5XSwgWzM3Ljg2NjkzNTk5OTk5OTk5NSwgLTEyMi4yOTYyMThdLCBbMzcuODkwMzY2LCAtMTIyLjI2Njk5OF0sIFszNy44Nzk2MjI5OTk5OTk5OTUsIC0xMjIuMzA0Nzk1XSwgWzM3Ljg1MzE0Mjk5OTk5OTk5NiwgLTEyMi4yNjQwODUwMDAwMDAwMV0sIFszNy44Njg5NTcsIC0xMjIuMjU0NTUyXSwgWzM3Ljg4NTU0MDk5OTk5OTk5NiwgLTEyMi4yNzQ3NzFdLCBbMzcuODgxNDMzLCAtMTIyLjI3MjkyMV0sIFszNy44NTI3MjQsIC0xMjIuMjYzOTkwOTk5OTk5OTldLCBbMzcuODYzMjkyLCAtMTIyLjI1NjI5M10sIFszNy44NTc3NzYsIC0xMjIuMjg2NTc2XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg2MDIyNSwgLTEyMi4yNjk0NTNdLCBbMzcuODU5NjY1LCAtMTIyLjI1ODJdLCBbMzcuODYyODcsIC0xMjIuMjk5Mzg1MDAwMDAwMDJdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2MDg1OCwgLTEyMi4yOTA3MzNdLCBbMzcuODY3NjY4LCAtMTIyLjI2MDEwOTAwMDAwMDAxXSwgWzM3Ljg2NzQ5MDk5OTk5OTk5NCwgLTEyMi4yNTQwNTQwMDAwMDAwMV0sIFszNy44NDgxNTIsIC0xMjIuMjc1ODA3XSwgWzM3Ljg2NjUxMywgLTEyMi4yNzQ3NF0sIFszNy44NTI2MTgsIC0xMjIuMjgzNjc3XSwgWzM3Ljg2OTQ4OCwgLTEyMi4yODk1MjE5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY2MzEwOTk5OTk5OTk2LCAtMTIyLjI1NjM2MTAwMDAwMDAxXSwgWzM3Ljg5NTQxMywgLTEyMi4yNTg2NzRdLCBbMzcuODU2MDYzLCAtMTIyLjI1Mjk1MjAwMDAwMDAxXSwgWzM3Ljg2ODEwOCwgLTEyMi4yNzcyMjJdLCBbMzcuODU4NTI1LCAtMTIyLjI2NjkwNl0sIFszNy44NTU3OTgsIC0xMjIuMjUyNzA3XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NzIxMjUsIC0xMjIuMjg5NjM5OTk5OTk5OTldLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3Ljg2NTEyMSwgLTEyMi4yNTg0NTVdLCBbMzcuODY5MTY0MDAwMDAwMDA1LCAtMTIyLjI1MjEzMl0sIFszNy44NjkxODYsIC0xMjIuMjgzOTQzXSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44NzUxMTMsIC0xMjIuMjczNDEyOTk5OTk5OTldLCBbMzcuODYwOTkzLCAtMTIyLjI2MjEwNDAwMDAwMDAxXSwgWzM3Ljg3NzIzMiwgLTEyMi4yNzEyNDRdLCBbMzcuODU5MzA5LCAtMTIyLjI1OTI5MDk5OTk5OTk5XSwgWzM3Ljg1NTM4OSwgLTEyMi4yNjQ1NTJdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2ODY2MywgLTEyMi4zMDEzMjVdLCBbMzcuODU5OTg4LCAtMTIyLjI1MzMzODk5OTk5OTk4XSwgWzM3Ljg1MzkyOSwgLTEyMi4yODk2NzldLCBbMzcuODc5MzYzLCAtMTIyLjMwMTM0MV0sIFszNy44NjkzMjQsIC0xMjIuMjUwOTQ3XSwgWzM3Ljg1ODE2NSwgLTEyMi4yNTU2ODcwMDAwMDAwMV0sIFszNy44NTU0MzUsIC0xMjIuMjU5ODQxXSwgWzM3Ljg2NjI1MywgLTEyMi4yOTk0ODMwMDAwMDAwMV0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODcxODgzMDAwMDAwMDA0LCAtMTIyLjMwMTI1NV0sIFszNy44Nzc1MjgwMDAwMDAwMDUsIC0xMjIuMjc1OTU2MDAwMDAwMDFdLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NzMzMjcsIC0xMjIuMjczMjE0XSwgWzM3Ljg2NTE3MTk5OTk5OTk5NCwgLTEyMi4zMTExNTVdLCBbMzcuODY3MzgzMDAwMDAwMDA0LCAtMTIyLjI5MzkzNzk5OTk5OTk4XSwgWzM3Ljg2OTM5LCAtMTIyLjI2Nzg4MzAwMDAwMDAxXSwgWzM3Ljg1Mjk1NiwgLTEyMi4yNjYxOTVdLCBbMzcuODc2MjI4MDAwMDAwMDA1LCAtMTIyLjI1ODg2MDAwMDAwMDAxXSwgWzM3Ljg1ODM1NiwgLTEyMi4yNTMxNzldLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODg5MDE2OTk5OTk5OTk2LCAtMTIyLjI3MjM4ODk5OTk5OTk5XSwgWzM3Ljg2NTQ2NiwgLTEyMi4yNzAwNV0sIFszNy44NzM5MjEsIC0xMjIuMjc1NTc3XSwgWzM3Ljg5MjgyNCwgLTEyMi4yNzI3MTY5OTk5OTk5OV0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODcyNDcsIC0xMjIuMjc5NzE3OTk5OTk5OTldLCBbMzcuODYwNjg2LCAtMTIyLjI3ODMzNzAwMDAwMDAxXSwgWzM3Ljg0OTA1LCAtMTIyLjI2OTA5OF0sIFszNy44Njk4MzksIC0xMjIuMjUyMzY1XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg0OTA1LCAtMTIyLjI2OTA5OF0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NjMwNDUsIC0xMjIuMzE3MzQ4XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44NTE1MjEwMDAwMDAwMDUsIC0xMjIuMjg1NDldLCBbMzcuODYzOTQ1LCAtMTIyLjI5NDA4NjAwMDAwMDAxXSwgWzM3Ljg4NDA3MSwgLTEyMi4yNzkzMTAwMDAwMDAwMV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NzE0MDIsIC0xMjIuMjkyOTY1XSwgWzM3Ljg2OTY0MiwgLTEyMi4yODc0OTE5OTk5OTk5OV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg5MzE0OCwgLTEyMi4yNzQ4MDldLCBbMzcuODcxMzE4LCAtMTIyLjI3NTI3OF0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODU1OTY0LCAtMTIyLjI4MzExMzk5OTk5OTk4XSwgWzM3Ljg4MDAyMSwgLTEyMi4yOTgwOTA5OTk5OTk5OV0sIFszNy44NjU4NDksIC0xMjIuMjU5OTc3XSwgWzM3Ljg2NzU0NjAwMDAwMDAwNCwgLTEyMi4yNTE5NjddLCBbMzcuODU5OTE4LCAtMTIyLjI1NDU3NF0sIFszNy44Njg1MTIsIC0xMjIuMjY3ODEwMDAwMDAwMDFdLCBbMzcuODU5MzEsIC0xMjIuMjczNDk1XSwgWzM3Ljg2NzM3MywgLTEyMi4yNDk1MTQ5OTk5OTk5OV0sIFszNy44ODA3ODYsIC0xMjIuMzAzMDY3XSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NzAzOTYsIC0xMjIuMjgxNTg1XSwgWzM3Ljg3MDU5MTk5OTk5OTk5NSwgLTEyMi4yODY2MTI5OTk5OTk5OV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODgzNDA0LCAtMTIyLjI2MzQzODk5OTk5OTk5XSwgWzM3Ljg2NDIzOCwgLTEyMi4yNjUyNjI5OTk5OTk5OV0sIFszNy44NTk4ODEsIC0xMjIuMjg1MTI4XSwgWzM3Ljg2ODE2NCwgLTEyMi4yNTYzMTM5OTk5OTk5OV0sIFszNy44NjczMzYsIC0xMjIuMjY5ODc2XSwgWzM3Ljg4MjQ4LCAtMTIyLjI2NjEzNzAwMDAwMDAxXSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NTY5NDc5OTk5OTk5OTYsIC0xMjIuMjkzMDEzOTk5OTk5OTldLCBbMzcuODcxNDAyLCAtMTIyLjI5Mjk2NV0sIFszNy44NTQ5LCAtMTIyLjI3OTQ1XSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NTU5NjQsIC0xMjIuMjgzMTEzOTk5OTk5OThdLCBbMzcuODU1Mjk0LCAtMTIyLjI5MjQ3NV0sIFszNy44NjA1NTEsIC0xMjIuMjY0NTExMDAwMDAwMDFdLCBbMzcuODY2MjA5MDAwMDAwMDA1LCAtMTIyLjI2NTY1M10sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1OTIyLCAtMTIyLjI4OTAzNTAwMDAwMDAxXSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44Njc1NjYsIC0xMjIuMjY1OTQ4XSwgWzM3Ljg1ODM5MTk5OTk5OTk5NSwgLTEyMi4yNzU0MjFdLCBbMzcuODU2NzkyLCAtMTIyLjI3OTg0NV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODY0NTg0LCAtMTIyLjI3NTcwNV0sIFszNy44NzczMjMsIC0xMjIuMjY0MjczXSwgWzM3Ljg2ODM2NTk5OTk5OTk5NSwgLTEyMi4yOTU1MDgwMDAwMDAwMV0sIFszNy44OTg3NDcsIC0xMjIuMjY2MTA5MDAwMDAwMDFdLCBbMzcuODU3NjczOTk5OTk5OTk2LCAtMTIyLjI1OTQzNDAwMDAwMDAxXSwgWzM3Ljg1MjgyMTk5OTk5OTk5NiwgLTEyMi4yOTE2NzddLCBbMzcuODcyMDU3LCAtMTIyLjI3NjI0M10sIFszNy44NTI1NDMsIC0xMjIuMjYzNzE1OTk5OTk5OTldLCBbMzcuODU4NjA4MDAwMDAwMDA0LCAtMTIyLjI1OTMwMl0sIFszNy44NjcwMjYsIC0xMjIuMjk5NzM3MDAwMDAwMDFdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3MDIzNiwgLTEyMi4yOTI1OTA5OTk5OTk5OV0sIFszNy44NjE4NDMsIC0xMjIuMjY5NjQ0XSwgWzM3Ljg3MDg0LCAtMTIyLjI4OTY3ODAwMDAwMDAxXSwgWzM3Ljg3MDM0NjAwMDAwMDAwNSwgLTEyMi4yNjc3OTU5OTk5OTk5OV0sIFszNy44NTkyMiwgLTEyMi4yODkwMzUwMDAwMDAwMV0sIFszNy44ODE5NTcsIC0xMjIuMjY5NTUxXSwgWzM3Ljg1MTY1MzAwMDAwMDAwNiwgLTEyMi4yODkxOTRdLCBbMzcuODY5MDU3LCAtMTIyLjI3MDQ2Mjk5OTk5OTk5XSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NjYzMjcwMDAwMDAwMDUsIC0xMjIuMjYzMzU5MDAwMDAwMDFdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjgxNjQsIC0xMjIuMjU2MzEzOTk5OTk5OTldLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjYyNjUwMDAwMDAwMDYsIC0xMjIuMzA1NTkxOTk5OTk5OTldLCBbMzcuODcxNzU2LCAtMTIyLjI3OTldLCBbMzcuODYxMzEzLCAtMTIyLjI5Nzg5NF0sIFszNy44NjMxNzAwMDAwMDAwMDQsIC0xMjIuMjU5NTcxOTk5OTk5OTldLCBbMzcuODY3ODIyLCAtMTIyLjI2NjAwM10sIFszNy44NzAzNDYwMDAwMDAwMDUsIC0xMjIuMjY3Nzk1OTk5OTk5OTldLCBbMzcuODcxNDIsIC0xMjIuMzAzNTMyXSwgWzM3Ljg1Nzk1MSwgLTEyMi4yNzE0OTM5OTk5OTk5OV0sIFszNy44NzgzNzgwMDAwMDAwMDUsIC0xMjIuMjk3MDI5MDAwMDAwMDFdLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg2NTEyMSwgLTEyMi4yNTg0NTVdLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg1NTI5NCwgLTEyMi4yOTI0NzVdLCBbMzcuODY4NzA2LCAtMTIyLjI2NjI3OV0sIFszNy44NzYzMDcwMDAwMDAwMDQsIC0xMjIuMjY4OTIzXSwgWzM3Ljg2NzkxOSwgLTEyMi4yNTA4NDFdLCBbMzcuODUxMjU1LCAtMTIyLjI5MjUwOTAwMDAwMDAxXSwgWzM3Ljg1NDA4OCwgLTEyMi4yNjQyODYwMDAwMDAwMV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODY1NDIsIC0xMjIuMjU2MThdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODkxMzMyLCAtMTIyLjI3OTk3NV0sIFszNy44NjY5NSwgLTEyMi4yODY5ODRdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NDYxOTYsIC0xMjIuMjc1NDA4MDAwMDAwMDFdLCBbMzcuODY2MjUzLCAtMTIyLjI5OTQ4MzAwMDAwMDAxXSwgWzM3Ljg1NTUyMywgLTEyMi4yNjY1MjldLCBbMzcuODc5MzMzLCAtMTIyLjI3NDk2Nzk5OTk5OTk5XSwgWzM3Ljg3MDU2MiwgLTEyMi4zMTQ1MDNdLCBbMzcuODU4NTI1LCAtMTIyLjI2NjkwNl0sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTg1MjUsIC0xMjIuMjY2OTA2XSwgWzM3Ljg3MDYyNywgLTEyMi4yNzk3NjVdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg1ODEzMiwgLTEyMi4yNzc1OTQ5OTk5OTk5OV0sIFszNy44NDk1MTIsIC0xMjIuMjcyNjcxXSwgWzM3Ljg5ODAyNCwgLTEyMi4yNjk5MTY5OTk5OTk5OV0sIFszNy44NjI1NDIsIC0xMjIuMjkwMTA0XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODQ5NTEyLCAtMTIyLjI3MjY3MV0sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODY2MDc0LCAtMTIyLjI2MzMxXSwgWzM3Ljg5MzIxMywgLTEyMi4yODA0MzYwMDAwMDAwMV0sIFszNy44NjUyMDQ5OTk5OTk5OTYsIC0xMjIuMjcyMDI3MDAwMDAwMDFdLCBbMzcuOTAzNSwgLTEyMi4yNjk1MjldLCBbMzcuODcwNDcxLCAtMTIyLjI4MTg3OV0sIFszNy44NzUxODksIC0xMjIuMjk0MTc2MDAwMDAwMDFdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg2MDY4LCAtMTIyLjI0MTU4MjAwMDAwMDAxXSwgWzM3Ljg2MjMxNiwgLTEyMi4yNDU5NDhdLCBbMzcuODU5MTAyLCAtMTIyLjI5MDE2Mjk5OTk5OTk5XSwgWzM3Ljg3NjMzMywgLTEyMi4yNzgxMTc5OTk5OTk5OV0sIFszNy44NjM1MjE5OTk5OTk5OTYsIC0xMjIuMjU0OTkxOTk5OTk5OTldLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODUxNjUzMDAwMDAwMDA2LCAtMTIyLjI4OTE5NF0sIFszNy44NTE3NywgLTEyMi4yNzY0ODg5OTk5OTk5OF0sIFszNy44OTQwOTUsIC0xMjIuMjYzNzc0XSwgWzM3Ljg2Mzk1OSwgLTEyMi4yNjc0MzJdLCBbMzcuODcyOTg5MDAwMDAwMDA0LCAtMTIyLjI2ODUzMjAwMDAwMDAxXSwgWzM3Ljg0OTc0NywgLTEyMi4yNzc5MDcwMDAwMDAwMV0sIFszNy44Njc2NjgsIC0xMjIuMjYwMTA5MDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg3MTY4OSwgLTEyMi4yOTI4OThdLCBbMzcuODY4NzA2LCAtMTIyLjI2NjI3OV0sIFszNy44OTk0MzQsIC0xMjIuMjg3MDAyXSwgWzM3Ljg4MjAxNiwgLTEyMi4yODEyNzA5OTk5OTk5OV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODU1OTI1LCAtMTIyLjI1MjkzODk5OTk5OTk4XSwgWzM3Ljg2NjYyMiwgLTEyMi4yNjEwOF0sIFszNy44Njc4MzEsIC0xMjIuMjY1ODU4MDAwMDAwMDFdLCBbMzcuODY1MTQ5LCAtMTIyLjI1NjQ4N10sIFszNy44NTE1MDMsIC0xMjIuMjc4NTE3OTk5OTk5OTldLCBbMzcuODkyODI0LCAtMTIyLjI3MjcxNjk5OTk5OTk5XSwgWzM3Ljg1NjE4MSwgLTEyMi4yNTk3M10sIFszNy44NzA5NDgsIC0xMjIuMjc3MzNdLCBbMzcuODY0ODI2LCAtMTIyLjI2MDcxOV0sIFszNy44NDc4MzgsIC0xMjIuMjc1NzQxXSwgWzM3Ljg2ODk1NywgLTEyMi4yNTQ1NTJdLCBbMzcuODYxMDcsIC0xMjIuMjgyOTc1XSwgWzM3Ljg0ODUzNCwgLTEyMi4yNzI5OTldLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg2OTY3OSwgLTEyMi4yODgwMzc5OTk5OTk5OV0sIFszNy44NjgzNjU5OTk5OTk5OTUsIC0xMjIuMjk1NTA4MDAwMDAwMDFdLCBbMzcuODYwNjQwOTk5OTk5OTk0LCAtMTIyLjI5MTgyN10sIFszNy44NjQ5MDgsIC0xMjIuMjY3Mjg4OTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2NDUzNSwgLTEyMi4yNjI5OTNdLCBbMzcuODU5MTk1LCAtMTIyLjI2MTkxNDk5OTk5OTk5XSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODY1ODc1LCAtMTIyLjI5MzUyM10sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY3MzgzMDAwMDAwMDA0LCAtMTIyLjI5MzkzNzk5OTk5OTk4XSwgWzM3Ljg2OTIsIC0xMjIuMjY5MzA4MDAwMDAwMDFdLCBbMzcuODc0NzkzLCAtMTIyLjI2ODYzOV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODk5ODEyLCAtMTIyLjI3NTI3M10sIFszNy44NDg0NTMwMDAwMDAwMDYsIC0xMjIuMjczNjA3MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NTU3NDgsIC0xMjIuMjkwMjgxMDAwMDAwMDFdLCBbMzcuODc4Nzk3OTk5OTk5OTk2LCAtMTIyLjI5NDI4NF0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg2NzMzNiwgLTEyMi4yNjk4NzZdLCBbMzcuODY4ODQ1LCAtMTIyLjI5MjEzOTk5OTk5OTk5XSwgWzM3Ljg4MTEzLCAtMTIyLjI3NjM4OV0sIFszNy44NTgzNTYsIC0xMjIuMjUzMTc5XSwgWzM3Ljg3ODI0MDk5OTk5OTk5NiwgLTEyMi4yNTcwNTkwMDAwMDAwMV0sIFszNy44NTU4MjQsIC0xMjIuMjU1MDJdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NTc3NDMsIC0xMjIuMjg4NTQ1XSwgWzM3Ljg3NTQyNjAwMDAwMDAwNCwgLTEyMi4yNzgwNTddLCBbMzcuODgwODkxLCAtMTIyLjI5MDE4ODk5OTk5OTk4XSwgWzM3Ljg3OTkyMSwgLTEyMi4yNzE2NDU5OTk5OTk5OV0sIFszNy44NjAxNzIsIC0xMjIuMjgyODQ3XSwgWzM3Ljg2MzEyNiwgLTEyMi4yODgwNjNdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODU4ODU2LCAtMTIyLjI3MTU5Ml0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODc2Mzg2LCAtMTIyLjI4NTAxN10sIFszNy44NTc0NTIsIC0xMjIuMjU5NTQ4XSwgWzM3Ljg4MjI5NCwgLTEyMi4yODQ4MzUwMDAwMDAwMl0sIFszNy44OTgxMzgsIC0xMjIuMjY4MjU1MDAwMDAwMDFdLCBbMzcuODY3NzIzLCAtMTIyLjI5ODQwNl0sIFszNy44NjgxNjEsIC0xMjIuMjkxNzUxXSwgWzM3Ljg2NzAyNiwgLTEyMi4yOTk3MzcwMDAwMDAwMV0sIFszNy44NTkyMiwgLTEyMi4yODkwMzUwMDAwMDAwMV0sIFszNy44NzUzMDgwMDAwMDAwMDQsIC0xMjIuMzA1OTJdLCBbMzcuODUwNDI0LCAtMTIyLjI5NjAzMV0sIFszNy44NTAwMDEsIC0xMjIuMjc1OTYyOTk5OTk5OTldLCBbMzcuODU3NTkyLCAtMTIyLjI2OTE4Nl0sIFszNy44Njg5OTcsIC0xMjIuMjU2ODg2MDAwMDAwMDFdLCBbMzcuODc5MjczLCAtMTIyLjI1NTk4NjAwMDAwMDAxXSwgWzM3Ljg3ODQsIC0xMjIuMjk2MzgzXSwgWzM3Ljg2MTA3ODAwMDAwMDAwNiwgLTEyMi4yODk2MzIwMDAwMDAwMV0sIFszNy44NTg1MjUsIC0xMjIuMjY2OTA2XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44Njc1NDYwMDAwMDAwMDQsIC0xMjIuMjUxOTY3XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NzUxODksIC0xMjIuMjk0MTc2MDAwMDAwMDFdLCBbMzcuODY2OTM1OTk5OTk5OTk1LCAtMTIyLjI5NjIxOF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2NDU5MSwgLTEyMi4yNzY4NTVdLCBbMzcuODcwMzQ2MDAwMDAwMDA1LCAtMTIyLjI2Nzc5NTk5OTk5OTk5XSwgWzM3Ljg2NzkzLCAtMTIyLjI1MTc5OF0sIFszNy44NzU1MzEsIC0xMjIuMzA0ODU1XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODcwMzQ1LCAtMTIyLjI2ODA3M10sIFszNy44ODkwMTY5OTk5OTk5OTYsIC0xMjIuMjcyMzg4OTk5OTk5OTldLCBbMzcuODU1MDI2LCAtMTIyLjI2NjQ3NV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg1NTE5OSwgLTEyMi4yNTk3NjhdLCBbMzcuODgwNTY0LCAtMTIyLjMwNDg5Nl0sIFszNy44Njc1ODMsIC0xMjIuMjY3ODQ0XSwgWzM3Ljg2NDUzNSwgLTEyMi4yNjI5OTNdLCBbMzcuODcwMzA4LCAtMTIyLjI2ODA1XSwgWzM3Ljg1MzA4NSwgLTEyMi4yODEzNjhdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjY3NjEsIC0xMjIuMjU4Nzc5XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjE5NDAwMDAwMDAwMDQsIC0xMjIuMjgzMDI2XSwgWzM3Ljg3MDI4NywgLTEyMi4zMTYyMzc5OTk5OTk5OF0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODYzMjcxOTk5OTk5OTk1LCAtMTIyLjI1ODY1Nl0sIFszNy44NjYyNTMsIC0xMjIuMjk5NDgzMDAwMDAwMDFdLCBbMzcuODU3OTkzLCAtMTIyLjI2Mzk2NDk5OTk5OTk4XSwgWzM3Ljg1MzU3NjAwMDAwMDAwNCwgLTEyMi4yODcyMDIwMDAwMDAwMV0sIFszNy44NTgzNTYsIC0xMjIuMjUzMTc5XSwgWzM3Ljg2OTU5NCwgLTEyMi4zMDI5Ml0sIFszNy44NzA0MTY5OTk5OTk5OTYsIC0xMjIuMjkyNDg1MDAwMDAwMDFdLCBbMzcuODY5MDg0LCAtMTIyLjI5OTI0NV0sIFszNy44ODAzNzYsIC0xMjIuMjY4MTgzMDAwMDAwMDFdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NzE4ODMwMDAwMDAwMDQsIC0xMjIuMzAxMjU1XSwgWzM3Ljg1MDM0NTAwMDAwMDAwNCwgLTEyMi4yNzA5MTEwMDAwMDAwMV0sIFszNy44Njk4MzksIC0xMjIuMjUyMzY1XSwgWzM3Ljg5ODAyNCwgLTEyMi4yNjk5MTY5OTk5OTk5OV0sIFszNy44NjYyMzEsIC0xMjIuMjkxMjk5XSwgWzM3Ljg4MDg5MSwgLTEyMi4yOTAxODg5OTk5OTk5OF0sIFszNy44NTk1ODksIC0xMjIuMjU3MDE5XSwgWzM3Ljg2MDE3MiwgLTEyMi4yODI4NDddLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg3ODQwNywgLTEyMi4yNjc5NjIwMDAwMDAwMV0sIFszNy44Nzg0LCAtMTIyLjI5NjM4M10sIFszNy44NTE0NywgLTEyMi4yOTE0OTVdLCBbMzcuODczMDQsIC0xMjIuMjg5NjU5MDAwMDAwMDFdLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg4MTQzMywgLTEyMi4yNzI5MjFdLCBbMzcuODkxMzE1OTk5OTk5OTk2LCAtMTIyLjI4MDMxMTAwMDAwMDAxXSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODgwODM0LCAtMTIyLjI2NDU3OF0sIFszNy44NjE2NzIsIC0xMjIuMjU1OTkxOTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2NjAzNywgLTEyMi4yNjU2MTc5OTk5OTk5OV0sIFszNy44NTI4MjE5OTk5OTk5OTYsIC0xMjIuMjkxNjc3XSwgWzM3Ljg2NTE0MDk5OTk5OTk5NCwgLTEyMi4yNjU0NDFdLCBbMzcuODY5NjQyLCAtMTIyLjI4NzQ5MTk5OTk5OTk5XSwgWzM3Ljg2MzUyMTk5OTk5OTk5NiwgLTEyMi4yNTQ5OTE5OTk5OTk5OV0sIFszNy44NzY5NjUwMDAwMDAwMDYsIC0xMjIuMjYwNTQ0XSwgWzM3Ljg3MDI4OSwgLTEyMi4yOTg0MzAwMDAwMDAwMV0sIFszNy44NTU2OTIsIC0xMjIuMjgxMjU5XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODcwMzA4LCAtMTIyLjI2ODA1XSwgWzM3Ljg1ODg1NiwgLTEyMi4yNzE1OTJdLCBbMzcuODUyODcxLCAtMTIyLjI2Nzk5XSwgWzM3Ljg2NTc3MiwgLTEyMi4yNjc2NDI5OTk5OTk5OV0sIFszNy44Nzc3OTMsIC0xMjIuMjYwNzA5XSwgWzM3Ljg2MzA3MTk5OTk5OTk5NSwgLTEyMi4yNjAzNTJdLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg3OTE4OCwgLTEyMi4yNzYxMDcwMDAwMDAwMV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODUzNjgzMDAwMDAwMDA0LCAtMTIyLjI2MTc0NF0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg1NDkyLCAtMTIyLjI3OTMyM10sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NTc3ODQsIC0xMjIuMjcyOTk4XSwgWzM3Ljg2MzY3OSwgLTEyMi4yNjk2M10sIFszNy44ODA0NjgsIC0xMjIuMjk1ODc2XSwgWzM3Ljg3MjE1OCwgLTEyMi4yODIwNjU5OTk5OTk5OV0sIFszNy44NTYzNjcsIC0xMjIuMjM0NjA3MDAwMDAwMDFdLCBbMzcuODY3MzAxLCAtMTIyLjI1NTc3N10sIFszNy44NjY5MzUsIC0xMjIuMjY1NzcyXSwgWzM3Ljg1NjA3Mjk5OTk5OTk5NSwgLTEyMi4yOTI3MzUwMDAwMDAwMV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODc2NDQsIC0xMjIuMjU3MDIzXSwgWzM3Ljg2NTc5NywgLTEyMi4yNTI3NDA5OTk5OTk5OV0sIFszNy44NTYxODEsIC0xMjIuMjU5NzNdLCBbMzcuODQ4MTUyLCAtMTIyLjI3NTgwN10sIFszNy44NDk0MzEsIC0xMjIuMjc4MTczOTk5OTk5OTldLCBbMzcuODY4MzM5LCAtMTIyLjI5MDM4OF0sIFszNy44NjE0MTY5OTk5OTk5OTYsIC0xMjIuMjUzMTQ5XSwgWzM3Ljg3MjQ3LCAtMTIyLjI3MzAyMV0sIFszNy44NTUyOTQsIC0xMjIuMjkyNDc1XSwgWzM3Ljg3MDYwMywgLTEyMi4yNzA2MTIwMDAwMDAwMV0sIFszNy44NzE0MiwgLTEyMi4zMDM1MzJdLCBbMzcuODY4MzUyLCAtMTIyLjI1NDQ1OTAwMDAwMDAxXSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44OTExMDEsIC0xMjIuMjY1ODUzXSwgWzM3Ljg1NzMxNiwgLTEyMi4yNjkxNTYwMDAwMDAwMV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg2NTc0Nzk5OTk5OTk5NiwgLTEyMi4yNTMzOTZdLCBbMzcuODY2NywgLTEyMi4yNjc2MTRdLCBbMzcuOTAyMDU5LCAtMTIyLjI2NTI5NF0sIFszNy44NTYxMzIsIC0xMjIuMjcxMjkxOTk5OTk5OTldLCBbMzcuODcwNDE2OTk5OTk5OTk2LCAtMTIyLjI5MjQ4NTAwMDAwMDAxXSwgWzM3Ljg1NTY4NDAwMDAwMDAwNCwgLTEyMi4yNjM0OTA5OTk5OTk5OV0sIFszNy44OTUwOTksIC0xMjIuMjcwNDkyOTk5OTk5OTldLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NTc3ODcsIC0xMjIuMjU3MDEyOTk5OTk5OTldLCBbMzcuODUyMjExLCAtMTIyLjI4NjMzNl0sIFszNy44Njk2ODUsIC0xMjIuMjcyODA0MDAwMDAwMDFdLCBbMzcuODcxMTc1LCAtMTIyLjMwNDc1NV0sIFszNy44NTYxODEsIC0xMjIuMjU5NzNdLCBbMzcuODY4MjgxLCAtMTIyLjMwMDEwMl0sIFszNy44Njk4MzksIC0xMjIuMjUyMzY1XSwgWzM3Ljg3NDgzMywgLTEyMi4zMDIyMTU5OTk5OTk5OV0sIFszNy44NTkxOTUsIC0xMjIuMjYxOTE0OTk5OTk5OTldLCBbMzcuODc0OTMsIC0xMjIuMzAxMTQ3XSwgWzM3Ljg2NDMzNSwgLTEyMi4yODY0MjldLCBbMzcuODY5MzMyLCAtMTIyLjI1MDE4OTk5OTk5OTk5XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44ODM4MiwgLTEyMi4yOTY5NTJdLCBbMzcuODYzMzUzMDAwMDAwMDA0LCAtMTIyLjI2NTA1MzAwMDAwMDAxXSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NzY5NjUwMDAwMDAwMDYsIC0xMjIuMjYwNTQ0XSwgWzM3Ljg3ODk2MywgLTEyMi4yOTM0NDZdLCBbMzcuODcxNTQ0LCAtMTIyLjI3MjcxNF0sIFszNy44NzM5MjEsIC0xMjIuMjc1NTc3XSwgWzM3Ljg2NDgyNiwgLTEyMi4yNjA3MTldLCBbMzcuODkzMjQ0LCAtMTIyLjI4MzU4OF0sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODg1NzUyMDAwMDAwMDA0LCAtMTIyLjI3ODA1XSwgWzM3Ljg2ODM2NTk5OTk5OTk5NSwgLTEyMi4yOTU1MDgwMDAwMDAwMV0sIFszNy44NjU3Mjg5OTk5OTk5OTUsIC0xMjIuMjYwOTAzXSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NTUwMjYsIC0xMjIuMjY2NDc1XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44ODE3NTcsIC0xMjIuMjUxMTYyOTk5OTk5OTldLCBbMzcuODc1MzA4MDAwMDAwMDA0LCAtMTIyLjMwNTkyXSwgWzM3Ljg1ODM5MTk5OTk5OTk5NSwgLTEyMi4yNzU0MjFdLCBbMzcuODUzMzE2LCAtMTIyLjI3ODczNzk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODYxNjc3LCAtMTIyLjI2NzE2XSwgWzM3Ljg3MzkyMSwgLTEyMi4yNzU1NzddLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3MjU0NSwgLTEyMi4yOTgwNDI5OTk5OTk5OV0sIFszNy44ODk5OTg5OTk5OTk5OTYsIC0xMjIuMjcyNDU2XSwgWzM3Ljg3OTUyMTk5OTk5OTk5NCwgLTEyMi4yODA4ODJdLCBbMzcuODU4NDM5MDAwMDAwMDA0LCAtMTIyLjI2NzU2OTk5OTk5OTk5XSwgWzM3Ljg2NzIwOSwgLTEyMi4yNTY1NTQwMDAwMDAwMV0sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODIxNTMzLCAtMTIyLjI3Njc0MDk5OTk5OTk5XSwgWzM3Ljg2OTgzOSwgLTEyMi4yNTIzNjVdLCBbMzcuODYzMzcyOTk5OTk5OTk2LCAtMTIyLjI5Njg5M10sIFszNy44NjMyNzE5OTk5OTk5OTUsIC0xMjIuMjU4NjU2XSwgWzM3Ljg1NTc5MiwgLTEyMi4yNDcxNDJdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NjE2NDUsIC0xMjIuMjUzNTA4MDAwMDAwMDFdLCBbMzcuODc2MTc0LCAtMTIyLjI4NzA1NF0sIFszNy44NzU3MDcsIC0xMjIuMjc1ODE1OTk5OTk5OTldLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy44NjMzNzI5OTk5OTk5OTYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg2MjE4OSwgLTEyMi4yNTk5MV0sIFszNy44OTMxNDgsIC0xMjIuMjc0ODA5XSwgWzM3Ljg2ODg0NSwgLTEyMi4yOTIxMzk5OTk5OTk5OV0sIFszNy44NDg3NTIwMDAwMDAwMDUsIC0xMjIuMjcxMzMxXSwgWzM3Ljg2NTUzNDk5OTk5OTk5NCwgLTEyMi4yNTUyMzUwMDAwMDAwMV0sIFszNy44Nzg0MjMsIC0xMjIuMjY5MDIzXSwgWzM3Ljg2NjQyNjAwMDAwMDAwNCwgLTEyMi4yNjk3NjIwMDAwMDAwMV0sIFszNy44NjIyNjQsIC0xMjIuMjUwOTcxOTk5OTk5OTldLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODYzNTk3OTk5OTk5OTk2LCAtMTIyLjI1MzY5M10sIFszNy44ODc2NiwgLTEyMi4yNjIxNTQwMDAwMDAwMV0sIFszNy44NzE2MDcsIC0xMjIuMjg0MzM2MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44ODA1NjQsIC0xMjIuMzA0ODk2XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODYyODQ0LCAtMTIyLjI5ODM2OF0sIFszNy44NjY5ODEsIC0xMjIuMzAyMDgzMDAwMDAwMDFdLCBbMzcuODU1ODI0LCAtMTIyLjI1NTAyXSwgWzM3Ljg1ODM5MTk5OTk5OTk5NSwgLTEyMi4yNzU0MjFdLCBbMzcuODY5OTIxMDAwMDAwMDA1LCAtMTIyLjI5NDgyNV0sIFszNy44OTE1MTUwMDAwMDAwMDUsIC0xMjIuMjcwMDM4OTk5OTk5OThdLCBbMzcuODY1MTU2LCAtMTIyLjI5Njc1Nl0sIFszNy44NTk5ODgsIC0xMjIuMjUzMzM4OTk5OTk5OThdLCBbMzcuODY2MjY1MDAwMDAwMDA2LCAtMTIyLjI3ODE2MjAwMDAwMDAxXSwgWzM3Ljg2NzkwNiwgLTEyMi4yNzk0MjhdLCBbMzcuODYzODM5LCAtMTIyLjI4MTM5MDk5OTk5OTk5XSwgWzM3Ljg3OTgxNjk5OTk5OTk5NiwgLTEyMi4zMDM4MjRdLCBbMzcuODY5MzEyLCAtMTIyLjI1NDMxNF0sIFszNy44OTcyNDI5OTk5OTk5OTYsIC0xMjIuMjcyNjI4XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NzI1NDE5OTk5OTk5OTYsIC0xMjIuMjcxOTc4XSwgWzM3Ljg1NDg4LCAtMTIyLjI2OTA3OV0sIFszNy44Njk2ODUsIC0xMjIuMjcyODA0MDAwMDAwMDFdLCBbMzcuODY4ODQ1LCAtMTIyLjI5MjEzOTk5OTk5OTk5XSwgWzM3Ljg4NzIyMTAwMDAwMDAwNCwgLTEyMi4yNzU4MzYwMDAwMDAwMV0sIFszNy44NTU2NTEsIC0xMjIuMjU1MDA2MDAwMDAwMDFdLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg3NDc5MywgLTEyMi4yNjg2MzldLCBbMzcuODc0NDg5MDAwMDAwMDA0LCAtMTIyLjI3MTA3Ml0sIFszNy44NTEyNTUsIC0xMjIuMjkyNTA5MDAwMDAwMDFdLCBbMzcuODYyMTg0LCAtMTIyLjI5MzUxN10sIFszNy44NzgwMDIsIC0xMjIuMjU3MDE2OTk5OTk5OTldLCBbMzcuODY1ODI2LCAtMTIyLjI2NzI0Mzk5OTk5OTk5XSwgWzM3Ljg1NDg5MDAwMDAwMDAwNSwgLTEyMi4yNTI1NjM5OTk5OTk5OV0sIFszNy44Njg0NDY5OTk5OTk5OTYsIC0xMjIuMjYxMjY3OTk5OTk5OTldLCBbMzcuODc4OTE1LCAtMTIyLjMwMzUyMDk5OTk5OTk5XSwgWzM3Ljg1ODY0NiwgLTEyMi4yOTIzOTE5OTk5OTk5OV0sIFszNy44NTcwNDA5OTk5OTk5OTUsIC0xMjIuMjUzMDUzMDAwMDAwMDFdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg1NDYyODk5OTk5OTk5NiwgLTEyMi4yNjkxNjAwMDAwMDAwMV0sIFszNy44ODIwNjcsIC0xMjIuMjk2MzkyXSwgWzM3Ljg3MzkwOTAwMDAwMDAwNSwgLTEyMi4yNjgyMzMwMDAwMDAwMV0sIFszNy44Njc1MzMsIC0xMjIuMjkxNzE5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODU2NzU1LCAtMTIyLjI1NTI0OF0sIFszNy44NjU3NzIsIC0xMjIuMjY3NjQyOTk5OTk5OTldLCBbMzcuODY2OTE5LCAtMTIyLjI1ODgxMl0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg2MzU5Nzk5OTk5OTk5NiwgLTEyMi4yNTM2OTNdLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg3ODcyMTk5OTk5OTk5NiwgLTEyMi4yOTUzMTIwMDAwMDAwMV0sIFszNy44NTQ4MDUsIC0xMjIuMjc0MzAzXSwgWzM3Ljg2NDcwMzAwMDAwMDAwNiwgLTEyMi4yOTk2NTRdLCBbMzcuODc5MiwgLTEyMi4yNjMwNDRdLCBbMzcuODY4NzA2LCAtMTIyLjI2NjI3OV0sIFszNy44NjY0NzE5OTk5OTk5OTUsIC0xMjIuMjk4NDAzMDAwMDAwMDFdLCBbMzcuODcyNjU2LCAtMTIyLjI5Mjc0OF0sIFszNy44NjY5MTksIC0xMjIuMjU4ODEyXSwgWzM3Ljg0ODc1MjAwMDAwMDAwNSwgLTEyMi4yNzEzMzFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg1MjQyMiwgLTEyMi4yNzg1NzFdLCBbMzcuODQ4ODEyLCAtMTIyLjI3ODA0M10sIFszNy44NzgyNzQsIC0xMjIuMjk3NTU2XSwgWzM3Ljg2MDczMiwgLTEyMi4yOTEzNjg5OTk5OTk5OV0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44Njk3NDEsIC0xMjIuMjc5NDc5MDAwMDAwMDFdLCBbMzcuODY3NTY2LCAtMTIyLjI2NTk0OF0sIFszNy44Njk5OTMsIC0xMjIuMjk0Nzc0XSwgWzM3Ljg5MDQwOCwgLTEyMi4yNTIzNjc5OTk5OTk5OV0sIFszNy44NzA2NTIsIC0xMjIuMjc5NTgwMDAwMDAwMDFdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODcxMTg0LCAtMTIyLjI4MTk2Mzk5OTk5OTk5XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg0ODUzNCwgLTEyMi4yNzI5OTldLCBbMzcuODY5MDQwOTk5OTk5OTk2LCAtMTIyLjI5MjIwNF0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44ODE1OTIsIC0xMjIuMjk5NzU1XSwgWzM3Ljg3MzQ1NSwgLTEyMi4yOTM0NjVdLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg3ODY0NCwgLTEyMi4zMDM0MzJdLCBbMzcuODU2MDcyOTk5OTk5OTk1LCAtMTIyLjI5MjczNTAwMDAwMDAxXSwgWzM3Ljg2MTY3MiwgLTEyMi4yNTU5OTE5OTk5OTk5OV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg5NzE0NywgLTEyMi4yNjMyNzVdLCBbMzcuODcwMzk2LCAtMTIyLjI4MTU4NV0sIFszNy44NjgyNzI5OTk5OTk5OTUsIC0xMjIuMjk1OTYyOTk5OTk5OTldLCBbMzcuODU2MTk1LCAtMTIyLjI4ODA1M10sIFszNy44OTA3MTYsIC0xMjIuMjY4Mjk5XSwgWzM3Ljg1NDg1NywgLTEyMi4yNjIzMTM5OTk5OTk5OV0sIFszNy44Njk2ODUsIC0xMjIuMjcyODA0MDAwMDAwMDFdLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODY2NzI0LCAtMTIyLjI4ODgwNF0sIFszNy44NjMzNzI5OTk5OTk5OTYsIC0xMjIuMjk2ODkzXSwgWzM3Ljg2MDMxNjk5OTk5OTk5NSwgLTEyMi4yODg4MDRdLCBbMzcuODcwMzYsIC0xMjIuMjgxODYzOTk5OTk5OThdLCBbMzcuODY4OTU3LCAtMTIyLjI1NDU1Ml0sIFszNy44NjgxNDIsIC0xMjIuMjk2NTg4OTk5OTk5OThdLCBbMzcuODc2MzMzLCAtMTIyLjI3ODExNzk5OTk5OTk5XSwgWzM3Ljg3MzA0LCAtMTIyLjI4OTY1OTAwMDAwMDAxXSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44ODI0NTkwMDAwMDAwMDQsIC0xMjIuMjYxODE0OTk5OTk5OThdLCBbMzcuODczMTk0LCAtMTIyLjMwNDA3XSwgWzM3Ljg2ODM2NTk5OTk5OTk5NSwgLTEyMi4yOTU1MDgwMDAwMDAwMV0sIFszNy44NzQ5Mjg5OTk5OTk5OTUsIC0xMjIuMjY3NjAxXSwgWzM3Ljg4ODc4NCwgLTEyMi4yNjY2OTldLCBbMzcuODgzNjIsIC0xMjIuMjY5NzM0MDAwMDAwMDFdLCBbMzcuODc5OTk2MDAwMDAwMDA2LCAtMTIyLjI5Njg5M10sIFszNy44NjI2NDksIC0xMjIuMjQzOTk2XSwgWzM3Ljg2OTgzOSwgLTEyMi4yNTIzNjVdLCBbMzcuODU2NzE5LCAtMTIyLjI2NjY3Ml0sIFszNy44NTI0MjIsIC0xMjIuMjc4NTcxXSwgWzM3Ljg2NjQwMzk5OTk5OTk5NiwgLTEyMi4yNzcwNDI5OTk5OTk5OV0sIFszNy44Njc4MTYsIC0xMjIuMjU4OTk0XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY4MTAzMDAwMDAwMDA1LCAtMTIyLjI1NjcyXSwgWzM3Ljg3MDA1Mzk5OTk5OTk5NiwgLTEyMi4yODQyNjNdLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg1ODA3OSwgLTEyMi4yNjgwMTU5OTk5OTk5OV0sIFszNy44NjA4NTgsIC0xMjIuMjkwNzMzXSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODc3NTQ4LCAtMTIyLjI2MjcxMDAwMDAwMDAxXSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODY1NDIsIC0xMjIuMjU2MThdLCBbMzcuODg5MzI1LCAtMTIyLjI3ODQ2Mjk5OTk5OTk5XSwgWzM3Ljg2MzA3NzAwMDAwMDAwNCwgLTEyMi4yNjcxOTFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2NjUzNCwgLTEyMi4yNzU4OTddLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODcyNjkwOTk5OTk5OTk2LCAtMTIyLjI3MDc0MDk5OTk5OTk5XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY2OTE5LCAtMTIyLjI1ODgxMl0sIFszNy44ODE5LCAtMTIyLjI5ODE5N10sIFszNy44NTg4NjcsIC0xMjIuMjc4OTkxOTk5OTk5OTldLCBbMzcuODY2MDM3LCAtMTIyLjI2NTYxNzk5OTk5OTk5XSwgWzM3Ljg2MjU0MiwgLTEyMi4yOTAxMDRdLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg2NTE3MTk5OTk5OTk5NCwgLTEyMi4zMTExNTVdLCBbMzcuODYzOTYzLCAtMTIyLjI2MDU0NTk5OTk5OTk5XSwgWzM3Ljg0NzY4MiwgLTEyMi4yNzkzODFdLCBbMzcuODgyMzUzLCAtMTIyLjI2NzEzNjAwMDAwMDAxXSwgWzM3Ljg2ODMsIC0xMjIuMjYyNDI2XSwgWzM3Ljg2NzY0NSwgLTEyMi4yOTk5MDhdLCBbMzcuODgxMTQyLCAtMTIyLjMwMTkxXSwgWzM3Ljg3MTk2OSwgLTEyMi4yOTg5NzhdLCBbMzcuODYyOTI3LCAtMTIyLjI1ODc4NF0sIFszNy44ODIyMTcsIC0xMjIuMzAyMjI2XSwgWzM3Ljg2Mzk3NywgLTEyMi4yNjczMDddLCBbMzcuODY5Njg1LCAtMTIyLjI3MjgwNDAwMDAwMDAxXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44ODg3ODQsIC0xMjIuMjY2Njk5XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NjQyMzgsIC0xMjIuMjY1MjYyOTk5OTk5OTldLCBbMzcuODY2MzI3MDAwMDAwMDA1LCAtMTIyLjI2MzM1OTAwMDAwMDAxXSwgWzM3Ljg2NDgzNiwgLTEyMi4yOTkwMjRdLCBbMzcuODY5ODkyLCAtMTIyLjI1MDQyMl0sIFszNy44NTUxOTksIC0xMjIuMjU5NzY4XSwgWzM3Ljg5MzQ0OCwgLTEyMi4yNzIxMzcwMDAwMDAwMV0sIFszNy44NTM3MjI5OTk5OTk5OTUsIC0xMjIuMjU5OTc1XSwgWzM3Ljg2NjYyMiwgLTEyMi4yNjEwOF0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg2Mjc2MywgLTEyMi4yNjI2MzldLCBbMzcuODY3OTcxOTk5OTk5OTk1LCAtMTIyLjI2MzY5OV0sIFszNy44NjMyNzE5OTk5OTk5OTUsIC0xMjIuMjU4NjU2XSwgWzM3Ljg4MTEzOCwgLTEyMi4yODg3NV0sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODYxNTExLCAtMTIyLjI5NjgxMDAwMDAwMDAxXSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NTUyNSwgLTEyMi4yNzcxMjZdLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg2OTk3MywgLTEyMi4yNzA1NTcwMDAwMDAwMV0sIFszNy44NzQ5MywgLTEyMi4yOTg2MDRdLCBbMzcuODY4MTk5LCAtMTIyLjI2MzI1M10sIFszNy44NTg0ODMsIC0xMjIuMjUzMTkwOTk5OTk5OTldLCBbMzcuODU4ODE0LCAtMTIyLjI5MDA3Ml0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg3MjEwNiwgLTEyMi4yNjg0MDVdLCBbMzcuODUxNTAzLCAtMTIyLjI3ODUxNzk5OTk5OTk5XSwgWzM3Ljg2OTM5LCAtMTIyLjI2Nzg4MzAwMDAwMDAxXSwgWzM3Ljg2OTE2NywgLTEyMi4yODQxMzc5OTk5OTk5OF0sIFszNy44NjI0OTEsIC0xMjIuMjY0Nl0sIFszNy44NzQyNTEsIC0xMjIuMjgwMjAzXSwgWzM3Ljg1MzMxNiwgLTEyMi4yNzg3Mzc5OTk5OTk5OV0sIFszNy44NTIyMTEsIC0xMjIuMjg2MzM2XSwgWzM3Ljg3Njk2NTAwMDAwMDAwNiwgLTEyMi4yNjA1NDRdLCBbMzcuODgwODg5LCAtMTIyLjI5MzE3NV0sIFszNy44NTI3NjQsIC0xMjIuMjYxNjVdLCBbMzcuODgxOTU3LCAtMTIyLjI2OTU1MV0sIFszNy44NTE2OTg5OTk5OTk5OTYsIC0xMjIuMjc2NTQ2XSwgWzM3Ljg2NTEyMSwgLTEyMi4yNTg0NTVdLCBbMzcuODU2ODQ2OTk5OTk5OTk1LCAtMTIyLjI2NTc2NDk5OTk5OTk5XSwgWzM3Ljg4Mjk0MywgLTEyMi4yNzkzODMwMDAwMDAwMV0sIFszNy44NjgzMDgsIC0xMjIuMjk1Nzk0XSwgWzM3Ljg1NTE5OSwgLTEyMi4yNTk3NjhdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NTk0MTU5OTk5OTk5OTYsIC0xMjIuMjgxODQ0OTk5OTk5OTldLCBbMzcuODY3MzM2LCAtMTIyLjI2OTg3Nl0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODUxMDE3LCAtMTIyLjI5MTA4Nzk5OTk5OTk5XSwgWzM3Ljg3Mjk5MTk5OTk5OTk5NiwgLTEyMi4yOTU4MDFdLCBbMzcuODc2OTY1MDAwMDAwMDA2LCAtMTIyLjI2MDU0NF0sIFszNy44Njc4MzEsIC0xMjIuMjY1ODU4MDAwMDAwMDFdLCBbMzcuODQ4NDUzMDAwMDAwMDA2LCAtMTIyLjI3MzYwNzAwMDAwMDAxXSwgWzM3Ljg2MTk0NCwgLTEyMi4yOTQ2MDcwMDAwMDAwMV0sIFszNy44NzE0MDIsIC0xMjIuMjkyOTY1XSwgWzM3Ljg1MTY1MzAwMDAwMDAwNiwgLTEyMi4yODkxOTRdLCBbMzcuODgzNTI4OTk5OTk5OTk2LCAtMTIyLjI1OTg4NDAwMDAwMDAxXSwgWzM3Ljg1MDU0MSwgLTEyMi4yODYwMzcwMDAwMDAwMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NjIxODQsIC0xMjIuMjkzNTE3XSwgWzM3Ljg1MDY4MSwgLTEyMi4yNzA2MTldLCBbMzcuODcxODE4LCAtMTIyLjI3MDU5NV0sIFszNy44NDg3NTIwMDAwMDAwMDUsIC0xMjIuMjcxMzMxXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NzE2NjYsIC0xMjIuMzAyMzE0XSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NjgxNDAwMDAwMDAwMDQsIC0xMjIuMjYzNzM2MDAwMDAwMDFdLCBbMzcuODgwNzg2LCAtMTIyLjMwMzA2N10sIFszNy44NjE2MDQsIC0xMjIuMjY0MzY2XSwgWzM3Ljg1ODUyNSwgLTEyMi4yNjY5MDZdLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg2NTUwMSwgLTEyMi4yNjk3NzRdLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjIxODQsIC0xMjIuMjkzNTE3XSwgWzM3Ljg3Nzk1MSwgLTEyMi4yNzEzOTVdLCBbMzcuODg1MjY3LCAtMTIyLjI1OTUzNTAwMDAwMDAxXSwgWzM3Ljg2Njk4MSwgLTEyMi4zMDIwODMwMDAwMDAwMV0sIFszNy44NjIzMjAwMDAwMDAwMDQsIC0xMjIuMjQ3MDQ2XSwgWzM3Ljg2NTk5MDk5OTk5OTk5NCwgLTEyMi4yNDk1ODJdLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODYwNjU5OTk5OTk5OTk2LCAtMTIyLjI1MzQwNzAwMDAwMDAxXSwgWzM3Ljg2OTgzOSwgLTEyMi4yNTIzNjVdLCBbMzcuODg1MDUxMDAwMDAwMDA0LCAtMTIyLjI3NDI4Nzk5OTk5OTk4XSwgWzM3Ljg1OTIyLCAtMTIyLjI4OTAzNTAwMDAwMDAxXSwgWzM3Ljg2MzgxMSwgLTEyMi4yNjc0MTIwMDAwMDAwMV0sIFszNy44NjgxNjEsIC0xMjIuMjkxNzUxXSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NjM2MTEsIC0xMjIuMzE3NTY1OTk5OTk5OTldLCBbMzcuODc5NTcxLCAtMTIyLjMwMDI5Nl0sIFszNy44ODE4MTQsIC0xMjIuMjk4NjQzXSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44Nzc5NTEsIC0xMjIuMjcxMzk1XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg1OTkwNiwgLTEyMi4yODQ5MzFdLCBbMzcuODQ4NzUyMDAwMDAwMDA1LCAtMTIyLjI3MTMzMV0sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NTk1NTcsIC0xMjIuMjk3MzNdLCBbMzcuODY5Njg1LCAtMTIyLjI3MjgwNDAwMDAwMDAxXSwgWzM3Ljg2MzYxMSwgLTEyMi4zMTc1NjU5OTk5OTk5OV0sIFszNy44NTY3OTIsIC0xMjIuMjc5ODQ1XSwgWzM3Ljg3MzIwNywgLTEyMi4yOTQ3MTFdLCBbMzcuODYyOTI3LCAtMTIyLjI1ODc4NF0sIFszNy44Njc3MjMsIC0xMjIuMjk4NDA2XSwgWzM3Ljg1NTI5Mjk5OTk5OTk5NiwgLTEyMi4yNjY1MDJdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NjM5NjMsIC0xMjIuMjYwNTQ1OTk5OTk5OTldLCBbMzcuODY1MTQ5LCAtMTIyLjI1NjQ4N10sIFszNy44NTUyNSwgLTEyMi4yNzcxMjZdLCBbMzcuODU2MTExLCAtMTIyLjI2MDI0OF0sIFszNy44ODk0MjQsIC0xMjIuMjg2MTEzOTk5OTk5OThdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3NjI5Njk5OTk5OTk5NCwgLTEyMi4yNzEyMzk5OTk5OTk5OV0sIFszNy44Njg0NDY5OTk5OTk5OTYsIC0xMjIuMjYxMjY3OTk5OTk5OTldLCBbMzcuODU5NTI4MDAwMDAwMDA1LCAtMTIyLjI1OTI2MDAwMDAwMDAxXSwgWzM3Ljg2MjI2NCwgLTEyMi4yNTA5NzE5OTk5OTk5OV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NTY1OTUsIC0xMjIuMjc1MDYzOTk5OTk5OTldLCBbMzcuODU3NjM3LCAtMTIyLjI2NjgwM10sIFszNy44NjM4OTMsIC0xMjIuMjUxNDIxOTk5OTk5OTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44OTU4NDksIC0xMjIuMjYzNDI4XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44NzUwODQsIC0xMjIuMjYwMTM5OTk5OTk5OTldLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg2NTE0OSwgLTEyMi4yNTY0ODddLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44NzYzMDcwMDAwMDAwMDQsIC0xMjIuMjY4OTIzXSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODYzMzEsIC0xMjIuMzE2MTEyOTk5OTk5OTldLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44Njc1NjYsIC0xMjIuMjY1OTQ4XSwgWzM3Ljg3MTE3MTAwMDAwMDAwNCwgLTEyMi4yNjc3MTc5OTk5OTk5OV0sIFszNy44NjcxNzYsIC0xMjIuMjY3ODAyXSwgWzM3Ljg1OTU4OSwgLTEyMi4yNTcwMTldLCBbMzcuODY3MjU5MDAwMDAwMDA0LCAtMTIyLjI2MzI0XSwgWzM3Ljg2NTEyMSwgLTEyMi4yNTg0NTVdLCBbMzcuODczMTk0LCAtMTIyLjI4MTNdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg3ODcyMTk5OTk5OTk5NiwgLTEyMi4yOTUzMTIwMDAwMDAwMV0sIFszNy44Nzc5ODMsIC0xMjIuMjcyNTU4XSwgWzM3Ljg3Njk2NTAwMDAwMDAwNiwgLTEyMi4yNjA1NDRdLCBbMzcuODkyODc1LCAtMTIyLjI2ODc0OF0sIFszNy44NjY3NjksIC0xMjIuMjc0MjI5XSwgWzM3Ljg3ODQsIC0xMjIuMjk2MzgzXSwgWzM3Ljg1NjE5NSwgLTEyMi4yODgwNTNdLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg3OTY1MzAwMDAwMDAwNSwgLTEyMi4yOTkxMzldLCBbMzcuODY2NTY4LCAtMTIyLjI1NDA4NF0sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODcwMzQ2MDAwMDAwMDA1LCAtMTIyLjI2Nzc5NTk5OTk5OTk5XSwgWzM3Ljg2MjYyNCwgLTEyMi4zMDA1OTVdLCBbMzcuODc3MjQ3LCAtMTIyLjI3NzA4XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODU1Mjk0LCAtMTIyLjI5MjQ3NV0sIFszNy44NjUwMDksIC0xMjIuMjU4NzY2OTk5OTk5OTldLCBbMzcuODY1MTM0MDAwMDAwMDA1LCAtMTIyLjI1ODMzMTAwMDAwMDAxXSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODY4MTY0LCAtMTIyLjI1NjMxMzk5OTk5OTk5XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODUxOTIxMDAwMDAwMDA0LCAtMTIyLjI2OTgxMjk5OTk5OTk4XSwgWzM3Ljg0OTc0NywgLTEyMi4yNzc5MDcwMDAwMDAwMV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2MjkyNywgLTEyMi4yNTg3ODRdLCBbMzcuODcwODk0LCAtMTIyLjI3ODU2Nl0sIFszNy44NTcwNTQsIC0xMjIuMjcxMzkyOTk5OTk5OTldLCBbMzcuODgzMjI0LCAtMTIyLjI1NjQ2NF0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg3OTcwOCwgLTEyMi4yOTc5OTVdLCBbMzcuODc2MDg0MDAwMDAwMDA2LCAtMTIyLjI4MDEwNV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3NjMwNzAwMDAwMDAwNCwgLTEyMi4yNjg5MjNdLCBbMzcuODU3NjM3LCAtMTIyLjI2NjgwM10sIFszNy44OTY0MzIsIC0xMjIuMjc4NDNdLCBbMzcuODYzODI0LCAtMTIyLjI4MjI4MjAwMDAwMDAxXSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NzE5LCAtMTIyLjI2ODM4ODk5OTk5OTk4XSwgWzM3Ljg2MzM1MzAwMDAwMDAwNCwgLTEyMi4yNzIwOTddLCBbMzcuODcwOTcxOTk5OTk5OTk1LCAtMTIyLjI4ODE4NTAwMDAwMDAxXSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODY4NzE0MDAwMDAwMDA0LCAtMTIyLjI1OTE4ODk5OTk5OTk5XSwgWzM3Ljg2Njk1LCAtMTIyLjI4Njk4NF0sIFszNy44Njg0MTcsIC0xMjIuMzAyNTM5XSwgWzM3Ljg3MTgxOCwgLTEyMi4yNzA1OTVdLCBbMzcuODczODY1LCAtMTIyLjMwMDc3N10sIFszNy44NzAzOTYsIC0xMjIuMjgxNTg1XSwgWzM3Ljg2MTU3MywgLTEyMi4yNTc0NTJdLCBbMzcuODY1MDA5LCAtMTIyLjI1ODc2Njk5OTk5OTk5XSwgWzM3Ljg2MDgxLCAtMTIyLjI1MzQyMl0sIFszNy44Njc2MDEsIC0xMjIuMjY3NzE3OTk5OTk5OTldLCBbMzcuODU5ODg5LCAtMTIyLjI3ODE2N10sIFszNy44NjE2NTMwMDAwMDAwMDQsIC0xMjIuMjc4NTI5XSwgWzM3Ljg3ODI0MDk5OTk5OTk5NiwgLTEyMi4yNTcwNTkwMDAwMDAwMV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODY3NzA4LCAtMTIyLjI1MDgwMV0sIFszNy44Njk4OTIsIC0xMjIuMjUwNDIyXSwgWzM3Ljg3NzUyODAwMDAwMDAwNSwgLTEyMi4yNzU5NTYwMDAwMDAwMV0sIFszNy44OTM0NDgsIC0xMjIuMjcyMTM3MDAwMDAwMDFdLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg3Njg4MSwgLTEyMi4yNjY2NjU5OTk5OTk5OV0sIFszNy44NjM0NDMsIC0xMjIuMjU2MzA0XSwgWzM3Ljg1MDg5OSwgLTEyMi4yNzYxNzRdLCBbMzcuODg0NjQ0LCAtMTIyLjI4MDA5Nl0sIFszNy44NTAwMDEsIC0xMjIuMjc1OTYyOTk5OTk5OTldLCBbMzcuODc0NDg5MDAwMDAwMDA0LCAtMTIyLjI3MTA3Ml0sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44Njk2NDIsIC0xMjIuMjg3NDkxOTk5OTk5OTldLCBbMzcuODY1NTAxLCAtMTIyLjI2OTc3NF0sIFszNy44NTQ5LCAtMTIyLjI3OTQ1XSwgWzM3Ljg4OTk5ODk5OTk5OTk5NiwgLTEyMi4yNzI0NTZdLCBbMzcuODY3NTY2LCAtMTIyLjI2NTk0OF0sIFszNy44ODE3NTcsIC0xMjIuMjUxMTYyOTk5OTk5OTldLCBbMzcuODY4NTkwOTk5OTk5OTk1LCAtMTIyLjI5NDM5M10sIFszNy44Njc2MDEsIC0xMjIuMjY3NzE3OTk5OTk5OTldLCBbMzcuODkzMTQ4LCAtMTIyLjI3NDgwOV0sIFszNy44Njk5NDQsIC0xMjIuMzAwNjM2MDAwMDAwMDFdLCBbMzcuODgxODk0LCAtMTIyLjI5ODY2Nzk5OTk5OTk5XSwgWzM3Ljg2ODcyMiwgLTEyMi4yNTkxMjNdLCBbMzcuODc2OTY1MDAwMDAwMDA2LCAtMTIyLjI2MDU0NF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2MjUxNiwgLTEyMi4yNzg1M10sIFszNy44NzUwNjMsIC0xMjIuMjY1NDc0XSwgWzM3Ljg2NTg3NSwgLTEyMi4yOTM1MjNdLCBbMzcuODU5NTg5LCAtMTIyLjI1NzAxOV0sIFszNy44NTE1MjEwMDAwMDAwMDUsIC0xMjIuMjg1NDldLCBbMzcuODU4OTkzLCAtMTIyLjI0NDU3NF0sIFszNy44NzIxNTgsIC0xMjIuMjgyMDY1OTk5OTk5OTldLCBbMzcuODUwNTQxLCAtMTIyLjI4NjAzNzAwMDAwMDAxXSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NzYyOTY5OTk5OTk5OTQsIC0xMjIuMjcxMjM5OTk5OTk5OTldLCBbMzcuODY4MjcyOTk5OTk5OTk1LCAtMTIyLjI5NTk2Mjk5OTk5OTk5XSwgWzM3Ljg1NTAyNiwgLTEyMi4yNjY0NzVdLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg2NzAyNiwgLTEyMi4yOTk3MzcwMDAwMDAwMV0sIFszNy45MDMyNTIsIC0xMjIuMjY3NDU2MDAwMDAwMDFdLCBbMzcuODY4MTAzMDAwMDAwMDA1LCAtMTIyLjI1NjcyXSwgWzM3Ljg2ODU5NSwgLTEyMi4yNzM4MzVdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Nzg2MjksIC0xMjIuMjYwODgzXSwgWzM3Ljg2Mjc2MywgLTEyMi4yNjI2MzldLCBbMzcuODY1NTM0OTk5OTk5OTk0LCAtMTIyLjI1NTIzNTAwMDAwMDAxXSwgWzM3Ljg1NTk1MywgLTEyMi4yMzY0NzVdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NTM4MTU5OTk5OTk5OTUsIC0xMjIuMjY2MzEyOTk5OTk5OThdLCBbMzcuODU5NDE1OTk5OTk5OTk2LCAtMTIyLjI4MTg0NDk5OTk5OTk5XSwgWzM3Ljg4NjIzNCwgLTEyMi4yODM2MjZdLCBbMzcuODY3NjM5MDAwMDAwMDA0LCAtMTIyLjI5ODc4Ml0sIFszNy44NTg0NTUsIC0xMjIuMjkzMzc0XSwgWzM3Ljg1Njg4NCwgLTEyMi4yNTQyNDldLCBbMzcuODgwODU5LCAtMTIyLjI4Nzc3NF0sIFszNy44ODA4LCAtMTIyLjI5NDAzNl0sIFszNy44NjU3OTcsIC0xMjIuMjUyNzQwOTk5OTk5OTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg3MTIyNSwgLTEyMi4yODQ0NDddLCBbMzcuODY1OTYzLCAtMTIyLjI3OTI4OF0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg1MzU3NjAwMDAwMDAwNCwgLTEyMi4yODcyMDIwMDAwMDAwMV0sIFszNy44NjkwNTcsIC0xMjIuMjcwNDYyOTk5OTk5OTldLCBbMzcuODY1NzQ3OTk5OTk5OTk2LCAtMTIyLjI1MzM5Nl0sIFszNy44NjM4OTMsIC0xMjIuMjUxNDIxOTk5OTk5OTldLCBbMzcuODYwOTMzLCAtMTIyLjI0ODc1ODAwMDAwMDAxXSwgWzM3Ljg2ODE5OSwgLTEyMi4yNjMyNTNdLCBbMzcuODY4NDI0LCAtMTIyLjI2MTQ1MV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODYyMjAyLCAtMTIyLjI4MTAyNl0sIFszNy44NjQ4NzIsIC0xMjIuMjc0NTg3MDAwMDAwMDFdLCBbMzcuODY2NDI2MDAwMDAwMDA0LCAtMTIyLjI2OTc2MjAwMDAwMDAxXSwgWzM3Ljg1MTUxNiwgLTEyMi4yOTEyMzg5OTk5OTk5OV0sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODczOTQwOTk5OTk5OTk1LCAtMTIyLjI4OTc2Mzk5OTk5OTk5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU3NDczOTk5OTk5OTk2LCAtMTIyLjI3NTQyNV0sIFszNy44NTkyMiwgLTEyMi4yODkwMzUwMDAwMDAwMV0sIFszNy44NDgyNywgLTEyMi4yNzE3ODc5OTk5OTk5OV0sIFszNy44Nzk3OTksIC0xMjIuMjk5MTg3MDAwMDAwMDJdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg2NTg0OSwgLTEyMi4yNTk5NzddLCBbMzcuODUzMzE2LCAtMTIyLjI3ODczNzk5OTk5OTk5XSwgWzM3Ljg1MDYyLCAtMTIyLjI3ODMxMjk5OTk5OTk4XSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44OTUwNzYsIC0xMjIuMjY0NzQzXSwgWzM3Ljg2ODk3NywgLTEyMi4yNzExMTY5OTk5OTk5OV0sIFszNy44NTk1NTcsIC0xMjIuMjk3MzNdLCBbMzcuODgyMTM1LCAtMTIyLjI2NzIzODk5OTk5OTk5XSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY4MjA0LCAtMTIyLjI3MDA1NF0sIFszNy44NjMzNTMwMDAwMDAwMDQsIC0xMjIuMjcyMDk3XSwgWzM3Ljg1Mjk1NiwgLTEyMi4yNjYxOTVdLCBbMzcuODc4OTQxLCAtMTIyLjI1NzI3N10sIFszNy44ODU4OCwgLTEyMi4yNTMzNTldLCBbMzcuODczNjM5MDAwMDAwMDA0LCAtMTIyLjI3MDYzOTk5OTk5OTk5XSwgWzM3Ljg2MjQ5LCAtMTIyLjI5MTIzOTk5OTk5OTk5XSwgWzM3Ljg5MjE1MiwgLTEyMi4yNjkyMTEwMDAwMDAwMV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg2ODM1MiwgLTEyMi4yNTQ0NTkwMDAwMDAwMV0sIFszNy44NTExMDcsIC0xMjIuMjgzMjM5OTk5OTk5OTldLCBbMzcuODU1MTA2LCAtMTIyLjI5MjQxOTk5OTk5OTk5XSwgWzM3Ljg3NzUyODAwMDAwMDAwNSwgLTEyMi4yNzU5NTYwMDAwMDAwMV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODUwODk5LCAtMTIyLjI3NjE3NF0sIFszNy44NjgyMDQsIC0xMjIuMjcwMDU0XSwgWzM3Ljg4MjUyNiwgLTEyMi4yODIxMzFdLCBbMzcuODgxNzc2LCAtMTIyLjI2MDQyMV0sIFszNy44NjkxNjcsIC0xMjIuMjg0MTM3OTk5OTk5OThdLCBbMzcuODY0MjM4LCAtMTIyLjI2NTI2Mjk5OTk5OTk5XSwgWzM3Ljg3NzQxNywgLTEyMi4zMDA3MTI5OTk5OTk5OV0sIFszNy44NzE3MTMsIC0xMjIuMjgyMTg1MDAwMDAwMDFdLCBbMzcuODYxNjUzMDAwMDAwMDA0LCAtMTIyLjI3ODUyOV0sIFszNy44Njc4NTIsIC0xMjIuMjU4Njk5XSwgWzM3Ljg3OTY4OSwgLTEyMi4yNzE2MTM5OTk5OTk5OV0sIFszNy44ODkwMTY5OTk5OTk5OTYsIC0xMjIuMjcyMzg4OTk5OTk5OTldLCBbMzcuODYyNDYyLCAtMTIyLjI5MjE0OV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg2NzUzMywgLTEyMi4yOTE3MTldLCBbMzcuODU2NzkyLCAtMTIyLjI3OTg0NV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg3MjQ3LCAtMTIyLjI3MzAyMV0sIFszNy44NzA2MzkwMDAwMDAwMDQsIC0xMjIuMjcyNDY3OTk5OTk5OTldLCBbMzcuODU5MzA5LCAtMTIyLjI1OTI5MDk5OTk5OTk5XSwgWzM3Ljg0NzY1NCwgLTEyMi4yNzI2NTFdLCBbMzcuODcwNjAzLCAtMTIyLjI3MDYxMjAwMDAwMDAxXSwgWzM3Ljg5NzE0NywgLTEyMi4yNjMyNzVdLCBbMzcuODgyMTM1LCAtMTIyLjI2NzIzODk5OTk5OTk5XSwgWzM3Ljg3ODk2MywgLTEyMi4yOTM0NDZdLCBbMzcuODU1OTUzLCAtMTIyLjIzNjQ3NV0sIFszNy44NjMzMSwgLTEyMi4zMTYxMTI5OTk5OTk5OV0sIFszNy44ODgwNjQsIC0xMjIuMjU2MzA0XSwgWzM3Ljg2OTA4NCwgLTEyMi4yOTkyNDVdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NzA2NTIsIC0xMjIuMjc5NTgwMDAwMDAwMDFdLCBbMzcuODYzNTk3OTk5OTk5OTk2LCAtMTIyLjI1MzY5M10sIFszNy44ODAyNjIsIC0xMjIuMjk1ODA5XSwgWzM3Ljg3MjQzNDk5OTk5OTk5NiwgLTEyMi4yNzk5ODc5OTk5OTk5OV0sIFszNy44OTgxMzQ5OTk5OTk5OTYsIC0xMjIuMjg2MjU2MDAwMDAwMDFdLCBbMzcuODYxMjgzLCAtMTIyLjI3MzkxMTAwMDAwMDAxXSwgWzM3Ljg1NzE3LCAtMTIyLjI1MjIwOTAwMDAwMDAxXSwgWzM3Ljg2OTU3ODAwMDAwMDAwNCwgLTEyMi4yODA4Mzg5OTk5OTk5OV0sIFszNy44ODI1MjYsIC0xMjIuMjgyMTMxXSwgWzM3Ljg3MzA4OSwgLTEyMi4zMDQ2MTZdLCBbMzcuODU1OTY4LCAtMTIyLjI4OTE4NjAwMDAwMDAyXSwgWzM3Ljg2MzM1MzAwMDAwMDAwNCwgLTEyMi4yNjUwNTMwMDAwMDAwMV0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg2NzUxMywgLTEyMi4yNjEyN10sIFszNy44NTU3NDgsIC0xMjIuMjkwMjgxMDAwMDAwMDFdLCBbMzcuODgwODkzLCAtMTIyLjI2MzY3M10sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Nzg5MTUsIC0xMjIuMzAzNTIwOTk5OTk5OTldLCBbMzcuODY5ODM5LCAtMTIyLjI1MjM2NV0sIFszNy44NzA2MDMsIC0xMjIuMjcwNjEyMDAwMDAwMDFdLCBbMzcuODczODg0OTk5OTk5OTk0LCAtMTIyLjI2NjMzMl0sIFszNy44Nzk2ODksIC0xMjIuMjcxNjEzOTk5OTk5OTldLCBbMzcuODY0NTM1LCAtMTIyLjI2Mjk5M10sIFszNy44ODMxMDMwMDAwMDAwMDYsIC0xMjIuMjYxNDU5XSwgWzM3Ljg5NTg0OSwgLTEyMi4yNjM0MjhdLCBbMzcuODkyMTA4LCAtMTIyLjI3OTk5NV0sIFszNy44Njg3MjIsIC0xMjIuMjU5MTIzXSwgWzM3Ljg1NTQzNSwgLTEyMi4yNTk4NDFdLCBbMzcuODcxNTQ0LCAtMTIyLjI3MjcxNF0sIFszNy44NjYwMzcsIC0xMjIuMjY1NjE3OTk5OTk5OTldLCBbMzcuODc1ODcsIC0xMjIuMjYxNzc3XSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44NjQzMzMsIC0xMjIuMjc4NzkyXSwgWzM3Ljg5ODAyNCwgLTEyMi4yNjk5MTY5OTk5OTk5OV0sIFszNy44NjQxMDEsIC0xMjIuMjU5NTYwMDAwMDAwMDFdLCBbMzcuODc4NzQ3LCAtMTIyLjI5NTE4OTk5OTk5OTk5XSwgWzM3Ljg3MDYyNywgLTEyMi4yNzk3NjVdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NTc3NTQsIC0xMjIuMjg5NzM3MDAwMDAwMDJdLCBbMzcuODY1NDQzLCAtMTIyLjI2MzE4ODk5OTk5OTk4XSwgWzM3Ljg3MDE1MjAwMDAwMDAwNCwgLTEyMi4zMDA3MDUwMDAwMDAwMV0sIFszNy44NzI0NjgsIC0xMjIuMjg2OTAyXSwgWzM3Ljg2NjA3NCwgLTEyMi4yNjMzMV0sIFszNy44NTU4MjQsIC0xMjIuMjU1MDJdLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NTEwMTcsIC0xMjIuMjkxMDg3OTk5OTk5OTldLCBbMzcuODYxODg0LCAtMTIyLjI4MzQ4MTAwMDAwMDAxXSwgWzM3Ljg3MDkwOTk5OTk5OTk5NSwgLTEyMi4yNjU5OTNdLCBbMzcuODY4NjQxLCAtMTIyLjI5NDE1XSwgWzM3Ljg3OTMzNSwgLTEyMi4zMDEzMzJdLCBbMzcuODY5MDY3LCAtMTIyLjI5MjA0Mjk5OTk5OTk5XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NjgxNjQsIC0xMjIuMjU2MzEzOTk5OTk5OTldLCBbMzcuODY2ODQyLCAtMTIyLjI3MzY2XSwgWzM3Ljg3MDg4MSwgLTEyMi4yODQzOTldLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY5NjkwOTk5OTk5OTk2LCAtMTIyLjI3ODQ4OTk5OTk5OTk5XSwgWzM3Ljg4MDAyNywgLTEyMi4yNzk5NzZdLCBbMzcuODYxOTkwOTk5OTk5OTk2LCAtMTIyLjI5NDM5NF0sIFszNy44NjU3MTEsIC0xMjIuMjUzODg5OTk5OTk5OThdLCBbMzcuODcyNjU2LCAtMTIyLjI5Mjc0OF0sIFszNy44NjI3ODEsIC0xMjIuMjY5Mzc2XSwgWzM3Ljg3MzkwOCwgLTEyMi4yOTAwMjVdLCBbMzcuODU1MjUsIC0xMjIuMjc3MTI2XSwgWzM3Ljg2ODc4NDk5OTk5OTk5NSwgLTEyMi4yNzI3MDFdLCBbMzcuODg4MjQxLCAtMTIyLjI1MDg3NV0sIFszNy44NzAzMDgsIC0xMjIuMjY4MDVdLCBbMzcuODY1MjAyMDAwMDAwMDA0LCAtMTIyLjI1Nzc5NV0sIFszNy44Njc3MDgsIC0xMjIuMjUwODAxXSwgWzM3Ljg3NjQ0LCAtMTIyLjI1NzAyM10sIFszNy44Nzg0ODksIC0xMjIuMjgwNTIzXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44OTA5NzQsIC0xMjIuMjY0NDQzXSwgWzM3Ljg1NTI1LCAtMTIyLjI3NzEyNl0sIFszNy44Njc4NzEsIC0xMjIuMjY1NjVdLCBbMzcuODU0NDQwMDAwMDAwMDA0LCAtMTIyLjI5NjYxODk5OTk5OTk5XSwgWzM3Ljg5NzAyMywgLTEyMi4yODQyNDFdLCBbMzcuODYzMjkyLCAtMTIyLjI1NjI5M10sIFszNy44NjU4NDksIC0xMjIuMjU5OTc3XSwgWzM3Ljg0OTY2MSwgLTEyMi4yOTIyNzNdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NjM1OTc5OTk5OTk5OTYsIC0xMjIuMjUzNjkzXSwgWzM3Ljg5NzY2MSwgLTEyMi4yNjA2NzkwMDAwMDAwMV0sIFszNy44NjgxOTgsIC0xMjIuMzAyNDY4OTk5OTk5OTldLCBbMzcuODYyODQ0LCAtMTIyLjI5ODM2OF0sIFszNy44NjU0OTEsIC0xMjIuMzEwMDY1XSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODY3NTEzLCAtMTIyLjI2MTI3XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODU5MTk1LCAtMTIyLjI2MTkxNDk5OTk5OTk5XSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODUyMjM2LCAtMTIyLjI3Mjg1Nl0sIFszNy44NTc4NTYsIC0xMjIuMjc5NzIxXSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODY5ODM5LCAtMTIyLjI1MjM2NV0sIFszNy44NTg3NTksIC0xMjIuMjY0MTEyMDAwMDAwMDFdLCBbMzcuODY2NTA4LCAtMTIyLjI2MTA1NzAwMDAwMDAxXSwgWzM3Ljg3MDk0OCwgLTEyMi4yNzczM10sIFszNy44NzIxMjUsIC0xMjIuMjg5NjM5OTk5OTk5OTldLCBbMzcuODUxMDg5LCAtMTIyLjI4MDk1XSwgWzM3Ljg1MzU3NjAwMDAwMDAwNCwgLTEyMi4yODcyMDIwMDAwMDAwMV0sIFszNy44NjkzODUsIC0xMjIuMjg5NTNdLCBbMzcuODUyOTQ2LCAtMTIyLjI5NDUxNDk5OTk5OTk5XSwgWzM3Ljg3ODkxNSwgLTEyMi4zMDM1MjA5OTk5OTk5OV0sIFszNy44NTgwNDcsIC0xMjIuMjQ1MzA2XSwgWzM3Ljg2MTUxMSwgLTEyMi4yOTY4MTAwMDAwMDAwMV0sIFszNy44NzYwNDUsIC0xMjIuMjYwMzM2MDAwMDAwMDFdLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3Ljg2ODE2NCwgLTEyMi4yNzAzNjI5OTk5OTk5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODU2NjM4MDAwMDAwMDA0LCAtMTIyLjI5MDU3OF0sIFszNy44NzQxNzcsIC0xMjIuMjk3MzY0OTk5OTk5OTldLCBbMzcuODcyMTc1LCAtMTIyLjI2NzgzNV0sIFszNy44NTMyODkwMDAwMDAwMDQsIC0xMjIuMjc4OTQxOTk5OTk5OTldLCBbMzcuODczMDQsIC0xMjIuMjg5NjU5MDAwMDAwMDFdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NTk5ODgsIC0xMjIuMjUzMzM4OTk5OTk5OThdLCBbMzcuODk1MDc2LCAtMTIyLjI2NDc0M10sIFszNy44NjI3NjMsIC0xMjIuMjYyNjM5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODUyOTU2LCAtMTIyLjI2NjE5NV0sIFszNy44NTk1OTAwMDAwMDAwMDQsIC0xMjIuMjg3MDEwMDAwMDAwMDFdLCBbMzcuODUwODk5LCAtMTIyLjI3NjE3NF0sIFszNy44NzEwMTMsIC0xMjIuMjk2MzY1OTk5OTk5OTldLCBbMzcuODgxMDA0LCAtMTIyLjI4MzIyNV0sIFszNy44NTM1NTIsIC0xMjIuMjY4Mjg2XSwgWzM3Ljg3MjE3NSwgLTEyMi4yNjc4MzVdLCBbMzcuODU4ODY3LCAtMTIyLjI3ODk5MTk5OTk5OTk5XSwgWzM3Ljg2NDIzOCwgLTEyMi4yNjUyNjI5OTk5OTk5OV0sIFszNy44ODE5LCAtMTIyLjI5ODE5N10sIFszNy44Njc1MzMsIC0xMjIuMjkxNzE5XSwgWzM3Ljg1MzczOCwgLTEyMi4yNTE2NjNdLCBbMzcuODcwMDUzOTk5OTk5OTk2LCAtMTIyLjI4NDI2M10sIFszNy44NTk5ODgsIC0xMjIuMjUzMzM4OTk5OTk5OThdLCBbMzcuODY4MTAzMDAwMDAwMDA1LCAtMTIyLjI1NjcyXSwgWzM3Ljg1NTEwNiwgLTEyMi4yOTI0MTk5OTk5OTk5OV0sIFszNy44ODE5LCAtMTIyLjI5ODE5N10sIFszNy44NzQ0ODkwMDAwMDAwMDQsIC0xMjIuMjcxMDcyXSwgWzM3Ljg1NDYyODk5OTk5OTk5NiwgLTEyMi4yNjkxNjAwMDAwMDAwMV0sIFszNy44NzI5ODkwMDAwMDAwMDQsIC0xMjIuMjY4NTMyMDAwMDAwMDFdLCBbMzcuODY1NzkzLCAtMTIyLjMwMTc3OTAwMDAwMDAxXSwgWzM3Ljg3MTgyOCwgLTEyMi4yNzA1MTU5OTk5OTk5OV0sIFszNy44Njk1OTQsIC0xMjIuMzAyOTJdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg3MDMwOCwgLTEyMi4yNjgwNV0sIFszNy44NjE2NzcsIC0xMjIuMjY3MTZdLCBbMzcuODY5ODQ5LCAtMTIyLjI4OTU2MV0sIFszNy44ODYzMywgLTEyMi4yNzUzNTkwMDAwMDAwMV0sIFszNy44ODA2MzU5OTk5OTk5OTYsIC0xMjIuMjY0NzU3XSwgWzM3Ljg5MDI3NCwgLTEyMi4yNjA3OTM5OTk5OTk5OV0sIFszNy44NjcyMTIsIC0xMjIuMjgxNzM4OTk5OTk5OTldLCBbMzcuODY4NDQ2OTk5OTk5OTk2LCAtMTIyLjI2MTI2Nzk5OTk5OTk5XSwgWzM3Ljg2Mjg0NCwgLTEyMi4yOTgzNjhdLCBbMzcuODY3MTc2LCAtMTIyLjI2NzgwMl0sIFszNy44NjI0NTYsIC0xMjIuMjY0ODUxMDAwMDAwMDFdLCBbMzcuODY3NTQ2MDAwMDAwMDA0LCAtMTIyLjI1MTk2N10sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg4MDIyNzAwMDAwMDAwNSwgLTEyMi4yNjkzNl0sIFszNy44NjAzODYsIC0xMjIuMjczNzI1XSwgWzM3Ljg2MzEzLCAtMTIyLjI5NjExMDAwMDAwMDAxXSwgWzM3Ljg1ODk5MywgLTEyMi4yNDQ1NzRdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjM1MjE5OTk5OTk5OTYsIC0xMjIuMjU0OTkxOTk5OTk5OTldLCBbMzcuODUxOTYyLCAtMTIyLjI3MDAyMl0sIFszNy44NjQwMzYsIC0xMjIuMjUwMjcyXSwgWzM3Ljg2NjcsIC0xMjIuMjY3NjE0XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg2MTA3ODAwMDAwMDAwNiwgLTEyMi4yODk2MzIwMDAwMDAwMV0sIFszNy44NjYwNzQsIC0xMjIuMjYzMzFdLCBbMzcuODczMDQsIC0xMjIuMjg5NjU5MDAwMDAwMDFdLCBbMzcuODU0MTM3LCAtMTIyLjI1MTAwN10sIFszNy44Njg3MjIsIC0xMjIuMjU5MTIzXSwgWzM3Ljg2ODcxNDAwMDAwMDAwNCwgLTEyMi4yNTkxODg5OTk5OTk5OV0sIFszNy44NzIxMDYsIC0xMjIuMjY4NDA1XSwgWzM3Ljg3MDM5NiwgLTEyMi4yODE1ODVdLCBbMzcuODgwNTY0LCAtMTIyLjMwNDg5Nl0sIFszNy44NjExMjksIC0xMjIuMjczODc5MDAwMDAwMDFdLCBbMzcuODYyNDA0OTk5OTk5OTk1LCAtMTIyLjI5MjQxOTk5OTk5OTk5XSwgWzM3Ljg3MTI0NiwgLTEyMi4yNzQ5OTA5OTk5OTk5OV0sIFszNy44NjEzMTMsIC0xMjIuMjk3ODk0XSwgWzM3Ljg3NjM4NiwgLTEyMi4yODUwMTddLCBbMzcuODY0NzE0LCAtMTIyLjI3NDU3MTk5OTk5OTk5XSwgWzM3Ljg1MTAxNywgLTEyMi4yOTEwODc5OTk5OTk5OV0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODUzMTkzLCAtMTIyLjI1ODMzOTk5OTk5OTk5XSwgWzM3Ljg2MTU5MSwgLTEyMi4yNTQ3MzYwMDAwMDAwMV0sIFszNy44Njg2NDEsIC0xMjIuMjk0MTVdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg3ODQwNywgLTEyMi4yNjc5NjIwMDAwMDAwMV0sIFszNy44NjcyNTkwMDAwMDAwMDQsIC0xMjIuMjYzMjRdLCBbMzcuODU1NzQ4LCAtMTIyLjI5MDI4MTAwMDAwMDAxXSwgWzM3Ljg3MTQwMiwgLTEyMi4yOTI5NjVdLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg3MDU4MywgLTEyMi4yNjU5NTZdLCBbMzcuODU3MTg2LCAtMTIyLjI4ODM2MDAwMDAwMDAxXSwgWzM3Ljg2MTU3MywgLTEyMi4yNTc0NTJdLCBbMzcuODU5NTM5LCAtMTIyLjI1OTE3MTk5OTk5OTk5XSwgWzM3Ljg2NzEyMTk5OTk5OTk5NSwgLTEyMi4yOTg2MzldLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODYyOTI3LCAtMTIyLjI1ODc4NF0sIFszNy44NTQ5MzMsIC0xMjIuMjg3NV0sIFszNy44NzA5MjQsIC0xMjIuMjc3NTE3OTk5OTk5OTldLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NjE2MDQsIC0xMjIuMjY0MzY2XSwgWzM3Ljg2OTIsIC0xMjIuMjY5MzA4MDAwMDAwMDFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44NjM4MzksIC0xMjIuMjgxMzkwOTk5OTk5OTldLCBbMzcuODc3NjM1OTk5OTk5OTk1LCAtMTIyLjI2NDMyM10sIFszNy44NTc5OTMsIC0xMjIuMjYzOTY0OTk5OTk5OThdLCBbMzcuODU4NTE4LCAtMTIyLjI4ODY2NV0sIFszNy44NTM1NTM5OTk5OTk5OTUsIC0xMjIuMjc2OTI1XSwgWzM3Ljg2OTY4NSwgLTEyMi4yNzI4MDQwMDAwMDAwMV0sIFszNy44NjU5NDUsIC0xMjIuMjUwNDcwOTk5OTk5OTldLCBbMzcuODY2OTgxLCAtMTIyLjMwMjA4MzAwMDAwMDAxXSwgWzM3Ljg3NzcxNSwgLTEyMi4zMDk2MThdLCBbMzcuODY3NDgyLCAtMTIyLjI1NDI1M10sIFszNy44NzU1MzEsIC0xMjIuMzA0ODU1XSwgWzM3Ljg3NzUwMiwgLTEyMi4yNjkwNjEwMDAwMDAwMV0sIFszNy44NzA5MDk5OTk5OTk5OTUsIC0xMjIuMjY1OTkzXSwgWzM3Ljg4MzYyLCAtMTIyLjI2OTczNDAwMDAwMDAxXSwgWzM3Ljg3NjE4NiwgLTEyMi4zMDE1OF0sIFszNy44NzMyNSwgLTEyMi4yOTM1NThdLCBbMzcuODY2MDM3LCAtMTIyLjI2NTYxNzk5OTk5OTk5XSwgWzM3Ljg2OTA5NiwgLTEyMi4yNzAxMzddLCBbMzcuODYyODQ0LCAtMTIyLjI5ODM2OF0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg1NjExMSwgLTEyMi4yNjAyNDhdLCBbMzcuODcwNjAzLCAtMTIyLjI3MDYxMjAwMDAwMDAxXSwgWzM3Ljg1OTk4OCwgLTEyMi4yNTMzMzg5OTk5OTk5OF0sIFszNy44Nzk2OTAwMDAwMDAwMDQsIC0xMjIuMjk5NzEyOTk5OTk5OThdLCBbMzcuODY2MzEwOTk5OTk5OTk2LCAtMTIyLjI1NjM2MTAwMDAwMDAxXSwgWzM3Ljg2ODk1NywgLTEyMi4yNTQ1NTJdLCBbMzcuODY5NjUyLCAtMTIyLjI2NTg4Ml0sIFszNy44NjI0MDQ5OTk5OTk5OTUsIC0xMjIuMjkyNDE5OTk5OTk5OTldLCBbMzcuODcwNjM5MDAwMDAwMDA0LCAtMTIyLjI3MjQ2Nzk5OTk5OTk5XSwgWzM3Ljg2ODIwNCwgLTEyMi4yNzAwNTRdLCBbMzcuODYxNjQ1LCAtMTIyLjI1MzUwODAwMDAwMDAxXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NzM2MzkwMDAwMDAwMDQsIC0xMjIuMjcwNjM5OTk5OTk5OTldLCBbMzcuODY4MTQyLCAtMTIyLjI5NjU4ODk5OTk5OTk4XSwgWzM3Ljg3ODQ2MSwgLTEyMi4zMDU3ODc5OTk5OTk5OV0sIFszNy44NTY5MDIwMDAwMDAwMDUsIC0xMjIuMjYxMjM2MDAwMDAwMDFdLCBbMzcuODY4OTc3LCAtMTIyLjI3MTExNjk5OTk5OTk5XSwgWzM3Ljg2MzgzOSwgLTEyMi4yODEzOTA5OTk5OTk5OV0sIFszNy44Nzg3NDcsIC0xMjIuMjk1MTg5OTk5OTk5OTldLCBbMzcuODU4NTI1LCAtMTIyLjI2NjkwNl0sIFszNy44OTUwOTcsIC0xMjIuMjY4NzgyXSwgWzM3Ljg0ODE1MiwgLTEyMi4yNzU4MDddLCBbMzcuODUwNDI0LCAtMTIyLjI5NjAzMV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg3NzEsIC0xMjIuMjk3MTcwOTk5OTk5OTldLCBbMzcuODk5MjExLCAtMTIyLjI2NDk3M10sIFszNy44NzEzMjMsIC0xMjIuMjY3MjIyXSwgWzM3Ljg4MDU2NCwgLTEyMi4zMDQ4OTZdLCBbMzcuODU1NDM1LCAtMTIyLjI1OTg0MV0sIFszNy44NjQ4MzYsIC0xMjIuMjk5MDI0XSwgWzM3Ljg2NzE3NiwgLTEyMi4yNjc4MDJdLCBbMzcuODYzNTk3OTk5OTk5OTk2LCAtMTIyLjI1MzY5M10sIFszNy44NzMxOTQsIC0xMjIuMzA0MDddLCBbMzcuODcwNTYyLCAtMTIyLjMxNDUwM10sIFszNy44NzQwMDIwMDAwMDAwMDQsIC0xMjIuMjY3NDg3OTk5OTk5OTldLCBbMzcuODYzMTg0OTk5OTk5OTk0LCAtMTIyLjI2OTc5MV0sIFszNy44NTkwMDYsIC0xMjIuMjc3ODc0XSwgWzM3Ljg3ODE3MywgLTEyMi4yNjQzNTkwMDAwMDAwMV0sIFszNy44NTgzOTE5OTk5OTk5OTUsIC0xMjIuMjc1NDIxXSwgWzM3Ljg4MTE0MiwgLTEyMi4zMDE5MV0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODY5MzMyLCAtMTIyLjI1MDE4OTk5OTk5OTk5XSwgWzM3Ljg2NTAwOSwgLTEyMi4yNTg3NjY5OTk5OTk5OV0sIFszNy44NjE2ODQ5OTk5OTk5OTQsIC0xMjIuMjgzMTkwOTk5OTk5OTldLCBbMzcuODY2NzYxLCAtMTIyLjI1ODc3OV0sIFszNy44NjE1NTMsIC0xMjIuMjk2NTk5XSwgWzM3Ljg4MzQwNywgLTEyMi4yNzMxNTRdLCBbMzcuODYxNTkxLCAtMTIyLjI1NDczNjAwMDAwMDAxXSwgWzM3Ljg1MzA4NSwgLTEyMi4yOTM4MzIwMDAwMDAwMV0sIFszNy44NTk1MjgwMDAwMDAwMDUsIC0xMjIuMjU5MjYwMDAwMDAwMDFdLCBbMzcuODgwNzg2LCAtMTIyLjMwMzA2N10sIFszNy44NjIzNzksIC0xMjIuMjUwMDU0XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODQ4ODEyLCAtMTIyLjI3ODA0M10sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODY5MzYzLCAtMTIyLjI2ODAyOF0sIFszNy44NTUwNTMwMDAwMDAwMDUsIC0xMjIuMjg2NTc3MDAwMDAwMDFdLCBbMzcuODgzMjI0LCAtMTIyLjI1NjQ2NF0sIFszNy44NTg0ODMsIC0xMjIuMjUzMTkwOTk5OTk5OTldLCBbMzcuODU1NzIxLCAtMTIyLjI1NTldLCBbMzcuODc3ODYsIC0xMjIuMjk4NTY1XSwgWzM3Ljg1NzQwOTAwMDAwMDAwNCwgLTEyMi4yNjg0NzNdLCBbMzcuODY3ODUyLCAtMTIyLjI1ODY5OV0sIFszNy44NzMwNCwgLTEyMi4yODk2NTkwMDAwMDAwMV0sIFszNy44NjY5MzUsIC0xMjIuMjY1NzcyXSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODY5ODM5LCAtMTIyLjI1MjM2NV0sIFszNy44NTc3NDMsIC0xMjIuMjg4NTQ1XSwgWzM3Ljg5NzAwNSwgLTEyMi4yNjE2ODEwMDAwMDAwMV0sIFszNy44NDgyNywgLTEyMi4yNzE3ODc5OTk5OTk5OV0sIFszNy44OTQ1MzU5OTk5OTk5OTUsIC0xMjIuMjcyMDU2XSwgWzM3Ljg3MTI2OCwgLTEyMi4zMDEwNl0sIFszNy44NzIwODQsIC0xMjIuMzAwMjE3OTk5OTk5OTldLCBbMzcuODU5MjIsIC0xMjIuMjg5MDM1MDAwMDAwMDFdLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NTU3OTgsIC0xMjIuMjUyNzA3XSwgWzM3Ljg2ODk1NywgLTEyMi4yNTQ1NTJdLCBbMzcuODY5MTU5LCAtMTIyLjI0ODg0ODk5OTk5OTk5XSwgWzM3Ljg3MTE2NywgLTEyMi4yNjgyODVdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Njg2NjY5OTk5OTk5OTUsIC0xMjIuMzEzNjU2MDAwMDAwMDFdLCBbMzcuODcyNzYxLCAtMTIyLjI5NjkxODk5OTk5OTk5XSwgWzM3Ljg1OTg4OSwgLTEyMi4yNzgxNjddLCBbMzcuODY3NjQzLCAtMTIyLjI4MDY0M10sIFszNy44ODg1MTIsIC0xMjIuMjY2NzQ2XSwgWzM3Ljg1OTUzOSwgLTEyMi4yNTkxNzE5OTk5OTk5OV0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODg4NzcxOTk5OTk5OTk2LCAtMTIyLjI3NzYyNF0sIFszNy44NjkwOTYsIC0xMjIuMjcwMTM3XSwgWzM3Ljg1MTUwMywgLTEyMi4yNzg1MTc5OTk5OTk5OV0sIFszNy44ODA1MTksIC0xMjIuMjY3MDUxXSwgWzM3Ljg1Mjg3MSwgLTEyMi4yNjc5OV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODgxOTU1LCAtMTIyLjI2MTQ5Nl0sIFszNy44NTUwMjYsIC0xMjIuMjY2NDc1XSwgWzM3Ljg3ODkwNCwgLTEyMi4yNTg4MTM5OTk5OTk5OV0sIFszNy44ODA1MTksIC0xMjIuMjY3MDUxXSwgWzM3Ljg2MTA3ODAwMDAwMDAwNiwgLTEyMi4yODk2MzIwMDAwMDAwMV0sIFszNy44NjYxNDUsIC0xMjIuMzAwMDE1OTk5OTk5OTldLCBbMzcuODY3OTY0LCAtMTIyLjI2NTA0MV0sIFszNy44OTA5MjgsIC0xMjIuMjg3MjUxXSwgWzM3Ljg1OTk4OCwgLTEyMi4yNTMzMzg5OTk5OTk5OF0sIFszNy44NzUwNDgsIC0xMjIuMjYwMzk4OTk5OTk5OTldLCBbMzcuODY5NjQyLCAtMTIyLjI4NzQ5MTk5OTk5OTk5XSwgWzM3Ljg2Njk1LCAtMTIyLjI4Njk4NF0sIFszNy44ODQ5MjUsIC0xMjIuMjQ4NDk3XSwgWzM3Ljg1NjM0NCwgLTEyMi4yOTE2NTQwMDAwMDAwMV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2Mzk0NSwgLTEyMi4yOTQwODYwMDAwMDAwMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODU1Njc4MDAwMDAwMDA1LCAtMTIyLjI3NDQyOV0sIFszNy44NzEzMjMsIC0xMjIuMjY3MjIyXSwgWzM3Ljg2ODg3OCwgLTEyMi4zMDAyODRdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NjE4NDMsIC0xMjIuMjY5NjQ0XSwgWzM3Ljg2OTc2NCwgLTEyMi4yODY1NV0sIFszNy44NTg4NjcsIC0xMjIuMjc4OTkxOTk5OTk5OTldLCBbMzcuODcxMjY4LCAtMTIyLjMwMTA2XSwgWzM3Ljg1Mzg2MiwgLTEyMi4yODU2NTQwMDAwMDAwMV0sIFszNy44NTM2NDQsIC0xMjIuMjYyMDQ2XSwgWzM3Ljg3NTA4NCwgLTEyMi4yNjY0NjM5OTk5OTk5OF0sIFszNy44OTA3MzQsIC0xMjIuMjY3MTkyXSwgWzM3Ljg1NDg4LCAtMTIyLjI2OTA3OV0sIFszNy44Njk3NjQsIC0xMjIuMjg2NTVdLCBbMzcuODYxMDc4MDAwMDAwMDA2LCAtMTIyLjI4OTYzMjAwMDAwMDAxXSwgWzM3LjkwNTUwNCwgLTEyMi4yNzUxMDddLCBbMzcuODkwMjc0LCAtMTIyLjI2MDc5Mzk5OTk5OTk5XSwgWzM3Ljg2ODUxMiwgLTEyMi4yNjc4MTAwMDAwMDAwMV0sIFszNy44NzA2NTIsIC0xMjIuMjc5NTgwMDAwMDAwMDFdLCBbMzcuODY5NzY0LCAtMTIyLjI4NjU1XSwgWzM3Ljg2NTcxMSwgLTEyMi4yNTM4ODk5OTk5OTk5OF0sIFszNy44NTgwNzksIC0xMjIuMjY4MDE1OTk5OTk5OTldLCBbMzcuODcxMTcxMDAwMDAwMDA0LCAtMTIyLjI2NzcxNzk5OTk5OTk5XSwgWzM3Ljg2OTM2MywgLTEyMi4yNjgwMjhdLCBbMzcuODU0MDUsIC0xMjIuMjM2NDI5XSwgWzM3Ljg3MDIzNiwgLTEyMi4yOTI1OTA5OTk5OTk5OV0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg3ODk0MSwgLTEyMi4yNTcyNzddLCBbMzcuODY5MDk2LCAtMTIyLjI3MDEzN10sIFszNy44NDgyNywgLTEyMi4yNzE3ODc5OTk5OTk5OV0sIFszNy44NzQxNDUsIC0xMjIuMjY2MjI1XSwgWzM3Ljg3NTAyMywgLTEyMi4yODEyMjkwMDAwMDAwMV0sIFszNy44ODI5NDMsIC0xMjIuMjc5MzgzMDAwMDAwMDFdLCBbMzcuODU0OSwgLTEyMi4yNzk0NV0sIFszNy44OTAwNSwgLTEyMi4yNzE2MDddLCBbMzcuODY3OTA2LCAtMTIyLjI3OTQyOF0sIFszNy44NjQ5MDgsIC0xMjIuMjY3Mjg4OTk5OTk5OTldLCBbMzcuODgwMjI3MDAwMDAwMDA1LCAtMTIyLjI2OTM2XSwgWzM3Ljg2MTM4NywgLTEyMi4yNTkwMDFdLCBbMzcuODYzNTY0MDAwMDAwMDA0LCAtMTIyLjI5NTEzNTAwMDAwMDAyXSwgWzM3Ljg3NjQ0LCAtMTIyLjI1NzAyM10sIFszNy44OTE1MTUwMDAwMDAwMDUsIC0xMjIuMjcwMDM4OTk5OTk5OThdLCBbMzcuODY1ODQ5LCAtMTIyLjI1OTk3N10sIFszNy44OTEyMTQsIC0xMjIuMjgyMTU4MDAwMDAwMDFdLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg3MjU0MTk5OTk5OTk5NiwgLTEyMi4yNzE5NzhdLCBbMzcuODY3OTA2LCAtMTIyLjI3OTQyOF0sIFszNy44NzE4ODQsIC0xMjIuMjc3NjNdLCBbMzcuODY3NDgyLCAtMTIyLjI1NDI1M10sIFszNy44NTUyOTI5OTk5OTk5OTYsIC0xMjIuMjY2NTAyXSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44ODk5OTg5OTk5OTk5OTYsIC0xMjIuMjcyNDU2XSwgWzM3Ljg1NTEwNiwgLTEyMi4yOTI0MTk5OTk5OTk5OV0sIFszNy44NDg3NTIwMDAwMDAwMDUsIC0xMjIuMjcxMzMxXSwgWzM3Ljg4MDI2MiwgLTEyMi4yOTU4MDldLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg4MjAyNCwgLTEyMi4yOTc1Nl0sIFszNy44NjM1MDEsIC0xMjIuMjk2MjI1XSwgWzM3Ljg2MzE0MywgLTEyMi4yNjY2ODFdLCBbMzcuODU4MzU2LCAtMTIyLjI1MzE3OV0sIFszNy44NTc0MDkwMDAwMDAwMDQsIC0xMjIuMjY4NDczXSwgWzM3Ljg2NTUzNDk5OTk5OTk5NCwgLTEyMi4yNTUyMzUwMDAwMDAwMV0sIFszNy44NTI5NTYsIC0xMjIuMjY2MTk1XSwgWzM3Ljg3ODk0MSwgLTEyMi4yNTcyNzddLCBbMzcuODU5NTU3LCAtMTIyLjI5NzMzXSwgWzM3Ljg2NTQyLCAtMTIyLjI1NjE4XSwgWzM3Ljg2NDgzNiwgLTEyMi4yOTkwMjRdLCBbMzcuODcwMzQ2MDAwMDAwMDA1LCAtMTIyLjI2Nzc5NTk5OTk5OTk5XSwgWzM3Ljg2NTQ0MywgLTEyMi4yNjMxODg5OTk5OTk5OF0sIFszNy44NjcyNTkwMDAwMDAwMDQsIC0xMjIuMjYzMjRdLCBbMzcuODgwODkzLCAtMTIyLjI2MzY3M10sIFszNy44NTg1MjUsIC0xMjIuMjY2OTA2XSwgWzM3Ljg2NzI1OTAwMDAwMDAwNCwgLTEyMi4yNjMyNF0sIFszNy44ODc3NDEsIC0xMjIuMjU0NTM5XSwgWzM3Ljg4Mjk0MywgLTEyMi4yNzkzODMwMDAwMDAwMV0sIFszNy44NzIxMDYsIC0xMjIuMjY4NDA1XSwgWzM3Ljg2Njg0MiwgLTEyMi4yNzM2Nl0sIFszNy44NjkwNjcsIC0xMjIuMjkyMDQyOTk5OTk5OTldLCBbMzcuODYyNzgxLCAtMTIyLjI2OTM3Nl0sIFszNy44ODAyMjcwMDAwMDAwMDUsIC0xMjIuMjY5MzZdLCBbMzcuODg3ODQzLCAtMTIyLjI3MDAxMTAwMDAwMDAxXSwgWzM3Ljg3MTQwMiwgLTEyMi4yOTI5NjVdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44Njg3ODQ5OTk5OTk5OTUsIC0xMjIuMjcyNzAxXSwgWzM3Ljg2ODg0NSwgLTEyMi4yOTIxMzk5OTk5OTk5OV0sIFszNy44NjM4OTMsIC0xMjIuMjUxNDIxOTk5OTk5OTldLCBbMzcuODgwNzg2LCAtMTIyLjMwMzA2N10sIFszNy44NjI4NDQsIC0xMjIuMjk4MzY4XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODcyMTY2LCAtMTIyLjI3NTM3MTk5OTk5OTk5XSwgWzM3Ljg4ODA3MTk5OTk5OTk5NCwgLTEyMi4yNzIzNDM5OTk5OTk5OV0sIFszNy44OTA5NDUsIC0xMjIuMjcxMTI2XSwgWzM3Ljg1MzYwMywgLTEyMi4yODM5NjFdLCBbMzcuODU5MzA5LCAtMTIyLjI1OTI5MDk5OTk5OTk5XSwgWzM3Ljg5MDk0NSwgLTEyMi4yNzExMjZdLCBbMzcuODUyMDY2LCAtMTIyLjI3Mjk5NF0sIFszNy44NTYxMTEsIC0xMjIuMjYwMjQ4XSwgWzM3Ljg2MTI2NSwgLTEyMi4yNjY5OF0sIFszNy44NzcxOTYwMDAwMDAwMDUsIC0xMjIuMzAyOTg2XSwgWzM3Ljg1MTc1LCAtMTIyLjI5Mzc4OTk5OTk5OTk5XSwgWzM3Ljg1NTgyNCwgLTEyMi4yNTUwMl0sIFszNy44NzM2MzkwMDAwMDAwMDQsIC0xMjIuMjcwNjM5OTk5OTk5OTldLCBbMzcuODcwNTgzLCAtMTIyLjI2NTk1Nl0sIFszNy44NTY3OTIsIC0xMjIuMjc5ODQ1XSwgWzM3Ljg2OTAzMSwgLTEyMi4yNTY2MTFdLCBbMzcuODcxMTY3LCAtMTIyLjI2ODI4NV0sIFszNy44ODk1MDcsIC0xMjIuMjgxNjY5OTk5OTk5OTldLCBbMzcuODYzMzY5LCAtMTIyLjI1NzYyMl0sIFszNy44NzM1MjYsIC0xMjIuMjcxNTM1MDAwMDAwMDFdLCBbMzcuODQ4NzUyMDAwMDAwMDA1LCAtMTIyLjI3MTMzMV0sIFszNy44OTI2MjUsIC0xMjIuMjY4NDM4OTk5OTk5OTldLCBbMzcuODY2NDYzLCAtMTIyLjI1NTJdLCBbMzcuODY2OTY5LCAtMTIyLjI2NTUzXSwgWzM3Ljg1MDY4MSwgLTEyMi4yNzA2MTldLCBbMzcuODczNjg3LCAtMTIyLjI2ODYxNl0sIFszNy44NjY0NzE5OTk5OTk5OTUsIC0xMjIuMjk4NDAzMDAwMDAwMDFdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NTA4OTksIC0xMjIuMjc2MTc0XSwgWzM3Ljg4NTM4NSwgLTEyMi4yNzM1NDddLCBbMzcuODg4MjQxLCAtMTIyLjI1MDg3NV0sIFszNy44NjU1Mjg5OTk5OTk5OTUsIC0xMjIuMjgyNjI4XSwgWzM3Ljg2ODI4MSwgLTEyMi4zMDAxMDJdLCBbMzcuODY1NTAxLCAtMTIyLjI2OTc3NF0sIFszNy44NzEzODgsIC0xMjIuMjk0MTA0XSwgWzM3Ljg2MDk5MywgLTEyMi4yNjIxMDQwMDAwMDAwMV0sIFszNy44NjQ5MDgsIC0xMjIuMjY3Mjg4OTk5OTk5OTldLCBbMzcuODY4NzQ3LCAtMTIyLjI4NzM0Ml0sIFszNy44NDgxNTIsIC0xMjIuMjc1ODA3XSwgWzM3Ljg2NTM3Mzk5OTk5OTk5NiwgLTEyMi4yNTY1MTFdLCBbMzcuODkwMDUsIC0xMjIuMjcxNjA3XSwgWzM3Ljg1MjYxOCwgLTEyMi4yODM2NzddLCBbMzcuODY5MzE0LCAtMTIyLjI5ODFdLCBbMzcuODk0NzIxMDAwMDAwMDA0LCAtMTIyLjI4NjQxNjk5OTk5OTk5XSwgWzM3Ljg2MzkzOCwgLTEyMi4yNTM3MzVdLCBbMzcuODY4MzI1LCAtMTIyLjI2OTEyNV0sIFszNy44Njg5NTcsIC0xMjIuMjU0NTUyXSwgWzM3Ljg4MjAyNCwgLTEyMi4yOTc1Nl0sIFszNy44NTM1NTIsIC0xMjIuMjY4Mjg2XSwgWzM3Ljg1MTIwOCwgLTEyMi4yODkxMDVdLCBbMzcuODU3NDA5MDAwMDAwMDA0LCAtMTIyLjI2ODQ3M10sIFszNy44NTAzNDUwMDAwMDAwMDQsIC0xMjIuMjcwOTExMDAwMDAwMDFdLCBbMzcuODY1OTYzLCAtMTIyLjI3OTI4OF0sIFszNy44NTczNiwgLTEyMi4yOTA4MDQwMDAwMDAwMV0sIFszNy44NzQ3ODEsIC0xMjIuMjY4NzU4XSwgWzM3Ljg2MDY0MDk5OTk5OTk5NCwgLTEyMi4yOTE4MjddLCBbMzcuODY4ODQ1LCAtMTIyLjI5MjEzOTk5OTk5OTk5XSwgWzM3Ljg3MDY1MiwgLTEyMi4yNzk1ODAwMDAwMDAwMV0sIFszNy44NzE4MjgsIC0xMjIuMjcwNTE1OTk5OTk5OTldLCBbMzcuODcwMjMxLCAtMTIyLjI5OTYyNF0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44ODExMSwgLTEyMi4yNjI1ODRdLCBbMzcuODc1MjE4LCAtMTIyLjI5NDA1MjAwMDAwMDAxXSwgWzM3Ljg4MDE2MywgLTEyMi4zMDY3NjAwMDAwMDAwMV0sIFszNy44NTUsIC0xMjIuMjc3MjAyXSwgWzM3Ljg3NjQ0LCAtMTIyLjI1NzAyM10sIFszNy44NzM2MDcsIC0xMjIuMjcwOTAzXSwgWzM3Ljg2ODY1NSwgLTEyMi4yODgwNjM5OTk5OTk5OV0sIFszNy44NDg4MTIsIC0xMjIuMjc4MDQzXSwgWzM3Ljg2MTY3MiwgLTEyMi4yNTU5OTE5OTk5OTk5OV0sIFszNy44NzkzNSwgLTEyMi4yNzYxMjNdLCBbMzcuODc4OTQ5LCAtMTIyLjI4NTI5MDk5OTk5OTk5XSwgWzM3Ljg3MDM0NjAwMDAwMDAwNSwgLTEyMi4yNjc3OTU5OTk5OTk5OV0sIFszNy44ODA3ODYsIC0xMjIuMzAzMDY3XSwgWzM3Ljg4MDI0LCAtMTIyLjI2OTIzNTAwMDAwMDAxXSwgWzM3Ljg2OTI3OSwgLTEyMi4yNDQ1NjVdLCBbMzcuODc4NzM0LCAtMTIyLjI4OTY1M10sIFszNy44Njg3MDYsIC0xMjIuMjY2Mjc5XSwgWzM3Ljg1MzU1MiwgLTEyMi4yOTE1NjEwMDAwMDAwMl0sIFszNy44NzI0NywgLTEyMi4yNzMwMjFdLCBbMzcuODc4OTYzLCAtMTIyLjI5MzQ0Nl0sIFszNy44NjkzNjMsIC0xMjIuMjY4MDI4XSwgWzM3Ljg4MDAyMSwgLTEyMi4yOTgwOTA5OTk5OTk5OV0sIFszNy44NDkzMjEsIC0xMjIuMjc5NzddLCBbMzcuODgxMTM4LCAtMTIyLjI4ODc1XSwgWzM3Ljg0ODM1NywgLTEyMi4yODE1MjFdLCBbMzcuODUyMDY2LCAtMTIyLjI3Mjk5NF0sIFszNy44Njg4NDUsIC0xMjIuMjkyMTM5OTk5OTk5OTldLCBbMzcuODU5ODUxLCAtMTIyLjI5Mjc2Mzk5OTk5OTk5XSwgWzM3Ljg2NzQ4MiwgLTEyMi4yNTQyNTNdLCBbMzcuODU4MDQzLCAtMTIyLjI4ODY0Ml0sIFszNy44ODExNDIsIC0xMjIuMzAxOTFdLCBbMzcuODg3NzQ3LCAtMTIyLjI2NDUxMzk5OTk5OTk5XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44OTE1NDUsIC0xMjIuMjUxOTEyXSwgWzM3Ljg2NzY2OCwgLTEyMi4yNjAxMDkwMDAwMDAwMV0sIFszNy44NTMyODkwMDAwMDAwMDQsIC0xMjIuMjc4OTQxOTk5OTk5OTldLCBbMzcuODg3NzQ3LCAtMTIyLjI2NDUxMzk5OTk5OTk5XSwgWzM3Ljg3ODAyMzk5OTk5OTk5NiwgLTEyMi4zMDc5OF0sIFszNy44Njc1NDYwMDAwMDAwMDQsIC0xMjIuMjUxOTY3XSwgWzM3Ljg3NDAwMjAwMDAwMDAwNCwgLTEyMi4yNjc0ODc5OTk5OTk5OV0sIFszNy44NjUyMDIwMDAwMDAwMDQsIC0xMjIuMjU3Nzk1XSwgWzM3Ljg2ODY2Njk5OTk5OTk5NSwgLTEyMi4zMTM2NTYwMDAwMDAwMV0sIFszNy44NTA0MjQsIC0xMjIuMjk2MDMxXSwgWzM3Ljg1NDEzNywgLTEyMi4yNTEwMDddLCBbMzcuODU1MjkyOTk5OTk5OTk2LCAtMTIyLjI2NjUwMl0sIFszNy44NzE1NDQsIC0xMjIuMjcyNzE0XSwgWzM3Ljg4Mjk0MywgLTEyMi4yNzkzODMwMDAwMDAwMV0sIFszNy44NjI5MjcsIC0xMjIuMjU4Nzg0XSwgWzM3Ljg2MTczOCwgLTEyMi4yOTU2NjM5OTk5OTk5OV0sIFszNy44NjMzMSwgLTEyMi4zMTYxMTI5OTk5OTk5OV0sIFszNy44Njk5NzMsIC0xMjIuMjcwNTU3MDAwMDAwMDFdLCBbMzcuODY5Mzg1LCAtMTIyLjI4OTUzXSwgWzM3Ljg4Mzk3MywgLTEyMi4yNjYzMjNdLCBbMzcuODY2MDM3LCAtMTIyLjI2NTYxNzk5OTk5OTk5XSwgWzM3Ljg2ODY1NSwgLTEyMi4yODgwNjM5OTk5OTk5OV0sIFszNy44Njg3MTQwMDAwMDAwMDQsIC0xMjIuMjU5MTg4OTk5OTk5OTldLCBbMzcuODczNDU1LCAtMTIyLjI5MzQ2NV0sIFszNy44ODA3ODYsIC0xMjIuMzAzMDY3XSwgWzM3Ljg1ODYxNjk5OTk5OTk5NSwgLTEyMi4yNTExNDldLCBbMzcuODU1Mjk0LCAtMTIyLjI5MjQ3NV0sIFszNy44NzQwOTUwMDAwMDAwMDQsIC0xMjIuMjg4NTQxOTk5OTk5OTldLCBbMzcuODc4NDExLCAtMTIyLjMwNjA0MV0sIFszNy44NzE2MDcsIC0xMjIuMjg0MzM2MDAwMDAwMDFdLCBbMzcuODUzOTk4LCAtMTIyLjI3NzAxNTk5OTk5OTk5XSwgWzM3Ljg3Mzg4NDk5OTk5OTk5NCwgLTEyMi4yNjYzMzJdLCBbMzcuODcxODI4LCAtMTIyLjI3MDUxNTk5OTk5OTk5XSwgWzM3Ljg1MjQyMiwgLTEyMi4yNzg1NzFdLCBbMzcuODU5MDY2OTk5OTk5OTk2LCAtMTIyLjI5MDM0OF0sIFszNy44NjEwNzgwMDAwMDAwMDYsIC0xMjIuMjg5NjMyMDAwMDAwMDFdLCBbMzcuODY3ODA1LCAtMTIyLjI5MTgwOTAwMDAwMDAxXSwgWzM3Ljg2MDIyNSwgLTEyMi4yNjk0NTNdLCBbMzcuODcwMjQzLCAtMTIyLjI3NTE0OV0sIFszNy44NTA5NzQsIC0xMjIuMjgwOTI2MDAwMDAwMDFdLCBbMzcuODQ5NzQ3LCAtMTIyLjI3NzkwNzAwMDAwMDAxXSwgWzM3Ljg4Nzk2MSwgLTEyMi4yNjk4MjE5OTk5OTk5OV0sIFszNy44ODAyNCwgLTEyMi4yNjkyMzUwMDAwMDAwMV0sIFszNy44NTA1NDEsIC0xMjIuMjg2MDM3MDAwMDAwMDFdLCBbMzcuODYzMzcyOTk5OTk5OTk2LCAtMTIyLjI5Njg5M10sIFszNy44ODUwNTgsIC0xMjIuMjc4NDE1OTk5OTk5OTldLCBbMzcuODY1NzcyLCAtMTIyLjI2NzY0Mjk5OTk5OTk5XSwgWzM3Ljg4MTc1NywgLTEyMi4yNTExNjI5OTk5OTk5OV0sIFszNy44NzM2ODcsIC0xMjIuMjY4NjE2XSwgWzM3Ljg2NTQ5MSwgLTEyMi4zMTAwNjVdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg2OTM4NSwgLTEyMi4yODk1M10sIFszNy44NjYxNzAwMDAwMDAwMDQsIC0xMjIuMjQ3MDI0XSwgWzM3Ljg2NDIzOCwgLTEyMi4yNjUyNjI5OTk5OTk5OV0sIFszNy44NzEyNDYsIC0xMjIuMjc0OTkwOTk5OTk5OTldLCBbMzcuODcwOTA5OTk5OTk5OTk1LCAtMTIyLjI2NTk5M10sIFszNy44NTM3MTUsIC0xMjIuMjc0MjEzOTk5OTk5OTldLCBbMzcuODY4NDQ2OTk5OTk5OTk2LCAtMTIyLjI2MTI2Nzk5OTk5OTk5XSwgWzM3Ljg3MzY4NywgLTEyMi4yNjg2MTZdLCBbMzcuODU2NDg0LCAtMTIyLjI2ODYyNF0sIFszNy44NjMzNTMwMDAwMDAwMDQsIC0xMjIuMjY1MDUzMDAwMDAwMDFdLCBbMzcuODcyMTI1LCAtMTIyLjI4OTYzOTk5OTk5OTk5XSwgWzM3Ljg3OTMyNCwgLTEyMi4yNjIxNzZdLCBbMzcuODUzNTUyLCAtMTIyLjI5MTU2MTAwMDAwMDAyXSwgWzM3Ljg0ODUzNCwgLTEyMi4yNzI5OTldLCBbMzcuODUwNDI0LCAtMTIyLjI5NjAzMV0sIFszNy44ODIyMjAwMDAwMDAwMDQsIC0xMjIuMjQ3OTU1XSwgWzM3Ljg3NzMyMywgLTEyMi4yNjQyNzNdLCBbMzcuODU5ODAyLCAtMTIyLjI2NzE3N10sIFszNy44NjY1MDgsIC0xMjIuMjYxMDU3MDAwMDAwMDFdLCBbMzcuODU4MDc5LCAtMTIyLjI2ODAxNTk5OTk5OTk5XSwgWzM3Ljg3OTE2NSwgLTEyMi4zMDIzMDVdLCBbMzcuODcxMDEzLCAtMTIyLjI5NjM2NTk5OTk5OTk5XSwgWzM3Ljg2NzQ4MiwgLTEyMi4yNTQyNTNdLCBbMzcuODQ5NjA5LCAtMTIyLjI4MjAwMDAwMDAwMDAxXSwgWzM3Ljg1MzkyOSwgLTEyMi4yODk2NzldLCBbMzcuODY1Nzk3LCAtMTIyLjI1Mjc0MDk5OTk5OTk5XSwgWzM3Ljg2OTY5MDk5OTk5OTk5NiwgLTEyMi4yNzg0ODk5OTk5OTk5OV0sIFszNy44ODE3ODgsIC0xMjIuMjcwNjc4XSwgWzM3Ljg2OTk0NCwgLTEyMi4zMDA2MzYwMDAwMDAwMV0sIFszNy44NzEyNjgsIC0xMjIuMzAxMDZdLCBbMzcuODcyNjkwOTk5OTk5OTk2LCAtMTIyLjI3MDc0MDk5OTk5OTk5XSwgWzM3Ljg1Njc5MiwgLTEyMi4yNzk4NDVdLCBbMzcuODY0Nzk1LCAtMTIyLjI5Nzg2Mjk5OTk5OTk5XSwgWzM3Ljg3OTI3MywgLTEyMi4yNTU5ODYwMDAwMDAwMV0sIFszNy44NTM1NTIsIC0xMjIuMjkxNTYxMDAwMDAwMDJdLCBbMzcuODY0Nzk1LCAtMTIyLjI5Nzg2Mjk5OTk5OTk5XSwgWzM3Ljg3MTU0NCwgLTEyMi4yNzI3MTRdLCBbMzcuODgxNDMzLCAtMTIyLjI3MjkyMV0sIFszNy44Njc1MTMsIC0xMjIuMjYxMjddLCBbMzcuODYzNjExLCAtMTIyLjMxNzU2NTk5OTk5OTk5XSwgWzM3Ljg3MTAxMywgLTEyMi4yOTYzNjU5OTk5OTk5OV0sIFszNy44NzQ5Nzg5OTk5OTk5OTYsIC0xMjIuMjk1MjhdLCBbMzcuODgwNTE5LCAtMTIyLjI2NzA1MV0sIFszNy44NzQxNzcsIC0xMjIuMjk3MzY0OTk5OTk5OTldLCBbMzcuODczMDg5LCAtMTIyLjMwNDYxNl0sIFszNy44NjMzNjksIC0xMjIuMjU3NjIyXSwgWzM3Ljg2NjA3NCwgLTEyMi4yNjMzMV0sIFszNy44OTQ1OTc5OTk5OTk5OTUsIC0xMjIuMjgyNTIzXSwgWzM3Ljg3MTksIC0xMjIuMjY4Mzg4OTk5OTk5OThdLCBbMzcuODgyNDU3LCAtMTIyLjI5NTQ2NF0sIFszNy44NzExNjcsIC0xMjIuMjY4Mjg1XSwgWzM3Ljg4MTk1NywgLTEyMi4yNjk1NTFdLCBbMzcuODczMjAxLCAtMTIyLjI2NzQ0NF0sIFszNy44NTY5NDc5OTk5OTk5OTYsIC0xMjIuMjkzMDEzOTk5OTk5OTldLCBbMzcuODkyMTUyLCAtMTIyLjI2OTIxMTAwMDAwMDAxXSwgWzM3Ljg4MDE1LCAtMTIyLjI5NzQ0Nl0sIFszNy44NzE2ODksIC0xMjIuMjkyODk4XSwgWzM3Ljg1ODY3Mjk5OTk5OTk5NiwgLTEyMi4yNzMzNjQ5OTk5OTk5OF0sIFszNy44NjE5NDAwMDAwMDAwMDQsIC0xMjIuMjgzMDI2XSwgWzM3Ljg0OTc0NywgLTEyMi4yNzc5MDcwMDAwMDAwMV0sIFszNy44ODAxNSwgLTEyMi4yOTc0NDZdLCBbMzcuODgwMTUsIC0xMjIuMjk3NDQ2XSwgWzM3Ljg0ODc1MjAwMDAwMDAwNSwgLTEyMi4yNzEzMzFdLCBbMzcuODY3ODcxLCAtMTIyLjI2NTY1XSwgWzM3Ljg3MTk2OSwgLTEyMi4yOTg5NzhdLCBbMzcuODY1NDkxLCAtMTIyLjMxMDA2NV0sIFszNy44NjI4NywgLTEyMi4yOTkzODUwMDAwMDAwMl0sIFszNy44NzkzNjMsIC0xMjIuMzAxMzQxXSwgWzM3Ljg2NjgwMzAwMDAwMDAwNCwgLTEyMi4yNTE4NDddLCBbMzcuODU1NzQ4LCAtMTIyLjI5MDI4MTAwMDAwMDAxXSwgWzM3Ljg2NjI4OCwgLTEyMi4yOTgzNDRdLCBbMzcuODY4NTEyLCAtMTIyLjI2NzgxMDAwMDAwMDAxXSwgWzM3Ljg3ODI3NCwgLTEyMi4yOTc1NTZdLCBbMzcuODUzNzYsIC0xMjIuMjUzNzkxOTk5OTk5OTldLCBbMzcuODYxNTcxMDAwMDAwMDA1LCAtMTIyLjI3MTcyMl0sIFszNy44NTkyMiwgLTEyMi4yODkwMzUwMDAwMDAwMV0sIFszNy44NTI2LCAtMTIyLjI4OTcxNDk5OTk5OTk5XSwgWzM3Ljg1ODAyNCwgLTEyMi4yNTY5MTU5OTk5OTk5OV0sIFszNy44Njc1NDYwMDAwMDAwMDQsIC0xMjIuMjUxOTY3XSwgWzM3Ljg4MDg1OSwgLTEyMi4yODc3NzRdLCBbMzcuODY3NDkwOTk5OTk5OTk0LCAtMTIyLjI1NDA1NDAwMDAwMDAxXSwgWzM3Ljg5NjIxOCwgLTEyMi4yNzA2NzFdLCBbMzcuODY4OTU3LCAtMTIyLjI1NDU1Ml0sIFszNy44Njk2NzksIC0xMjIuMjg4MDM3OTk5OTk5OTldXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtaW5PcGFjaXR5OiAwLjUsCiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogMTgsCiAgICAgICAgICAgICAgICAgICAgbWF4OiAxLjAsCiAgICAgICAgICAgICAgICAgICAgcmFkaXVzOiAxMCwKICAgICAgICAgICAgICAgICAgICBibHVyOiAxNSwKICAgICAgICAgICAgICAgICAgICBncmFkaWVudDogbnVsbAogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzA2MDU1YTVlMmZlYTRjN2U5N2RjMjc0MGRiNTZjNDUyKTsKICAgICAgICAKPC9zY3JpcHQ+" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" webkitallowfullscreen=""></iframe></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With a few exceptions, the Calls dataset covers the Berkeley area. We can see that most police calls happened in the Downtown Berkeley and south of UC Berkeley campus areas.</p>
<p>Let's now confirm the temporal and geographic scope for the Stops dataset:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stops</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Incident Number</th>
<th>Call Date/Time</th>
<th>Location</th>
<th>Incident Type</th>
<th>Dispositions</th>
<th>Location - Latitude</th>
<th>Location - Longitude</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2015-00004825</td>
<td>2015-01-26 00:10:00</td>
<td>SAN PABLO AVE / MARIN AVE</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2015-00004829</td>
<td>2015-01-26 00:50:00</td>
<td>SAN PABLO AVE / CHANNING WAY</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>2015-00004831</td>
<td>2015-01-26 01:03:00</td>
<td>UNIVERSITY AVE / NINTH ST</td>
<td>T</td>
<td>M</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>29205</th>
<td>2017-00024245</td>
<td>2017-04-30 22:59:26</td>
<td>UNIVERSITY AVE/6TH ST</td>
<td>T</td>
<td>BM2TWN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<th>29206</th>
<td>2017-00024250</td>
<td>2017-04-30 23:19:27</td>
<td>UNIVERSITY AVE /  WEST ST</td>
<td>T</td>
<td>HM4TCS</td>
<td>37.869876</td>
<td>-122.286551</td>
</tr>
<tr>
<th>29207</th>
<td>2017-00024254</td>
<td>2017-04-30 23:38:34</td>
<td>CHANNING WAY /  BOWDITCH ST</td>
<td>1194</td>
<td>AR</td>
<td>37.867208</td>
<td>-122.256529</td>
</tr>
</tbody>
</table>
<p>29208 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stops</span><span class="p">[</span><span class="s1">'Call Date/Time'</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0        2015-01-26
25       2015-01-26
26       2015-01-26
            ...    
29175    2017-04-30
29177    2017-04-30
29207    2017-04-30
Name: Call Date/Time, Length: 29208, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As promised, the data collection begins on January 26th, 2015. It looks like the data were downloaded somewhere around the beginning of May 2017 since the dates stop on April 30th, 2017. Let's draw a map to see the geographic data:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">SF_COORDINATES</span> <span class="o">=</span> <span class="p">(</span><span class="mf">37.87</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.28</span><span class="p">)</span>
<span class="n">sf_map</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">SF_COORDINATES</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
<span class="n">locs</span> <span class="o">=</span> <span class="n">stops</span><span class="p">[[</span><span class="s1">'Location - Latitude'</span><span class="p">,</span> <span class="s1">'Location - Longitude'</span><span class="p">]]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">heatmap</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">HeatMap</span><span class="p">(</span><span class="n">locs</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">radius</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">sf_map</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe allowfullscreen="" mozallowfullscreen="" src="data:text/html;charset=utf-8;base64,PCFET0NUWVBFIGh0bWw+CjxoZWFkPiAgICAKICAgIDxtZXRhIGh0dHAtZXF1aXY9ImNvbnRlbnQtdHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04IiAvPgogICAgPHNjcmlwdD5MX1BSRUZFUl9DQU5WQVMgPSBmYWxzZTsgTF9OT19UT1VDSCA9IGZhbHNlOyBMX0RJU0FCTEVfM0QgPSBmYWxzZTs8L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmpzIj48L3NjcmlwdD4KICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjEvanF1ZXJ5Lm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvanMvYm9vdHN0cmFwLm1pbi5qcyI+PC9zY3JpcHQ+CiAgICA8c2NyaXB0IHNyYz0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuanMiPjwvc2NyaXB0PgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2Nkbi5qc2RlbGl2ci5uZXQvbnBtL2xlYWZsZXRAMS4yLjAvZGlzdC9sZWFmbGV0LmNzcyIgLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuNi4zL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhd2dpdC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgPHN0eWxlPmh0bWwsIGJvZHkge3dpZHRoOiAxMDAlO2hlaWdodDogMTAwJTttYXJnaW46IDA7cGFkZGluZzogMDt9PC9zdHlsZT4KICAgIDxzdHlsZT4jbWFwIHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtib3R0b206MDtyaWdodDowO2xlZnQ6MDt9PC9zdHlsZT4KICAgIAogICAgICAgICAgICA8c3R5bGU+ICNtYXBfODQ4NGI0MDU0NWYxNDM2Mzg3NGYyMjhmYmFiY2EyMGMgewogICAgICAgICAgICAgICAgcG9zaXRpb24gOiByZWxhdGl2ZTsKICAgICAgICAgICAgICAgIHdpZHRoIDogMTAwLjAlOwogICAgICAgICAgICAgICAgaGVpZ2h0OiAxMDAuMCU7CiAgICAgICAgICAgICAgICBsZWZ0OiAwLjAlOwogICAgICAgICAgICAgICAgdG9wOiAwLjAlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICA8L3N0eWxlPgogICAgICAgIAogICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vbGVhZmxldC5naXRodWIuaW8vTGVhZmxldC5oZWF0L2Rpc3QvbGVhZmxldC1oZWF0LmpzIj48L3NjcmlwdD4KPC9oZWFkPgo8Ym9keT4gICAgCiAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF84NDg0YjQwNTQ1ZjE0MzYzODc0ZjIyOGZiYWJjYTIwYyIgPjwvZGl2PgogICAgICAgIAo8L2JvZHk+CjxzY3JpcHQ+ICAgIAogICAgCgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBib3VuZHMgPSBudWxsOwogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXBfODQ4NGI0MDU0NWYxNDM2Mzg3NGYyMjhmYmFiY2EyMGMgPSBMLm1hcCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdtYXBfODQ4NGI0MDU0NWYxNDM2Mzg3NGYyMjhmYmFiY2EyMGMnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAge2NlbnRlcjogWzM3Ljg3LC0xMjIuMjhdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3b3JsZENvcHlKdW1wOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNyczogTC5DUlMuRVBTRzM4NTcKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgCiAgICAgICAgICAgIHZhciB0aWxlX2xheWVyX2FiOGY4MTM5ZDM4NzQ2YzY4NWVlZDYyYzZmODRhZGI3ID0gTC50aWxlTGF5ZXIoCiAgICAgICAgICAgICAgICAnaHR0cHM6Ly97c30udGlsZS5vcGVuc3RyZWV0bWFwLm9yZy97en0ve3h9L3t5fS5wbmcnLAogICAgICAgICAgICAgICAgewogICJhdHRyaWJ1dGlvbiI6IG51bGwsCiAgImRldGVjdFJldGluYSI6IGZhbHNlLAogICJtYXhab29tIjogMTgsCiAgIm1pblpvb20iOiAxLAogICJub1dyYXAiOiBmYWxzZSwKICAic3ViZG9tYWlucyI6ICJhYmMiCn0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzg0ODRiNDA1NDVmMTQzNjM4NzRmMjI4ZmJhYmNhMjBjKTsKICAgICAgICAKICAgIAogICAgICAgICAgICB2YXIgaGVhdF9tYXBfOTQ2OTE3ODkxNjdmNDg5ZThjMjhlZTg0MTZlNDJkYTAgPSBMLmhlYXRMYXllcigKICAgICAgICAgICAgICAgIFtbMzcuODYzNDQ0ODc1LCAtMTIyLjI1NjMxNzI5Nl0sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44Nzk2NDQxMjcwMDAxMDUsIC0xMjIuMjgwOTY1OTgyMDAwMDFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODc1MjA0OTc4MDAwMSwgLTEyMi4yOTQwOTQ5NDFdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODUxMjM1NjI3MDAwMSwgLTEyMi4yNTI0NzA2NDcwMDAwMV0sIFszNy44NjgxMzcwMjgsIC0xMjIuMjYzNzMyNDE3OTk5OTldLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODgxMTM3MjU5MDAwMSwgLTEyMi4yODg3NjExNzNdLCBbMzcuODY0NjE2NTYxOTk5OTk1LCAtMTIyLjI5MDY3MjA3MV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NTU2NjUxMDcwMDAxLCAtMTIyLjI3NDQxNzg2M10sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NzMyNTU0NDQwMDAxLCAtMTIyLjI2NzA1MjQ2MV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NzEzMTYyNDk0NDcsIC0xMjIuMzAzNTgwMjYwNzU1XSwgWzM3Ljg4MTgwMjUzNjAwMDEsIC0xMjIuMjk4NjY3OTQ3OTk5OTldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODcwOTc0NjA2MDAwMSwgLTEyMi4yNzc1MDI0MThdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODY2NDY4NTc5MDAwMSwgLTEyMi4yOTgzOTY2MzFdLCBbMzcuODY2OTE4MDI4LCAtMTIyLjI5NjIwOTA1M10sIFszNy44Njc4MDkwNDQwMDAxMDQsIC0xMjIuMjU4OTc1OTg2MDAwMDFdLCBbMzcuODUzNzg3OTc2LCAtMTIyLjI4MzA1NDM4Ml0sIFszNy44NDcyMDU2ODYwMDAxLCAtMTIyLjI3MTY3NDc2M10sIFszNy44NTg3MTI3OTMwMDAxLCAtMTIyLjI4MDE1NTE4MV0sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg1MTc2NDY3OSwgLTEyMi4yNzY1NjI0MjddLCBbMzcuODgyMjYwMjczLCAtMTIyLjI5NjM4NjU2MV0sIFszNy44NjI3NjI5NDgwMDAxLCAtMTIyLjI3NjY0NTY0M10sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODQ3NjU0NzcwMDAwMSwgLTEyMi4yNzk1NzExOTVdLCBbMzcuODQ4NzQ5OTQwMDAwMSwgLTEyMi4yNzEzOTYyNTVdLCBbMzcuODY5NDM2ODAxMDAwMSwgLTEyMi4yODk1MjAyNTJdLCBbMzcuODQ3MDM4MTM0MDAwMSwgLTEyMi4yNzc0MTI1Njc5OTk5OV0sIFszNy44NjgxNTUzNTgsIC0xMjIuMjcwMzUyNTc2MDAwMDFdLCBbMzcuODYzMDQ4NzA3MDAwMTA0LCAtMTIyLjI5ODQwMzgwNF0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2NjcwOTkyNTAwMDEsIC0xMjIuMjk3MjQ4NjhdLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg1ODQyOTE5LCAtMTIyLjI5MzQ5MDA1NjAwMDAxXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjE1NzgzNzcwMDAxLCAtMTIyLjI5MjUwMjc0NjAwMDAxXSwgWzM3Ljg1MjM5MTQ5NywgLTEyMi4yNzg4MDQ5MDcwMDAwMV0sIFszNy44NTEzNTE3ODgsIC0xMjIuMjkwOTAxNDk2XSwgWzM3Ljg3MzIzNDQxMTk5OTk5NSwgLTEyMi4yNzE2NDg4MzldLCBbMzcuODY5MzU3ODQzLCAtMTIyLjMwMDczODk1OF0sIFszNy44NjUyNjEyMDEwMDAxLCAtMTIyLjI5Njc4MzkzOV0sIFszNy44NzE1NjgyNTUwMDAxLCAtMTIyLjI2NzQ1NTcyM10sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NzQ5ODExNjkwMDAxLCAtMTIyLjI5NTI2NTk5XSwgWzM3Ljg2ODMxNjA5MiwgLTEyMi4yNjkxMTI1MDEwMDAwMV0sIFszNy44NTQwMjk2NzUsIC0xMjIuMjczMjExMjldLCBbMzcuODY2Njg2NzgzLCAtMTIyLjI2NzY3NzMxNF0sIFszNy44NTYxODU5NTMwMDAxLCAtMTIyLjI1OTY3Mzg5ODk5OTk5XSwgWzM3Ljg3NzgyODcyNjAwMDEsIC0xMjIuMjczNjk4ODI2XSwgWzM3Ljg5NzMxOTU5MDAwMDEsIC0xMjIuMjgxNDY4NTEyXSwgWzM3Ljg1NzYyOTk5NSwgLTEyMi4yNjY4MDMyOF0sIFszNy44NTc2NjEyNjgwMDAxLCAtMTIyLjI1OTQ2OTg1MV0sIFszNy44NTM5MDE2NjIwMDAxMDUsIC0xMjIuMjc0MjM1Mzc4OTk5OTldLCBbMzcuODY1MTI5NzMsIC0xMjIuMjU4NDExNzg5XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODU3NDYzNzUyMDAwMSwgLTEyMi4yNjgwOTE1NDg5OTk5OV0sIFszNy44NjM2NDg2NjMsIC0xMjIuMjY5Nzk4MDY3MDAwMDFdLCBbMzcuODc4MDA2NzQxLCAtMTIyLjMwNzk1NzA5NV0sIFszNy44NzgwNzc0NTAwOTcxLCAtMTIyLjMwODAyODE2MzA3NTAxXSwgWzM3Ljg2ODcxNjc0ODAwMDEwNCwgLTEyMi4yNjYyMDI4MzcwMDAwMV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODY5Njc2MDQ4LCAtMTIyLjI2NTc5MDgyMzk5OTk5XSwgWzM3Ljg2ODcxNjc0ODAwMDEwNCwgLTEyMi4yNjYyMDI4MzcwMDAwMV0sIFszNy44NzQxNDU4MTEwMDAxLCAtMTIyLjI2NjI5MDUzN10sIFszNy44Njk2NzYwNDgsIC0xMjIuMjY1NzkwODIzOTk5OTldLCBbMzcuODY4NzE2NzQ4MDAwMTA0LCAtMTIyLjI2NjIwMjgzNzAwMDAxXSwgWzM3Ljg2OTY3NjA0OCwgLTEyMi4yNjU3OTA4MjM5OTk5OV0sIFszNy44NjgxNTUzNTgsIC0xMjIuMjcwMzUyNTc2MDAwMDFdLCBbMzcuODY1NTMzNzg0LCAtMTIyLjI4Mzc0NzI4MV0sIFszNy44NjYxMDM2MTg4NzUxLCAtMTIyLjMwNTY4ODEzNTAzMDk5XSwgWzM3Ljg4MDIyMjIxMiwgLTEyMi4yNjkzMjcxNzldLCBbMzcuODYyMTEwNzIyMDAwMTA0LCAtMTIyLjI1MzUzOTk5NV0sIFszNy44NTg0NjIyMTUsIC0xMjIuMjUzMTc2NjAxXSwgWzM3Ljg1NTQ5NzIxNzg5MjEsIC0xMjIuMjgzMTIyNzk1ODU0XSwgWzM3Ljg1MzYxMjExMjAwMDEsIC0xMjIuMjg3MTQ0ODkyXSwgWzM3Ljg1NDcyODk4NywgLTEyMi4yNjkwMTkxNzIwMDAwMV0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44Njg5OTE2NjQwMDAxLCAtMTIyLjI1Njg5MjEzOV0sIFszNy44NjI5OTAxNDAwMDAxLCAtMTIyLjI4OTEwODM1XSwgWzM3Ljg2ODEzNzAyOCwgLTEyMi4yNjM3MzI0MTc5OTk5OV0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NjQ4MjM0MDYsIC0xMjIuMjk4OTcxNzQzXSwgWzM3Ljg2NjI2NzIxNDAwMDEsIC0xMjIuMjk5NDQzMzI0XSwgWzM3Ljg2NjI2NzIxNDAwMDEsIC0xMjIuMjk5NDQzMzI0XSwgWzM3Ljg2NDgyMzQwNiwgLTEyMi4yOTg5NzE3NDNdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg2NDE5MTQ5NTAwMDEsIC0xMjIuMjU4NTY0NTI0XSwgWzM3Ljg1OTgwMjMxMywgLTEyMi4yNjc4MjkxODddLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg3MTAwMjU0MiwgLTEyMi4yOTYzNDI2MjIwMDAwMV0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NjcyMTkwMzMwMDAwMDUsIC0xMjIuMjYzNTQwODE3XSwgWzM3Ljg1NzcyNDU0ODAwMDEsIC0xMjIuMjUwNjg5MDM3OTk5OTldLCBbMzcuODY0ODc2MjYwMDAwMSwgLTEyMi4yNjc0NzQ3OTFdLCBbMzcuODY1NzIxNjgyMDAwMSwgLTEyMi4yNjA4OTc5NTcwMDAwMV0sIFszNy44Njc1MTMxNjEsIC0xMjIuMjYxMjczMTA1XSwgWzM3Ljg2OTYyODE5OSwgLTEyMi4yODgwODk0NDddLCBbMzcuODgwMjUyNjI4MDAwMSwgLTEyMi4yOTY5NTY1MzFdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2NjEwNDgxOSwgLTEyMi4zMDAyNDczNTZdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzU2NTg5NjcsIC0xMjIuMjkwNjA2MDAyXSwgWzM3Ljg3NTg5MTM0OCwgLTEyMi4yODg3NzY3MzddLCBbMzcuODY2MTIxMTk3LCAtMTIyLjI4NTAxNTE2NV0sIFszNy44NzY4ODg0NzcwMDAxLCAtMTIyLjI2NjY1NzMzNV0sIFszNy44NTU1NTMzNTIwMDAxLCAtMTIyLjI2NDU1OTE2NV0sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg3ODA3NzQ1MDA5NzEsIC0xMjIuMzA4MDI4MTYzMDc1MDFdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg1MTQ4Njg1NzAwMDEwNCwgLTEyMi4yNzg1OTQ0MTcwMDAwMV0sIFszNy44Njg4NzYyMDQwMDAxLCAtMTIyLjMwMDI4NDUwNV0sIFszNy44NTk5ODI4NTQwMDAxLCAtMTIyLjI5NTA5MzU5N10sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODY3MjAwOTk3MDAwMTA0LCAtMTIyLjMwMjE1MTA1Mjk5OTk5XSwgWzM3Ljg2NDgyMzQwNiwgLTEyMi4yOTg5NzE3NDNdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODUyNDM1MDYwMDAwMSwgLTEyMi4yNjkzMTU1OTldLCBbMzcuODY3MzkzNjE4MDAwMSwgLTEyMi4yODE2Mzg1NzcwMDAwMV0sIFszNy44NjEyNTAwMzUwMDAxLCAtMTIyLjI2NzA0NzEyODk5OTk5XSwgWzM3Ljg3MjQ0NzMwOTAwMDEsIC0xMjIuMjY2MDgyMDIyXSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODY2NDgxODIzMDAwMSwgLTEyMi4yNjQxOTA3MjNdLCBbMzcuODY3MzkzNjE4MDAwMSwgLTEyMi4yODE2Mzg1NzcwMDAwMV0sIFszNy44NTg3NTU0MzEwMDAxLCAtMTIyLjI1Mjg5NDg4MV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44Njg3MjcyMzUwMDAxLCAtMTIyLjI2NzQ3NzIyN10sIFszNy44NTQ0NTM2NDQsIC0xMjIuMjY5OTkwOTg5XSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NzUzMjIyMDQsIC0xMjIuMzA1OTA3NDIyXSwgWzM3Ljg2NDEyNjYzOTAwMDEsIC0xMjIuMjUwMjY4NDUxMDAwMDFdLCBbMzcuODc0ODY4NTE5MDAwMSwgLTEyMi4yODI0NDM1OTYwMDAwMV0sIFszNy44NjgxNDg4MzMwMDAxLCAtMTIyLjI5MTgxMDY3Nzk5OTk5XSwgWzM3Ljg2ODg2NzIwNDAwMDAwNCwgLTEyMi4yOTMyOTcxNzc5OTk5OV0sIFszNy44NjYxMDM2MTg4NzUxLCAtMTIyLjMwNTY4ODEzNTAzMDk5XSwgWzM3Ljg2OTM5MTk3LCAtMTIyLjI2NzkzMjM0M10sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2NjAxNDU4MiwgLTEyMi4yNTg2MTY0MDI5OTk5OV0sIFszNy44NjgxMzcwMjgsIC0xMjIuMjYzNzMyNDE3OTk5OTldLCBbMzcuODU0NTAzOTI0LCAtMTIyLjI4MTg0NTIyNl0sIFszNy44ODA0NzQxOTUsIC0xMjIuMjk1Nzk5MjE1XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg1NTI4NDYzOTAwMDAwNCwgLTEyMi4yODQ4MDM0NTVdLCBbMzcuODY1MTM4MzEyMDAwMTA2LCAtMTIyLjI2NzEwNDE4OV0sIFszNy44NjEyOTk5NzkwMDAxLCAtMTIyLjI5Nzg0MzQ1NjAwMDAxXSwgWzM3Ljg1OTI4MTQ1LCAtMTIyLjMxNTg0OTE0XSwgWzM3Ljg1NDkxMTkxMSwgLTEyMi4yNzkzODE1MTVdLCBbMzcuODY2MDM0OTY0MDAwMSwgLTEyMi4yNjU2MjI3MzIwMDAwMV0sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XSwgWzM3Ljg2NzIwNzUzOSwgLTEyMi4yNTY1MjkzNzddLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NjIwNjY5MjgwMDAwMDQsIC0xMjIuMjgyMDkyNzEyMDAwMDFdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODY0MDAyNTI3LCAtMTIyLjI4MTI4Njg4Mjk5OTk5XSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODc5NDI1MTQ4MDAwMSwgLTEyMi4yOTYzNTQwOF0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODY1MTI5NzMsIC0xMjIuMjU4NDExNzg5XSwgWzM3Ljg2NjM4MTc4MSwgLTEyMi4yOTEyMzQ0MTIwMDAwMV0sIFszNy44ODIyNjAyNzMsIC0xMjIuMjk2Mzg2NTYxXSwgWzM3Ljg1NzE3NDE1NiwgLTEyMi4yNDM4NDc3NTYwMDAwMV0sIFszNy44NjU3MjA3NzEsIC0xMjIuMjUzOTAyNTIxXSwgWzM3Ljg2ODg2NzIwNDAwMDAwNCwgLTEyMi4yOTMyOTcxNzc5OTk5OV0sIFszNy44Njc4MDkwNDQwMDAxMDQsIC0xMjIuMjU4OTc1OTg2MDAwMDFdLCBbMzcuODQ4ODIyNzk5MDAwMTA0LCAtMTIyLjI3Nzk3OTc3ODk5OTk5XSwgWzM3Ljg0ODg1OTMwMDAwMDEsIC0xMjIuMjkyMTU0MzQxXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2NTEzODc4MzAwMDEsIC0xMjIuMjY1NDQyMDIyXSwgWzM3Ljg2NjYwODgzNjAwMDEsIC0xMjIuMjU0MDc1OTddLCBbMzcuODY0MjQwODI4MDAwMSwgLTEyMi4yNjUyNDIyMTcwMDAwMV0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg3NzMwOTI5LCAtMTIyLjI5NjAxODg3Nl0sIFszNy44NjYxMDM2MTg4NzUxLCAtMTIyLjMwNTY4ODEzNTAzMDk5XSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODkzMTAyMDQsIC0xMjIuMjgzODcxNDM5XSwgWzM3Ljg3MjMzMTgsIC0xMjIuMjk5MDYwMjg1XSwgWzM3Ljg3ODMwMjMzODAwMDAwNSwgLTEyMi4zMDY1NjU1MzVdLCBbMzcuODUyNjQ3OTYwMDAwMSwgLTEyMi4yODY0Nzg0ODNdLCBbMzcuODYxMDk0Mzk2OTk5OTk1LCAtMTIyLjI4OTU0NTk1MTAwMDAxXSwgWzM3Ljg1MjIxMjIxMiwgLTEyMi4yNzMwMTM3MDZdLCBbMzcuODU2MTMzMTY5LCAtMTIyLjI3MTI4MTY4MjAwMDAxXSwgWzM3Ljg3NTMyMjIwNCwgLTEyMi4zMDU5MDc0MjJdLCBbMzcuODY3ODQzMTUyLCAtMTIyLjI5NTg3MzA3NF0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44NjMwNDg3MDcwMDAxMDQsIC0xMjIuMjk4NDAzODA0XSwgWzM3Ljg1Njk0NDk0MTAwMDEsIC0xMjIuMjkzMDEyNDYzXSwgWzM3Ljg2MTIwNDIxNiwgLTEyMi4yODg3MzQ0MDhdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODYzNjMxMjE0MDAwMSwgLTEyMi4yNTc5MjE2MjM5OTk5OV0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODUxOTQzODM3MDAwMSwgLTEyMi4yNTAyMzM5NjIwMDAwMV0sIFszNy44NzI1ODA4NDMsIC0xMjIuMjkzMjUzNTU3OTk5OTldLCBbMzcuODcyNTQ2MDkzMDAwMDA0LCAtMTIyLjI5ODAyMDc0XSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44Nzg3MDQ0NTQ1NzgyMDUsIC0xMjIuMzA0NjQxOTA4NzU3XSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODUzNDQ1NDc4MDAwMDA1LCAtMTIyLjI2OTUxODY1N10sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg2OTM5MTk3LCAtMTIyLjI2NzkzMjM0M10sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NzQxOTYwMDQwMDAxLCAtMTIyLjI3MzI5NDg5MV0sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NzEyNjcyOCwgLTEyMi4yNzI2NzM5MzhdLCBbMzcuODY3MzkzNjE4MDAwMSwgLTEyMi4yODE2Mzg1NzcwMDAwMV0sIFszNy44Njc3NjI1NTAwMDAxLCAtMTIyLjI1MjAzNjQ0Ml0sIFszNy44NzE3NDkzNywgLTEyMi4yNzE4ODM4NzZdLCBbMzcuODQ0NzQzMjcxLCAtMTIyLjI4NDI4MTY1XSwgWzM3Ljg2NTQyNjc1MSwgLTEyMi4yNjMxNzQyNTM5OTk5OV0sIFszNy44NTcwNTM4NDQwMDAxLCAtMTIyLjI3MTM4NTA4NjAwMDAxXSwgWzM3Ljg2NTI2MTIwMTAwMDEsIC0xMjIuMjk2NzgzOTM5XSwgWzM3Ljg3ODkwNTQ2NiwgLTEyMi4yODI5OTgwNDI5OTk5OV0sIFszNy44Nzg5MDU0NjYsIC0xMjIuMjgyOTk4MDQyOTk5OTldLCBbMzcuODc3MTA4NzE2MDAwMSwgLTEyMi4yODQyOTQyMTRdLCBbMzcuODY1OTI3MzI3MDAwMSwgLTEyMi4yOTM1MzEwMTI5OTk5OV0sIFszNy44NjY4ODU0NiwgLTEyMi4yOTUyNTg0MDZdLCBbMzcuODYwNjQxMDExLCAtMTIyLjI5MTgxOTkwOV0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODYyNzU0ODY1NDYyNCwgLTEyMi4yOTk0MzAxMzgyNThdLCBbMzcuODU1MDQ0MDE3MDAwMTA0LCAtMTIyLjI4NjU5MjE4NzAwMDAxXSwgWzM3Ljg2NTgwMTY5NCwgLTEyMi4yNTI3NTQxMTVdLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODgwMjIyMjEyLCAtMTIyLjI2OTMyNzE3OV0sIFszNy44NjM2NDg2NjMsIC0xMjIuMjY5Nzk4MDY3MDAwMDFdLCBbMzcuODY1MTYyMzMxMDAwMSwgLTEyMi4yODY1NTg2ODVdLCBbMzcuODg0MjUwNjMyLCAtMTIyLjI3Njc2MTg1NV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NDk1MDM2MTUwMDAxLCAtMTIyLjI2NTczNjU0NV0sIFszNy44NjE3NDM5OTgwMDAxLCAtMTIyLjI5NTY1MDcwMjk5OTk5XSwgWzM3Ljg3ODU5NjEyMzAwMDEsIC0xMjIuMjgzODM3OTA5XSwgWzM3Ljg3ODk2MTM2MiwgLTEyMi4yODUyOTY5NzM5OTk5OV0sIFszNy44Nzg5MDU0NjYsIC0xMjIuMjgyOTk4MDQyOTk5OTldLCBbMzcuODcyNTgwODQzLCAtMTIyLjI5MzI1MzU1Nzk5OTk5XSwgWzM3Ljg2OTg2NTMyNSwgLTEyMi4yNzg0NjAxNDddLCBbMzcuODY2MDM0OTY0MDAwMSwgLTEyMi4yNjU2MjI3MzIwMDAwMV0sIFszNy44NTY4NTMzMjksIC0xMjIuMjg4MTg3ODAyOTk5OTldLCBbMzcuODQ4NzQ5OTQwMDAwMSwgLTEyMi4yNzEzOTYyNTVdLCBbMzcuODcwODcwNjMwMDAwMSwgLTEyMi4yNjg1NjM4Nl0sIFszNy44NzAzMzc5ODEsIC0xMjIuMjY3NzY2MDQ5XSwgWzM3Ljg2NTI4MzQ3MDAwMDEsIC0xMjIuMjY2MzY0NDQyMDAwMDFdLCBbMzcuODY2MDE0NTgyLCAtMTIyLjI1ODYxNjQwMjk5OTk5XSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY5MjkzNDg2MDAwMDk2LCAtMTIyLjI1NDYwNTQ4Mjk5OTk5XSwgWzM3Ljg3MDU4MjQ2LCAtMTIyLjI3Mjg5MzE5Mzk5OTk5XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODY5NjI4MTk5LCAtMTIyLjI4ODA4OTQ0N10sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODUwNDA5MDkzMDAwMSwgLTEyMi4yNzgzNDM0MTZdLCBbMzcuODU4NDYyMjE1LCAtMTIyLjI1MzE3NjYwMV0sIFszNy44NTYxODU5NTMwMDAxLCAtMTIyLjI1OTY3Mzg5ODk5OTk5XSwgWzM3Ljg2Mzk3MTQ4ODAwMDEwNCwgLTEyMi4yNjczNjMxNV0sIFszNy44NTU4MjY0NDUsIC0xMjIuMjYyNDU5MzU3OTk5OTldLCBbMzcuODc0MTQ1ODExMDAwMSwgLTEyMi4yNjYyOTA1MzddLCBbMzcuODc2NjA0MzA3LCAtMTIyLjI2ODg5NjA4MTAwMDAxXSwgWzM3Ljg2OTA1NjQ0NDAwMDEsIC0xMjIuMjcwNDM0NzA3XSwgWzM3Ljg2MDQ2OTc0OTAwMDEsIC0xMjIuMjgwNDk1Mjg4XSwgWzM3Ljg2ODQ1MjI1NzAwMDEsIC0xMjIuMjU5MzkwODAyMDAwMDFdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODUwNjgyMzMyMDAwMTA1LCAtMTIyLjI3MDY3NTI0Nzk5OTk5XSwgWzM3Ljg2MzM0ODMwOTAwMDEsIC0xMjIuMjY1MDQ2MDEzOTk5OTldLCBbMzcuODUyMzkxNDk3LCAtMTIyLjI3ODgwNDkwNzAwMDAxXSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODU5NTk5NTA4LCAtMTIyLjI4MDMyNTQyOV0sIFszNy44NDM4MjA3NjgwMDAxLCAtMTIyLjI3NDk0Nzk3NF0sIFszNy44NTA1MzIzNjUsIC0xMjIuMjg2MTUxMDQ5XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg0NjQ2NTE1MTAwMDA5NiwgLTEyMi4yODQ5MDUyMTldLCBbMzcuODc5MzY4MDUzMDAwMSwgLTEyMi4zMDEyODk0NDldLCBbMzcuODYyNTU3MDM0MDAwMSwgLTEyMi4yNDU5NDU2N10sIFszNy44NTM3MDk0NjIsIC0xMjIuMjkwNzc5NTA0XSwgWzM3Ljg3MDMwMzczNDAwMDEsIC0xMjIuMjY4MDM1NTAzXSwgWzM3Ljg3MjQ0NzQ2OTAwMDEsIC0xMjIuMjczMDc5ODM1XSwgWzM3Ljg2NTk1Nzk4Nzg3MDYsIC0xMjIuMjY1NTczMjUzNTZdLCBbMzcuODY3NTA1Nzk0MDAwMSwgLTEyMi4yNTQyNTEzNzVdLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg4MTkwODYwMzAwMDEsIC0xMjIuMjcwNDM0ODFdLCBbMzcuODY3MDg0MjQ0MDAwMTA0LCAtMTIyLjI4Mzg5MDIzOF0sIFszNy44NTk1Mzc4MTgsIC0xMjIuMjU5MjA2MDA3OTk5OTldLCBbMzcuODUwNDA4MzEyMDAwMTA2LCAtMTIyLjI3MjgyNjgzNjAwMDAxXSwgWzM3Ljg1OTAwNTgxNSwgLTEyMi4yNDQ1NzUwMzldLCBbMzcuODU3NzI0NTQ4MDAwMSwgLTEyMi4yNTA2ODkwMzc5OTk5OV0sIFszNy44NjU4MDk2NTIwMDAxLCAtMTIyLjMwMTcwODYxN10sIFszNy44NzI3MTU3MjgwMDAxLCAtMTIyLjI3NzcwN10sIFszNy44NTM5MDE2NjIwMDAxMDUsIC0xMjIuMjc0MjM1Mzc4OTk5OTldLCBbMzcuODczMDczMTkyLCAtMTIyLjI4MjIzNTg2M10sIFszNy44NTE0ODY4NTcwMDAxMDQsIC0xMjIuMjc4NTk0NDE3MDAwMDFdLCBbMzcuODU1NjY1MTA3MDAwMSwgLTEyMi4yNzQ0MTc4NjNdLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44NjI0ODMyNywgLTEyMi4yNzg4MDA4ODZdLCBbMzcuODcxNTkwMjgyMDAwMTA2LCAtMTIyLjI4NDQ4NTQ1MTAwMDAxXSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODc5MzY4MDUzMDAwMSwgLTEyMi4zMDEyODk0NDldLCBbMzcuODQ4MTQ0OTE5LCAtMTIyLjI3NTg0MzU4MV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NjU4MjM1MjgwMDAxLCAtMTIyLjI4MTQ3NjEzXSwgWzM3Ljg2ODEzMDA3OCwgLTEyMi4zMDM1MDI2NDZdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODQ4MjU3OTU1MDAwMSwgLTEyMi4yOTUxMDk5MTVdLCBbMzcuODcwNDE1MzU0LCAtMTIyLjI5MjU1MTUxMjk5OTk5XSwgWzM3Ljg3MDU5MDk4NSwgLTEyMi4yODY2Mjg3OThdLCBbMzcuODU0OTExOTExLCAtMTIyLjI3OTM4MTUxNV0sIFszNy44Njk2MjgxOTksIC0xMjIuMjg4MDg5NDQ3XSwgWzM3Ljg3MTQyNjg0LCAtMTIyLjMwMzUwODI5OTk5OTk5XSwgWzM3Ljg2ODEwODQ4ODAwMDEwNCwgLTEyMi4yNTY3MTM1NzNdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODcxMTEyNDIsIC0xMjIuMjg4MjAwNjMzOTk5OTldLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44Njg0MDkzNDgwMDAxLCAtMTIyLjI2MTQ1Mzc3NF0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg1ODk4OTM4NDAwMDAwNCwgLTEyMi4yNzc5NzkxODFdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODgxODAyNTM2MDAwMSwgLTEyMi4yOTg2Njc5NDc5OTk5OV0sIFszNy44NjY5MzAzNjksIC0xMjIuMjY1ODA4NjI1XSwgWzM3Ljg1MzQyNDk5MzAwMDAwNCwgLTEyMi4yNzU4MTA5OTNdLCBbMzcuODYxNjUxMjk5MDAwMSwgLTEyMi4yNTU5ODkwMV0sIFszNy44NjUzNzk5MjYwMDAxLCAtMTIyLjI1NjUwNTE2NV0sIFszNy44NTY5MDM1MDcsIC0xMjIuMjg5NDUzNTI0XSwgWzM3Ljg2MjU1NzAzNDAwMDEsIC0xMjIuMjQ1OTQ1NjddLCBbMzcuODcxODg0NDEzMDAwMDA0LCAtMTIyLjMwMTI0NDU4NV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NzI0NzgyNDkwMDAwMDQsIC0xMjIuMjY4MTQ4MzI2XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODY2OTUwNDI1LCAtMTIyLjI4NjkyNTcyXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2Njk3MTQ2MSwgLTEyMi4yNzI1MDU0NDM5OTk5OV0sIFszNy44NjY2ODMyMDksIC0xMjIuMjg4OTcyMjA2XSwgWzM3Ljg3NzU0OTM3NDAwMDEwNCwgLTEyMi4yOTQ4NjIwNTZdLCBbMzcuODY0ODk5MjEyMDAwMTA0LCAtMTIyLjI4ODYwNjk2XSwgWzM3Ljg4MDI1MjYyODAwMDEsIC0xMjIuMjk2OTU2NTMxXSwgWzM3Ljg2OTMxNDc2MywgLTEyMi4yOTgwOTMxNDI5OTk5OV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44NzUzMjIyMDQsIC0xMjIuMzA1OTA3NDIyXSwgWzM3Ljg2NTAzNDE2MDAwMDEsIC0xMjIuMjg3NTg2MzddLCBbMzcuODc1NTQxMzQzMDAwMSwgLTEyMi4zMDQ4MjQ2NjVdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODgwMDI0MDgxLCAtMTIyLjI5ODA3NTUzOV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg3MDExMjY1NzAwMDExLCAtMTIyLjI4NDI0ODkzMzk5OTk5XSwgWzM3Ljg0NzQ3MTg2NDA4ODc5NiwgLTEyMi4yOTgwNzY4MzU0Njk5OF0sIFszNy44NzI1ODA4NDMsIC0xMjIuMjkzMjUzNTU3OTk5OTldLCBbMzcuODYzMjU4Mzg4MDAwMTA1LCAtMTIyLjI1ODY5NDg1OF0sIFszNy44NzA1ODQ1MjMwMDAwMDUsIC0xMjIuMjY1ODgzNDg2XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjgxNTUzNTgsIC0xMjIuMjcwMzUyNTc2MDAwMDFdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44Nzg5MjU5ODYwMDAxLCAtMTIyLjMwMzUyNzc3NV0sIFszNy44NTg4NDY4NDUwMDAxLCAtMTIyLjI1MzU4MjI0XSwgWzM3Ljg2ODg3NjIwNDAwMDEsIC0xMjIuMzAwMjg0NTA1XSwgWzM3Ljg2MTYzMTkwMDAwMDEsIC0xMjIuMjc4NTE4ODk1XSwgWzM3Ljg2OTY5MTg1NSwgLTEyMi4yNzI3OTkxNF0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODY3MjAwOTk3MDAwMTA0LCAtMTIyLjMwMjE1MTA1Mjk5OTk5XSwgWzM3Ljg2NjYwODgzNjAwMDEsIC0xMjIuMjU0MDc1OTddLCBbMzcuODYwNDA3NDczMDAwMSwgLTEyMi4yOTkxODk0NTRdLCBbMzcuODc3Mzg1OTg1LCAtMTIyLjMwMTg5MTA1N10sIFszNy44NTQ5MTE5MTEsIC0xMjIuMjc5MzgxNTE1XSwgWzM3Ljg2NDE5MTQ5NTAwMDEsIC0xMjIuMjU4NTY0NTI0XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg3NzMwOTI5LCAtMTIyLjI5NjAxODg3Nl0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg1NjM2NjQ2MiwgLTEyMi4yNTc5OTI4MTM5OTk5OV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NTYxODU5NTMwMDAxLCAtMTIyLjI1OTY3Mzg5ODk5OTk5XSwgWzM3Ljg1MzIxMDc0OTc0MjUsIC0xMjIuMjk3MTQ0NzI5NTYwMDJdLCBbMzcuODY2MzgzMTYxLCAtMTIyLjMwMjY4MDkyNzk5OTk5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1NjYzNDE5MzAwMDAwNSwgLTEyMi4yOTA1NDg3MTI5OTk5OV0sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODYxMzk1ODAyMDAwMTA0LCAtMTIyLjI1ODk0MzQ1N10sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg4MTU4MDY4NzAwMDEsIC0xMjIuMjk5NzUyNDkyOTk5OTldLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2OTY5NjA5MzAwMDEsIC0xMjIuMjg3NDk5NDc3OTk5OTldLCBbMzcuODY4MDUzOTc0MDAwMSwgLTEyMi4yNzgzMjk4NTEwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NjE5NjUxNjAwMDAxLCAtMTIyLjI5NDYwOTczNzk5OTk5XSwgWzM3Ljg2MzcwNzYwODg3MTYsIC0xMjIuMzEzNTkwNzkwNzU3XSwgWzM3Ljg3MDU4MjQ2LCAtMTIyLjI3Mjg5MzE5Mzk5OTk5XSwgWzM3Ljg3NDE0NTgxMTAwMDEsIC0xMjIuMjY2MjkwNTM3XSwgWzM3Ljg3MjMyOTYzMjAwMDEsIC0xMjIuMjY5MzEzMjQzXSwgWzM3Ljg0MzM1NDgyOTAwMDEsIC0xMjIuMjc3MDYyODE1XSwgWzM3Ljg1MzA2Mjc1ODAwMDEsIC0xMjIuMjg4MTg2NjhdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NjY4MjA0MjA3OTY3MSwgLTEyMi4zMDM3MTk4MDc5MDMwMV0sIFszNy44NzQwOTA2ODQwMDAxLCAtMTIyLjI5OTYyOTY1NV0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg1MzIwNDcwODAwMDEsIC0xMjIuMjgxMzg5NjZdLCBbMzcuODcyOTY0NTk0MDAwMSwgLTEyMi4zMDUyNDUzNTVdLCBbMzcuODQ2OTQzNTQsIC0xMjIuMjg0OTkwNzYxXSwgWzM3Ljg3NjczMDIxNjk5OTk5NSwgLTEyMi4zMDUyMTU3MjIwMDAwMV0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg3Njg4ODQ3NzAwMDEsIC0xMjIuMjY2NjU3MzM1XSwgWzM3Ljg0ODAzNTA0MywgLTEyMi4yODUzNDE3NzFdLCBbMzcuODcwNDE1MzU0LCAtMTIyLjI5MjU1MTUxMjk5OTk5XSwgWzM3Ljg1NDAyOTY3NSwgLTEyMi4yNzMyMTEyOV0sIFszNy44NjMwNDg3MDcwMDAxMDQsIC0xMjIuMjk4NDAzODA0XSwgWzM3Ljg2ODE0ODgzMzAwMDEsIC0xMjIuMjkxODEwNjc3OTk5OTldLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODY2MzYyMzg1MDAwMSwgLTEyMi4yNzAxMjQ0MDg5OTk5OV0sIFszNy44NjEwOTQzOTY5OTk5OTUsIC0xMjIuMjg5NTQ1OTUxMDAwMDFdLCBbMzcuODcxNDI2ODQsIC0xMjIuMzAzNTA4Mjk5OTk5OTldLCBbMzcuODcwODc2OTE0MDAwMSwgLTEyMi4yNzA2MTUwMzYwMDAwMV0sIFszNy44NzUyNjYwODQsIC0xMjIuMzAwMDA0NzA3OTk5OTldLCBbMzcuODY0MTkxNDk1MDAwMSwgLTEyMi4yNTg1NjQ1MjRdLCBbMzcuODc4MDg4MDMwNjIzNDk1LCAtMTIyLjMwNzYxMjQ1NjQzOV0sIFszNy44ODE0NDExMTEwMDAxLCAtMTIyLjI5MDAwNzQzMV0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODY3MTQ1NjU0MDAwMTA1LCAtMTIyLjI5NTEwNDA4MV0sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg0NzY1NDc3MDAwMDEsIC0xMjIuMjc5NTcxMTk1XSwgWzM3Ljg4MDI1MjYyODAwMDEsIC0xMjIuMjk2OTU2NTMxXSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg2Nzc2MjU1MDAwMDEsIC0xMjIuMjUyMDM2NDQyXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODYwNDY5NzQ5MDAwMSwgLTEyMi4yODA0OTUyODhdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44Njg0MDkzNDgwMDAxLCAtMTIyLjI2MTQ1Mzc3NF0sIFszNy44NjI5MTEwNDYwMDAxLCAtMTIyLjI3NTUxOTcwNV0sIFszNy44OTcwMDk5MjUwMDAxLCAtMTIyLjI2MTY5Mjk3NF0sIFszNy44NjM2NDExOTQsIC0xMjIuMzE3NjM5NzMyXSwgWzM3Ljg2ODYzODg1LCAtMTIyLjMxMzczMzE3MjAwMDAxXSwgWzM3Ljg3MjM0NzcwMzAwMDEsIC0xMjIuMjY2ODY0NTA2XSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODYzMDgzODgzMDAwMSwgLTEyMi4zMTcyNjgyNTJdLCBbMzcuODU4MDc0MzEwMDAwMSwgLTEyMi4yNDM4NTUwNTddLCBbMzcuODY2ODIwNDIwNzk2NzEsIC0xMjIuMzAzNzE5ODA3OTAzMDFdLCBbMzcuODU3ODI5MzgxLCAtMTIyLjI0NDExODA2XSwgWzM3Ljg2ODYzODg1LCAtMTIyLjMxMzczMzE3MjAwMDAxXSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODU0MDI5Njc1LCAtMTIyLjI3MzIxMTI5XSwgWzM3Ljg1ODA2NTM2NTAwMDEsIC0xMjIuMjQ1Mjk2MDQzXSwgWzM3Ljg3MTY1OTM5Nzk3MzcsIC0xMjIuMzAyMzYzMzk2MDI2XSwgWzM3Ljg2MTY0MDg0MiwgLTEyMi4yNTYxMzc3MzI5OTk5OV0sIFszNy44NjA5OTYyNDIwMDAxMDUsIC0xMjIuMjU2MTQzNjk4OTk5OTldLCBbMzcuODc4MDg4MDMwNjIzNDk1LCAtMTIyLjMwNzYxMjQ1NjQzOV0sIFszNy44NzgwODgwMzA2MjM0OTUsIC0xMjIuMzA3NjEyNDU2NDM5XSwgWzM3Ljg2MzY0ODY2MywgLTEyMi4yNjk3OTgwNjcwMDAwMV0sIFszNy44NjYzMTM0MzIsIC0xMjIuMjU2MzQ3MTAyXSwgWzM3Ljg2NjAzNDk2NDAwMDEsIC0xMjIuMjY1NjIyNzMyMDAwMDFdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODcyMzUzODMxMDAwMSwgLTEyMi4yNjkxMjI3MTddLCBbMzcuODU5MzQyNTEyMDAwMTA0LCAtMTIyLjI2NzQ4NjExMTAwMDAxXSwgWzM3Ljg1ODIxODYwOTAwMDEwNCwgLTEyMi4yNjkyMjUwODhdLCBbMzcuODczMDI1OTI2LCAtMTIyLjI2ODQ4NTIwODk5OTk5XSwgWzM3Ljg3MDMwMzczNDAwMDEsIC0xMjIuMjY4MDM1NTAzXSwgWzM3Ljg2ODc3NDQ4MiwgLTEyMi4yNzI3MDQ0NV0sIFszNy44NjY5MzAzNjksIC0xMjIuMjY1ODA4NjI1XSwgWzM3Ljg3Njc0MTA0MDAwMDEsIC0xMjIuMjY3NzkwNDQ1XSwgWzM3Ljg2MjE5NTk5NSwgLTEyMi4yODEwOTI3ODhdLCBbMzcuODY3NDU3OTk0MDAwMSwgLTEyMi4yNjcyODk3NjJdLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NzE0NjQyMDY5OTk5OTUsIC0xMjIuMjY1OTczNzI5XSwgWzM3Ljg1NzIwMjU1OSwgLTEyMi4yODgyOTg0MjEwMDAwMV0sIFszNy44NjYwMzQ5NjQwMDAxLCAtMTIyLjI2NTYyMjczMjAwMDAxXSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODUxMTgxMTMzMDAwMTA0LCAtMTIyLjI4OTIzNDA5OV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTcxNjg3MDAwMDEwNCwgLTEyMi4yODY2MDM0ODJdLCBbMzcuODUyMjI2MzEyLCAtMTIyLjI5MTQ5NTQ0Mjk5OTk5XSwgWzM3Ljg0Nzg0OTI5OCwgLTEyMi4yOTcxOTY3N10sIFszNy44Njg4Mzc5MjIwMDAxMDQsIC0xMjIuMjY4NjQzNjgyXSwgWzM3Ljg3MDQ1MTkzNjAwMDEsIC0xMjIuMjY4NzA5NDYxXSwgWzM3Ljg0OTA3MDA3MjAwMDEsIC0xMjIuMjc2MDE0Njg0XSwgWzM3Ljg2ODgzNzkyMjAwMDEwNCwgLTEyMi4yNjg2NDM2ODJdLCBbMzcuODU2MDIwOTkyLCAtMTIyLjI3OTYwNTU3NF0sIFszNy44NjMyODEzMzYyOTM2LCAtMTIyLjI3MjAyNjM0NzI4NV0sIFszNy44NjUxNzExNTUsIC0xMjIuMjcyMzA4MjQ3MDAwMDFdLCBbMzcuODU4ODU4MDY0MDAwMSwgLTEyMi4yNzE1OTYxODM5OTk5OV0sIFszNy44Njg5OTE2NjQwMDAxLCAtMTIyLjI1Njg5MjEzOV0sIFszNy44Njk2MDU4MTkwMDAxLCAtMTIyLjI3MzM2NjcwMl0sIFszNy44NDk2OTA1NTgwMDAxMDYsIC0xMjIuMjc4MTc3MjQzOTk5OTldLCBbMzcuODY5OTE5ODMwMDAwMSwgLTEyMi4yODMxNjk0MTVdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODU2MjA2MjA4MDAwMSwgLTEyMi4yODc5NzgyMDNdLCBbMzcuODcwMjExOTQxNjY3OSwgLTEyMi4yODQyNTA0ODkxMjNdLCBbMzcuODY3NTA1Nzk0MDAwMSwgLTEyMi4yNTQyNTEzNzVdLCBbMzcuODU4MjI3NjYzLCAtMTIyLjI1MzM1MTg0Nl0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODU0OTE4NzI5MDAwMTA0LCAtMTIyLjI4NzU2NDM2Nl0sIFszNy44NTc0OTczMDYsIC0xMjIuMjkwODI0MTc0XSwgWzM3Ljg1NzEyMjQ1OCwgLTEyMi4yNTk1NDU0MDldLCBbMzcuODY1NzIwNzcxLCAtMTIyLjI1MzkwMjUyMV0sIFszNy44NzAyMjM5ODI3ODQ3OSwgLTEyMi4yNzMxNzE2OTE2NjJdLCBbMzcuODcxNzQ0NTk4MDAwMSwgLTEyMi4yNjkwMTE0NjIwMDAwMV0sIFszNy44NTQ0NTM2NDQsIC0xMjIuMjY5OTkwOTg5XSwgWzM3Ljg2NjEwMzEzOCwgLTEyMi4yNzkyODI2OF0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NTMyMTgyMTAwMDAxLCAtMTIyLjI4MDgxMzE4OF0sIFszNy44NjQxOTE0OTUwMDAxLCAtMTIyLjI1ODU2NDUyNF0sIFszNy44NTg0MjA4NzYsIC0xMjIuMjY3NzMzMjYzXSwgWzM3Ljg3NDE0NTgxMTAwMDEsIC0xMjIuMjY2MjkwNTM3XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODYwNjY3NDQsIC0xMjIuMjY0NDk1NDY3XSwgWzM3Ljg3ODA4ODAzMDYyMzQ5NSwgLTEyMi4zMDc2MTI0NTY0MzldLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44NzAzMTUwNjgwMDAwMDQsIC0xMjIuMzAxMjA3OTcyMDAwMDFdLCBbMzcuODY1MDE0MTcxOTk5OTk1LCAtMTIyLjI2Nzk0NzEwM10sIFszNy44NTc2NjEyNjgwMDAxLCAtMTIyLjI1OTQ2OTg1MV0sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg3MTQ1NjQ5NTAwMDEsIC0xMjIuMjk0MTI3MjkxMDAwMDFdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODU0ODY2Mzg1LCAtMTIyLjI1MjgyNjYxNjAwMDAxXSwgWzM3Ljg4MjI2MDI3MywgLTEyMi4yOTYzODY1NjFdLCBbMzcuODY2NzA5OTI1MDAwMSwgLTEyMi4yOTcyNDg2OF0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NjMzNzE1OTMwMDAxLCAtMTIyLjI4NjE4NDY3NzAwMDAxXSwgWzM3Ljg3Mjk2NDU5NDAwMDEsIC0xMjIuMzA1MjQ1MzU1XSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODYzNzQ4MzIyLCAtMTIyLjI4MzI1MDQ2N10sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44ODIyNjAyNzMsIC0xMjIuMjk2Mzg2NTYxXSwgWzM3Ljg0Njk0MzU0LCAtMTIyLjI4NDk5MDc2MV0sIFszNy44NTE5Mzk0NjQwMDAxMDQsIC0xMjIuMjgzNTAzNTk3XSwgWzM3Ljg3NzU0OTM3NDAwMDEwNCwgLTEyMi4yOTQ4NjIwNTZdLCBbMzcuODY4NjQzNjYxMDAwMSwgLTEyMi4yOTQ0MDU3NTRdLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44Njc4NjY3NTEwMDAxLCAtMTIyLjI5ODg0NzUyOV0sIFszNy44NzA2MDg1NDUsIC0xMjIuMjk0NjU5MTg1XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODQ3NzM2NTc5MDAwMSwgLTEyMi4yNzE5NTg4NzI5OTk5OV0sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg1NjAyMDk5MiwgLTEyMi4yNzk2MDU1NzRdLCBbMzcuODc1MjA0OTc4MDAwMSwgLTEyMi4yOTQwOTQ5NDFdLCBbMzcuODU2MzY2NDYyLCAtMTIyLjI1Nzk5MjgxMzk5OTk5XSwgWzM3Ljg3MDQxNTM1NCwgLTEyMi4yOTI1NTE1MTI5OTk5OV0sIFszNy44NTQwMjk2NzUsIC0xMjIuMjczMjExMjldLCBbMzcuODY3ODQzMTUyLCAtMTIyLjI5NTg3MzA3NF0sIFszNy44Njc4NDMxNTIsIC0xMjIuMjk1ODczMDc0XSwgWzM3Ljg2OTk3Njk2NzAwMDEwNiwgLTEyMi4yOTQ4Mjk1NjNdLCBbMzcuODY5NzUzMzYzLCAtMTIyLjMwMDIzNTEzNl0sIFszNy44NTgwNzQzMTAwMDAxLCAtMTIyLjI0Mzg1NTA1N10sIFszNy44NzQxOTYwMDQwMDAxLCAtMTIyLjI3MzI5NDg5MV0sIFszNy44OTE0NjM1MTkwMDAxLCAtMTIyLjI3NzA5MDYyOV0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NzA1ODI0NiwgLTEyMi4yNzI4OTMxOTM5OTk5OV0sIFszNy44NTAxMDQyNzUsIC0xMjIuMjg1OTk4OTgxXSwgWzM3Ljg3ODc0MDUwNTAwMDEsIC0xMjIuMjk1MjQyNjI2XSwgWzM3Ljg4MjAzNTI0NywgLTEyMi4yOTc1NDU1NDNdLCBbMzcuODY0Mzg5NzM3MDAwMSwgLTEyMi4yOTkxNTg5NjYwMDAwMV0sIFszNy44ODA0Njk1MTAwMDAxLCAtMTIyLjI5NTA5MjIxNl0sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg2OTc4MjYzNSwgLTEyMi4zMDExMjQ0MDIwMDAwMV0sIFszNy44NjY0NTMwODIxNDg2LCAtMTIyLjMxMjQxOTgxNTYzN10sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NjkzOTE5NywgLTEyMi4yNjc5MzIzNDNdLCBbMzcuODY4NjQzNjYxMDAwMSwgLTEyMi4yOTQ0MDU3NTRdLCBbMzcuODY4ODM3OTIyMDAwMTA0LCAtMTIyLjI2ODY0MzY4Ml0sIFszNy44Njg4Mzc5MjIwMDAxMDQsIC0xMjIuMjY4NjQzNjgyXSwgWzM3Ljg2MzA4Mzg4MzAwMDEsIC0xMjIuMzE3MjY4MjUyXSwgWzM3Ljg1Nzk5ODM4MzAwMDEsIC0xMjIuMjgwNjM3NDRdLCBbMzcuODY5NjA1ODE5MDAwMSwgLTEyMi4yNzMzNjY3MDJdLCBbMzcuODgxODY4NDU3NzE0NCwgLTEyMi4zMDY3NTI5MTcwOV0sIFszNy44NDY2NDg4MzQwMDAxLCAtMTIyLjI3MzIyNTQyNzk5OTk5XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44NzQxNDg4NzMsIC0xMjIuMzA1NTc3Mzg3OTk5OTldLCBbMzcuODY5MzkxOTcsIC0xMjIuMjY3OTMyMzQzXSwgWzM3Ljg2NTgwOTY1MjAwMDEsIC0xMjIuMzAxNzA4NjE3XSwgWzM3Ljg2MDYyNTk3OCwgLTEyMi4yNzE4MDEyNF0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2MDQ2MTMwNTAwMDEsIC0xMjIuMjU5MDc1NDY3XSwgWzM3Ljg2OTA4ODU1NjAwMDEsIC0xMjIuMjk5MjM4MDIyMDAwMDFdLCBbMzcuODY4NjM4ODUsIC0xMjIuMzEzNzMzMTcyMDAwMDFdLCBbMzcuODQ2MDE1MTE2LCAtMTIyLjI3MTEyMzEyNF0sIFszNy44NTEwMjg2MjksIC0xMjIuMjYwMzcwNjM5XSwgWzM3Ljg1NTY5MzU3LCAtMTIyLjI2MzQ5Mzc2Nzk5OTk5XSwgWzM3Ljg1OTU5OTUwOCwgLTEyMi4yODAzMjU0MjldLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NjA2NTQzMzEsIC0xMjIuMjUzMzk0NzA3OTk5OTldLCBbMzcuODQ2MDQxOTg3LCAtMTIyLjI4NDY5MjQ0Nzk5OTk5XSwgWzM3Ljg1ODU5NTc2NzAwMDEwNCwgLTEyMi4yNTkzMzc4MzZdLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NTYxMzUyODYsIC0xMjIuMjQ2ODU5ODMyMDAwMDFdLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODU4MDY1MzY1MDAwMSwgLTEyMi4yNDUyOTYwNDNdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44OTQ4Mjc1MSwgLTEyMi4yNjg1NDU3MTNdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg2MzI1ODM4ODAwMDEwNSwgLTEyMi4yNTg2OTQ4NThdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg3ODA3NzQ1MDA5NzEsIC0xMjIuMzA4MDI4MTYzMDc1MDFdLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODQ3MjA1Njg2MDAwMSwgLTEyMi4yNzE2NzQ3NjNdLCBbMzcuODY0NjU2Mzg3OTY5NSwgLTEyMi4zMTMwNDA4OTUxMzkwMV0sIFszNy44NzMzNjcxMDUwMDAxLCAtMTIyLjI2NjE4MjA2Mjk5OTk5XSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NTAxODM0NTEwMDAxLCAtMTIyLjI2MDQ5NTA0Mjk5OTk5XSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg3MjAxMDEzMzAwMDEsIC0xMjIuMjczNTA4NDkyXSwgWzM3Ljg2Mzk3MTQ4ODAwMDEwNCwgLTEyMi4yNjczNjMxNV0sIFszNy44NzkxMjgzMDMwMDAxLCAtMTIyLjMwMjQ2NTMzOV0sIFszNy44Njc1MTMxNjEsIC0xMjIuMjYxMjczMTA1XSwgWzM3Ljg2OTI5MzQ4NjAwMDA5NiwgLTEyMi4yNTQ2MDU0ODI5OTk5OV0sIFszNy44NTk1MzQ4MjAwMDAxLCAtMTIyLjI5NzI3OTI2OV0sIFszNy44NTYxODU5NTMwMDAxLCAtMTIyLjI1OTY3Mzg5ODk5OTk5XSwgWzM3Ljg2MTM0MzQ2NDAwMDEsIC0xMjIuMjgwNzUxODVdLCBbMzcuODU4MDc0MzEwMDAwMSwgLTEyMi4yNDM4NTUwNTddLCBbMzcuODY0MTU4MjcxMDAwMSwgLTEyMi4yOTI5NTEyMTJdLCBbMzcuODUzMjM4NTYyMDAwMSwgLTEyMi4yNzk5NjQ5NDcwMDAwMV0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODY5MTQ4MTI3MDAwMSwgLTEyMi4yODQwOTQwNjg5OTk5OV0sIFszNy44NjEzOTU4MDIwMDAxMDQsIC0xMjIuMjU4OTQzNDU3XSwgWzM3Ljg2MTM5NTgwMjAwMDEwNCwgLTEyMi4yNTg5NDM0NTddLCBbMzcuODUxODQyNDA0LCAtMTIyLjI4OTQ2MTM3Nl0sIFszNy44NjEzOTU4MDIwMDAxMDQsIC0xMjIuMjU4OTQzNDU3XSwgWzM3Ljg2MzM1MzY2ODAwMDEsIC0xMjIuMjcyMTEyMzg0XSwgWzM3Ljg1NjAyMDk5MiwgLTEyMi4yNzk2MDU1NzRdLCBbMzcuODcwMzUxODkxMzk5Mzk1LCAtMTIyLjMwMDY0NzI1Mjc4OV0sIFszNy44NzYwMjAyOTcsIC0xMjIuMjYwMzI2Mzc2MDAwMDFdLCBbMzcuODY0NjE2NTYxOTk5OTk1LCAtMTIyLjI5MDY3MjA3MV0sIFszNy44NDY3NzE3ODgwMDAxMDUsIC0xMjIuMjc5MzczMDM4OTk5OTldLCBbMzcuODQ4MDM1MDQzLCAtMTIyLjI4NTM0MTc3MV0sIFszNy44NTQxNTkxNDIwMDAxLCAtMTIyLjI4ODU2ODAyNjAwMDAxXSwgWzM3Ljg2NzQ5NTA4NzQ2OTYsIC0xMjIuMjk5ODY3NTcwMTQyXSwgWzM3Ljg2NjI0MDU2OTkwNTUsIC0xMjIuMjk4NDMwMTcxMTY4OTldLCBbMzcuODY1NzIyMzA1MDAwMSwgLTEyMi4zMDIxMDc4OTNdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY2MTM5NDI1LCAtMTIyLjI5ODkzMTg5Mzk5OTk5XSwgWzM3Ljg0ODE0NDkxOSwgLTEyMi4yNzU4NDM1ODFdLCBbMzcuODc1NTQzMTg3MDAwMTA1LCAtMTIyLjI5MTQ0ODcyOV0sIFszNy44NzU1NDMxODcwMDAxMDUsIC0xMjIuMjkxNDQ4NzI5XSwgWzM3Ljg1NjA4MDczMjAwMDEsIC0xMjIuMjUyOTQ3MTE3XSwgWzM3Ljg3MDY4NDMyNTAwMDEsIC0xMjIuMjc5NzY4NTIzOTk5OTldLCBbMzcuODU4NzEyNzkzMDAwMSwgLTEyMi4yODAxNTUxODFdLCBbMzcuODU3ODE1OTEyLCAtMTIyLjI3OTk3NjAyMjAwMDAxXSwgWzM3Ljg2MzY1NDM4MzAwMDAwNCwgLTEyMi4yOTAzNjMwMDRdLCBbMzcuODcyMTQ5NzgyMDAwMSwgLTEyMi4yODIxMzIyMzg5OTk5OV0sIFszNy44NjQ2NDU0NzYwMDAxLCAtMTIyLjI2NDI1ODEyMV0sIFszNy44OTUzNTU0NTMsIC0xMjIuMjczNTgzNjkxXSwgWzM3Ljg1NjU1NjQxNiwgLTEyMi4yNTY3OTM0MDI5OTk5OV0sIFszNy44NTg1MTgwNCwgLTEyMi4yODg3MjE2MDVdLCBbMzcuODU2MDgwNzMyMDAwMSwgLTEyMi4yNTI5NDcxMTddLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NzgxMjQ1MTMsIC0xMjIuMjcxNDIzOTQ5XSwgWzM3Ljg2MTA5NDM5Njk5OTk5NSwgLTEyMi4yODk1NDU5NTEwMDAwMV0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NzY5NDgwNTcwMDAxMSwgLTEyMi4yODA0NzE1NDddLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODY1ODA5NjUyMDAwMSwgLTEyMi4zMDE3MDg2MTddLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODY1ODA5NjUyMDAwMSwgLTEyMi4zMDE3MDg2MTddLCBbMzcuODc2Njg5OTk3LCAtMTIyLjI4MjY0Njc3Ml0sIFszNy44NjYyNDExNjUwMDAxLCAtMTIyLjI2MTkxMzkxMjk5OTk5XSwgWzM3Ljg3NDc0OTMxNCwgLTEyMi4yOTYzNzc5MTldLCBbMzcuODcyMzg5NTExMDAwMSwgLTEyMi4yNjg3Mjc3MjVdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NTM2OTQ5OTUwMDAxLCAtMTIyLjI2MDAxNjY2OV0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg2MzY0ODY2MywgLTEyMi4yNjk3OTgwNjcwMDAwMV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MzM2NzEwNTAwMDEsIC0xMjIuMjY2MTgyMDYyOTk5OTldLCBbMzcuODU2MjA2MjA4MDAwMSwgLTEyMi4yODc5NzgyMDNdLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg1MzQ4MDExNTE3OTksIC0xMjIuMjc2ODMzMDUxMzc0XSwgWzM3Ljg2ODY0MzY2MTAwMDEsIC0xMjIuMjk0NDA1NzU0XSwgWzM3Ljg2OTM5MTk3LCAtMTIyLjI2NzkzMjM0M10sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTU0NTE2MDMwOTYzLCAtMTIyLjI5MTQ1MjIyNjA1ODAxXSwgWzM3Ljg2NjAxNDU4MiwgLTEyMi4yNTg2MTY0MDI5OTk5OV0sIFszNy44NTU4MTEzNjEwMDAxLCAtMTIyLjI4MTI1NjUwOF0sIFszNy44NTQ5MTg3MjkwMDAxMDQsIC0xMjIuMjg3NTY0MzY2XSwgWzM3Ljg2MTUzMDMxNiwgLTEyMi4yNzE4OTU1OTJdLCBbMzcuODYwMjQ2MzAxMDAwMDk2LCAtMTIyLjI4OTI3NjA0Nl0sIFszNy44NDY1MDAzODEwMDAxLCAtMTIyLjI3Mjk3NDc4NzAwMDAxXSwgWzM3Ljg1MzYxMjExMjAwMDEsIC0xMjIuMjg3MTQ0ODkyXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODc1MjA0OTc4MDAwMSwgLTEyMi4yOTQwOTQ5NDFdLCBbMzcuODY5NjI4MTk5LCAtMTIyLjI4ODA4OTQ0N10sIFszNy44NTM0ODAxMTUxNzk5LCAtMTIyLjI3NjgzMzA1MTM3NF0sIFszNy44Njk1MzA0NzUsIC0xMjIuMjk3MDUwMjEyOTk5OTldLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg2NjM4MTc4MSwgLTEyMi4yOTEyMzQ0MTIwMDAwMV0sIFszNy44Njc4NjY3NTEwMDAxLCAtMTIyLjI5ODg0NzUyOV0sIFszNy44NTg1MTgwNCwgLTEyMi4yODg3MjE2MDVdLCBbMzcuODUyOTE5NzUwMTkyNCwgLTEyMi4yNjk5NjQxMjI4ODYwMV0sIFszNy44NjkzMTQ3NjMsIC0xMjIuMjk4MDkzMTQyOTk5OTldLCBbMzcuODQ3MDM4MTM0MDAwMSwgLTEyMi4yNzc0MTI1Njc5OTk5OV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NjY5MTgwMjgsIC0xMjIuMjk2MjA5MDUzXSwgWzM3Ljg2NjcwOTkyNTAwMDEsIC0xMjIuMjk3MjQ4NjhdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUzMDYyNzU4MDAwMSwgLTEyMi4yODgxODY2OF0sIFszNy44NTMwMDg3MDgwMDAxMDQsIC0xMjIuMjg2OTUwMjE4OTk5OTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTA5NzA4OSwgLTEyMi4yODYyOTQ5MjFdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUxMTgxMTMzMDAwMTA0LCAtMTIyLjI4OTIzNDA5OV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUwNDM2NzA5MDAwMSwgLTEyMi4yOTE4MTYyNTVdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTM0ODMxMTUwMDAxLCAtMTIyLjI5MTg5Mjk5Ml0sIFszNy44NTMxMDA5MTc3MzYzLCAtMTIyLjI5MzM1OTAyNDU1N10sIFszNy44NTU4MDk3OTcwMDAxMDYsIC0xMjIuMjU1MDA1NDUzXSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg0NjAxNTExNiwgLTEyMi4yNzExMjMxMjRdLCBbMzcuODUxMTAwOTI1LCAtMTIyLjI3ODUwMzc1OV0sIFszNy44NTk1Mzc4MTgsIC0xMjIuMjU5MjA2MDA3OTk5OTldLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTQ3NTU1MDksIC0xMjIuMjgwMzI2OTc3OTk5OTldLCBbMzcuODU0NTYwNDcyNjYzNywgLTEyMi4yODEyNDcxMTU3NzYwMV0sIFszNy44NjYzMTM0MzIsIC0xMjIuMjU2MzQ3MTAyXSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg1NjEzMzE2OSwgLTEyMi4yNzEyODE2ODIwMDAwMV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NjY2ODY3ODMsIC0xMjIuMjY3Njc3MzE0XSwgWzM3Ljg2OTM5MTk3LCAtMTIyLjI2NzkzMjM0M10sIFszNy44NzExNzAxMTcwMDAxMDUsIC0xMjIuMjY4Mjc5NjQ1XSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODU5NzY1NzUyLCAtMTIyLjI3MTY5NTgxNV0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg3MTQ2NDIwNjk5OTk5NSwgLTEyMi4yNjU5NzM3MjldLCBbMzcuODY1MTcxMTU1LCAtMTIyLjI3MjMwODI0NzAwMDAxXSwgWzM3Ljg2NjM4MTc4MSwgLTEyMi4yOTEyMzQ0MTIwMDAwMV0sIFszNy44NTExODQ2NzAwMDAxLCAtMTIyLjI3Mzk0MzUxMl0sIFszNy44NjgyMDIwMTAwMDAxLCAtMTIyLjI5NjYyNDc1Mzk5OTk5XSwgWzM3Ljg2NjYwODgzNjAwMDEsIC0xMjIuMjU0MDc1OTddLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NTA4MDcwMDEwMDAxLCAtMTIyLjI5MTAzNjgxOV0sIFszNy44Njk2OTE4NTUsIC0xMjIuMjcyNzk5MTRdLCBbMzcuODcyNTgzOTc4MDAwMSwgLTEyMi4yNjc0NDM3MTFdLCBbMzcuODY3NjYyMTg0MDAwMDA0LCAtMTIyLjI5OTg5MTczMl0sIFszNy44NTQ5MTg3MjkwMDAxMDQsIC0xMjIuMjg3NTY0MzY2XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODUzMDgyNTU0MDEwMjksIC0xMjIuMjk2ODM3NzYwMTQ2XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODU4NjA5MDY0MDAwMSwgLTEyMi4yNTExMDEzOTc5OTk5OV0sIFszNy44Nzg5MjU5ODYwMDAxLCAtMTIyLjMwMzUyNzc3NV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NTIyMjYzMTIsIC0xMjIuMjkxNDk1NDQyOTk5OTldLCBbMzcuODcyNTgzOTc4MDAwMSwgLTEyMi4yNjc0NDM3MTFdLCBbMzcuODYyMTEwNzIyMDAwMTA0LCAtMTIyLjI1MzUzOTk5NV0sIFszNy44Njc4NjY3NTEwMDAxLCAtMTIyLjI5ODg0NzUyOV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODY4MjkwNTA4LCAtMTIyLjI5ODI0ODQ3Nzk5OTk5XSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODc0MzY2NjM2LCAtMTIyLjMwNDQ0OTU1MjAwMDAxXSwgWzM3Ljg3ODMwMjMzODAwMDAwNSwgLTEyMi4zMDY1NjU1MzVdLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg4MDQ3NDE5NSwgLTEyMi4yOTU3OTkyMTVdLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODcwMzUxODkxMzk5Mzk1LCAtMTIyLjMwMDY0NzI1Mjc4OV0sIFszNy44NzgwMjY1MjY5OTk5OTYsIC0xMjIuMjU4ODcxNzUzXSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44NjkzMzc5ODEwMDAxLCAtMTIyLjMwMDE1MTY2M10sIFszNy44ODMwMTY4MjMsIC0xMjIuMjY1MDc1NzA4XSwgWzM3Ljg3ODQxNjEyNiwgLTEyMi4yNjkxMDM4OThdLCBbMzcuODU2ODU4MDc4MDAwMSwgLTEyMi4yNzI5ODk2MDg5OTk5OV0sIFszNy44OTIxNDI4MzgwMDAwMDUsIC0xMjIuMjcyOTY4MzA3MDAwMDFdLCBbMzcuODk1MzU1NDUzLCAtMTIyLjI3MzU4MzY5MV0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NjIxNTU1OTYsIC0xMjIuMjY3MTUxODUzOTk5OTldLCBbMzcuODY0ODk5MjEyMDAwMTA0LCAtMTIyLjI4ODYwNjk2XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg1NDE3MTU0NDAwMDEsIC0xMjIuMjY5MTc4MTU0XSwgWzM3Ljg1MjY4NTA1MjcxMSwgLTEyMi4yODM2MjU3NTIwOV0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg3MjQ0NzQ2OTAwMDEsIC0xMjIuMjczMDc5ODM1XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODY5NjkxODU1LCAtMTIyLjI3Mjc5OTE0XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODYyODU0ODMzLCAtMTIyLjI5MDEwNjM4NzAwMDAxXSwgWzM3Ljg3MzMwMDY2MzAwMDEsIC0xMjIuMjczMTk1NTE4XSwgWzM3Ljg1MDE5MTQ1MDAwMDEsIC0xMjIuMjk0NTEyOTk2MDAwMDFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODY2NDQ0MTExMDAwMSwgLTEyMi4zMDU1NTY1Njg5OTk5OV0sIFszNy44NjgzMTkwNjIwMDAxMDQsIC0xMjIuMjY3MTcwODI3XSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg3MjE5Nzc4MjAwMDEsIC0xMjIuMjcwMzIwMzA1XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44NjMzNjQzNjIsIC0xMjIuMjU3NjE5ODQ1XSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44ODE0NzU2NTMwMDAxLCAtMTIyLjI2OTAwNjA1NF0sIFszNy44NzQwOTA2ODQwMDAxLCAtMTIyLjI5OTYyOTY1NV0sIFszNy44NTI5NTgwNSwgLTEyMi4yNjAxMTY5NzJdLCBbMzcuODU2MTg1OTUzMDAwMSwgLTEyMi4yNTk2NzM4OTg5OTk5OV0sIFszNy44NzI5NjQ1OTQwMDAxLCAtMTIyLjMwNTI0NTM1NV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODQ5NTAzNjE1MDAwMSwgLTEyMi4yNjU3MzY1NDVdLCBbMzcuODcwNzUwMTM2LCAtMTIyLjI3NzEyMTA5Ml0sIFszNy44NzkwOTEyMjEwMDAxLCAtMTIyLjI5MzQ5MjM5NzAwMDAxXSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg3NjIxMjEwMzAwMDEsIC0xMjIuMjg2NjQxMTc5XSwgWzM3Ljg1NTIzMzk1OSwgLTEyMi4yNzcyNDEzNTZdLCBbMzcuODUwNDc2ODM2LCAtMTIyLjI5NjEzMzIwMjAwMDAxXSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg1NzIzNzA2ODAwMDEsIC0xMjIuMjg1MjAyMDY2MDAwMDFdLCBbMzcuODY4MTMwMDc4LCAtMTIyLjMwMzUwMjY0Nl0sIFszNy44NTQwMjk2NzUsIC0xMjIuMjczMjExMjldLCBbMzcuODU1MjMzOTU5LCAtMTIyLjI3NzI0MTM1Nl0sIFszNy44ODA0NzQxOTUsIC0xMjIuMjk1Nzk5MjE1XSwgWzM3Ljg2MTM5NTgwMjAwMDEwNCwgLTEyMi4yNTg5NDM0NTddLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44ODA3MDI1NjEwMDAxLCAtMTIyLjMwNDEwNjRdLCBbMzcuODU4NTE4MDQsIC0xMjIuMjg4NzIxNjA1XSwgWzM3Ljg2NjQ2NjcxMTE5MTIsIC0xMjIuMzEyMDY4ODk2MzQ3MDFdLCBbMzcuODUzOTAxMTA1LCAtMTIyLjI4NTQyODM4MV0sIFszNy44NjU5NjQ2MzMwMDAwMDQsIC0xMjIuMzExNjM3NDE3MDAwMDFdLCBbMzcuODQ4ODIyNzk5MDAwMTA0LCAtMTIyLjI3Nzk3OTc3ODk5OTk5XSwgWzM3Ljg2MTc0Mzk5ODAwMDEsIC0xMjIuMjk1NjUwNzAyOTk5OTldLCBbMzcuODUzMjA0NzA4MDAwMSwgLTEyMi4yODEzODk2Nl0sIFszNy44NjY0NjY3MTExOTEyLCAtMTIyLjMxMjA2ODg5NjM0NzAxXSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODY2NDQ0MTExMDAwMSwgLTEyMi4zMDU1NTY1Njg5OTk5OV0sIFszNy44ODA0NzQxOTUsIC0xMjIuMjk1Nzk5MjE1XSwgWzM3Ljg2NjE1MDkzNywgLTEyMi4yOTI0MTcyNzYwMDAwMV0sIFszNy44NjkzMTQ3NjMsIC0xMjIuMjk4MDkzMTQyOTk5OTldLCBbMzcuODUwNjA4OTA0MDAwMTA0LCAtMTIyLjI3ODM4OTc2OV0sIFszNy44NTg3NjkyNDYwMDAxLCAtMTIyLjI4Njc4MDYzNF0sIFszNy44NTU4MjY0NDUsIC0xMjIuMjYyNDU5MzU3OTk5OTldLCBbMzcuODUyNTkwNzkwMDAwMSwgLTEyMi4yODk2OTU5Mjc5OTk5OV0sIFszNy44NjMzNjQzNjIsIC0xMjIuMjU3NjE5ODQ1XSwgWzM3Ljg2OTUzMDQ3NSwgLTEyMi4yOTcwNTAyMTI5OTk5OV0sIFszNy44NzE2ODU2NDMsIC0xMjIuMjkyOTY1MDk5OTk5OTldLCBbMzcuODYzMjU4Mzg4MDAwMTA1LCAtMTIyLjI1ODY5NDg1OF0sIFszNy44NDYyMDQ0MzUwMDAxMDQsIC0xMjIuMjc2NzEzMjYyXSwgWzM3Ljg4MDg1NDk0NTAwMDEsIC0xMjIuMjYwMzA0MjRdLCBbMzcuODgxODc3NzM1LCAtMTIyLjI3MDcwNzg1Mjk5OTk5XSwgWzM3Ljg3MDU1OTE2LCAtMTIyLjI5ODQ5MjM0XSwgWzM3Ljg1MzIwNDcwODAwMDEsIC0xMjIuMjgxMzg5NjZdLCBbMzcuODUyMjI2MzEyLCAtMTIyLjI5MTQ5NTQ0Mjk5OTk5XSwgWzM3Ljg0ODg1OTMwMDAwMDEsIC0xMjIuMjkyMTU0MzQxXSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MTE4MTEzMzAwMDEwNCwgLTEyMi4yODkyMzQwOTldLCBbMzcuODU5MjgxNDUsIC0xMjIuMzE1ODQ5MTRdLCBbMzcuODUzMjA0NzA4MDAwMSwgLTEyMi4yODEzODk2Nl0sIFszNy44NjM2NDExOTQsIC0xMjIuMzE3NjM5NzMyXSwgWzM3Ljg2ODgzNzkyMjAwMDEwNCwgLTEyMi4yNjg2NDM2ODJdLCBbMzcuODY4ODM3OTIyMDAwMTA0LCAtMTIyLjI2ODY0MzY4Ml0sIFszNy44NTc4MTU5MTIsIC0xMjIuMjc5OTc2MDIyMDAwMDFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODkxNDMwNTM2LCAtMTIyLjI3ODE4NjgzN10sIFszNy44NTc0NjkzNjQwMDAxLCAtMTIyLjI4MzQxODI3OF0sIFszNy44NjUxODI3NDMwMDAwMDUsIC0xMjIuMjY3OTY5OTQxXSwgWzM3Ljg1MDUzMjM2NSwgLTEyMi4yODYxNTEwNDldLCBbMzcuODQ4NzQ5OTQwMDAwMSwgLTEyMi4yNzEzOTYyNTVdLCBbMzcuODQ3NzM2NTc5MDAwMSwgLTEyMi4yNzE5NTg4NzI5OTk5OV0sIFszNy44NjgyMDIwMTAwMDAxLCAtMTIyLjI5NjYyNDc1Mzk5OTk5XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg1MDk3MDg5LCAtMTIyLjI4NjI5NDkyMV0sIFszNy44NDE0MzAzMzIwMDAxLCAtMTIyLjI3NjY3MzEyNF0sIFszNy44NDM5ODMwNTgsIC0xMjIuMjYxMzcwNzkyMDAwMDFdLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NTA2ODIzMzIwMDAxMDUsIC0xMjIuMjcwNjc1MjQ3OTk5OTldLCBbMzcuODY3ODY2NzUxMDAwMSwgLTEyMi4yOTg4NDc1MjldLCBbMzcuODcwNTU5MTYsIC0xMjIuMjk4NDkyMzRdLCBbMzcuODY2NzA5OTI1MDAwMSwgLTEyMi4yOTcyNDg2OF0sIFszNy44NjkzMzI5MjkwMDAxLCAtMTIyLjI1MDkzMTgzXSwgWzM3Ljg2NDQ5NjkzNSwgLTEyMi4yOTAzMDI0NV0sIFszNy44Njc3Mjc1MjAwMDAxLCAtMTIyLjI1NzM5MTQ1M10sIFszNy44ODAyNTI2MjgwMDAxLCAtMTIyLjI5Njk1NjUzMV0sIFszNy44NTM2OTQ5OTUwMDAxLCAtMTIyLjI2MDAxNjY2OV0sIFszNy44NzMwMTEzMSwgLTEyMi4yNzU0NTEzNDddLCBbMzcuODU5OTgxMDA4MDAwMDA1LCAtMTIyLjI1MzMyNjgyNzAwMDAxXSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODcxODg0NDEzMDAwMDA0LCAtMTIyLjMwMTI0NDU4NV0sIFszNy44Njc1MDU3OTQwMDAxLCAtMTIyLjI1NDI1MTM3NV0sIFszNy44NTIwMzA2MDQsIC0xMjIuMjYwMjM3NTk2MDAwMDFdLCBbMzcuODU2MTMzMTY5LCAtMTIyLjI3MTI4MTY4MjAwMDAxXSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NzgwODgwMzA2MjM0OTUsIC0xMjIuMzA3NjEyNDU2NDM5XSwgWzM3Ljg3MDQxNTM1NCwgLTEyMi4yOTI1NTE1MTI5OTk5OV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODc1ODkxMzQ4LCAtMTIyLjI4ODc3NjczN10sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44Njk2NjEzOCwgLTEyMi4yODUxOTMxMThdLCBbMzcuODcwODQwNjc0MDAwMSwgLTEyMi4yNzg1NTI1NzNdLCBbMzcuODgwMjE1MDA1MzEzLCAtMTIyLjMwNjIyMTA4ODk3OF0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NjU0MjY3NTEsIC0xMjIuMjYzMTc0MjUzOTk5OTldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44NzI1ODM5NzgwMDAxLCAtMTIyLjI2NzQ0MzcxMV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODcwOTc0NjA2MDAwMSwgLTEyMi4yNzc1MDI0MThdLCBbMzcuODU3NjYxMjY4MDAwMSwgLTEyMi4yNTk0Njk4NTFdLCBbMzcuODY1NDY3MjY2MDAwMSwgLTEyMi4yOTU3NDI1NTVdLCBbMzcuODY4NjA4Mjg2MDk4NSwgLTEyMi4zMDEzMjg4OTg4NjddLCBbMzcuODc0MzY2NjM2LCAtMTIyLjMwNDQ0OTU1MjAwMDAxXSwgWzM3Ljg3NzYyNDg2LCAtMTIyLjMwMDcyNzI5NzAwMDAxXSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg3MDExMjY1NzAwMDExLCAtMTIyLjI4NDI0ODkzMzk5OTk5XSwgWzM3Ljg2NDE5MTQ5NTAwMDEsIC0xMjIuMjU4NTY0NTI0XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg4MTAyMDgyNTAwMDEsIC0xMjIuMzA3MDM2NzU4XSwgWzM3Ljg2ODQ2NTY4MjAwMDEsIC0xMjIuMjg5MzQ3ODI3OTk5OTldLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44Njc2ODYyMjMwMDAxLCAtMTIyLjI5MTI5Nzk1Nzk5OTk5XSwgWzM3Ljg4ODIxMTY5MSwgLTEyMi4yNjY4MTc5MDI5OTk5OV0sIFszNy44ODI0NjY1MzYsIC0xMjIuMjY2MTQ5MDYxMDAwMDFdLCBbMzcuODc2NDQwMzg5LCAtMTIyLjI4ODM2MDg4Nzk5OTk5XSwgWzM3Ljg3NTI2NjA4NCwgLTEyMi4zMDAwMDQ3MDc5OTk5OV0sIFszNy44NTgyODcxMTgwMDAxLCAtMTIyLjI2MTcwNzEyNzAwMDAxXSwgWzM3Ljg1NDQ0MDIwOCwgLTEyMi4yNTk5MTQ4Mjc5OTk5OV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU3NDYzNzUyMDAwMSwgLTEyMi4yNjgwOTE1NDg5OTk5OV0sIFszNy44NzMzMDA2NjMwMDAxLCAtMTIyLjI3MzE5NTUxOF0sIFszNy44Njk2OTE4NTUsIC0xMjIuMjcyNzk5MTRdLCBbMzcuODU5OTc4NDU2MDAwMSwgLTEyMi4yNTEyMzI0NTIwMDAwMV0sIFszNy44Njc4MTgyNzYsIC0xMjIuMjY4NTUwNTM3MDAwMDFdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44NjIxOTU5OTUsIC0xMjIuMjgxMDkyNzg4XSwgWzM3Ljg2NTM3OTkyNjAwMDEsIC0xMjIuMjU2NTA1MTY1XSwgWzM3Ljg2OTQzNjgwMTAwMDEsIC0xMjIuMjg5NTIwMjUyXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg1NTY0OTY5NywgLTEyMi4yODUxNTAzMjNdLCBbMzcuODczMDExMzEsIC0xMjIuMjc1NDUxMzQ3XSwgWzM3Ljg3NTUxOTY2MDAwMDEsIC0xMjIuMjU2Nzc5OTM5XSwgWzM3Ljg3NDMwODYxOCwgLTEyMi4yODI5NjQyM10sIFszNy44NjY2ODY3ODMsIC0xMjIuMjY3Njc3MzE0XSwgWzM3Ljg1NjcyNTI4MDk5OTk5NiwgLTEyMi4yNjY2ODgxOThdLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44NTE0ODQzMDUsIC0xMjIuMjcxNTk2Nzk2XSwgWzM3Ljg1NzQ1NDY3OTAwMDEsIC0xMjIuMjc1NDIwMzExXSwgWzM3Ljg1NzA1Mzg0NDAwMDEsIC0xMjIuMjcxMzg1MDg2MDAwMDFdLCBbMzcuODc2Njg5OTk3LCAtMTIyLjI4MjY0Njc3Ml0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg1NjcyNTU0NTAwMDEsIC0xMjIuMjU1NDg3ODgyMDAwMDFdLCBbMzcuODYzNjQxMTk0LCAtMTIyLjMxNzYzOTczMl0sIFszNy44NjI2MTMyOTksIC0xMjIuMjkxMjcxNjFdLCBbMzcuODQ5MzY0MjU1MDAwMSwgLTEyMi4yNzM3NTk2OTM5OTk5OV0sIFszNy44NzI1ODM5NzgwMDAxLCAtMTIyLjI2NzQ0MzcxMV0sIFszNy44NzM2MDAxODYsIC0xMjIuMjcwOTAwMDcxXSwgWzM3Ljg1MTQ4Njg1NzAwMDEwNCwgLTEyMi4yNzg1OTQ0MTcwMDAwMV0sIFszNy44NTc2MDA2MjkwMDAwMDQsIC0xMjIuMjgyNDExNTQ4XSwgWzM3Ljg1MzAwODcwODAwMDEwNCwgLTEyMi4yODY5NTAyMTg5OTk5OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NTM2MTIxMTIwMDAxLCAtMTIyLjI4NzE0NDg5Ml0sIFszNy44NjA2NDEwMTEsIC0xMjIuMjkxODE5OTA5XSwgWzM3Ljg1NDkxMTkxMSwgLTEyMi4yNzkzODE1MTVdLCBbMzcuODUzNTUwNzI2LCAtMTIyLjI3NjkzMDgyN10sIFszNy44NTExMTA3MzYwMDAxLCAtMTIyLjI4MzI2ODg5ODk5OTk5XSwgWzM3Ljg1ODUzMjE5OSwgLTEyMi4yNjY5MDI3MTVdLCBbMzcuODY3ODA5MDQ0MDAwMTA0LCAtMTIyLjI1ODk3NTk4NjAwMDAxXSwgWzM3Ljg0ODE0NDkxOSwgLTEyMi4yNzU4NDM1ODFdLCBbMzcuODUzNDgzMTE1MDAwMSwgLTEyMi4yOTE4OTI5OTJdLCBbMzcuODU1MzAzNjg5LCAtMTIyLjI5MjQ3MjIwMTAwMDAxXSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODQ5NzYxMjgzMDAwMSwgLTEyMi4yOTIyNDk5ODFdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTExODExMzMwMDAxMDQsIC0xMjIuMjg5MjM0MDk5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODc4MjY4MzkwMDAwMSwgLTEyMi4yNzAzMDExMjg5OTk5OV0sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg3NzAwNjE5MTAwMDEsIC0xMjIuMjg1MDgwMTE5XSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg3NzgyODcyNjAwMDEsIC0xMjIuMjczNjk4ODI2XSwgWzM3Ljg3ODAwNjc0MSwgLTEyMi4zMDc5NTcwOTVdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzQ1NjE3MDEwMDAxLCAtMTIyLjI4NDc5Nzc3NV0sIFszNy44NTkzNDI1MTIwMDAxMDQsIC0xMjIuMjY3NDg2MTExMDAwMDFdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg1NDcyODk4NywgLTEyMi4yNjkwMTkxNzIwMDAwMV0sIFszNy44NzcwMDk3NzMwMDAxMDQsIC0xMjIuMjg2MTU5NjU4OTk5OTldLCBbMzcuODU5MzQyNTEyMDAwMTA0LCAtMTIyLjI2NzQ4NjExMTAwMDAxXSwgWzM3Ljg1NDQ1MzY0NCwgLTEyMi4yNjk5OTA5ODldLCBbMzcuODYwMzM3MzYwMDAwMSwgLTEyMi4yNjcwNTEzODVdLCBbMzcuODUwMTgzNDUxMDAwMSwgLTEyMi4yNjA0OTUwNDI5OTk5OV0sIFszNy44NTkzNDI1MTIwMDAxMDQsIC0xMjIuMjY3NDg2MTExMDAwMDFdLCBbMzcuODYxMjUwMDM1MDAwMSwgLTEyMi4yNjcwNDcxMjg5OTk5OV0sIFszNy44NjQxOTE0OTUwMDAxLCAtMTIyLjI1ODU2NDUyNF0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTA0MzY3MDkwMDAxLCAtMTIyLjI5MTgxNjI1NV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTExODExMzMwMDAxMDQsIC0xMjIuMjg5MjM0MDk5XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MDgwNzAwMTAwMDEsIC0xMjIuMjkxMDM2ODE5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUwNDM2NzA5MDAwMSwgLTEyMi4yOTE4MTYyNTVdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44NzI0NDc0NjkwMDAxLCAtMTIyLjI3MzA3OTgzNV0sIFszNy44NjU3MjE2ODIwMDAxLCAtMTIyLjI2MDg5Nzk1NzAwMDAxXSwgWzM3Ljg2NzQ5NTA4NzQ2OTYsIC0xMjIuMjk5ODY3NTcwMTQyXSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODcyNjI2NDU2OTk5OTk2LCAtMTIyLjI2NzcxNzMzNV0sIFszNy44NjAxNDkyNTEwMDAxLCAtMTIyLjI3NTk2OTgzXSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODc3OTc1OTQ2LCAtMTIyLjI5MjIzMTc1Ml0sIFszNy44NTM4MTUzNDUsIC0xMjIuMjY2MzAxOTI2XSwgWzM3Ljg4MDcwMjU2MTAwMDEsIC0xMjIuMzA0MTA2NF0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NDcwMzgxMzQwMDAxLCAtMTIyLjI3NzQxMjU2Nzk5OTk5XSwgWzM3Ljg2Mzk3MTQ4ODAwMDEwNCwgLTEyMi4yNjczNjMxNV0sIFszNy44NTIzNDMzNTgsIC0xMjIuMjc3MDU3NDY0XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44NTEyMzU2MjcwMDAxLCAtMTIyLjI1MjQ3MDY0NzAwMDAxXSwgWzM3Ljg2NjY5OTAyNTAwMDEsIC0xMjIuMjkwOTA4NzMyXSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NTYwMjA5OTIsIC0xMjIuMjc5NjA1NTc0XSwgWzM3Ljg1NDE3NzYwNjAwMDEsIC0xMjIuMjc5MjE0OTRdLCBbMzcuODcxNzQ5MzcsIC0xMjIuMjcxODgzODc2XSwgWzM3Ljg1Mjc1MTI5NzAwMDEwNCwgLTEyMi4yODM3MjA1OF0sIFszNy44NjIzMTA4NDYwMDAxLCAtMTIyLjI1MDA5NTY5OTk5OTk5XSwgWzM3Ljg3MDQxNTM1NCwgLTEyMi4yOTI1NTE1MTI5OTk5OV0sIFszNy44NTU0OTcyMTc4OTIxLCAtMTIyLjI4MzEyMjc5NTg1NF0sIFszNy44Njk0MzkzNDcsIC0xMjIuMjg3MDQwNDE1XSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODY1NzUxOTMsIC0xMjIuMjU1ODM1MDY1XSwgWzM3Ljg2ODEzNzAyOCwgLTEyMi4yNjM3MzI0MTc5OTk5OV0sIFszNy44OTEzNDU1OTYwMDAxLCAtMTIyLjI3OTg1ODg3OF0sIFszNy44ODg4NjMwMywgLTEyMi4yNzIzODQwMzRdLCBbMzcuODg1NDg1MzI4MDAwMSwgLTEyMi4yNzEyNjMyMDRdLCBbMzcuODY2MDM0OTY0MDAwMSwgLTEyMi4yNjU2MjI3MzIwMDAwMV0sIFszNy44NzY3MzAyMTY5OTk5OTUsIC0xMjIuMzA1MjE1NzIyMDAwMDFdLCBbMzcuODY0MjQwODI4MDAwMSwgLTEyMi4yNjUyNDIyMTcwMDAwMV0sIFszNy44Nzk0MjUxNDgwMDAxLCAtMTIyLjI5NjM1NDA4XSwgWzM3Ljg2MDE5NjQyMDAwMDEsIC0xMjIuMjk0MDU0MTkxXSwgWzM3Ljg2ODY0MzY2MTAwMDEsIC0xMjIuMjk0NDA1NzU0XSwgWzM3Ljg2ODQyMzUxMywgLTEyMi4yOTU1MTYxNDldLCBbMzcuODYwNDY5NzQ5MDAwMSwgLTEyMi4yODA0OTUyODhdLCBbMzcuODY2NDY4NTc5MDAwMSwgLTEyMi4yOTgzOTY2MzFdLCBbMzcuODQxNjAyMzc3MDAwMSwgLTEyMi4yNzQ0MTUxMTddLCBbMzcuODQyMTE2MzkwMDAwMSwgLTEyMi4yNzY4MDczNV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODU0MTY0Nzc4MDAwMDA1LCAtMTIyLjI3MjE3MTc3Nzk5OTk5XSwgWzM3Ljg1Njg1MzMyOSwgLTEyMi4yODgxODc4MDI5OTk5OV0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NTMwODI1NTQwMTAyOSwgLTEyMi4yOTY4Mzc3NjAxNDZdLCBbMzcuODcyMzQ3NzAzMDAwMSwgLTEyMi4yNjY4NjQ1MDZdLCBbMzcuODY0ODIzNDA2LCAtMTIyLjI5ODk3MTc0M10sIFszNy44Njk4NzU3MDAwMDAxLCAtMTIyLjI4NjU1MDg0Nl0sIFszNy44NjE3MjMzMDEsIC0xMjIuMjU0Nzk1NDE3OTk5OTldLCBbMzcuODYzMDY2NjQ2MDAwMSwgLTEyMi4yNjcyNTY3MV0sIFszNy44Njc1OTM4NDMwMDAxLCAtMTIyLjI2Nzc3MzQyOF0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzU0NzYxNjY5OTk5OTUsIC0xMjIuMjk4OTcxOTVdLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44NTg2NTQ4NDMwMDAxLCAtMTIyLjI5MjM3ODIxNF0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3NjAxMzMyNzAwMDEsIC0xMjIuMjczNTAxMjA2XSwgWzM3Ljg3ODA3NzQ1MDA5NzEsIC0xMjIuMzA4MDI4MTYzMDc1MDFdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg3MjU0NjAxMDAwMDEsIC0xMjIuMjUzNzUwMzA4XSwgWzM3Ljg3MTg4MjkwOCwgLTEyMi4yNzI3MTI2MTg5OTk5OV0sIFszNy44NzcxNzk0NzMwMDAxMDUsIC0xMjIuMzAyOTU4NTc1XSwgWzM3Ljg2Mzc0ODMyMiwgLTEyMi4yODMyNTA0NjddLCBbMzcuODc5MTI4MzAzMDAwMSwgLTEyMi4zMDI0NjUzMzldLCBbMzcuODcyNDQ3NDY5MDAwMSwgLTEyMi4yNzMwNzk4MzVdLCBbMzcuODY2MDM0OTY0MDAwMSwgLTEyMi4yNjU2MjI3MzIwMDAwMV0sIFszNy44NTA2ODIzMzIwMDAxMDUsIC0xMjIuMjcwNjc1MjQ3OTk5OTldLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODQ5MDUxMDQ0MDAwMSwgLTEyMi4yNjkwOTgyOTVdLCBbMzcuODU4ODc3MDcyLCAtMTIyLjI5MTI2NDU0XSwgWzM3Ljg3MzI1NTQ0NDAwMDEsIC0xMjIuMjY3MDUyNDYxXSwgWzM3Ljg4MjI2MDI3MywgLTEyMi4yOTYzODY1NjFdLCBbMzcuODYxNTMwMzE2LCAtMTIyLjI3MTg5NTU5Ml0sIFszNy44ODYxOTA1MzMwMDAwMDQsIC0xMjIuMjcxNzM2MTc4XSwgWzM3Ljg2ODIwMTM4OSwgLTEyMi4yNzcyMDU1NTIwMDAwMV0sIFszNy44NTY5MTc3ODAwMDAxLCAtMTIyLjI3OTc4OTkxN10sIFszNy44NzkxMjgzMDMwMDAxLCAtMTIyLjMwMjQ2NTMzOV0sIFszNy44NTA5NTg3NDksIC0xMjIuMjU0NzE0NjkxXSwgWzM3Ljg2NzM5MzYxODAwMDEsIC0xMjIuMjgxNjM4NTc3MDAwMDFdLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NTU1NTMzNTIwMDAxLCAtMTIyLjI2NDU1OTE2NV0sIFszNy44NzE3NDkzNywgLTEyMi4yNzE4ODM4NzZdLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44ODA0NzQxOTUsIC0xMjIuMjk1Nzk5MjE1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg4MDAyNDA4MSwgLTEyMi4yOTgwNzU1MzldLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44ODA2NjY1OTUsIC0xMjIuMjk0ODg3MjQ3XSwgWzM3Ljg3NjIxMjEwMzAwMDEsIC0xMjIuMjg2NjQxMTc5XSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NTcwNTM4NDQwMDAxLCAtMTIyLjI3MTM4NTA4NjAwMDAxXSwgWzM3Ljg3NjM3OTI5ODAwMDEsIC0xMjIuMjg1MDMwMzddLCBbMzcuODUyNjcwNTM2MDAwMSwgLTEyMi4yNzEyNjMxMjNdLCBbMzcuODU2MTMzMTY5LCAtMTIyLjI3MTI4MTY4MjAwMDAxXSwgWzM3Ljg3NjM3OTI5ODAwMDEsIC0xMjIuMjg1MDMwMzddLCBbMzcuODU5OTgxMDA4MDAwMDA1LCAtMTIyLjI1MzMyNjgyNzAwMDAxXSwgWzM3Ljg1NzQ2Mzc1MjAwMDEsIC0xMjIuMjY4MDkxNTQ4OTk5OTldLCBbMzcuODQ3ODk0MTYxOTk5OTk2LCAtMTIyLjI3Nzc2NzAxMTAwMDAxXSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg0OTY5MDU2MDY3NjksIC0xMjIuMjkyMTgwMDU3ODY1MDFdLCBbMzcuODc1ODkxMzQ4LCAtMTIyLjI4ODc3NjczN10sIFszNy44NzYwMTUzOTMsIC0xMjIuMjkyNTA0OTI2XSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODc2MTQ4MzE3MDAwMSwgLTEyMi4yOTU2NDI1MDVdLCBbMzcuODU0MTc3NjA2MDAwMSwgLTEyMi4yNzkyMTQ5NF0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg2MjE3NzM4MiwgLTEyMi4yNzQwNzY0NDIwMDAwMV0sIFszNy44NjQ4Njg0ODMwMDAxLCAtMTIyLjI3NDU4MjU2OV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODcyNDI4MzcxMDAwMSwgLTEyMi4yNzk5NjExMDZdLCBbMzcuODc3NjI0ODYsIC0xMjIuMzAwNzI3Mjk3MDAwMDFdLCBbMzcuODcxNzQ5MzcsIC0xMjIuMjcxODgzODc2XSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODc1ODE1OTc3MDAwMSwgLTEyMi4yODI1NDYwNzI5OTk5OV0sIFszNy44NTI3NTEyOTcwMDAxMDQsIC0xMjIuMjgzNzIwNThdLCBbMzcuODc2OTQ4MDU3MDAwMTEsIC0xMjIuMjgwNDcxNTQ3XSwgWzM3Ljg1NjQ5MTMyMzAwMDEsIC0xMjIuMjY4NDYzMzA4XSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg2NzIzNjc5MzAwMDEsIC0xMjIuMjY3MjcwMDgxXSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODQ2MDQxOTg3LCAtMTIyLjI4NDY5MjQ0Nzk5OTk5XSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg1NjAyMDk5MiwgLTEyMi4yNzk2MDU1NzRdLCBbMzcuODc2MjEyMTAzMDAwMSwgLTEyMi4yODY2NDExNzldLCBbMzcuODc1ODkxMzQ4LCAtMTIyLjI4ODc3NjczN10sIFszNy44NzA5NzMzNjcsIC0xMjIuMjc0OTM5NzhdLCBbMzcuODYwODk1NDkyMDAwMTA0LCAtMTIyLjI5MjI4MDMxMV0sIFszNy44Njg5MjQ4NSwgLTEyMi4yODM5MDQwMjJdLCBbMzcuODYwMjQ2MzAxMDAwMDk2LCAtMTIyLjI4OTI3NjA0Nl0sIFszNy44ODIxODIwODQwMDAxLCAtMTIyLjMwMzEwOTk3MV0sIFszNy44NjQ1MzgxMTUwMDAxLCAtMTIyLjI2Mjk5Mzc0Nl0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg2ODg2NzIwNDAwMDAwNCwgLTEyMi4yOTMyOTcxNzc5OTk5OV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg5ODkyODQ3NywgLTEyMi4yNzA0MjE3NTVdLCBbMzcuODY3MjYzMjQzMDAwMDA0LCAtMTIyLjI5MTUyMjUwMDAwMDAxXSwgWzM3Ljg1MDUzMjM2NSwgLTEyMi4yODYxNTEwNDldLCBbMzcuODQ5MDUxMDQ0MDAwMSwgLTEyMi4yNjkwOTgyOTVdLCBbMzcuODQ5MDUxMDQ0MDAwMSwgLTEyMi4yNjkwOTgyOTVdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODYyMTEwNzIyMDAwMTA0LCAtMTIyLjI1MzUzOTk5NV0sIFszNy44NzIzMjk2MzIwMDAxLCAtMTIyLjI2OTMxMzI0M10sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NjEzOTU4MDIwMDAxMDQsIC0xMjIuMjU4OTQzNDU3XSwgWzM3Ljg3MDIyMzk4Mjc4NDc5LCAtMTIyLjI3MzE3MTY5MTY2Ml0sIFszNy44ODIyNjAyNzMsIC0xMjIuMjk2Mzg2NTYxXSwgWzM3Ljg3NDM2NjYzNiwgLTEyMi4zMDQ0NDk1NTIwMDAwMV0sIFszNy44Njk4NzU3MDAwMDAxLCAtMTIyLjI4NjU1MDg0Nl0sIFszNy44NDY5NDM1NCwgLTEyMi4yODQ5OTA3NjFdLCBbMzcuODQ2MDQ3OTg3MDAwMTA1LCAtMTIyLjI3MDg2MzQ3MV0sIFszNy44NzE4ODQ0MTMwMDAwMDQsIC0xMjIuMzAxMjQ0NTg1XSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODUwNjA4OTA0MDAwMTA0LCAtMTIyLjI3ODM4OTc2OV0sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NDMwNTAzMjQwMDAwMDQsIC0xMjIuMjgzNzM1MDgzXSwgWzM3Ljg2ODM5MDM2NzAwMDEsIC0xMjIuMjU0NDI4MjAyOTk5OTldLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODcxMjYxOTcyMDAwMTA2LCAtMTIyLjI3NTI0NDg4Nzk5OTk5XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2ODE0ODgzMzAwMDEsIC0xMjIuMjkxODEwNjc3OTk5OTldLCBbMzcuODY5MzE0NzYzLCAtMTIyLjI5ODA5MzE0Mjk5OTk5XSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODU3MjI1OTQ4MDAwMSwgLTEyMi4yOTE5MTc1NjVdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg3MjQ0NzQ2OTAwMDEsIC0xMjIuMjczMDc5ODM1XSwgWzM3Ljg2ODQ2NTY4MjAwMDEsIC0xMjIuMjg5MzQ3ODI3OTk5OTldLCBbMzcuODY4MzMzODg3MDAwMTA1LCAtMTIyLjI2NzQyMzMxM10sIFszNy44NjU4MDE2OTQsIC0xMjIuMjUyNzU0MTE1XSwgWzM3Ljg4NDEwNDExOCwgLTEyMi4yNjkyMDcxNjJdLCBbMzcuODgxNDc1NjUzMDAwMSwgLTEyMi4yNjkwMDYwNTRdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NTA2NTU5MjksIC0xMjIuMjU3MDAwNzc5XSwgWzM3Ljg1NzY2MTI2ODAwMDEsIC0xMjIuMjU5NDY5ODUxXSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODY4MTA4NDg4MDAwMTA0LCAtMTIyLjI1NjcxMzU3M10sIFszNy44NTEyMzU2MjcwMDAxLCAtMTIyLjI1MjQ3MDY0NzAwMDAxXSwgWzM3Ljg1NzY2MTI2ODAwMDEsIC0xMjIuMjU5NDY5ODUxXSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44Njg0MDkzNDgwMDAxLCAtMTIyLjI2MTQ1Mzc3NF0sIFszNy44NjU3MjE2ODIwMDAxLCAtMTIyLjI2MDg5Nzk1NzAwMDAxXSwgWzM3Ljg1MzIwNDcwODAwMDEsIC0xMjIuMjgxMzg5NjZdLCBbMzcuODY0MTkxNDk1MDAwMSwgLTEyMi4yNTg1NjQ1MjRdLCBbMzcuODU3OTg2Nzk0MDAwMSwgLTEyMi4yNjcyNzM2MjldLCBbMzcuODY2MDE0NTgyLCAtMTIyLjI1ODYxNjQwMjk5OTk5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg2ODQwOTM0ODAwMDEsIC0xMjIuMjYxNDUzNzc0XSwgWzM3Ljg2MzUyNjE5NjAwMDEsIC0xMjIuMjU1MDA0MzcyXSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NTg0MjA4NzYsIC0xMjIuMjY3NzMzMjYzXSwgWzM3Ljg1MzY5NDk5NTAwMDEsIC0xMjIuMjYwMDE2NjY5XSwgWzM3Ljg2MzA2MjIyNTAwMDEsIC0xMjIuMjc0MzcxMzE1XSwgWzM3Ljg2NzE0NTY1NDAwMDEwNSwgLTEyMi4yOTUxMDQwODFdLCBbMzcuODQ5NDM1NDAyLCAtMTIyLjI1MjI2ODkwMjk5OTk5XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODgxMDA1MjI4LCAtMTIyLjI5MzIwOTQ1N10sIFszNy44NjU3Nzk4LCAtMTIyLjI2NzU3NjAwNV0sIFszNy44Njg5OTE2NjQwMDAxLCAtMTIyLjI1Njg5MjEzOV0sIFszNy44Njc4MDkwNDQwMDAxMDQsIC0xMjIuMjU4OTc1OTg2MDAwMDFdLCBbMzcuODQ5Njk3NDQ4LCAtMTIyLjI3MTA1MTg0NzAwMDAxXSwgWzM3Ljg3MTc0NDU5ODAwMDEsIC0xMjIuMjY5MDExNDYyMDAwMDFdLCBbMzcuODUzNTUwNzI2LCAtMTIyLjI3NjkzMDgyN10sIFszNy44NjY5MDc5OTYwMDAxLCAtMTIyLjI1ODc5ODY5N10sIFszNy44NjY2MDg4MzYwMDAxLCAtMTIyLjI1NDA3NTk3XSwgWzM3Ljg2ODM5MDM2NzAwMDEsIC0xMjIuMjU0NDI4MjAyOTk5OTldLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODU0MDI5Njc1LCAtMTIyLjI3MzIxMTI5XSwgWzM3Ljg0MDQ1NDEzNTAwMDEsIC0xMjIuMjY0NTE3MjE1XSwgWzM3Ljg2ODAyNDA2NzAwMDEsIC0xMjIuMjU5NTczNTk3MDAwMDFdLCBbMzcuODcyNDQ3NDY5MDAwMSwgLTEyMi4yNzMwNzk4MzVdLCBbMzcuODcwOTIzMDc2MDAwMDk2LCAtMTIyLjI4OTY4NDMxXSwgWzM3Ljg3NTQ3NjE2Njk5OTk5NSwgLTEyMi4yOTg5NzE5NV0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODQ4ODIyNzk5MDAwMTA0LCAtMTIyLjI3Nzk3OTc3ODk5OTk5XSwgWzM3Ljg3NjQzNzYyNywgLTEyMi4zMDAzNjIzNTFdLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg0MjA1MzAyODAwMDEsIC0xMjIuMjcwMjc5NjY3OTk5OTldLCBbMzcuODQ3NTUxOTczMDAwMSwgLTEyMi4yNzMzOTk0MTZdLCBbMzcuODc4MDc3NDUwMDk3MSwgLTEyMi4zMDgwMjgxNjMwNzUwMV0sIFszNy44NzgwNzc0NTAwOTcxLCAtMTIyLjMwODAyODE2MzA3NTAxXSwgWzM3Ljg2NjEwMzYxODg3NTEsIC0xMjIuMzA1Njg4MTM1MDMwOTldLCBbMzcuODU5MjgxNDUsIC0xMjIuMzE1ODQ5MTRdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NjgxNTUzNTgsIC0xMjIuMjcwMzUyNTc2MDAwMDFdLCBbMzcuODY5MDU2NDQ0MDAwMSwgLTEyMi4yNzA0MzQ3MDddLCBbMzcuODcxNzQ5MzcsIC0xMjIuMjcxODgzODc2XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg0NTM3MTUwOCwgLTEyMi4yNzU5NjMzMDRdLCBbMzcuODY3NjYyMTg0MDAwMDA0LCAtMTIyLjI5OTg5MTczMl0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg2NzIwNzUzOSwgLTEyMi4yNTY1MjkzNzddLCBbMzcuODY5NDI2NzA0LCAtMTIyLjI5MTgxNjIwNV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MTc0OTM3LCAtMTIyLjI3MTg4Mzg3Nl0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NDkwNTEwNDQwMDAxLCAtMTIyLjI2OTA5ODI5NV0sIFszNy44ODAwMjQwODEsIC0xMjIuMjk4MDc1NTM5XSwgWzM3Ljg1ODU5NTc2NzAwMDEwNCwgLTEyMi4yNTkzMzc4MzZdLCBbMzcuODU4NTk1NzY3MDAwMTA0LCAtMTIyLjI1OTMzNzgzNl0sIFszNy44NzQ4Njg1MTkwMDAxLCAtMTIyLjI4MjQ0MzU5NjAwMDAxXSwgWzM3Ljg0Nzg5NDE2MTk5OTk5NiwgLTEyMi4yNzc3NjcwMTEwMDAwMV0sIFszNy44NzMwMjU5MjYsIC0xMjIuMjY4NDg1MjA4OTk5OTldLCBbMzcuODY4MTM3MDI4LCAtMTIyLjI2MzczMjQxNzk5OTk5XSwgWzM3Ljg3MDk3NDYwNjAwMDEsIC0xMjIuMjc3NTAyNDE4XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg2Mjg1NDgzMywgLTEyMi4yOTAxMDYzODcwMDAwMV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU0MTY0Nzc4MDAwMDA1LCAtMTIyLjI3MjE3MTc3Nzk5OTk5XSwgWzM3Ljg4MTQzNjc1MSwgLTEyMi4yNzQxMDA0ODFdLCBbMzcuODcyNTgwODQzLCAtMTIyLjI5MzI1MzU1Nzk5OTk5XSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODcwOTc0NjA2MDAwMSwgLTEyMi4yNzc1MDI0MThdLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODY1MTcxMTU1LCAtMTIyLjI3MjMwODI0NzAwMDAxXSwgWzM3Ljg3NDg2ODUxOTAwMDEsIC0xMjIuMjgyNDQzNTk2MDAwMDFdLCBbMzcuODU5NTI2MzkyMDgwOSwgLTEyMi4yODAyNDQyOTY4NjFdLCBbMzcuODUxOTM5NDY0MDAwMTA0LCAtMTIyLjI4MzUwMzU5N10sIFszNy44Njc1MDU3OTQwMDAxLCAtMTIyLjI1NDI1MTM3NV0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODc5OTMwMjA4MDAwMTA0LCAtMTIyLjI4MzEyMTQ1Mjk5OTk5XSwgWzM3Ljg3NzMwOTI5LCAtMTIyLjI5NjAxODg3Nl0sIFszNy44Nzc1NDkzNzQwMDAxMDQsIC0xMjIuMjk0ODYyMDU2XSwgWzM3Ljg4MjI2MDI3MywgLTEyMi4yOTYzODY1NjFdLCBbMzcuODgyMjYwMjczLCAtMTIyLjI5NjM4NjU2MV0sIFszNy44NDg4NTkzMDAwMDAxLCAtMTIyLjI5MjE1NDM0MV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Nzc5NDczMzgwMDAxMDUsIC0xMjIuMjg4OTExMjJdLCBbMzcuODcwMTk1NjUxMDAwMSwgLTEyMi4yOTM3MjQzMTRdLCBbMzcuODY1ODcwMjQ2LCAtMTIyLjI1MTYwNTQyN10sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MTg0MjQwNCwgLTEyMi4yODk0NjEzNzZdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NzI1ODM5NzgwMDAxLCAtMTIyLjI2NzQ0MzcxMV0sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44NjgzMDU3OTMwMDAwMDUsIC0xMjIuMjY2NTEyMDkzOTk5OTldLCBbMzcuODY0NTc2NTkxMDAwMSwgLTEyMi4yNzY4MjI0NjldLCBbMzcuODY5NDM2ODAxMDAwMSwgLTEyMi4yODk1MjAyNTJdLCBbMzcuODY4MTQ4ODMzMDAwMSwgLTEyMi4yOTE4MTA2Nzc5OTk5OV0sIFszNy44NjcyNjg0NjY5OTk5OTUsIC0xMjIuMjcwMjM5NTk3OTk5OTldLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1ODcxMjc5MzAwMDEsIC0xMjIuMjgwMTU1MTgxXSwgWzM3Ljg2OTQzMjA3NjAwMDEsIC0xMjIuMjgxODQzNDU3MDAwMDFdLCBbMzcuODgxODAyNTM2MDAwMSwgLTEyMi4yOTg2Njc5NDc5OTk5OV0sIFszNy44NDk2OTc0NDgsIC0xMjIuMjcxMDUxODQ3MDAwMDFdLCBbMzcuODcxNjg1NjQzLCAtMTIyLjI5Mjk2NTA5OTk5OTk5XSwgWzM3Ljg1ODA3NDMxMDAwMDEsIC0xMjIuMjQzODU1MDU3XSwgWzM3Ljg0NzAzODEzNDAwMDEsIC0xMjIuMjc3NDEyNTY3OTk5OTldLCBbMzcuODU0MzE2Mzg1MDAwMTA0LCAtMTIyLjI3MTA4NDE1NF0sIFszNy44Nzk1ODAxMjQsIC0xMjIuMzAwMjYxODgyOTk5OTldLCBbMzcuODc3NjI0ODYsIC0xMjIuMzAwNzI3Mjk3MDAwMDFdLCBbMzcuODYzMDgzODgzMDAwMSwgLTEyMi4zMTcyNjgyNTJdLCBbMzcuODUwNjc1NDU4MDAwMTA0LCAtMTIyLjI4NDMyMTM1M10sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg4MTMzNzY1NSwgLTEyMi4yOTE1MzE1MDZdLCBbMzcuODY2NTUwMzM3LCAtMTIyLjI4OTk5MTEzMzk5OTk5XSwgWzM3Ljg2NTcyMDc3MSwgLTEyMi4yNTM5MDI1MjFdLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg2NzYyMTQzNywgLTEyMi4yNTg2NTQ4OTc5OTk5OV0sIFszNy44ODEwMDcxODMwMDAxLCAtMTIyLjI4MzI0MjY1MTAwMDAxXSwgWzM3Ljg1NTE4MDc4MDAwMDEsIC0xMjIuMjY3Mzg0MTI0XSwgWzM3Ljg1MTIzNTYyNzAwMDEsIC0xMjIuMjUyNDcwNjQ3MDAwMDFdLCBbMzcuODYyMzI5NjE0MDAwMDA0LCAtMTIyLjI1ODgxMTQxNF0sIFszNy44NTg1OTU3NjcwMDAxMDQsIC0xMjIuMjU5MzM3ODM2XSwgWzM3Ljg2MjU2ODk1ODAwMDEwNCwgLTEyMi4yNjc3MDc0MjRdLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg1MDUzMjM2NSwgLTEyMi4yODYxNTEwNDldLCBbMzcuODQ4MDk0NDQ2MDAwMSwgLTEyMi4yNTQzMDgwMDI5OTk5OV0sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44NTkzNDI1MTIwMDAxMDQsIC0xMjIuMjY3NDg2MTExMDAwMDFdLCBbMzcuODM5NTYyMDUsIC0xMjIuMjgyNTk3MDU0XSwgWzM3Ljg2NjEyMTE5NywgLTEyMi4yODUwMTUxNjVdLCBbMzcuODYxMDk0Mzk2OTk5OTk1LCAtMTIyLjI4OTU0NTk1MTAwMDAxXSwgWzM3Ljg3ODMwMjMzODAwMDAwNSwgLTEyMi4zMDY1NjU1MzVdLCBbMzcuODc0MDkwNjg0MDAwMSwgLTEyMi4yOTk2Mjk2NTVdLCBbMzcuODY0NjE2NTYxOTk5OTk1LCAtMTIyLjI5MDY3MjA3MV0sIFszNy44NjUwMzc2OTksIC0xMjIuMjk3OTMyMzA0XSwgWzM3Ljg2NDEyNjYzOTAwMDEsIC0xMjIuMjUwMjY4NDUxMDAwMDFdLCBbMzcuODc1MzIyMjA0LCAtMTIyLjMwNTkwNzQyMl0sIFszNy44NjY5MDc5OTYwMDAxLCAtMTIyLjI1ODc5ODY5N10sIFszNy44NTMwODI1NTQwMTAyOSwgLTEyMi4yOTY4Mzc3NjAxNDZdLCBbMzcuODYxMjUwMDM1MDAwMSwgLTEyMi4yNjcwNDcxMjg5OTk5OV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODU1MzAwNTU0MDAwMSwgLTEyMi4yNjY0OTMxODNdLCBbMzcuODUyMDMwNjA0LCAtMTIyLjI2MDIzNzU5NjAwMDAxXSwgWzM3Ljg2NDc1OTQ2NzAwMDEwNiwgLTEyMi4yODk2MjU2OTRdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODc2NDM3NjI3LCAtMTIyLjMwMDM2MjM1MV0sIFszNy44NTM0NDU0NzgwMDAwMDUsIC0xMjIuMjY5NTE4NjU3XSwgWzM3Ljg3MjU4Mzk3ODAwMDEsIC0xMjIuMjY3NDQzNzExXSwgWzM3Ljg3MDA3ODY0NSwgLTEyMi4yNzE4NDI5MTldLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODY5NjA1ODE5MDAwMSwgLTEyMi4yNzMzNjY3MDJdLCBbMzcuODgwNzQ5NDc5LCAtMTIyLjMwOTE2OTIzMV0sIFszNy44NDY0NjUxNTEwMDAwOTYsIC0xMjIuMjg0OTA1MjE5XSwgWzM3Ljg0NTY1MDI5OTk5OTk5NiwgLTEyMi4yODQ1Nzc3ODIwMDAwMV0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODU3NjYxMjY4MDAwMSwgLTEyMi4yNTk0Njk4NTFdLCBbMzcuODUzMjgxMDk0MDAwMSwgLTEyMi4yNzkwMTE1Njc5OTk5OV0sIFszNy44NjA0Njk3NDkwMDAxLCAtMTIyLjI4MDQ5NTI4OF0sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NDc4OTQxNjE5OTk5OTYsIC0xMjIuMjc3NzY3MDExMDAwMDFdLCBbMzcuODY3MjE5MDMzMDAwMDA1LCAtMTIyLjI2MzU0MDgxN10sIFszNy44NjQ4MjM0MDYsIC0xMjIuMjk4OTcxNzQzXSwgWzM3Ljg3MTQ2NDIwNjk5OTk5NSwgLTEyMi4yNjU5NzM3MjldLCBbMzcuODY0NTU0MTc2MDAwMSwgLTEyMi4yNjk5MDQ1NjIwMDAwMV0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg3MTE3MDExNzAwMDEwNSwgLTEyMi4yNjgyNzk2NDVdLCBbMzcuODY1Nzc5OCwgLTEyMi4yNjc1NzYwMDVdLCBbMzcuODUwMTA0Mjc1LCAtMTIyLjI4NTk5ODk4MV0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg2NjkzMDM2OSwgLTEyMi4yNjU4MDg2MjVdLCBbMzcuODc5NDI1MTQ4MDAwMSwgLTEyMi4yOTYzNTQwOF0sIFszNy44NjUxNzExNTUsIC0xMjIuMjcyMzA4MjQ3MDAwMDFdLCBbMzcuODU0MDI5Njc1LCAtMTIyLjI3MzIxMTI5XSwgWzM3Ljg1MDY4MjMzMjAwMDEwNSwgLTEyMi4yNzA2NzUyNDc5OTk5OV0sIFszNy44NDY0Nzk3OTQwMDAxLCAtMTIyLjI2MTAxMTVdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2ODMwNTc5MzAwMDAwNSwgLTEyMi4yNjY1MTIwOTM5OTk5OV0sIFszNy44NzU1NDEzNDMwMDAxLCAtMTIyLjMwNDgyNDY2NV0sIFszNy44NjMwNDg3MDcwMDAxMDQsIC0xMjIuMjk4NDAzODA0XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg2ODQxMjc4NSwgLTEyMi4yOTY5NzQ5M10sIFszNy44NzA5MjMwNzYwMDAwOTYsIC0xMjIuMjg5Njg0MzFdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NTE4NjQ0NCwgLTEyMi4yNjE2MTI1NzldLCBbMzcuODU1ODI2NDQ1LCAtMTIyLjI2MjQ1OTM1Nzk5OTk5XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg1MDY4MjMzMjAwMDEwNSwgLTEyMi4yNzA2NzUyNDc5OTk5OV0sIFszNy44NTYxMzMxNjksIC0xMjIuMjcxMjgxNjgyMDAwMDFdLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44NDUwMjgzMjQwMDAxMDQsIC0xMjIuMjc4OTk2ODIxXSwgWzM3Ljg1MzIwNDcwODAwMDEsIC0xMjIuMjgxMzg5NjZdLCBbMzcuODcyNjk5OTM5LCAtMTIyLjI3MDcxNzQ1OF0sIFszNy44Njk5NzY5NjcwMDAxMDYsIC0xMjIuMjk0ODI5NTYzXSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODU2NzI1MjgwOTk5OTk2LCAtMTIyLjI2NjY4ODE5OF0sIFszNy44NTUzMDM2ODksIC0xMjIuMjkyNDcyMjAxMDAwMDFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTQ2MTkwNzcwMDAxLCAtMTIyLjI5MTkwMjcxXSwgWzM3Ljg1MDA1ODkwOSwgLTEyMi4yOTA3ODMyMDddLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MTE4MTEzMzAwMDEwNCwgLTEyMi4yODkyMzQwOTldLCBbMzcuODUxMTgxMTMzMDAwMTA0LCAtMTIyLjI4OTIzNDA5OV0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MDgwNzAwMTAwMDEsIC0xMjIuMjkxMDM2ODE5XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODU1MTg5NTM1MDAwMSwgLTEyMi4yNTk4MTMwOTddLCBbMzcuODU5NTM3ODE4LCAtMTIyLjI1OTIwNjAwNzk5OTk5XSwgWzM3Ljg1MzkzNTA2ODAwMDEwNSwgLTEyMi4yODk2Njk0NTldLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODY1ODAxNjk0LCAtMTIyLjI1Mjc1NDExNV0sIFszNy44NzU0NDY4MjMwMDAxMDQsIC0xMjIuMjkyMzIzMTE5XSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODc1NTQzMTg3MDAwMTA1LCAtMTIyLjI5MTQ0ODcyOV0sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg3NjM3OTI5ODAwMDEsIC0xMjIuMjg1MDMwMzddLCBbMzcuODc1NDQ2ODIzMDAwMTA0LCAtMTIyLjI5MjMyMzExOV0sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODU3NDYzNzUyMDAwMSwgLTEyMi4yNjgwOTE1NDg5OTk5OV0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg2OTIwMTIzMSwgLTEyMi4yNjkyOTY0NjEwMDAwMV0sIFszNy44NjkyMDEyMzEsIC0xMjIuMjY5Mjk2NDYxMDAwMDFdLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NTg2NDIxODYwMDAxLCAtMTIyLjI3MzM1MDk3OF0sIFszNy44NTA2ODIzMzIwMDAxMDUsIC0xMjIuMjcwNjc1MjQ3OTk5OTldLCBbMzcuODY4MzkwMzY3MDAwMSwgLTEyMi4yNTQ0MjgyMDI5OTk5OV0sIFszNy44Njc1OTM4NDMwMDAxLCAtMTIyLjI2Nzc3MzQyOF0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NTg0NjIyMTUsIC0xMjIuMjUzMTc2NjAxXSwgWzM3Ljg4MjA0NjEwMDAwMDAwNCwgLTEyMi4yODExOTg2NzZdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg2NjkzMDM2OSwgLTEyMi4yNjU4MDg2MjVdLCBbMzcuODYwNDY5NzQ5MDAwMSwgLTEyMi4yODA0OTUyODhdLCBbMzcuODY1MTcxMTU1LCAtMTIyLjI3MjMwODI0NzAwMDAxXSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODUxMTgxMTMzMDAwMTA0LCAtMTIyLjI4OTIzNDA5OV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg3NDI4MDc3MjAwMDEwNSwgLTEyMi4yOTM0NTMzOTJdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MzcwOTQ2MiwgLTEyMi4yOTA3Nzk1MDRdLCBbMzcuODUyMjI2MzEyLCAtMTIyLjI5MTQ5NTQ0Mjk5OTk5XSwgWzM3Ljg1MjU5MDc5MDAwMDEsIC0xMjIuMjg5Njk1OTI3OTk5OTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTYwODI2NDEwMDAxLCAtMTIyLjI5MjcyODMzNV0sIFszNy44NTQzOTczMzUsIC0xMjIuMjg3Mzk1OTA2XSwgWzM3Ljg1MzAwODcwODAwMDEwNCwgLTEyMi4yODY5NTAyMTg5OTk5OV0sIFszNy44Njg4Mzc5MjIwMDAxMDQsIC0xMjIuMjY4NjQzNjgyXSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODc4NDY4MDc3LCAtMTIyLjMwNTc2NTcxMjAwMDAxXSwgWzM3Ljg1OTExOTY1NSwgLTEyMi4yODYxMTc3NDhdLCBbMzcuODUxNDg2ODU3MDAwMTA0LCAtMTIyLjI3ODU5NDQxNzAwMDAxXSwgWzM3Ljg1MDI3MTkzOCwgLTEyMi4yNzc5NDI1ODg5OTk5OV0sIFszNy44NDY5NDM1NCwgLTEyMi4yODQ5OTA3NjFdLCBbMzcuODY5OTk3MTY0MDAwMDA0LCAtMTIyLjI3NzM4MzcxMjk5OTk5XSwgWzM3Ljg2MDg4MDQ3NSwgLTEyMi4yNzUyNDQ3ODFdLCBbMzcuODczNDQyNTU5MDAwMTA0LCAtMTIyLjI5MzUzMDgxNF0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NzQ5ODExNjkwMDAxLCAtMTIyLjI5NTI2NTk5XSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg1Nzk4Njc5NDAwMDEsIC0xMjIuMjY3MjczNjI5XSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg3MzQ0MjU1OTAwMDEwNCwgLTEyMi4yOTM1MzA4MTRdLCBbMzcuODc4ODU0NTM5LCAtMTIyLjI2NTczNTU3Nzk5OTk5XSwgWzM3Ljg4MDQ3NDE5NSwgLTEyMi4yOTU3OTkyMTVdLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODczNDQyNTU5MDAwMTA0LCAtMTIyLjI5MzUzMDgxNF0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NzE0NDczMzAwMDAxLCAtMTIyLjI3NjI0NjMyXSwgWzM3Ljg0NzQyMTM5OTk5OTk5NSwgLTEyMi4yODEzMzkxNDNdLCBbMzcuODU3NjYxMjY4MDAwMSwgLTEyMi4yNTk0Njk4NTFdLCBbMzcuODY3NDc4Mzg3MDAwMTA1LCAtMTIyLjI1NDI0NzI0Nl0sIFszNy44NTUzMDA1NTQwMDAxLCAtMTIyLjI2NjQ5MzE4M10sIFszNy44NTAwOTQ4NzUsIC0xMjIuMjY3NTU5NzM3OTk5OTldLCBbMzcuODcwMTg3MzY3LCAtMTIyLjI0OTY2ODIxNl0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NTk5MTcyODQwMDAxMDUsIC0xMjIuMjU0NTY1NjEzXSwgWzM3Ljg2NjMxMzQzMiwgLTEyMi4yNTYzNDcxMDJdLCBbMzcuODcyNTgwODQzLCAtMTIyLjI5MzI1MzU1Nzk5OTk5XSwgWzM3Ljg1OTc2NTc1MiwgLTEyMi4yNzE2OTU4MTVdLCBbMzcuODQ4NzQ5OTQwMDAwMSwgLTEyMi4yNzEzOTYyNTVdLCBbMzcuODY5NjI4MTk5LCAtMTIyLjI4ODA4OTQ0N10sIFszNy44NTY5MTc3ODAwMDAxLCAtMTIyLjI3OTc4OTkxN10sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg2OTg0NjI3MzAwMDEsIC0xMjIuMjY2NDI3NjQ1XSwgWzM3Ljg2MjQ0NjE4Njk5OTk5NiwgLTEyMi4yNzE5OTg4OTM5OTk5OV0sIFszNy44NTk1Mzc4MTgsIC0xMjIuMjU5MjA2MDA3OTk5OTldLCBbMzcuODY4MzA3NTQyLCAtMTIyLjI1NDQxMDY1NV0sIFszNy44NzcyMzE2NDQwMDAxLCAtMTIyLjI3ODI4NjUyNV0sIFszNy44NjE3OTM5MzIwMDAxMDQsIC0xMjIuMjUzNTA4MjZdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODY4NjQyODc1OTk5OTk2LCAtMTIyLjI3MzgzMDg2Nzk5OTk5XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjQyNTk5MjE5OTk5OTUsIC0xMjIuMzEzMzYwODA4XSwgWzM3Ljg1MTQ4Njg1NzAwMDEwNCwgLTEyMi4yNzg1OTQ0MTcwMDAwMV0sIFszNy44NjkzMTQ3NjMsIC0xMjIuMjk4MDkzMTQyOTk5OTldLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg2MzY0MTE5NCwgLTEyMi4zMTc2Mzk3MzJdLCBbMzcuODUzMjE4MjEwMDAwMSwgLTEyMi4yODA4MTMxODhdLCBbMzcuODUzOTAxNjYyMDAwMTA1LCAtMTIyLjI3NDIzNTM3ODk5OTk5XSwgWzM3Ljg0NDMzNjYwNTAwMDEsIC0xMjIuMjc1MTcwMDA0XSwgWzM3Ljg1ODUxODA0LCAtMTIyLjI4ODcyMTYwNV0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg1Mjc1MTI5NzAwMDEwNCwgLTEyMi4yODM3MjA1OF0sIFszNy44NzIzMjk2MzIwMDAxLCAtMTIyLjI2OTMxMzI0M10sIFszNy44OTE0MzA1MzYsIC0xMjIuMjc4MTg2ODM3XSwgWzM3Ljg2MzkxODE0NCwgLTEyMi4yNTM3MjEzMTVdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NzA5NzMzNjcsIC0xMjIuMjc0OTM5NzhdLCBbMzcuODc4MDg4MDMwNjIzNDk1LCAtMTIyLjMwNzYxMjQ1NjQzOV0sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODY2Njg2NzgzLCAtMTIyLjI2NzY3NzMxNF0sIFszNy44NTUxODA3ODAwMDAxLCAtMTIyLjI2NzM4NDEyNF0sIFszNy44NTQxNjQ3NzgwMDAwMDUsIC0xMjIuMjcyMTcxNzc3OTk5OTldLCBbMzcuODc1NDQ2ODIzMDAwMTA0LCAtMTIyLjI5MjMyMzExOV0sIFszNy44NjYzOTY5NTEwMDAxLCAtMTIyLjI3NzAwOTg1Nzk5OTk5XSwgWzM3Ljg2MzM1MzY2ODAwMDEsIC0xMjIuMjcyMTEyMzg0XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44Nzc3MDgzMTYwMDAxLCAtMTIyLjMwOTQ3OTA2ODk5OTk5XSwgWzM3Ljg1MTU4NzIzMzAwMDAwNCwgLTEyMi4yNzA3NzgyNTEwMDAwMV0sIFszNy44NjM2NTQzODMwMDAwMDQsIC0xMjIuMjkwMzYzMDA0XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODU3NjMwNzY2MDAwMSwgLTEyMi4yNzk2NzEzMTRdLCBbMzcuODQ4MTQ0OTE5LCAtMTIyLjI3NTg0MzU4MV0sIFszNy44NTE2NzQxMTYsIC0xMjIuMjc1MTgzMjg2XSwgWzM3Ljg1ODcxMjc5MzAwMDEsIC0xMjIuMjgwMTU1MTgxXSwgWzM3Ljg0MjY4MDM0MDAwMDEsIC0xMjIuMjc4ODgyNTQzXSwgWzM3Ljg3NDM2NjYzNiwgLTEyMi4zMDQ0NDk1NTIwMDAwMV0sIFszNy44NDY5NDM1NCwgLTEyMi4yODQ5OTA3NjFdLCBbMzcuODY0ODc2MjYwMDAwMSwgLTEyMi4yNjc0NzQ3OTFdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44Njc4MzQ2NzYsIC0xMjIuMjY1OTUxNDE3OTk5OTldLCBbMzcuODU1OTE4MDc3MDAwMTA1LCAtMTIyLjI4MDQxODk3XSwgWzM3Ljg3NDMwMjk0MywgLTEyMi4yOTg1ODgzMDVdLCBbMzcuODY3NjYyMTg0MDAwMDA0LCAtMTIyLjI5OTg5MTczMl0sIFszNy44NTIzOTE0OTcsIC0xMjIuMjc4ODA0OTA3MDAwMDFdLCBbMzcuODU1NjkzNTcsIC0xMjIuMjYzNDkzNzY3OTk5OTldLCBbMzcuODc4NzQwNTA1MDAwMSwgLTEyMi4yOTUyNDI2MjZdLCBbMzcuODU2MTg1OTUzMDAwMSwgLTEyMi4yNTk2NzM4OTg5OTk5OV0sIFszNy44NDMzNTQ4MjkwMDAxLCAtMTIyLjI3NzA2MjgxNV0sIFszNy44NjgxNDg4MzMwMDAxLCAtMTIyLjI5MTgxMDY3Nzk5OTk5XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg2ODQwOTM0ODAwMDEsIC0xMjIuMjYxNDUzNzc0XSwgWzM3Ljg2NzI2MzI0MzAwMDAwNCwgLTEyMi4yOTE1MjI1MDAwMDAwMV0sIFszNy44NjA0NjEzMDUwMDAxLCAtMTIyLjI1OTA3NTQ2N10sIFszNy44NTA2MDg5MDQwMDAxMDQsIC0xMjIuMjc4Mzg5NzY5XSwgWzM3Ljg2NzE0NTY1NDAwMDEwNSwgLTEyMi4yOTUxMDQwODFdLCBbMzcuODc2MDEzMzI3MDAwMSwgLTEyMi4yNzM1MDEyMDZdLCBbMzcuODc4MzAyMzM4MDAwMDA1LCAtMTIyLjMwNjU2NTUzNV0sIFszNy44Nzg5MjU5ODYwMDAxLCAtMTIyLjMwMzUyNzc3NV0sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44NzQyNzAwMzQwMDAxLCAtMTIyLjI2NTM3Njk0Nl0sIFszNy44Nzc1NDkzNzQwMDAxMDQsIC0xMjIuMjk0ODYyMDU2XSwgWzM3Ljg2MDE5NjQyMDAwMDEsIC0xMjIuMjk0MDU0MTkxXSwgWzM3Ljg2NDEyNjYzOTAwMDEsIC0xMjIuMjUwMjY4NDUxMDAwMDFdLCBbMzcuODUyNDkyMDc0MDAwMTA0LCAtMTIyLjI3MDg4NDcxOV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44Njc1OTM4NDMwMDAxLCAtMTIyLjI2Nzc3MzQyOF0sIFszNy44NjU3Nzk4LCAtMTIyLjI2NzU3NjAwNV0sIFszNy44NjY2MTQ5OTUwMDAxLCAtMTIyLjI2MTA4NzIwNl0sIFszNy44NjIzMTA4NDYwMDAxLCAtMTIyLjI1MDA5NTY5OTk5OTk5XSwgWzM3Ljg2NjMxMzQzMiwgLTEyMi4yNTYzNDcxMDJdLCBbMzcuODY4MTQ4ODMzMDAwMSwgLTEyMi4yOTE4MTA2Nzc5OTk5OV0sIFszNy44Njk3NTAwMjcwMDAxLCAtMTIyLjI5NTkzNDYwMjk5OTk5XSwgWzM3Ljg1NTMwMzY4OSwgLTEyMi4yOTI0NzIyMDEwMDAwMV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg4MDQ3NDE5NSwgLTEyMi4yOTU3OTkyMTVdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MzIxMDc0OTc0MjUsIC0xMjIuMjk3MTQ0NzI5NTYwMDJdLCBbMzcuODY2NDQ0MTExMDAwMSwgLTEyMi4zMDU1NTY1Njg5OTk5OV0sIFszNy44NTgyNDI5NzMwMDAxLCAtMTIyLjI1MjUyMTk5Nzk5OTk5XSwgWzM3Ljg2NDI1OTkyMTk5OTk5NSwgLTEyMi4zMTMzNjA4MDhdLCBbMzcuODYzMjc1OTI2MDM2OCwgLTEyMi4yNjQ5NjE4MDYyM10sIFszNy44NDc4OTQxNjE5OTk5OTYsIC0xMjIuMjc3NzY3MDExMDAwMDFdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODQ5Njk3NDQ4LCAtMTIyLjI3MTA1MTg0NzAwMDAxXSwgWzM3Ljg2OTU5NDk1OTAwMDAwNCwgLTEyMi4yNTIyOTI4MjFdLCBbMzcuODYwNjI1OTc4LCAtMTIyLjI3MTgwMTI0XSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODUyMDMwNjA0LCAtMTIyLjI2MDIzNzU5NjAwMDAxXSwgWzM3Ljg0OTA3NDQyMjAwMDEsIC0xMjIuMjg1NjcwNDg3XSwgWzM3Ljg1OTM0MjUxMjAwMDEwNCwgLTEyMi4yNjc0ODYxMTEwMDAwMV0sIFszNy44NTUxMTA3Mjc2NDY2MDQsIC0xMjIuMjg1Nzc3NDA2NTA5XSwgWzM3Ljg3MTE3MDExNzAwMDEwNSwgLTEyMi4yNjgyNzk2NDVdLCBbMzcuODY2NTQ0OTYxLCAtMTIyLjI3NTg5MDc5OV0sIFszNy44NjQ2MTY1NjE5OTk5OTUsIC0xMjIuMjkwNjcyMDcxXSwgWzM3Ljg2NjM4MTc4MSwgLTEyMi4yOTEyMzQ0MTIwMDAwMV0sIFszNy44NjEyNTAwMzUwMDAxLCAtMTIyLjI2NzA0NzEyODk5OTk5XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg2Mzk3MTQ4ODAwMDEwNCwgLTEyMi4yNjczNjMxNV0sIFszNy44NTI3NTEyOTcwMDAxMDQsIC0xMjIuMjgzNzIwNThdLCBbMzcuODQ3MjA1Njg2MDAwMSwgLTEyMi4yNzE2NzQ3NjNdLCBbMzcuODY0NTg2NTQwMDAwMSwgLTEyMi4yNTM0NDc4NDRdLCBbMzcuODY0NTU0MTc2MDAwMSwgLTEyMi4yNjk5MDQ1NjIwMDAwMV0sIFszNy44NTYwODA3MzIwMDAxLCAtMTIyLjI1Mjk0NzExN10sIFszNy44ODgwODk1NDQsIC0xMjIuMjc2Mzc3MjY3XSwgWzM3Ljg2NzIwMDk5NzAwMDEwNCwgLTEyMi4zMDIxNTEwNTI5OTk5OV0sIFszNy44NjIzMjk2MTQwMDAwMDQsIC0xMjIuMjU4ODExNDE0XSwgWzM3Ljg2NTE2MjMzMTAwMDEsIC0xMjIuMjg2NTU4Njg1XSwgWzM3Ljg1NjcyNTI4MDk5OTk5NiwgLTEyMi4yNjY2ODgxOThdLCBbMzcuODcxMTcwMTE3MDAwMTA1LCAtMTIyLjI2ODI3OTY0NV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODY3MzkzNjE4MDAwMSwgLTEyMi4yODE2Mzg1NzcwMDAwMV0sIFszNy44NTYxMzMxNjksIC0xMjIuMjcxMjgxNjgyMDAwMDFdLCBbMzcuODU5NzY1NzUyLCAtMTIyLjI3MTY5NTgxNV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzExMTI0MiwgLTEyMi4yODgyMDA2MzM5OTk5OV0sIFszNy44NzYzODI5NCwgLTEyMi4yOTQ0ODM4M10sIFszNy44NTM2MTIxMTIwMDAxLCAtMTIyLjI4NzE0NDg5Ml0sIFszNy44NzA5MjMwNzYwMDAwOTYsIC0xMjIuMjg5Njg0MzFdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44ODA3NDk0NzksIC0xMjIuMzA5MTY5MjMxXSwgWzM3Ljg3MDY4NDMyNTAwMDEsIC0xMjIuMjc5NzY4NTIzOTk5OTldLCBbMzcuODYzNTMyOTE3LCAtMTIyLjI4NDk2MjA1OV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU4NDYyMjE1LCAtMTIyLjI1MzE3NjYwMV0sIFszNy44NjMyNzUzNTIwMDAxLCAtMTIyLjI5NzM2NDY5NV0sIFszNy44NjczOTM2MTgwMDAxLCAtMTIyLjI4MTYzODU3NzAwMDAxXSwgWzM3Ljg2NDI0MDgyODAwMDEsIC0xMjIuMjY1MjQyMjE3MDAwMDFdLCBbMzcuODU1MzAwNTU0MDAwMSwgLTEyMi4yNjY0OTMxODNdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODcwNDEwNTYzMDAwMSwgLTEyMi4yODE5Mzc5ODRdLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NjIzMTA4NDYwMDAxLCAtMTIyLjI1MDA5NTY5OTk5OTk5XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODc5OTQwMTQ0LCAtMTIyLjI2OTcwMjM5N10sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODYzMzY0MzYyLCAtMTIyLjI1NzYxOTg0NV0sIFszNy44NjAzMzczNjAwMDAxLCAtMTIyLjI2NzA1MTM4NV0sIFszNy44NjU3Nzk4LCAtMTIyLjI2NzU3NjAwNV0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg1NDcyODk4NywgLTEyMi4yNjkwMTkxNzIwMDAwMV0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODUwMTkxNDUwMDAwMSwgLTEyMi4yOTQ1MTI5OTYwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NDk5MDk3NTMwMDAxMDUsIC0xMjIuMjkyNDc0Mzk2XSwgWzM3Ljg1MDE5MTQ1MDAwMDEsIC0xMjIuMjk0NTEyOTk2MDAwMDFdLCBbMzcuODUxMTgxMTMzMDAwMTA0LCAtMTIyLjI4OTIzNDA5OV0sIFszNy44NTAxOTE0NTAwMDAxLCAtMTIyLjI5NDUxMjk5NjAwMDAxXSwgWzM3Ljg2ODIxMTc5ODAwMDEwNCwgLTEyMi4yNTgwMzM4MDEwMDAwMV0sIFszNy44NzUzOTU5MTAwMDAxLCAtMTIyLjI3MTEyODM0MTAwMDAxXSwgWzM3Ljg3MjI3NjM4NjAwMDEsIC0xMjIuMjg4MzM2MTE1XSwgWzM3Ljg2MzkzNjI0MzAwMDEwNCwgLTEyMi4yNjA1MzE2MzIwMDAwMV0sIFszNy44NjU4MjM1MjgwMDAxLCAtMTIyLjI4MTQ3NjEzXSwgWzM3Ljg1MTQ4Njg1NzAwMDEwNCwgLTEyMi4yNzg1OTQ0MTcwMDAwMV0sIFszNy44NTYwODA3MzIwMDAxLCAtMTIyLjI1Mjk0NzExN10sIFszNy44Njc1MTMxNjEsIC0xMjIuMjYxMjczMTA1XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODU2NzI1MjgwOTk5OTk2LCAtMTIyLjI2NjY4ODE5OF0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODY1NDY3MjY2MDAwMSwgLTEyMi4yOTU3NDI1NTVdLCBbMzcuODYxNzIzMzAxLCAtMTIyLjI1NDc5NTQxNzk5OTk5XSwgWzM3Ljg1NDQxNzY1MDAwMDEsIC0xMjIuMjcxNzgwNzIyXSwgWzM3Ljg0ODcwNjI3ODAwMDEsIC0xMjIuMjYwNzE1NzIxXSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NjMyNTgzODgwMDAxMDUsIC0xMjIuMjU4Njk0ODU4XSwgWzM3Ljg1NjIwNjIwODAwMDEsIC0xMjIuMjg3OTc4MjAzXSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg1ODQyOTE5LCAtMTIyLjI5MzQ5MDA1NjAwMDAxXSwgWzM3Ljg2MzM1MzY2ODAwMDEsIC0xMjIuMjcyMTEyMzg0XSwgWzM3Ljg3MDMwMzczNDAwMDEsIC0xMjIuMjY4MDM1NTAzXSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg2MjMxMDg0NjAwMDEsIC0xMjIuMjUwMDk1Njk5OTk5OTldLCBbMzcuODYyNTU3MDM0MDAwMSwgLTEyMi4yNDU5NDU2N10sIFszNy44NjI1NTcwMzQwMDAxLCAtMTIyLjI0NTk0NTY3XSwgWzM3Ljg2MTc1MDYwNiwgLTEyMi4yNDY5ODMzODldLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjA3OTE4MDYwMDAxLCAtMTIyLjI1MTA3MzIzNF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NTQxNjQ3NzgwMDAwMDUsIC0xMjIuMjcyMTcxNzc3OTk5OTldLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODUzNTUwNzI2LCAtMTIyLjI3NjkzMDgyN10sIFszNy44ODQxMDQxMTgsIC0xMjIuMjY5MjA3MTYyXSwgWzM3Ljg2ODk5MTY2NDAwMDEsIC0xMjIuMjU2ODkyMTM5XSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NTEyMzU2MjcwMDAxLCAtMTIyLjI1MjQ3MDY0NzAwMDAxXSwgWzM3Ljg2NzI2ODQ2Njk5OTk5NSwgLTEyMi4yNzAyMzk1OTc5OTk5OV0sIFszNy44NTc5NjQxMjgsIC0xMjIuMjcxNDk1MTYyMDAwMDFdLCBbMzcuODUyOTkyNTQ4LCAtMTIyLjI3NDEzOTE2XSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODcwNTU5MTYsIC0xMjIuMjk4NDkyMzRdLCBbMzcuODQzOTc2MTA2MDAwMSwgLTEyMi4yNzI2MzM0NTIwMDAwMV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg3ODc0MDUwNTAwMDEsIC0xMjIuMjk1MjQyNjI2XSwgWzM3Ljg2OTA1NjQ0NDAwMDEsIC0xMjIuMjcwNDM0NzA3XSwgWzM3Ljg1MjkxOTc1MDE5MjQsIC0xMjIuMjY5OTY0MTIyODg2MDFdLCBbMzcuODUwNjgyMzMyMDAwMTA1LCAtMTIyLjI3MDY3NTI0Nzk5OTk5XSwgWzM3Ljg3NTY1ODk2NywgLTEyMi4yOTA2MDYwMDJdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NTMwNDQyMjA1OTU4LCAtMTIyLjI2OTczNzk3ODA2ODAxXSwgWzM3Ljg3NTMwNDMzMywgLTEyMi4yOTMxNjY3ODddLCBbMzcuODU0MzE2Mzg1MDAwMTA0LCAtMTIyLjI3MTA4NDE1NF0sIFszNy44NzMyMDE4NjEsIC0xMjIuMjg4NDM5ODU3MDAwMDFdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg3NTMwNDMzMywgLTEyMi4yOTMxNjY3ODddLCBbMzcuODY2OTcxNDYxLCAtMTIyLjI3MjUwNTQ0Mzk5OTk5XSwgWzM3Ljg2OTk4MTA4OTAwMDEsIC0xMjIuMjcwNTQ4NjAxXSwgWzM3Ljg2MjQ4MzAyMDAwMDEsIC0xMjIuMjQ3MDQ5MTM4XSwgWzM3Ljg2MjQ4MzAyMDAwMDEsIC0xMjIuMjQ3MDQ5MTM4XSwgWzM3Ljg2NDEyNjYzOTAwMDEsIC0xMjIuMjUwMjY4NDUxMDAwMDFdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjIzMTA4NDYwMDAxLCAtMTIyLjI1MDA5NTY5OTk5OTk5XSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODYyMTU1NTk2LCAtMTIyLjI2NzE1MTg1Mzk5OTk5XSwgWzM3Ljg0Nzk1NDA1MzAwMDEsIC0xMjIuMjcyMzEzMzE3OTk5OTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NjQ2MTY1NjE5OTk5OTUsIC0xMjIuMjkwNjcyMDcxXSwgWzM3Ljg3MTQ2NDIwNjk5OTk5NSwgLTEyMi4yNjU5NzM3MjldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODY0MjY0MTI4MDAwMSwgLTEyMi4yNzIyMTAzNjcwMDAwMV0sIFszNy44NjQyODc1OTMsIC0xMjIuMjc5MDk1MzUyOTk5OTldLCBbMzcuODY4Nzc0NDgyLCAtMTIyLjI3MjcwNDQ1XSwgWzM3Ljg3MDg0MDY3NDAwMDEsIC0xMjIuMjc4NTUyNTczXSwgWzM3Ljg3NzU0OTM3NDAwMDEwNCwgLTEyMi4yOTQ4NjIwNTZdLCBbMzcuODY5NjI4MTk5LCAtMTIyLjI4ODA4OTQ0N10sIFszNy44NzMzMDA2NjMwMDAxLCAtMTIyLjI3MzE5NTUxOF0sIFszNy44NjEyNTAwMzUwMDAxLCAtMTIyLjI2NzA0NzEyODk5OTk5XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODQ5NDM1NDAyLCAtMTIyLjI1MjI2ODkwMjk5OTk5XSwgWzM3Ljg0NjA0MTk4NywgLTEyMi4yODQ2OTI0NDc5OTk5OV0sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44NTY3MjUyODA5OTk5OTYsIC0xMjIuMjY2Njg4MTk4XSwgWzM3Ljg2NjgyMDQyMDc5NjcxLCAtMTIyLjMwMzcxOTgwNzkwMzAxXSwgWzM3Ljg2MzY1NDM4MzAwMDAwNCwgLTEyMi4yOTAzNjMwMDRdLCBbMzcuODU4NDYyMjE1LCAtMTIyLjI1MzE3NjYwMV0sIFszNy44OTAyODA0MTQwMDAxLCAtMTIyLjI5ODkwMDMyNzAwMDAxXSwgWzM3Ljg1NzA0NDgxLCAtMTIyLjI1MzA0MjY1Ml0sIFszNy44NTYxODU5NTMwMDAxLCAtMTIyLjI1OTY3Mzg5ODk5OTk5XSwgWzM3Ljg2MjQ4MzAyMDAwMDEsIC0xMjIuMjQ3MDQ5MTM4XSwgWzM3Ljg2MjU1NzAzNDAwMDEsIC0xMjIuMjQ1OTQ1NjddLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyNDgzMDIwMDAwMSwgLTEyMi4yNDcwNDkxMzhdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NzI0NDczMDkwMDAxLCAtMTIyLjI2NjA4MjAyMl0sIFszNy44NzQxNDU4MTEwMDAxLCAtMTIyLjI2NjI5MDUzN10sIFszNy44NzQxNDU4MTEwMDAxLCAtMTIyLjI2NjI5MDUzN10sIFszNy44NzU4OTEzNDgsIC0xMjIuMjg4Nzc2NzM3XSwgWzM3Ljg3NTg5MTM0OCwgLTEyMi4yODg3NzY3MzddLCBbMzcuODczODkwNDIwMDAwMSwgLTEyMi4yNjg1ODAxMzc5OTk5OV0sIFszNy44NjQxNTgyNzEwMDAxLCAtMTIyLjI5Mjk1MTIxMl0sIFszNy44NDkwNTEwNDQwMDAxLCAtMTIyLjI2OTA5ODI5NV0sIFszNy44NTc0NjM3NTIwMDAxLCAtMTIyLjI2ODA5MTU0ODk5OTk5XSwgWzM3Ljg2Mjg1NDgzMywgLTEyMi4yOTAxMDYzODcwMDAwMV0sIFszNy44NjkyMDEyMzEsIC0xMjIuMjY5Mjk2NDYxMDAwMDFdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg2NzU5Mjc3MzAwMDEwNSwgLTEyMi4yOTI4ODUyMzFdLCBbMzcuODU1ODExMzYxMDAwMSwgLTEyMi4yODEyNTY1MDhdLCBbMzcuODY2MzEzNDMyLCAtMTIyLjI1NjM0NzEwMl0sIFszNy44NDg3MDYyNzgwMDAxLCAtMTIyLjI2MDcxNTcyMV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NzA1ODI0NiwgLTEyMi4yNzI4OTMxOTM5OTk5OV0sIFszNy44NjM5MTgxNDQsIC0xMjIuMjUzNzIxMzE1XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODU1MzAwNTU0MDAwMSwgLTEyMi4yNjY0OTMxODNdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODUwNjA4OTA0MDAwMTA0LCAtMTIyLjI3ODM4OTc2OV0sIFszNy44NTUyMzM5NTksIC0xMjIuMjc3MjQxMzU2XSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg1ODU4MTc4NzUzODcwNCwgLTEyMi4yOTIzMTkyMzMwMjNdLCBbMzcuODY3ODA5MDQ0MDAwMTA0LCAtMTIyLjI1ODk3NTk4NjAwMDAxXSwgWzM3Ljg2MjE5NTk5NSwgLTEyMi4yODEwOTI3ODhdLCBbMzcuODY4MTA4NDg4MDAwMTA0LCAtMTIyLjI1NjcxMzU3M10sIFszNy44NTcxMDEyNzMwMDAxMDQsIC0xMjIuMjg2MjM0NjQ3OTk5OTldLCBbMzcuODY3MjA3NTM5LCAtMTIyLjI1NjUyOTM3N10sIFszNy44ODI1MzExNDcwMDAxLCAtMTIyLjI5Njg3Mzc5N10sIFszNy44NTQ0NDAyMDgsIC0xMjIuMjU5OTE0ODI3OTk5OTldLCBbMzcuODYzMjU4Mzg4MDAwMTA1LCAtMTIyLjI1ODY5NDg1OF0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODY3NzYyNTUwMDAwMSwgLTEyMi4yNTIwMzY0NDJdLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NDcxNTc1OTgsIC0xMjIuMzAwMjExNjRdLCBbMzcuODY2OTA3OTk2MDAwMSwgLTEyMi4yNTg3OTg2OTddLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODU3MTIyNDU4LCAtMTIyLjI1OTU0NTQwOV0sIFszNy44Njg3MjcyMzUwMDAxLCAtMTIyLjI2NzQ3NzIyN10sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODQ1MTI4MzU2LCAtMTIyLjI3MDkzNzQzMTAwMDAxXSwgWzM3Ljg2OTA1NjQ0NDAwMDEsIC0xMjIuMjcwNDM0NzA3XSwgWzM3Ljg2ODMxNjA5MiwgLTEyMi4yNjkxMTI1MDEwMDAwMV0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NjA0MjA3ODksIC0xMjIuMjkyOTM3MTAyOTk5OTldLCBbMzcuODc0NzkyNTk4MDAwMSwgLTEyMi4yNjg2ODEzNDc5OTk5OV0sIFszNy44NTAxOTE0NTAwMDAxLCAtMTIyLjI5NDUxMjk5NjAwMDAxXSwgWzM3Ljg3MjMzMTgsIC0xMjIuMjk5MDYwMjg1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg2ODE0ODgzMzAwMDEsIC0xMjIuMjkxODEwNjc3OTk5OTldLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44ODAyNDgxNTMwMDAwMDQsIC0xMjIuMzA2MzM5MjY4OTk5OTldLCBbMzcuODcxMTcwMTE3MDAwMTA1LCAtMTIyLjI2ODI3OTY0NV0sIFszNy44NTkzNDI1MTIwMDAxMDQsIC0xMjIuMjY3NDg2MTExMDAwMDFdLCBbMzcuODcyOTY0NTk0MDAwMSwgLTEyMi4zMDUyNDUzNTVdLCBbMzcuODY5NjkxODU1LCAtMTIyLjI3Mjc5OTE0XSwgWzM3Ljg2NDg3NjI2MDAwMDEsIC0xMjIuMjY3NDc0NzkxXSwgWzM3Ljg2NjM2MjM4NTAwMDEsIC0xMjIuMjcwMTI0NDA4OTk5OTldLCBbMzcuODUwMTgzNDUxMDAwMSwgLTEyMi4yNjA0OTUwNDI5OTk5OV0sIFszNy44NDk1MDM2MTUwMDAxLCAtMTIyLjI2NTczNjU0NV0sIFszNy44NjM0NjY3NCwgLTEyMi4yNjYyNDMzMDZdLCBbMzcuODU4MDY1MzY1MDAwMSwgLTEyMi4yNDUyOTYwNDNdLCBbMzcuODU2ODg1NTk3LCAtMTIyLjI1NDIzNzU2MTAwMDAxXSwgWzM3Ljg1NzA0NDgxLCAtMTIyLjI1MzA0MjY1Ml0sIFszNy44NTMwMDg3MDgwMDAxMDQsIC0xMjIuMjg2OTUwMjE4OTk5OTldLCBbMzcuODczMDI1OTI2LCAtMTIyLjI2ODQ4NTIwODk5OTk5XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODc2ODg4NDc3MDAwMSwgLTEyMi4yNjY2NTczMzVdLCBbMzcuODczMzAwNjYzMDAwMSwgLTEyMi4yNzMxOTU1MThdLCBbMzcuODczNjAwMTg2LCAtMTIyLjI3MDkwMDA3MV0sIFszNy44NjYwMzYzOTEwMDAxLCAtMTIyLjI5NTU4MzgxMV0sIFszNy44Nzg3MDc5MDAwMDAxLCAtMTIyLjI2Njg2MTgxXSwgWzM3Ljg3MzAyNTkyNiwgLTEyMi4yNjg0ODUyMDg5OTk5OV0sIFszNy44NzA1ODQ1MjMwMDAwMDUsIC0xMjIuMjY1ODgzNDg2XSwgWzM3Ljg3NDE0NTgxMTAwMDEsIC0xMjIuMjY2MjkwNTM3XSwgWzM3Ljg3MzM2NzEwNTAwMDEsIC0xMjIuMjY2MTgyMDYyOTk5OTldLCBbMzcuODczMDI1OTI2LCAtMTIyLjI2ODQ4NTIwODk5OTk5XSwgWzM3Ljg3ODA4ODAzMDYyMzQ5NSwgLTEyMi4zMDc2MTI0NTY0MzldLCBbMzcuODM5ODE4MDUyMDAwMTA1LCAtMTIyLjI2OTU1NzkzXSwgWzM3Ljg0ODQ1MTA4NjAwMDEsIC0xMjIuMjczNjEzMTddLCBbMzcuODUxNTg3MjMzMDAwMDA0LCAtMTIyLjI3MDc3ODI1MTAwMDAxXSwgWzM3Ljg2MTM5NTgwMjAwMDEwNCwgLTEyMi4yNTg5NDM0NTddLCBbMzcuODYxMzk1ODAyMDAwMTA0LCAtMTIyLjI1ODk0MzQ1N10sIFszNy44NzM4OTA0MjAwMDAxLCAtMTIyLjI2ODU4MDEzNzk5OTk5XSwgWzM3Ljg0NzAzODEzNDAwMDEsIC0xMjIuMjc3NDEyNTY3OTk5OTldLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MzAwODcwODAwMDEwNCwgLTEyMi4yODY5NTAyMTg5OTk5OV0sIFszNy44NTI0OTIwNzQwMDAxMDQsIC0xMjIuMjcwODg0NzE5XSwgWzM3Ljg2NDYxNjU2MTk5OTk5NSwgLTEyMi4yOTA2NzIwNzFdLCBbMzcuODUyMDMwNjA0LCAtMTIyLjI2MDIzNzU5NjAwMDAxXSwgWzM3Ljg2MzkzNjI0MzAwMDEwNCwgLTEyMi4yNjA1MzE2MzIwMDAwMV0sIFszNy44NjI5OTM5MTMyNDIyLCAtMTIyLjI2NzE3Mzc4NTc0NDk5XSwgWzM3Ljg3MDg0MDY3NDAwMDEsIC0xMjIuMjc4NTUyNTczXSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NTIwNDEzMjksIC0xMjIuMjg2MjgwODUyXSwgWzM3Ljg1NTY5MzU3LCAtMTIyLjI2MzQ5Mzc2Nzk5OTk5XSwgWzM3Ljg0Njk0MzU0LCAtMTIyLjI4NDk5MDc2MV0sIFszNy44NTQ5MTg3MjkwMDAxMDQsIC0xMjIuMjg3NTY0MzY2XSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NzE4ODQ0MTMwMDAwMDQsIC0xMjIuMzAxMjQ0NTg1XSwgWzM3Ljg2NzY2MjE4NDAwMDAwNCwgLTEyMi4yOTk4OTE3MzJdLCBbMzcuODU1MzAwNTU0MDAwMSwgLTEyMi4yNjY0OTMxODNdLCBbMzcuODY1NDY3MjY2MDAwMSwgLTEyMi4yOTU3NDI1NTVdLCBbMzcuODU3NjAwNjI5MDAwMDA0LCAtMTIyLjI4MjQxMTU0OF0sIFszNy44NjQyNDA4MjgwMDAxLCAtMTIyLjI2NTI0MjIxNzAwMDAxXSwgWzM3Ljg3MDk3NDYwNjAwMDEsIC0xMjIuMjc3NTAyNDE4XSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NjA2MjU5NzgsIC0xMjIuMjcxODAxMjRdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg0OTUwMzYxNTAwMDEsIC0xMjIuMjY1NzM2NTQ1XSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg2NDUzODExNTAwMDEsIC0xMjIuMjYyOTkzNzQ2XSwgWzM3Ljg3ODA1NDk0ODAwMDEsIC0xMjIuMjk4NjQxMTg2XSwgWzM3Ljg0ODgyMjc5OTAwMDEwNCwgLTEyMi4yNzc5Nzk3Nzg5OTk5OV0sIFszNy44NzAyMjM5ODI3ODQ3OSwgLTEyMi4yNzMxNzE2OTE2NjJdLCBbMzcuODU2MTMzMTY5LCAtMTIyLjI3MTI4MTY4MjAwMDAxXSwgWzM3Ljg2NTE3MTE1NSwgLTEyMi4yNzIzMDgyNDcwMDAwMV0sIFszNy44NjM2NDg2NjMsIC0xMjIuMjY5Nzk4MDY3MDAwMDFdLCBbMzcuODQ4MzgwNjAwMDAwMDA2LCAtMTIyLjI3MjAxODU1OF0sIFszNy44NTI3NTEyOTcwMDAxMDQsIC0xMjIuMjgzNzIwNThdLCBbMzcuODUwOTcwODksIC0xMjIuMjg2Mjk0OTIxXSwgWzM3Ljg2NDM4MDQ4MjAwMDEsIC0xMjIuMjkxODM5MTkyMDAwMDFdLCBbMzcuODUxMjM1NjI3MDAwMSwgLTEyMi4yNTI0NzA2NDcwMDAwMV0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NTg4OTMwMjkwMDAxLCAtMTIyLjI2NDEyNzU5Nzk5OTk5XSwgWzM3Ljg2MjE1NTU5NiwgLTEyMi4yNjcxNTE4NTM5OTk5OV0sIFszNy44NjEzOTU4MDIwMDAxMDQsIC0xMjIuMjU4OTQzNDU3XSwgWzM3Ljg2MzM0ODMwOTAwMDEsIC0xMjIuMjY1MDQ2MDEzOTk5OTldLCBbMzcuODQ0MzM2NjA1MDAwMSwgLTEyMi4yNzUxNzAwMDRdLCBbMzcuODUyMzk1NTAzMDAwMDA0LCAtMTIyLjI4MTE4OTk4NV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3LjgzOTUyOTEzOCwgLTEyMi4yODkxODI3OTZdLCBbMzcuODcwNTgyNDYsIC0xMjIuMjcyODkzMTkzOTk5OTldLCBbMzcuODUzOTM1MDY4MDAwMTA1LCAtMTIyLjI4OTY2OTQ1OV0sIFszNy44NTMwMDg3MDgwMDAxMDQsIC0xMjIuMjg2OTUwMjE4OTk5OTldLCBbMzcuODQ4ODU5MzAwMDAwMSwgLTEyMi4yOTIxNTQzNDFdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NzE3NDkzNywgLTEyMi4yNzE4ODM4NzZdLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg2MzI1ODM4ODAwMDEwNSwgLTEyMi4yNTg2OTQ4NThdLCBbMzcuODY4NjQyODc1OTk5OTk2LCAtMTIyLjI3MzgzMDg2Nzk5OTk5XSwgWzM3Ljg1OTk4Mjg1NDAwMDEsIC0xMjIuMjk1MDkzNTk3XSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY2OTE4MDI4LCAtMTIyLjI5NjIwOTA1M10sIFszNy44NTIyMjYzMTIsIC0xMjIuMjkxNDk1NDQyOTk5OTldLCBbMzcuODY4ODM3OTIyMDAwMTA0LCAtMTIyLjI2ODY0MzY4Ml0sIFszNy44NzU1NDMxODcwMDAxMDUsIC0xMjIuMjkxNDQ4NzI5XSwgWzM3Ljg3ODQxNjEyNiwgLTEyMi4yNjkxMDM4OThdLCBbMzcuODcwNTg0NTIzMDAwMDA1LCAtMTIyLjI2NTg4MzQ4Nl0sIFszNy44NzA1ODQ1MjMwMDAwMDUsIC0xMjIuMjY1ODgzNDg2XSwgWzM3Ljg2ODcyNzIzNTAwMDEsIC0xMjIuMjY3NDc3MjI3XSwgWzM3Ljg3MjMyOTYzMjAwMDEsIC0xMjIuMjY5MzEzMjQzXSwgWzM3Ljg2NDQ3MzQ4NjAwMDEsIC0xMjIuMjU4MjE0NjZdLCBbMzcuODYxMDU5NjY2MDAwMSwgLTEyMi4yNTI3MDMxODJdLCBbMzcuODYyMTU1NTk2LCAtMTIyLjI2NzE1MTg1Mzk5OTk5XSwgWzM3Ljg1NzEyMjQ1OCwgLTEyMi4yNTk1NDU0MDldLCBbMzcuODY4NzE2NzQ4MDAwMTA0LCAtMTIyLjI2NjIwMjgzNzAwMDAxXSwgWzM3Ljg1MTMwNjM1ODQ0MDMsIC0xMjIuMjg2MjM3NjU2OTk4MDFdLCBbMzcuODU5NzY1NzUyLCAtMTIyLjI3MTY5NTgxNV0sIFszNy44NzEyNDU1NDMsIC0xMjIuMjY3NjkwNjYxXSwgWzM3Ljg0OTA3NDQyMjAwMDEsIC0xMjIuMjg1NjcwNDg3XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg2NzU5Mjc3MzAwMDEwNSwgLTEyMi4yOTI4ODUyMzFdLCBbMzcuODYyNjEzMjk5LCAtMTIyLjI5MTI3MTYxXSwgWzM3Ljg1NDkxODcyOTAwMDEwNCwgLTEyMi4yODc1NjQzNjZdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44Njg0OTQxNDMwMDAxLCAtMTIyLjI3NDk1NTE1OF0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MDUzMjM2NSwgLTEyMi4yODYxNTEwNDldLCBbMzcuODc3NTQ2NDg0MDAwMSwgLTEyMi4yODA1NDEzNThdLCBbMzcuODU2MDIwOTkyLCAtMTIyLjI3OTYwNTU3NF0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MDY4MjMzMjAwMDEwNSwgLTEyMi4yNzA2NzUyNDc5OTk5OV0sIFszNy44NTM4MTUzNDUsIC0xMjIuMjY2MzAxOTI2XSwgWzM3Ljg2NTAzNzY5OSwgLTEyMi4yOTc5MzIzMDRdLCBbMzcuODYzNTEwNTEsIC0xMjIuMjk2MjE2NjMzOTk5OTldLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODY4NzM4MzczLCAtMTIyLjI4NzMwMzE1NjAwMDAxXSwgWzM3Ljg1NDUwMzkyNCwgLTEyMi4yODE4NDUyMjZdLCBbMzcuODY5NDc4ODQ2MDAwMSwgLTEyMi4yOTM4MzY0NjZdLCBbMzcuODYzNjU0MzgzMDAwMDA0LCAtMTIyLjI5MDM2MzAwNF0sIFszNy44NDYwMTUxMTYsIC0xMjIuMjcxMTIzMTI0XSwgWzM3Ljg0NjA0Nzk4NzAwMDEwNSwgLTEyMi4yNzA4NjM0NzFdLCBbMzcuODQ3MjA1Njg2MDAwMSwgLTEyMi4yNzE2NzQ3NjNdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODg5NDExNDQ0MDAwMSwgLTEyMi4yODE4NDUwNjZdLCBbMzcuODYyMTEwNzIyMDAwMTA0LCAtMTIyLjI1MzUzOTk5NV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY2MTAzNjE4ODc1MSwgLTEyMi4zMDU2ODgxMzUwMzA5OV0sIFszNy44NjYzMTM0MzIsIC0xMjIuMjU2MzQ3MTAyXSwgWzM3Ljg1MzQ0NTQ3ODAwMDAwNSwgLTEyMi4yNjk1MTg2NTddLCBbMzcuODU4NDYyMjE1LCAtMTIyLjI1MzE3NjYwMV0sIFszNy44Njc3NjI1NTAwMDAxLCAtMTIyLjI1MjAzNjQ0Ml0sIFszNy44NDgzNTQ0OTQsIC0xMjIuMjgxNTI5NTQ5XSwgWzM3Ljg2ODk5MTY2NDAwMDEsIC0xMjIuMjU2ODkyMTM5XSwgWzM3Ljg2ODQyMzUxMywgLTEyMi4yOTU1MTYxNDldLCBbMzcuODQ0NzQzMjcxLCAtMTIyLjI4NDI4MTY1XSwgWzM3Ljg2Nzk5MzkwMzAwMDEwNSwgLTEyMi4yOTc2NjQzOThdLCBbMzcuODY1OTU3OTg3ODcwNiwgLTEyMi4yNjU1NzMyNTM1Nl0sIFszNy44NDU0NjIyNDgwMDAwMDQsIC0xMjIuMjc1Mjc2MDE0XSwgWzM3Ljg3MTY4MDE1NCwgLTEyMi4yNjkyNjQ3OTldLCBbMzcuODUzODk2MTM3LCAtMTIyLjI1MjczMDkzOV0sIFszNy44NTQwMjk2NzUsIC0xMjIuMjczMjExMjldLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44Nzk0NTgwMTgsIC0xMjIuMjkxNjc5MDc4OTk5OTldLCBbMzcuODY2NjA4ODM2MDAwMSwgLTEyMi4yNTQwNzU5N10sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NTA2ODIzMzIwMDAxMDUsIC0xMjIuMjcwNjc1MjQ3OTk5OTldLCBbMzcuODUyOTE5NzUwMTkyNCwgLTEyMi4yNjk5NjQxMjI4ODYwMV0sIFszNy44NTI0OTIwNzQwMDAxMDQsIC0xMjIuMjcwODg0NzE5XSwgWzM3Ljg1MjQ5MjA3NDAwMDEwNCwgLTEyMi4yNzA4ODQ3MTldLCBbMzcuODUyNDkyMDc0MDAwMTA0LCAtMTIyLjI3MDg4NDcxOV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODU0ODYwNTcyMDAwMTA2LCAtMTIyLjI1NTIzMTYwNzAwMDAxXSwgWzM3Ljg1NDQ2Njc0ODAwMDEsIC0xMjIuMjQ4MTk1ODZdLCBbMzcuODUwMzQ4ODY5MDAwMSwgLTEyMi4yNTIzNzE1NTddLCBbMzcuODU0NDY2NzQ4MDAwMSwgLTEyMi4yNDgxOTU4Nl0sIFszNy44NTIyNzUzNjMwMDAwMDQsIC0xMjIuMjQ5OTY2Mzc0XSwgWzM3Ljg0OTQzNTQwMiwgLTEyMi4yNTIyNjg5MDI5OTk5OV0sIFszNy44NDk1MDM2MTUwMDAxLCAtMTIyLjI2NTczNjU0NV0sIFszNy44Njg0OTQxNDMwMDAxLCAtMTIyLjI3NDk1NTE1OF0sIFszNy44NjQ4MjgyNTQsIC0xMjIuMjYwNzE1NjQxXSwgWzM3Ljg1NDcyODk4NywgLTEyMi4yNjkwMTkxNzIwMDAwMV0sIFszNy44Njg2NzgxNjYwMDAxLCAtMTIyLjI1MjI1MDM3MV0sIFszNy44NjEwOTQzOTY5OTk5OTUsIC0xMjIuMjg5NTQ1OTUxMDAwMDFdLCBbMzcuODUzODk2MTM3LCAtMTIyLjI1MjczMDkzOV0sIFszNy44NjQ1NzY1OTEwMDAxLCAtMTIyLjI3NjgyMjQ2OV0sIFszNy44NjE4NjAwNDMsIC0xMjIuMjYyNDM5ODU2XSwgWzM3Ljg2MjQ2NDQ4MzAwMDEsIC0xMjIuMjY0ODY1NjE1XSwgWzM3Ljg2MjE1NTU5NiwgLTEyMi4yNjcxNTE4NTM5OTk5OV0sIFszNy44NjQ2MTY1NjE5OTk5OTUsIC0xMjIuMjkwNjcyMDcxXSwgWzM3Ljg2NDE5MTQ5NTAwMDEsIC0xMjIuMjU4NTY0NTI0XSwgWzM3Ljg0ODAzNTA0MywgLTEyMi4yODUzNDE3NzFdLCBbMzcuODM5ODE4MDUyMDAwMTA1LCAtMTIyLjI2OTU1NzkzXSwgWzM3Ljg2Nzg0NzAzMTAwMDA5NiwgLTEyMi4yNjU4NTk4OTVdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODU0MTc3NjA2MDAwMSwgLTEyMi4yNzkyMTQ5NF0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg2MzY0ODY2MywgLTEyMi4yNjk3OTgwNjcwMDAwMV0sIFszNy44Njk1OTQ5NTkwMDAwMDQsIC0xMjIuMjUyMjkyODIxXSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg4MzI5MzQ2NywgLTEyMi4yOTYzNjA4NTcwMDAwMV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODY2OTA3OTk2MDAwMSwgLTEyMi4yNTg3OTg2OTddLCBbMzcuODY4NjQzNjYxMDAwMSwgLTEyMi4yOTQ0MDU3NTRdLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44Njc2NjIxODQwMDAwMDQsIC0xMjIuMjk5ODkxNzMyXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg4MTU4MDY4NzAwMDEsIC0xMjIuMjk5NzUyNDkyOTk5OTldLCBbMzcuODY4MzE2MDkyLCAtMTIyLjI2OTExMjUwMTAwMDAxXSwgWzM3Ljg0OTA3MDA3MjAwMDEsIC0xMjIuMjc2MDE0Njg0XSwgWzM3Ljg4MDA4NjI4MiwgLTEyMi4zMDcyMjIzODRdLCBbMzcuODc5MTI4MzAzMDAwMSwgLTEyMi4zMDI0NjUzMzldLCBbMzcuODY2MzI0MjE1MDAwMSwgLTEyMi4yNjMzNjE4ODZdLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODY4NDA5MzQ4MDAwMSwgLTEyMi4yNjE0NTM3NzRdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODU0OTExOTExLCAtMTIyLjI3OTM4MTUxNV0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44NDYwMTUxMTYsIC0xMjIuMjcxMTIzMTI0XSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODUzMzM0NzUxLCAtMTIyLjI5MDEyNzE0NV0sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg2NDI1OTkyMTk5OTk5NSwgLTEyMi4zMTMzNjA4MDhdLCBbMzcuODU0MTc3NjA2MDAwMSwgLTEyMi4yNzkyMTQ5NF0sIFszNy44NTM1NTA3MjYsIC0xMjIuMjc2OTMwODI3XSwgWzM3Ljg1NzU4NzI0OTAwMDEwNSwgLTEyMi4yODAzNTk1NjhdLCBbMzcuODczODkwNDIwMDAwMSwgLTEyMi4yNjg1ODAxMzc5OTk5OV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODgwMjQ4MTUzMDAwMDA0LCAtMTIyLjMwNjMzOTI2ODk5OTk5XSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44NTMzMzQ3NTEsIC0xMjIuMjkwMTI3MTQ1XSwgWzM3Ljg1NDkxMTkxMSwgLTEyMi4yNzkzODE1MTVdLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODYzNzE0NTYyLCAtMTIyLjI5NTE3MTc2Nzk5OTk5XSwgWzM3Ljg2MjM5NjYxMTAwMDEsIC0xMjIuMjkyMzgyMDAyOTk5OTldLCBbMzcuODU2ODUzMzI5LCAtMTIyLjI4ODE4NzgwMjk5OTk5XSwgWzM3Ljg2MjQ0NjE4Njk5OTk5NiwgLTEyMi4yNzE5OTg4OTM5OTk5OV0sIFszNy44ODAwMjQwODEsIC0xMjIuMjk4MDc1NTM5XSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2ODgxODU4MjIzNDMsIC0xMjIuMzE2OTUwNzczMTg2XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NTA5NzA4OSwgLTEyMi4yODYyOTQ5MjFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg2OTQzNjYwNzc5OTEsIC0xMjIuMjQ5NjQ1NDg0NTYzXSwgWzM3Ljg2ODMxNjA5MiwgLTEyMi4yNjkxMTI1MDEwMDAwMV0sIFszNy44NzE0MjY4NCwgLTEyMi4zMDM1MDgyOTk5OTk5OV0sIFszNy44Njk3NTAwMjcwMDAxLCAtMTIyLjI5NTkzNDYwMjk5OTk5XSwgWzM3Ljg2OTc4MjYzNSwgLTEyMi4zMDExMjQ0MDIwMDAwMV0sIFszNy44NjkzOTE5NywgLTEyMi4yNjc5MzIzNDNdLCBbMzcuODcxMTcwMTE3MDAwMTA1LCAtMTIyLjI2ODI3OTY0NV0sIFszNy44NTAzNTU1MzE3Mjc3MSwgLTEyMi4yODM1NjI3Nzg4NDU5OV0sIFszNy44NjM2NDg2NjMsIC0xMjIuMjY5Nzk4MDY3MDAwMDFdLCBbMzcuODU0NzI4OTg3LCAtMTIyLjI2OTAxOTE3MjAwMDAxXSwgWzM3Ljg3NjAxMzMyNzAwMDEsIC0xMjIuMjczNTAxMjA2XSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODY0MTI2NjM5MDAwMSwgLTEyMi4yNTAyNjg0NTEwMDAwMV0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg1MzM2MjI5MywgLTEyMi4yNjQxMzI5NDFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NjgyOTA1MDgsIC0xMjIuMjk4MjQ4NDc3OTk5OTldLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg3NjM4Mjk0LCAtMTIyLjI5NDQ4MzgzXSwgWzM3Ljg2ODQxMjc4NSwgLTEyMi4yOTY5NzQ5M10sIFszNy44Njc4NjY3NTEwMDAxLCAtMTIyLjI5ODg0NzUyOV0sIFszNy44NTUzMDM2ODksIC0xMjIuMjkyNDcyMjAxMDAwMDFdLCBbMzcuODcwNDEwNTYzMDAwMSwgLTEyMi4yODE5Mzc5ODRdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODU1NTI2NDUzLCAtMTIyLjI5MTM2OTAwMzk5OTk5XSwgWzM3Ljg4MDQ4NTM2MTA4MDQ5NSwgLTEyMi4zMDUxNjU3MDQ3ODddLCBbMzcuODgwMjUyNjI4MDAwMSwgLTEyMi4yOTY5NTY1MzFdLCBbMzcuODczODkwNDIwMDAwMSwgLTEyMi4yNjg1ODAxMzc5OTk5OV0sIFszNy44ODMyNDQ0NDgsIC0xMjIuMjc0MzA4MzRdLCBbMzcuODUzNTUwNzI2LCAtMTIyLjI3NjkzMDgyN10sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg2NDM4MDQ4MjAwMDEsIC0xMjIuMjkxODM5MTkyMDAwMDFdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODUxMjM1NjI3MDAwMSwgLTEyMi4yNTI0NzA2NDcwMDAwMV0sIFszNy44MzcyMTUwMTEwMDAxLCAtMTIyLjI2ODU1MzE1NF0sIFszNy44NzcwODkxMjkwMDAxMDUsIC0xMjIuMjk3MTI5Mzk2XSwgWzM3Ljg1NjcyNTI4MDk5OTk5NiwgLTEyMi4yNjY2ODgxOThdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg4MDcwMjU2MTAwMDEsIC0xMjIuMzA0MTA2NF0sIFszNy44NDkwNzAwNzIwMDAxLCAtMTIyLjI3NjAxNDY4NF0sIFszNy44NjQ5Njc0MDEwMDAxLCAtMTIyLjI1NTkxMDAyXSwgWzM3Ljg2ODgxODU4MjIzNDMsIC0xMjIuMzE2OTUwNzczMTg2XSwgWzM3Ljg1NTk4MzcyNDAwMDEwNCwgLTEyMi4yNzIzNjI0NjZdLCBbMzcuODU3OTY0MTI4LCAtMTIyLjI3MTQ5NTE2MjAwMDAxXSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODQ3MjA4Njg4MDAwMSwgLTEyMi4yOTQ4MTYyNjddLCBbMzcuODcyNjk5OTM5LCAtMTIyLjI3MDcxNzQ1OF0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODYzNTEwNTEsIC0xMjIuMjk2MjE2NjMzOTk5OTldLCBbMzcuODcwMjg3MDEyMDAwMTA1LCAtMTIyLjI3NTE0MzU5M10sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg1NTk5NDEzOTAwMDEsIC0xMjIuMjg4MjY1MDY2MDAwMDFdLCBbMzcuODU2MjA2MjA4MDAwMSwgLTEyMi4yODc5NzgyMDNdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODcyNDI4MzcxMDAwMSwgLTEyMi4yNzk5NjExMDZdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODUxMjM1NjI3MDAwMSwgLTEyMi4yNTI0NzA2NDcwMDAwMV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg0Njk0MzU0LCAtMTIyLjI4NDk5MDc2MV0sIFszNy44NTEyMzU2MjcwMDAxLCAtMTIyLjI1MjQ3MDY0NzAwMDAxXSwgWzM3Ljg1ODA2NTM2NTAwMDEsIC0xMjIuMjQ1Mjk2MDQzXSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg2ODEwODQ4ODAwMDEwNCwgLTEyMi4yNTY3MTM1NzNdLCBbMzcuODcwMTMzNzkxMDAwMSwgLTEyMi4yODE1MzEzNzRdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg2OTQzNjgwMTAwMDEsIC0xMjIuMjg5NTIwMjUyXSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODYwMDI5OTU3MDAwMSwgLTEyMi4yNjk0MTldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY5OTgxMDg5MDAwMSwgLTEyMi4yNzA1NDg2MDFdLCBbMzcuODcxNDY0MjA2OTk5OTk1LCAtMTIyLjI2NTk3MzcyOV0sIFszNy44NTYxMzMxNjksIC0xMjIuMjcxMjgxNjgyMDAwMDFdLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44Njc3NjI1NTAwMDAxLCAtMTIyLjI1MjAzNjQ0Ml0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg1MDM0ODg2OTAwMDEsIC0xMjIuMjUyMzcxNTU3XSwgWzM3Ljg3MTc0OTM3LCAtMTIyLjI3MTg4Mzg3Nl0sIFszNy44NDc4OTQxNjE5OTk5OTYsIC0xMjIuMjc3NzY3MDExMDAwMDFdLCBbMzcuODg1NDE1MDkyMDAwMSwgLTEyMi4yNzQ5NDc3MTI5OTk5OV0sIFszNy44NjE1MzAzMTYsIC0xMjIuMjcxODk1NTkyXSwgWzM3Ljg3MzQ0MjU1OTAwMDEwNCwgLTEyMi4yOTM1MzA4MTRdLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44Njg4Mzc5MjIwMDAxMDQsIC0xMjIuMjY4NjQzNjgyXSwgWzM3Ljg1OTI4MTQ1LCAtMTIyLjMxNTg0OTE0XSwgWzM3Ljg0OTY5MDU1ODAwMDEwNiwgLTEyMi4yNzgxNzcyNDM5OTk5OV0sIFszNy44NjYwNjAzNjEwMDAxLCAtMTIyLjI0ODQxNTM2N10sIFszNy44NDYwNDE5ODcsIC0xMjIuMjg0NjkyNDQ3OTk5OTldLCBbMzcuODY3MjYzMjQzMDAwMDA0LCAtMTIyLjI5MTUyMjUwMDAwMDAxXSwgWzM3Ljg0MjY4MDM0MDAwMDEsIC0xMjIuMjc4ODgyNTQzXSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODU5MjkxMzU1LCAtMTIyLjI4MjY3OTA5NjAwMDAxXSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODY2NjA4ODM2MDAwMSwgLTEyMi4yNTQwNzU5N10sIFszNy44NTg1MzIxOTksIC0xMjIuMjY2OTAyNzE1XSwgWzM3Ljg2NDgyODI1NCwgLTEyMi4yNjA3MTU2NDFdLCBbMzcuODYxMzc3NzE5MDAwMSwgLTEyMi4yNTM0NjcyNDEwMDAwMV0sIFszNy44NjQxOTE0OTUwMDAxLCAtMTIyLjI1ODU2NDUyNF0sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODY3OTkzOTAzMDAwMTA1LCAtMTIyLjI5NzY2NDM5OF0sIFszNy44NDAzNjU2NzIwMDAxMDQsIC0xMjIuMjgyODEyNjA1XSwgWzM3Ljg1MTkzOTQ2NDAwMDEwNCwgLTEyMi4yODM1MDM1OTddLCBbMzcuODQ2NzcxNzg4MDAwMTA1LCAtMTIyLjI3OTM3MzAzODk5OTk5XSwgWzM3Ljg1OTI4MTQ1LCAtMTIyLjMxNTg0OTE0XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODcyNjk5OTM5LCAtMTIyLjI3MDcxNzQ1OF0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg2OTIwMTIzMSwgLTEyMi4yNjkyOTY0NjEwMDAwMV0sIFszNy44NTc0NjM3NTIwMDAxLCAtMTIyLjI2ODA5MTU0ODk5OTk5XSwgWzM3Ljg3MDU4NDUyMzAwMDAwNSwgLTEyMi4yNjU4ODM0ODZdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44Njg4Mzc5MjIwMDAxMDQsIC0xMjIuMjY4NjQzNjgyXSwgWzM3Ljg2MTA5NDM5Njk5OTk5NSwgLTEyMi4yODk1NDU5NTEwMDAwMV0sIFszNy44NzkwMDQ0NjIwMDAxMDQsIC0xMjIuMjY0NjE4MDhdLCBbMzcuODYwMzM3MzYwMDAwMSwgLTEyMi4yNjcwNTEzODVdLCBbMzcuODcxNjg1NjQzLCAtMTIyLjI5Mjk2NTA5OTk5OTk5XSwgWzM3Ljg3MzA3MzE5MiwgLTEyMi4yODIyMzU4NjNdLCBbMzcuODYwNDYxMzA1MDAwMSwgLTEyMi4yNTkwNzU0NjddLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg3MTM5MDE0MjAwMDEsIC0xMjIuMjQ5NjQyODc4OTk5OTldLCBbMzcuODcxMzkwMTQyMDAwMSwgLTEyMi4yNDk2NDI4Nzg5OTk5OV0sIFszNy44NjM5MzgxOTIsIC0xMjIuMjk0MDU4MDczOTk5OTldLCBbMzcuODU5MDA1ODE1LCAtMTIyLjI0NDU3NTAzOV0sIFszNy44NTAxMDQyNzUsIC0xMjIuMjg1OTk4OTgxXSwgWzM3Ljg2MTY0MDg0MiwgLTEyMi4yNTYxMzc3MzI5OTk5OV0sIFszNy44NjU2Nzc4ODQsIC0xMjIuMjU3MjY2NTY1XSwgWzM3Ljg2NjI2NzIxNDAwMDEsIC0xMjIuMjk5NDQzMzI0XSwgWzM3Ljg0NjA0MTk4NywgLTEyMi4yODQ2OTI0NDc5OTk5OV0sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg3NDM2NjYzNiwgLTEyMi4zMDQ0NDk1NTIwMDAwMV0sIFszNy44NjgwNDg5MTYwMDAxLCAtMTIyLjI1OTMwOTA2MjAwMDAxXSwgWzM3Ljg1NjEzMzE2OSwgLTEyMi4yNzEyODE2ODIwMDAwMV0sIFszNy44NjkxNDgxMjcwMDAxLCAtMTIyLjI4NDA5NDA2ODk5OTk5XSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44ODIwMzUyNDcsIC0xMjIuMjk3NTQ1NTQzXSwgWzM3Ljg1OTUzNDgyMDAwMDEsIC0xMjIuMjk3Mjc5MjY5XSwgWzM3Ljg2NDYxNjU2MTk5OTk5NSwgLTEyMi4yOTA2NzIwNzFdLCBbMzcuODc5MTI4MzAzMDAwMSwgLTEyMi4zMDI0NjUzMzldLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44Nzg3NDA1MDUwMDAxLCAtMTIyLjI5NTI0MjYyNl0sIFszNy44NjIzOTY2MTEwMDAxLCAtMTIyLjI5MjM4MjAwMjk5OTk5XSwgWzM3Ljg3MTE3MDExNzAwMDEwNSwgLTEyMi4yNjgyNzk2NDVdLCBbMzcuODU1MzAzNjg5LCAtMTIyLjI5MjQ3MjIwMTAwMDAxXSwgWzM3Ljg3NTQxMzI0MiwgLTEyMi4yNjYxODM1MzEwMDAwMV0sIFszNy44NjQxMTc1MTU3MzcsIC0xMjIuMzE1NjI5MDA5MjAwOTldLCBbMzcuODYxNjMxOTAwMDAwMSwgLTEyMi4yNzg1MTg4OTVdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NjU0NjcyNjYwMDAxLCAtMTIyLjI5NTc0MjU1NV0sIFszNy44NzEwNTM5MDgwMDAxLCAtMTIyLjMwMTUwNDUxNF0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg1MTc2NDY3OSwgLTEyMi4yNzY1NjI0MjddLCBbMzcuODcxNDI2ODQsIC0xMjIuMzAzNTA4Mjk5OTk5OTldLCBbMzcuODYxMjA0MjE2LCAtMTIyLjI4ODczNDQwOF0sIFszNy44NTM1NTA3MjYsIC0xMjIuMjc2OTMwODI3XSwgWzM3Ljg3MTQyNjg0LCAtMTIyLjMwMzUwODI5OTk5OTk5XSwgWzM3Ljg2NjkwNzk5NjAwMDEsIC0xMjIuMjU4Nzk4Njk3XSwgWzM3Ljg4MDQ3NDE5NSwgLTEyMi4yOTU3OTkyMTVdLCBbMzcuODc1MjA0OTc4MDAwMSwgLTEyMi4yOTQwOTQ5NDFdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NTM2MTIxMTIwMDAxLCAtMTIyLjI4NzE0NDg5Ml0sIFszNy44NzAyMjM5ODI3ODQ3OSwgLTEyMi4yNzMxNzE2OTE2NjJdLCBbMzcuODcxMDU2ODYxOTk5OTk2LCAtMTIyLjI3NDI2MzI5Nl0sIFszNy44NjIzMTA4NDYwMDAxLCAtMTIyLjI1MDA5NTY5OTk5OTk5XSwgWzM3Ljg1NTE4OTUzNTAwMDEsIC0xMjIuMjU5ODEzMDk3XSwgWzM3Ljg2NTQ2NzI2NjAwMDEsIC0xMjIuMjk1NzQyNTU1XSwgWzM3Ljg1NjA4MjY0MTAwMDEsIC0xMjIuMjkyNzI4MzM1XSwgWzM3Ljg2NTM3OTkyNjAwMDEsIC0xMjIuMjU2NTA1MTY1XSwgWzM3Ljg1NzA0NDgxLCAtMTIyLjI1MzA0MjY1Ml0sIFszNy44NTEyMzU2MjcwMDAxLCAtMTIyLjI1MjQ3MDY0NzAwMDAxXSwgWzM3Ljg2MTY0MDg0MiwgLTEyMi4yNTYxMzc3MzI5OTk5OV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NTU5NzA4MzgwMDAxMDQsIC0xMjIuMjU5MDQ3OTIyMDAwMDFdLCBbMzcuODczMzAwNjYzMDAwMSwgLTEyMi4yNzMxOTU1MThdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44NzYyNzUxNDcwMDAxLCAtMTIyLjI4NjE1ODk2N10sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg2MTA5NDM5Njk5OTk5NSwgLTEyMi4yODk1NDU5NTEwMDAwMV0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg3NTc2ODExLCAtMTIyLjI4OTc0OTIzOV0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg1ODUxODA0LCAtMTIyLjI4ODcyMTYwNV0sIFszNy44NjM4NzcwNjAwMDAxLCAtMTIyLjI4MjI3NDc4NV0sIFszNy44NzQzNjY2MzYsIC0xMjIuMzA0NDQ5NTUyMDAwMDFdLCBbMzcuODYwNjU0MzMxLCAtMTIyLjI1MzM5NDcwNzk5OTk5XSwgWzM3Ljg2NDI2NDEyODAwMDEsIC0xMjIuMjcyMjEwMzY3MDAwMDFdLCBbMzcuODQ1MTI4MzU2LCAtMTIyLjI3MDkzNzQzMTAwMDAxXSwgWzM3Ljg2OTk5NzE2NDAwMDAwNCwgLTEyMi4yNzczODM3MTI5OTk5OV0sIFszNy44NDQzMzY2MDUwMDAxLCAtMTIyLjI3NTE3MDAwNF0sIFszNy44NTUyODQ2MzkwMDAwMDQsIC0xMjIuMjg0ODAzNDU1XSwgWzM3Ljg2ODY0MzY2MTAwMDEsIC0xMjIuMjk0NDA1NzU0XSwgWzM3Ljg1OTEyNTUzNjAwMDEsIC0xMjIuMjY5MzI5ODgzXSwgWzM3Ljg4MTQ0MTExMTAwMDEsIC0xMjIuMjkwMDA3NDMxXSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg1NTUyNjQ1MywgLTEyMi4yOTEzNjkwMDM5OTk5OV0sIFszNy44NTMzMzQ3NTEsIC0xMjIuMjkwMTI3MTQ1XSwgWzM3Ljg1ODc1NTQzMTAwMDEsIC0xMjIuMjUyODk0ODgxXSwgWzM3Ljg3MDk3NDYwNjAwMDEsIC0xMjIuMjc3NTAyNDE4XSwgWzM3Ljg1Mjc1MTI5NzAwMDEwNCwgLTEyMi4yODM3MjA1OF0sIFszNy44NzIxNTE0NTYsIC0xMjIuMjY4NDEzOTMxXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NTAxMDQyNzUsIC0xMjIuMjg1OTk4OTgxXSwgWzM3Ljg2ODQwOTM0ODAwMDEsIC0xMjIuMjYxNDUzNzc0XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODY2OTcxNDYxLCAtMTIyLjI3MjUwNTQ0Mzk5OTk5XSwgWzM3Ljg0OTQ0NzEwMTAwMDEsIC0xMjIuMjgyNzA3NTc3OTk5OTldLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44NTU1NzQ0MDIwMDAxLCAtMTIyLjI4MzAzMzIyOF0sIFszNy44NTQ5MTE5MTEsIC0xMjIuMjc5MzgxNTE1XSwgWzM3Ljg2OTk2MDE2MywgLTEyMi4yOTE2NTA1NjldLCBbMzcuODUzMDgyNTU0MDEwMjksIC0xMjIuMjk2ODM3NzYwMTQ2XSwgWzM3Ljg2ODQ5NDE0MzAwMDEsIC0xMjIuMjc0OTU1MTU4XSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODYyNDQ2MTg2OTk5OTk2LCAtMTIyLjI3MTk5ODg5Mzk5OTk5XSwgWzM3Ljg2ODgzNzkyMjAwMDEwNCwgLTEyMi4yNjg2NDM2ODJdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44Nzg0MTYxMjYsIC0xMjIuMjY5MTAzODk4XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg3OTM2ODA1MzAwMDEsIC0xMjIuMzAxMjg5NDQ5XSwgWzM3Ljg1NDc1NTUwOSwgLTEyMi4yODAzMjY5Nzc5OTk5OV0sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44NjgxNDg4MzMwMDAxLCAtMTIyLjI5MTgxMDY3Nzk5OTk5XSwgWzM3Ljg3MjkyMzIxODAwMDAwNCwgLTEyMi4yODE5MDQxMjI5OTk5OV0sIFszNy44NTA5NzA4OSwgLTEyMi4yODYyOTQ5MjFdLCBbMzcuODQ3MDM4MTM0MDAwMSwgLTEyMi4yNzc0MTI1Njc5OTk5OV0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODY0MjQwODI4MDAwMSwgLTEyMi4yNjUyNDIyMTcwMDAwMV0sIFszNy44Njg3NzQ0ODIsIC0xMjIuMjcyNzA0NDVdLCBbMzcuODY3MzkzNjE4MDAwMSwgLTEyMi4yODE2Mzg1NzcwMDAwMV0sIFszNy44NTE0ODY4NTcwMDAxMDQsIC0xMjIuMjc4NTk0NDE3MDAwMDFdLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODY2OTUwNDI1LCAtMTIyLjI4NjkyNTcyXSwgWzM3Ljg2MTI1MDAzNTAwMDEsIC0xMjIuMjY3MDQ3MTI4OTk5OTldLCBbMzcuODY3MTU3MzA3MDAwMTA2LCAtMTIyLjI2MDM2NzEyNF0sIFszNy44NDQzMzY2MDUwMDAxLCAtMTIyLjI3NTE3MDAwNF0sIFszNy44NjYxNTA5MzcsIC0xMjIuMjkyNDE3Mjc2MDAwMDFdLCBbMzcuODY2OTMwMzY5LCAtMTIyLjI2NTgwODYyNV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg1NjAyMDk5MiwgLTEyMi4yNzk2MDU1NzRdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NzA3MzY1NjIsIC0xMjIuMjY3MjA3NDhdLCBbMzcuODY2MDM0OTY0MDAwMSwgLTEyMi4yNjU2MjI3MzIwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg3MDU1OTE2LCAtMTIyLjI5ODQ5MjM0XSwgWzM3Ljg3MjM3NDIwOSwgLTEyMi4yNjg5NDY2MDZdLCBbMzcuODY2NzA5OTI1MDAwMSwgLTEyMi4yOTcyNDg2OF0sIFszNy44NjczNjg1MTgsIC0xMjIuMjkzOTk1NTAwMDAwMDFdLCBbMzcuODYwNDYxMzA1MDAwMSwgLTEyMi4yNTkwNzU0NjddLCBbMzcuODU2MTg1OTUzMDAwMSwgLTEyMi4yNTk2NzM4OTg5OTk5OV0sIFszNy44NTUxODA3ODAwMDAxLCAtMTIyLjI2NzM4NDEyNF0sIFszNy44NzIwMTAxMzMwMDAxLCAtMTIyLjI3MzUwODQ5Ml0sIFszNy44NDY1MDAzODEwMDAxLCAtMTIyLjI3Mjk3NDc4NzAwMDAxXSwgWzM3Ljg1NDkxMTkxMSwgLTEyMi4yNzkzODE1MTVdLCBbMzcuODY4MTQ4ODMzMDAwMSwgLTEyMi4yOTE4MTA2Nzc5OTk5OV0sIFszNy44NjEzNDM0NjQwMDAxLCAtMTIyLjI4MDc1MTg1XSwgWzM3Ljg1MzkwMTY2MjAwMDEwNSwgLTEyMi4yNzQyMzUzNzg5OTk5OV0sIFszNy44NjI5MTEwNDYwMDAxLCAtMTIyLjI3NTUxOTcwNV0sIFszNy44ODAyNTI2MjgwMDAxLCAtMTIyLjI5Njk1NjUzMV0sIFszNy44NDQzMzY2MDUwMDAxLCAtMTIyLjI3NTE3MDAwNF0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44Nzg3MDc5MDAwMDAxLCAtMTIyLjI2Njg2MTgxXSwgWzM3Ljg0MDQ3OTM0NDAwMDEsIC0xMjIuMjgzOTMzNTA2XSwgWzM3Ljg3ODYyOTg5NjAwMDEsIC0xMjIuMjYwODY4Mjc3MDAwMDFdLCBbMzcuODc3MDY1ODQ4LCAtMTIyLjI3OTU4MjA1NjAwMDAxXSwgWzM3Ljg2MTg2MDA0MywgLTEyMi4yNjI0Mzk4NTZdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg1NTE4OTUzNTAwMDEsIC0xMjIuMjU5ODEzMDk3XSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg3MDU4MjQ2LCAtMTIyLjI3Mjg5MzE5Mzk5OTk5XSwgWzM3Ljg2NTE3MTE1NSwgLTEyMi4yNzIzMDgyNDcwMDAwMV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU5NTM3ODE4LCAtMTIyLjI1OTIwNjAwNzk5OTk5XSwgWzM3Ljg2ODQwOTM0ODAwMDEsIC0xMjIuMjYxNDUzNzc0XSwgWzM3Ljg3MTc0OTM3LCAtMTIyLjI3MTg4Mzg3Nl0sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2NzU5Mjc3MzAwMDEwNSwgLTEyMi4yOTI4ODUyMzFdLCBbMzcuODYzMjYwMzQxMDAwMSwgLTEyMi4yOTA2NTY2NjJdLCBbMzcuODc2MjEyMTAzMDAwMSwgLTEyMi4yODY2NDExNzldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODc0MzA4NjE4LCAtMTIyLjI4Mjk2NDIzXSwgWzM3Ljg3NTIwNDk3ODAwMDEsIC0xMjIuMjk0MDk0OTQxXSwgWzM3Ljg2NzYyNjIxMzAwMDEsIC0xMjIuMjgwNjA0Njg3MDAwMDFdLCBbMzcuODY0MjY0MTI4MDAwMSwgLTEyMi4yNzIyMTAzNjcwMDAwMV0sIFszNy44NzE4Njk3NzcsIC0xMjIuMjc3NjEyMjI5XSwgWzM3Ljg2MzQ0NDg3NSwgLTEyMi4yNTYzMTcyOTZdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODcyNTQzMTMxLCAtMTIyLjI3MTk2ODA4OV0sIFszNy44Nzk3OTY5MzYsIC0xMjIuMjk5MTkyODQ5XSwgWzM3Ljg2MzcwNzYwODg3MTYsIC0xMjIuMzEzNTkwNzkwNzU3XSwgWzM3Ljg2NDgyODI1NCwgLTEyMi4yNjA3MTU2NDFdLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44NzE2NTkzOTc5NzM3LCAtMTIyLjMwMjM2MzM5NjAyNl0sIFszNy44NjYwMzQ5NjQwMDAxLCAtMTIyLjI2NTYyMjczMjAwMDAxXSwgWzM3Ljg1OTUzNzgxOCwgLTEyMi4yNTkyMDYwMDc5OTk5OV0sIFszNy44NjQyNjQxMjgwMDAxLCAtMTIyLjI3MjIxMDM2NzAwMDAxXSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODY4Njk4NDQzLCAtMTIyLjI1OTE1MTI2Ml0sIFszNy44NjIzMjk2MTQwMDAwMDQsIC0xMjIuMjU4ODExNDE0XSwgWzM3Ljg2ODE1NTM1OCwgLTEyMi4yNzAzNTI1NzYwMDAwMV0sIFszNy44Njc1MTMxNjEsIC0xMjIuMjYxMjczMTA1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2Mzk3MTQ4ODAwMDEwNCwgLTEyMi4yNjczNjMxNV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NDc3MzY1NzkwMDAxLCAtMTIyLjI3MTk1ODg3Mjk5OTk5XSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NjY5Nzg5MDA5OTk5OTYsIC0xMjIuMjU0ODYxODE1XSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg2OTY5NjA5MzAwMDEsIC0xMjIuMjg3NDk5NDc3OTk5OTldLCBbMzcuODY4Nzc0NDgyLCAtMTIyLjI3MjcwNDQ1XSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODY3NTkyNzczMDAwMTA1LCAtMTIyLjI5Mjg4NTIzMV0sIFszNy44NzYzODI5NCwgLTEyMi4yOTQ0ODM4M10sIFszNy44NzgwNzcxNzIwMDAxMDQsIC0xMjIuMjk0NjgyNDUxXSwgWzM3Ljg3MDM2NjUxODAwMDAwNCwgLTEyMi4zMTg0MTYzNDNdLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY2OTcxNDYxLCAtMTIyLjI3MjUwNTQ0Mzk5OTk5XSwgWzM3Ljg3MDMwMzczNDAwMDEsIC0xMjIuMjY4MDM1NTAzXSwgWzM3Ljg1MzIzODU2MjAwMDEsIC0xMjIuMjc5OTY0OTQ3MDAwMDFdLCBbMzcuODcxNDQ3MzMwMDAwMSwgLTEyMi4yNzYyNDYzMl0sIFszNy44NTQxMTM0MzMwMDAxLCAtMTIyLjI4NDE5MzI4MV0sIFszNy44NTIzOTE0OTcsIC0xMjIuMjc4ODA0OTA3MDAwMDFdLCBbMzcuODUwNTMyMzY1LCAtMTIyLjI4NjE1MTA0OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XSwgWzM3Ljg2NjAzNDk2NDAwMDEsIC0xMjIuMjY1NjIyNzMyMDAwMDFdLCBbMzcuODY1Nzc5OCwgLTEyMi4yNjc1NzYwMDVdLCBbMzcuODk1MzU1NDUzLCAtMTIyLjI3MzU4MzY5MV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44Njg2OTg0NDMsIC0xMjIuMjU5MTUxMjYyXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTEzNjg5NTAwMDAxLCAtMTIyLjI4NjM0ODYzMjk5OTk5XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg3MDA3ODY0NSwgLTEyMi4yNzE4NDI5MTldLCBbMzcuODQ4ODU5MzAwMDAwMSwgLTEyMi4yOTIxNTQzNDFdLCBbMzcuODczMzAwNjYzMDAwMSwgLTEyMi4yNzMxOTU1MThdLCBbMzcuODUwODA3MDAxMDAwMSwgLTEyMi4yOTEwMzY4MTldLCBbMzcuODUwODA3MDAxMDAwMSwgLTEyMi4yOTEwMzY4MTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODU0ODY2Mzg1LCAtMTIyLjI1MjgyNjYxNjAwMDAxXSwgWzM3Ljg2OTY3NjA0OCwgLTEyMi4yNjU3OTA4MjM5OTk5OV0sIFszNy44Njc1OTM4NDMwMDAxLCAtMTIyLjI2Nzc3MzQyOF0sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NjQyNjQxMjgwMDAxLCAtMTIyLjI3MjIxMDM2NzAwMDAxXSwgWzM3Ljg3MjQyODM3MTAwMDEsIC0xMjIuMjc5OTYxMTA2XSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NzY3MzAyMTY5OTk5OTUsIC0xMjIuMzA1MjE1NzIyMDAwMDFdLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODgxNzY0MzM5LCAtMTIyLjI5NjYyMTc4MV0sIFszNy44NTAxOTE0NTAwMDAxLCAtMTIyLjI5NDUxMjk5NjAwMDAxXSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg0NjA0MTk4NywgLTEyMi4yODQ2OTI0NDc5OTk5OV0sIFszNy44NjI0NjQ0ODMwMDAxLCAtMTIyLjI2NDg2NTYxNV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODYwMTk2NDIwMDAwMSwgLTEyMi4yOTQwNTQxOTFdLCBbMzcuODY1ODAxNjk0LCAtMTIyLjI1Mjc1NDExNV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU4NDI5MTksIC0xMjIuMjkzNDkwMDU2MDAwMDFdLCBbMzcuODUyNDM1MDYwMDAwMSwgLTEyMi4yNjkzMTU1OTldLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NjcwODQyNDQwMDAxMDQsIC0xMjIuMjgzODkwMjM4XSwgWzM3Ljg2NTA4MTM5MiwgLTEyMi4yNjIzNTRdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NjYwOTMwODgwMDAxLCAtMTIyLjI4NjQ1ODE4NF0sIFszNy44NTk1OTk1MDgsIC0xMjIuMjgwMzI1NDI5XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2NDM4OTczNzAwMDEsIC0xMjIuMjk5MTU4OTY2MDAwMDFdLCBbMzcuODY2MTA0ODE5LCAtMTIyLjMwMDI0NzM1Nl0sIFszNy44NjY2OTkwMjUwMDAxLCAtMTIyLjI5MDkwODczMl0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NjQ1MzgxMTUwMDAxLCAtMTIyLjI2Mjk5Mzc0Nl0sIFszNy44NjQyNDA4MjgwMDAxLCAtMTIyLjI2NTI0MjIxNzAwMDAxXSwgWzM3Ljg2OTY5NjA5MzAwMDEsIC0xMjIuMjg3NDk5NDc3OTk5OTldLCBbMzcuODUwNTMyMzY1LCAtMTIyLjI4NjE1MTA0OV0sIFszNy44NTk3NDg0NDgwMDAxMDQsIC0xMjIuMjk2MjM4MTQ3MDAwMDFdLCBbMzcuODY0MTkxNDk1MDAwMSwgLTEyMi4yNTg1NjQ1MjRdLCBbMzcuODcxODg0NDEzMDAwMDA0LCAtMTIyLjMwMTI0NDU4NV0sIFszNy44NzgzMDIzMzgwMDAwMDUsIC0xMjIuMzA2NTY1NTM1XSwgWzM3Ljg2NjQ2NjcxMTE5MTIsIC0xMjIuMzEyMDY4ODk2MzQ3MDFdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg2NzY2MjE4NDAwMDAwNCwgLTEyMi4yOTk4OTE3MzJdLCBbMzcuODY5MzE0NzYzLCAtMTIyLjI5ODA5MzE0Mjk5OTk5XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2ODE0ODgzMzAwMDEsIC0xMjIuMjkxODEwNjc3OTk5OTldLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg0OTc2MTI4MzAwMDEsIC0xMjIuMjkyMjQ5OTgxXSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUyMjI2MzEyLCAtMTIyLjI5MTQ5NTQ0Mjk5OTk5XSwgWzM3Ljg2NTI2MTIwMTAwMDEsIC0xMjIuMjk2NzgzOTM5XSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODYxMzQzNDY0MDAwMSwgLTEyMi4yODA3NTE4NV0sIFszNy44ODE1ODA2ODcwMDAxLCAtMTIyLjI5OTc1MjQ5Mjk5OTk5XSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODY2MDE0NTgyLCAtMTIyLjI1ODYxNjQwMjk5OTk5XSwgWzM3Ljg2NDU1NDE3NjAwMDEsIC0xMjIuMjY5OTA0NTYyMDAwMDFdLCBbMzcuODU0OTExOTExLCAtMTIyLjI3OTM4MTUxNV0sIFszNy44NzU1NDMxODcwMDAxMDUsIC0xMjIuMjkxNDQ4NzI5XSwgWzM3Ljg3NTY1ODk2NywgLTEyMi4yOTA2MDYwMDJdLCBbMzcuODc1MzA0MzMzLCAtMTIyLjI5MzE2Njc4N10sIFszNy44NTcxMDkwMzIsIC0xMjIuMzAxMTAyNDMyMDAwMDFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTExODExMzMwMDAxMDQsIC0xMjIuMjg5MjM0MDk5XSwgWzM3Ljg1MTE4MTEzMzAwMDEwNCwgLTEyMi4yODkyMzQwOTldLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg1MzQ4MzExNTAwMDEsIC0xMjIuMjkxODkyOTkyXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NTIyMjYzMTIsIC0xMjIuMjkxNDk1NDQyOTk5OTldLCBbMzcuODUwODA3MDAxMDAwMSwgLTEyMi4yOTEwMzY4MTldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODQ5NzYxMjgzMDAwMSwgLTEyMi4yOTIyNDk5ODFdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxMTEwNzM2MDAwMSwgLTEyMi4yODMyNjg4OTg5OTk5OV0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NzA4NDA2NzQwMDAxLCAtMTIyLjI3ODU1MjU3M10sIFszNy44NjgxMzcwMjgsIC0xMjIuMjYzNzMyNDE3OTk5OTldLCBbMzcuODY4MTA4NDg4MDAwMTA0LCAtMTIyLjI1NjcxMzU3M10sIFszNy44NzEyNjcyOCwgLTEyMi4yNzI2NzM5MzhdLCBbMzcuODc2NjA0MzA3LCAtMTIyLjI2ODg5NjA4MTAwMDAxXSwgWzM3Ljg2MDkxOTcxNzAwMDEsIC0xMjIuMjY5NTIzMzU2MDAwMDFdLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NTUxNjMxMTA1OTIyLCAtMTIyLjI3NzE1NTQ0NDUyN10sIFszNy44NzEyNzIxMTIsIC0xMjIuMjY4NzA1MDgzOTk5OTldLCBbMzcuODcxMTcwMTE3MDAwMTA1LCAtMTIyLjI2ODI3OTY0NV0sIFszNy44NTQzOTczMzUsIC0xMjIuMjg3Mzk1OTA2XSwgWzM3Ljg3MTI3MjExMiwgLTEyMi4yNjg3MDUwODM5OTk5OV0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODYwNjU0MzMxLCAtMTIyLjI1MzM5NDcwNzk5OTk5XSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODUxMjM1NjI3MDAwMSwgLTEyMi4yNTI0NzA2NDcwMDAwMV0sIFszNy44NTc3Njc5NjcsIC0xMjIuMjg5NzMwNzM2MDAwMDFdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NzE0NDczMzAwMDAxLCAtMTIyLjI3NjI0NjMyXSwgWzM3Ljg2OTY5MTg1NSwgLTEyMi4yNzI3OTkxNF0sIFszNy44Njk2OTE4NTUsIC0xMjIuMjcyNzk5MTRdLCBbMzcuODc1MTAyOTQ4MDAwMTA1LCAtMTIyLjI3MzM5ODAwNjAwMDAxXSwgWzM3Ljg3MjQ0NzQ2OTAwMDEsIC0xMjIuMjczMDc5ODM1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg4MTQzNjc1MSwgLTEyMi4yNzQxMDA0ODFdLCBbMzcuODczMzAwNjYzMDAwMSwgLTEyMi4yNzMxOTU1MThdLCBbMzcuODU3NzgzMDg2LCAtMTIyLjI0OTc1MTU2N10sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NzgzMDIzMzgwMDAwMDUsIC0xMjIuMzA2NTY1NTM1XSwgWzM3Ljg2NDYxNjU2MTk5OTk5NSwgLTEyMi4yOTA2NzIwNzFdLCBbMzcuODgwMjIyMjEyLCAtMTIyLjI2OTMyNzE3OV0sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODU0NDUzNjQ0LCAtMTIyLjI2OTk5MDk4OV0sIFszNy44NzExNzAxMTcwMDAxMDUsIC0xMjIuMjY4Mjc5NjQ1XSwgWzM3Ljg2NjYwODgzNjAwMDEsIC0xMjIuMjU0MDc1OTddLCBbMzcuODY3MjE3OTg0LCAtMTIyLjI3Njc1MzkxNF0sIFszNy44NDcwMzgxMzQwMDAxLCAtMTIyLjI3NzQxMjU2Nzk5OTk5XSwgWzM3Ljg0NDU1NjAzNiwgLTEyMi4yNzUzMDYxNzldLCBbMzcuODUxOTQxMTAyMDAwMTA0LCAtMTIyLjI3MDA4NTk3XSwgWzM3Ljg1MjQzNTA2MDAwMDEsIC0xMjIuMjY5MzE1NTk5XSwgWzM3Ljg3MDczNjU2MiwgLTEyMi4yNjcyMDc0OF0sIFszNy44NDk2OTc0NDgsIC0xMjIuMjcxMDUxODQ3MDAwMDFdLCBbMzcuODY3MjYzMjQzMDAwMDA0LCAtMTIyLjI5MTUyMjUwMDAwMDAxXSwgWzM3Ljg2NjM4MTc4MSwgLTEyMi4yOTEyMzQ0MTIwMDAwMV0sIFszNy44NjUyNjEyMDEwMDAxLCAtMTIyLjI5Njc4MzkzOV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODYzOTcxNDg4MDAwMTA0LCAtMTIyLjI2NzM2MzE1XSwgWzM3Ljg3MTYxNTE0MTAwMDEsIC0xMjIuMjcwNDg5MzEyMDAwMDFdLCBbMzcuODU0ODA2MzU1MDAwMSwgLTEyMi4yNjQ0MTMyM10sIFszNy44NjQ4MjM0MDYsIC0xMjIuMjk4OTcxNzQzXSwgWzM3Ljg1ODk4OTM4NDAwMDAwNCwgLTEyMi4yNzc5NzkxODFdLCBbMzcuODY1NzIwNzcxLCAtMTIyLjI1MzkwMjUyMV0sIFszNy44NzE0NjQyMDY5OTk5OTUsIC0xMjIuMjY1OTczNzI5XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODc2MjEyMTAzMDAwMSwgLTEyMi4yODY2NDExNzldLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NDkwNzQ0MjIwMDAxLCAtMTIyLjI4NTY3MDQ4N10sIFszNy44NjAxOTY0MjAwMDAxLCAtMTIyLjI5NDA1NDE5MV0sIFszNy44NzU1NDMxODcwMDAxMDUsIC0xMjIuMjkxNDQ4NzI5XSwgWzM3Ljg0NzgxMjg3MjAwMDEwNSwgLTEyMi4yOTE4MTkzNjI5OTk5OV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MjU5MDc5MDAwMDEsIC0xMjIuMjg5Njk1OTI3OTk5OTldLCBbMzcuODUwODA3MDAxMDAwMSwgLTEyMi4yOTEwMzY4MTldLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NzA1ODQ1MjMwMDAwMDUsIC0xMjIuMjY1ODgzNDg2XSwgWzM3Ljg3OTY0NDEyNzAwMDEwNSwgLTEyMi4yODA5NjU5ODIwMDAwMV0sIFszNy44NzMwNzMxOTIsIC0xMjIuMjgyMjM1ODYzXSwgWzM3Ljg4MTU4MDY4NzAwMDEsIC0xMjIuMjk5NzUyNDkyOTk5OTldLCBbMzcuODUzMjgxMDk0MDAwMSwgLTEyMi4yNzkwMTE1Njc5OTk5OV0sIFszNy44ODE2NjM2NTkwMDAwMDQsIC0xMjIuMjgxOTY5MjQ2XSwgWzM3Ljg1MzY5NDk5NTAwMDEsIC0xMjIuMjYwMDE2NjY5XSwgWzM3Ljg1MTEzMTMyOTAwMDEwNCwgLTEyMi4yNTM0MDA1MDldLCBbMzcuODc5Nzk2OTM2LCAtMTIyLjI5OTE5Mjg0OV0sIFszNy44NTM1NTA3MjYsIC0xMjIuMjc2OTMwODI3XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2MTUzMDMxNiwgLTEyMi4yNzE4OTU1OTJdLCBbMzcuODU4ODU4MDY0MDAwMSwgLTEyMi4yNzE1OTYxODM5OTk5OV0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NjkyMDEyMzEsIC0xMjIuMjY5Mjk2NDYxMDAwMDFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODQ5NDM1NDAyLCAtMTIyLjI1MjI2ODkwMjk5OTk5XSwgWzM3Ljg3MTQ2NDIwNjk5OTk5NSwgLTEyMi4yNjU5NzM3MjldLCBbMzcuODYxOTE5NjkxLCAtMTIyLjI3NjMyNTc1NV0sIFszNy44NTUzMDA1NTQwMDAxLCAtMTIyLjI2NjQ5MzE4M10sIFszNy44NjIxNzczODIsIC0xMjIuMjc0MDc2NDQyMDAwMDFdLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODY5NDMyMDc2MDAwMSwgLTEyMi4yODE4NDM0NTcwMDAwMV0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg3MDQzNDMyOCwgLTEyMi4yNzQwMjI3MDc5OTk5OV0sIFszNy44NjA5MTk3MTcwMDAxLCAtMTIyLjI2OTUyMzM1NjAwMDAxXSwgWzM3Ljg3Mzg4MzM3MjAwMDEsIC0xMjIuMjkwMDUwMjgzXSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg1NjEzMzE2OSwgLTEyMi4yNzEyODE2ODIwMDAwMV0sIFszNy44NTg2NTQ4NDMwMDAxLCAtMTIyLjI5MjM3ODIxNF0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg3MTQ1NjQ5NTAwMDEsIC0xMjIuMjk0MTI3MjkxMDAwMDFdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODgxNDQxMTExMDAwMSwgLTEyMi4yOTAwMDc0MzFdLCBbMzcuODYyMTEwNzIyMDAwMTA0LCAtMTIyLjI1MzUzOTk5NV0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg3NzczMDcxMjAwMDEsIC0xMjIuMjkzOTU1MDQ3MDAwMDFdLCBbMzcuODY2MzEzNDMyLCAtMTIyLjI1NjM0NzEwMl0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NTYyMDYyMDgwMDAxLCAtMTIyLjI4Nzk3ODIwM10sIFszNy44OTk3NzU4NDYwMDAxLCAtMTIyLjI3MTE1NDMzMV0sIFszNy44NjY2ODY3ODMsIC0xMjIuMjY3Njc3MzE0XSwgWzM3Ljg2NTEzODc4MzAwMDEsIC0xMjIuMjY1NDQyMDIyXSwgWzM3Ljg1NDMxNjM4NTAwMDEwNCwgLTEyMi4yNzEwODQxNTRdLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NTU2NjUxMDcwMDAxLCAtMTIyLjI3NDQxNzg2M10sIFszNy44NTI0OTIwNzQwMDAxMDQsIC0xMjIuMjcwODg0NzE5XSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg1Nzk2NDEyOCwgLTEyMi4yNzE0OTUxNjIwMDAwMV0sIFszNy44NTI5MTk3NTAxOTI0LCAtMTIyLjI2OTk2NDEyMjg4NjAxXSwgWzM3Ljg1MjkxOTc1MDE5MjQsIC0xMjIuMjY5OTY0MTIyODg2MDFdLCBbMzcuODczODU4OTc1MDAwMSwgLTEyMi4zMDA3NzQ0ODFdLCBbMzcuODU0NDUzNjQ0LCAtMTIyLjI2OTk5MDk4OV0sIFszNy44NzU5MjE5NTksIC0xMjIuMjg2OTMzMjc3XSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTQxNzc2MDYwMDAxLCAtMTIyLjI3OTIxNDk0XSwgWzM3Ljg3NzM4OTkzLCAtMTIyLjI3NzA3NzQ0NF0sIFszNy44Njk2OTE4NTUsIC0xMjIuMjcyNzk5MTRdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODc2Njg5OTk3LCAtMTIyLjI4MjY0Njc3Ml0sIFszNy44NTIyMjYzMTIsIC0xMjIuMjkxNDk1NDQyOTk5OTldLCBbMzcuODY5MjAxMjMxLCAtMTIyLjI2OTI5NjQ2MTAwMDAxXSwgWzM3Ljg2MDAyOTk1NzAwMDEsIC0xMjIuMjY5NDE5XSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44NjQ2MTY1NjE5OTk5OTUsIC0xMjIuMjkwNjcyMDcxXSwgWzM3Ljg2NDgyMzQwNiwgLTEyMi4yOTg5NzE3NDNdLCBbMzcuODU4NTk1NzY3MDAwMTA0LCAtMTIyLjI1OTMzNzgzNl0sIFszNy44NzIzMzE4LCAtMTIyLjI5OTA2MDI4NV0sIFszNy44NjI0ODMwMjAwMDAxLCAtMTIyLjI0NzA0OTEzOF0sIFszNy44NzExMTI0MiwgLTEyMi4yODgyMDA2MzM5OTk5OV0sIFszNy44NTQ0NjY3NDgwMDAxLCAtMTIyLjI0ODE5NTg2XSwgWzM3Ljg3MTA1MzkwODAwMDEsIC0xMjIuMzAxNTA0NTE0XSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODc0OTgxMTY5MDAwMSwgLTEyMi4yOTUyNjU5OV0sIFszNy44Njc4MDkwNDQwMDAxMDQsIC0xMjIuMjU4OTc1OTg2MDAwMDFdLCBbMzcuODY1OTQwMzkxLCAtMTIyLjI1MDQ0MTE4Mjk5OTk5XSwgWzM3Ljg2MjMxMDg0NjAwMDEsIC0xMjIuMjUwMDk1Njk5OTk5OTldLCBbMzcuODYxMzk1ODAyMDAwMTA0LCAtMTIyLjI1ODk0MzQ1N10sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODU0NDQwMjA4LCAtMTIyLjI1OTkxNDgyNzk5OTk5XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODQ1MTI4MzU2LCAtMTIyLjI3MDkzNzQzMTAwMDAxXSwgWzM3Ljg1MjEyOTY2MSwgLTEyMi4yNjc5ODg2ODFdLCBbMzcuODczNjUxNDk1LCAtMTIyLjMwMTgxNTkzMjAwMDAxXSwgWzM3Ljg4MDA4NjI4MiwgLTEyMi4zMDcyMjIzODRdLCBbMzcuODc5MzY4MDUzMDAwMSwgLTEyMi4zMDEyODk0NDldLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44Njc1OTM4NDMwMDAxLCAtMTIyLjI2Nzc3MzQyOF0sIFszNy44ODk2MDI0NzAwMDAxLCAtMTIyLjI3ODk2Nzg5NV0sIFszNy44NjY2OTkwMjUwMDAxLCAtMTIyLjI5MDkwODczMl0sIFszNy44NzEyNjE5NzIwMDAxMDYsIC0xMjIuMjc1MjQ0ODg3OTk5OTldLCBbMzcuODkzMTIyNTA1MDAwMSwgLTEyMi4yNjc3MTY1MV0sIFszNy44NjgyMDIwMTAwMDAxLCAtMTIyLjI5NjYyNDc1Mzk5OTk5XSwgWzM3Ljg2NzA4NDI0NDAwMDEwNCwgLTEyMi4yODM4OTAyMzhdLCBbMzcuODY3ODM0Njc2LCAtMTIyLjI2NTk1MTQxNzk5OTk5XSwgWzM3Ljg2OTY5MTg1NSwgLTEyMi4yNzI3OTkxNF0sIFszNy44Njk2MjgxOTksIC0xMjIuMjg4MDg5NDQ3XSwgWzM3Ljg2NDI2NDEyODAwMDEsIC0xMjIuMjcyMjEwMzY3MDAwMDFdLCBbMzcuODYzNjU0MzgzMDAwMDA0LCAtMTIyLjI5MDM2MzAwNF0sIFszNy44NjQ4OTkyMTIwMDAxMDQsIC0xMjIuMjg4NjA2OTZdLCBbMzcuODY4Nzg4MTI2LCAtMTIyLjI0OTExNjc0MTAwMDAxXSwgWzM3Ljg2OTY5MTg1NSwgLTEyMi4yNzI3OTkxNF0sIFszNy44NjE5NjUxNjAwMDAxLCAtMTIyLjI5NDYwOTczNzk5OTk5XSwgWzM3Ljg2NjQ2ODU3OTAwMDEsIC0xMjIuMjk4Mzk2NjMxXSwgWzM3Ljg2NTc3OTgsIC0xMjIuMjY3NTc2MDA1XSwgWzM3Ljg2NTIwOTU2NSwgLTEyMi4yNTc4MDA0MTcwMDAwMV0sIFszNy44NzA4NzY5MTQwMDAxLCAtMTIyLjI3MDYxNTAzNjAwMDAxXSwgWzM3Ljg2MDAyOTk1NzAwMDEsIC0xMjIuMjY5NDE5XSwgWzM3Ljg3MTE3NTI4NSwgLTEyMi4zMDQ3MzU3NTZdLCBbMzcuODcxMTcwMTE3MDAwMTA1LCAtMTIyLjI2ODI3OTY0NV0sIFszNy44NTQwMDk0ODgsIC0xMjIuMjc5NTQyMjcyOTk5OTldLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODY0MTkxNDk1MDAwMSwgLTEyMi4yNTg1NjQ1MjRdLCBbMzcuODYzMjc1MzUyMDAwMSwgLTEyMi4yOTczNjQ2OTVdLCBbMzcuODYzMjc1MzUyMDAwMSwgLTEyMi4yOTczNjQ2OTVdLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NzI1NDYwOTMwMDAwMDQsIC0xMjIuMjk4MDIwNzRdLCBbMzcuODcyOTk1MjQ0LCAtMTIyLjI5NTgwNzAwMDAwMDAxXSwgWzM3Ljg4NzA0Mjc1NiwgLTEyMi4yNzg4MjQyNjZdLCBbMzcuODY4NDA5MzQ4MDAwMSwgLTEyMi4yNjE0NTM3NzRdLCBbMzcuODY5MzE0NzYzLCAtMTIyLjI5ODA5MzE0Mjk5OTk5XSwgWzM3Ljg2NzgzNzk4NiwgLTEyMi4yNjk0NTg5ODRdLCBbMzcuODY2MTAzNjE4ODc1MSwgLTEyMi4zMDU2ODgxMzUwMzA5OV0sIFszNy44Nzk1ODAxMjQsIC0xMjIuMzAwMjYxODgyOTk5OTldLCBbMzcuODY3MjA5NDQyLCAtMTIyLjI1ODU4MzEyOF0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg3NTU0MTM0MzAwMDEsIC0xMjIuMzA0ODI0NjY1XSwgWzM3Ljg4ODQ5NTMzMiwgLTEyMi4yNzIzOTcxMDc5OTk5OV0sIFszNy44NTc4MTU5MTIsIC0xMjIuMjc5OTc2MDIyMDAwMDFdLCBbMzcuODc1NTQxMzQzMDAwMSwgLTEyMi4zMDQ4MjQ2NjVdLCBbMzcuODk1ODcyNzk2OTk5OTk2LCAtMTIyLjI2NDQ5NDA0NF0sIFszNy44NzExNzAxMTcwMDAxMDUsIC0xMjIuMjY4Mjc5NjQ1XSwgWzM3Ljg5MTg1MDI0NiwgLTEyMi4yNzI0MjI1MDZdLCBbMzcuODY0MDAyNTI3LCAtMTIyLjI4MTI4Njg4Mjk5OTk5XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODQ4NjcyODYwMDAwMSwgLTEyMi4yNzcwMTA4MTIwMDAwMV0sIFszNy44NTU3MjU3ODIsIC0xMjIuMjc1Nzg5NDc3XSwgWzM3Ljg2OTc4MjYzNSwgLTEyMi4zMDExMjQ0MDIwMDAwMV0sIFszNy44Njg3MTY3NDgwMDAxMDQsIC0xMjIuMjY2MjAyODM3MDAwMDFdLCBbMzcuODc3NjI0ODYsIC0xMjIuMzAwNzI3Mjk3MDAwMDFdLCBbMzcuODc3NjI0ODYsIC0xMjIuMzAwNzI3Mjk3MDAwMDFdLCBbMzcuODc3NjI0ODYsIC0xMjIuMzAwNzI3Mjk3MDAwMDFdLCBbMzcuODU1NDE5Nzg1LCAtMTIyLjIzOTMyNTQ1Mjk5OTk5XSwgWzM3Ljg3NTI2NjA4NCwgLTEyMi4zMDAwMDQ3MDc5OTk5OV0sIFszNy44NTQ4NTEzMTgsIC0xMjIuMjQ2NTI0NzM2XSwgWzM3Ljg3Mzg1ODk3NTAwMDEsIC0xMjIuMzAwNzc0NDgxXSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg3MDExMjY1NzAwMDExLCAtMTIyLjI4NDI0ODkzMzk5OTk5XSwgWzM3Ljg3NTg5MTM0OCwgLTEyMi4yODg3NzY3MzddLCBbMzcuODU1OTcyMTkxOTk5OTk2LCAtMTIyLjI0OTU3MjAyNV0sIFszNy44NTE0ODY4NTcwMDAxMDQsIC0xMjIuMjc4NTk0NDE3MDAwMDFdLCBbMzcuODc2MjEyMTAzMDAwMSwgLTEyMi4yODY2NDExNzldLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg3MjI3NjM4NjAwMDEsIC0xMjIuMjg4MzM2MTE1XSwgWzM3Ljg3MzE4OTEzNjAwMDEsIC0xMjIuMzA0MDc3ODY1XSwgWzM3Ljg2OTMxNDc2MywgLTEyMi4yOTgwOTMxNDI5OTk5OV0sIFszNy44NzA1NjI2MzE5OTk5OTUsIC0xMjIuMjgyOTY0OTE3XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg2NDg3NjI2MDAwMDEsIC0xMjIuMjY3NDc0NzkxXSwgWzM3Ljg3MDY4NDMyNTAwMDEsIC0xMjIuMjc5NzY4NTIzOTk5OTldLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44NTQzOTczMzUsIC0xMjIuMjg3Mzk1OTA2XSwgWzM3Ljg3OTU4MDEyNCwgLTEyMi4zMDAyNjE4ODI5OTk5OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzkzNjgwNTMwMDAxLCAtMTIyLjMwMTI4OTQ0OV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg2NTUzMzc4NCwgLTEyMi4yODM3NDcyODFdLCBbMzcuODY5NjgwNzg0MzUxMiwgLTEyMi4zMTk2Njk3NTk3MDNdLCBbMzcuODc1NTQzMTg3MDAwMTA1LCAtMTIyLjI5MTQ0ODcyOV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg1MzMzNDc1MSwgLTEyMi4yOTAxMjcxNDVdLCBbMzcuODU2MTMzMTY5LCAtMTIyLjI3MTI4MTY4MjAwMDAxXSwgWzM3Ljg0ODQ4MDE3MTAwMDEsIC0xMjIuMjgzNDUwNDM3OTk5OTldLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODcwMTY2OTczLCAtMTIyLjMwMDY5NTU3Nzk5OTk5XSwgWzM3Ljg2MzcwNzYwODg3MTYsIC0xMjIuMzEzNTkwNzkwNzU3XSwgWzM3Ljg2NDgyMzQwNiwgLTEyMi4yOTg5NzE3NDNdLCBbMzcuODczMTg5MTM2MDAwMSwgLTEyMi4zMDQwNzc4NjVdLCBbMzcuODcwNDI5NTIwNjM4OSwgLTEyMi4yOTk3NzU1ODcwMzVdLCBbMzcuODcyMzI5NjMyMDAwMSwgLTEyMi4yNjkzMTMyNDNdLCBbMzcuODYzMDY2NjQ2MDAwMSwgLTEyMi4yNjcyNTY3MV0sIFszNy44NzUwMjk1MTYsIC0xMjIuMzAxMTUyODk4XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODUzMjgxMDk0MDAwMSwgLTEyMi4yNzkwMTE1Njc5OTk5OV0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg2MzM1MzY2ODAwMDEsIC0xMjIuMjcyMTEyMzg0XSwgWzM3Ljg2MDQwNzQ3MzAwMDEsIC0xMjIuMjk5MTg5NDU0XSwgWzM3Ljg2OTk4MTA4OTAwMDEsIC0xMjIuMjcwNTQ4NjAxXSwgWzM3Ljg2NDU1NDE3NjAwMDEsIC0xMjIuMjY5OTA0NTYyMDAwMDFdLCBbMzcuODY0MjY0MTI4MDAwMSwgLTEyMi4yNzIyMTAzNjcwMDAwMV0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg3NDAwNzc0NzAwMDEsIC0xMjIuMjY3NDg2MjExXSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg2NDgyODI1NCwgLTEyMi4yNjA3MTU2NDFdLCBbMzcuODY4Njk4NDQzLCAtMTIyLjI1OTE1MTI2Ml0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg1MDQwOTA5MzAwMDEsIC0xMjIuMjc4MzQzNDE2XSwgWzM3Ljg1MzIxMDc0OTc0MjUsIC0xMjIuMjk3MTQ0NzI5NTYwMDJdLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44NTk5ODI4NTQwMDAxLCAtMTIyLjI5NTA5MzU5N10sIFszNy44NzM0NDI1NTkwMDAxMDQsIC0xMjIuMjkzNTMwODE0XSwgWzM3Ljg2ODczODM3MywgLTEyMi4yODczMDMxNTYwMDAwMV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NjY5MTgwMjgsIC0xMjIuMjk2MjA5MDUzXSwgWzM3Ljg0NzgxODQ2MjczNywgLTEyMi4yNTM3MDQxNTk5MTY5OV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg1MDA1ODkwOSwgLTEyMi4yOTA3ODMyMDddLCBbMzcuODYzNjU0MzgzMDAwMDA0LCAtMTIyLjI5MDM2MzAwNF0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODY0MjY0MTI4MDAwMSwgLTEyMi4yNzIyMTAzNjcwMDAwMV0sIFszNy44NjM1MTA1MSwgLTEyMi4yOTYyMTY2MzM5OTk5OV0sIFszNy44NjYxMjExOTcsIC0xMjIuMjg1MDE1MTY1XSwgWzM3Ljg0Nzg5NDE2MTk5OTk5NiwgLTEyMi4yNzc3NjcwMTEwMDAwMV0sIFszNy44Nzc1NDkzNzQwMDAxMDQsIC0xMjIuMjk0ODYyMDU2XSwgWzM3Ljg3MDM2NjUxODAwMDAwNCwgLTEyMi4zMTg0MTYzNDNdLCBbMzcuODY4NjQzNjYxMDAwMSwgLTEyMi4yOTQ0MDU3NTRdLCBbMzcuODYzOTcxNDg4MDAwMTA0LCAtMTIyLjI2NzM2MzE1XSwgWzM3Ljg2NDU1NDE3NjAwMDEsIC0xMjIuMjY5OTA0NTYyMDAwMDFdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg1NTE4OTUzNTAwMDEsIC0xMjIuMjU5ODEzMDk3XSwgWzM3Ljg2OTQzNjgwMTAwMDEsIC0xMjIuMjg5NTIwMjUyXSwgWzM3Ljg3MDExMjY1NzAwMDExLCAtMTIyLjI4NDI0ODkzMzk5OTk5XSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44Njc2NjIxODQwMDAwMDQsIC0xMjIuMjk5ODkxNzMyXSwgWzM3Ljg1OTI4MTQ1LCAtMTIyLjMxNTg0OTE0XSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NjUxMjk3MywgLTEyMi4yNTg0MTE3ODldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44Njc4MDkwNDQwMDAxMDQsIC0xMjIuMjU4OTc1OTg2MDAwMDFdLCBbMzcuODY3ODA5MDQ0MDAwMTA0LCAtMTIyLjI1ODk3NTk4NjAwMDAxXSwgWzM3Ljg3Nzk3NzE2NDAwMDEsIC0xMjIuMjcyNTQ4NDExXSwgWzM3Ljg3NzgyODcyNjAwMDEsIC0xMjIuMjczNjk4ODI2XSwgWzM3Ljg3NzgyODcyNjAwMDEsIC0xMjIuMjczNjk4ODI2XSwgWzM3Ljg3NzgyODcyNjAwMDEsIC0xMjIuMjczNjk4ODI2XSwgWzM3Ljg2NTE3MTE1NSwgLTEyMi4yNzIzMDgyNDcwMDAwMV0sIFszNy44NzEyNjE5NzIwMDAxMDYsIC0xMjIuMjc1MjQ0ODg3OTk5OTldLCBbMzcuODQ4OTc1OTQ4LCAtMTIyLjI3ODY1NDgxOV0sIFszNy44NjY5MTgwMjgsIC0xMjIuMjk2MjA5MDUzXSwgWzM3Ljg2NzI2MzI0MzAwMDAwNCwgLTEyMi4yOTE1MjI1MDAwMDAwMV0sIFszNy44NzkwMDQ0NjIwMDAxMDQsIC0xMjIuMjY0NjE4MDhdLCBbMzcuODYyODU0ODMzLCAtMTIyLjI5MDEwNjM4NzAwMDAxXSwgWzM3Ljg3ODkyNTk4NjAwMDEsIC0xMjIuMzAzNTI3Nzc1XSwgWzM3Ljg1NzEyMjQ1OCwgLTEyMi4yNTk1NDU0MDldLCBbMzcuODY1MTI5NzMsIC0xMjIuMjU4NDExNzg5XSwgWzM3Ljg1MTk0MTEwMjAwMDEwNCwgLTEyMi4yNzAwODU5N10sIFszNy44NjU3Nzk4LCAtMTIyLjI2NzU3NjAwNV0sIFszNy44Mzk4MTgwNTIwMDAxMDUsIC0xMjIuMjY5NTU3OTNdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg1NjQ5MTMyMzAwMDEsIC0xMjIuMjY4NDYzMzA4XSwgWzM3Ljg2OTI5MzQ4NjAwMDA5NiwgLTEyMi4yNTQ2MDU0ODI5OTk5OV0sIFszNy44NjE1MTM2NDgsIC0xMjIuMjk2Nzk4ODUxXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg3NjMwOTg5OTk5OTk5NSwgLTEyMi4yNzEyMTk0NzVdLCBbMzcuODc3OTc3MTY0MDAwMSwgLTEyMi4yNzI1NDg0MTFdLCBbMzcuODc4MjY4MzkwMDAwMSwgLTEyMi4yNzAzMDExMjg5OTk5OV0sIFszNy44NTYyMDYyMDgwMDAxLCAtMTIyLjI4Nzk3ODIwM10sIFszNy44NTk1Mzc4MTgsIC0xMjIuMjU5MjA2MDA3OTk5OTldLCBbMzcuODU1MzAzNjg5LCAtMTIyLjI5MjQ3MjIwMTAwMDAxXSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NjgxMDg0ODgwMDAxMDQsIC0xMjIuMjU2NzEzNTczXSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg1MTE4MTEzMzAwMDEwNCwgLTEyMi4yODkyMzQwOTldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg3Mjg0MTIzMiwgLTEyMi4yNjk1ODI1MzddLCBbMzcuODYwMTk2NDIwMDAwMSwgLTEyMi4yOTQwNTQxOTFdLCBbMzcuODU4MDY1MzY1MDAwMSwgLTEyMi4yNDUyOTYwNDNdLCBbMzcuODc0NzQ5MzE0LCAtMTIyLjI5NjM3NzkxOV0sIFszNy44NzAxOTU2NTEwMDAxLCAtMTIyLjI5MzcyNDMxNF0sIFszNy44NzIzODk1MTEwMDAxLCAtMTIyLjI2ODcyNzcyNV0sIFszNy44NDk0NDcxMDEwMDAxLCAtMTIyLjI4MjcwNzU3Nzk5OTk5XSwgWzM3Ljg2MDQ2MTMwNTAwMDEsIC0xMjIuMjU5MDc1NDY3XSwgWzM3Ljg2NjkwNzk5NjAwMDEsIC0xMjIuMjU4Nzk4Njk3XSwgWzM3Ljg2NzUwNTc5NDAwMDEsIC0xMjIuMjU0MjUxMzc1XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODUxMzUxNzg4LCAtMTIyLjI5MDkwMTQ5Nl0sIFszNy44NTYxMzMxNjksIC0xMjIuMjcxMjgxNjgyMDAwMDFdLCBbMzcuODQ3ODEyODcyMDAwMTA1LCAtMTIyLjI5MTgxOTM2Mjk5OTk5XSwgWzM3Ljg2OTk4MTA4OTAwMDEsIC0xMjIuMjcwNTQ4NjAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUwMDU4OTA5LCAtMTIyLjI5MDc4MzIwN10sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODY1MDk3MDcsIC0xMjIuMjU0MjI2MTIzXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODcxODg0NDEzMDAwMDA0LCAtMTIyLjMwMTI0NDU4NV0sIFszNy44NTE5Mzk0NjQwMDAxMDQsIC0xMjIuMjgzNTAzNTk3XSwgWzM3Ljg2NjcwOTkyNTAwMDEsIC0xMjIuMjk3MjQ4NjhdLCBbMzcuOTAwODMyMzY1OTk5OTk2LCAtMTIyLjI3NzExNTg2OF0sIFszNy44NzExNzAxMTcwMDAxMDUsIC0xMjIuMjY4Mjc5NjQ1XSwgWzM3Ljg4MTQ3MzI4NSwgLTEyMi4yOTA4NzQ1OTYwMDAwMV0sIFszNy44NzExNzUyODUsIC0xMjIuMzA0NzM1NzU2XSwgWzM3Ljg3MzA3MzE5MiwgLTEyMi4yODIyMzU4NjNdLCBbMzcuODY5MzE0NzYzLCAtMTIyLjI5ODA5MzE0Mjk5OTk5XSwgWzM3Ljg2MDY0MTAxMSwgLTEyMi4yOTE4MTk5MDldLCBbMzcuODY1NzIxNjgyMDAwMSwgLTEyMi4yNjA4OTc5NTcwMDAwMV0sIFszNy44NTAxODM0NTEwMDAxLCAtMTIyLjI2MDQ5NTA0Mjk5OTk5XSwgWzM3Ljg2NDI0MDgyODAwMDEsIC0xMjIuMjY1MjQyMjE3MDAwMDFdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2MDQwNzQ3MzAwMDEsIC0xMjIuMjk5MTg5NDU0XSwgWzM3Ljg2MDMzNzM2MDAwMDEsIC0xMjIuMjY3MDUxMzg1XSwgWzM3Ljg3MTU4NjU0MywgLTEyMi4yNzk4NjY0MDc5OTk5OV0sIFszNy44NzIwODkyMDUwMDAxLCAtMTIyLjI4OTgxMjk0MjAwMDAxXSwgWzM3Ljg1NTE4MDc4MDAwMDEsIC0xMjIuMjY3Mzg0MTI0XSwgWzM3Ljg1NDcyODk4NywgLTEyMi4yNjkwMTkxNzIwMDAwMV0sIFszNy44NTMwODI1NTQwMTAyOSwgLTEyMi4yOTY4Mzc3NjAxNDZdLCBbMzcuODcyMDg5MjA1MDAwMSwgLTEyMi4yODk4MTI5NDIwMDAwMV0sIFszNy44NzA1NTkxNiwgLTEyMi4yOTg0OTIzNF0sIFszNy44NTE0ODY4NTcwMDAxMDQsIC0xMjIuMjc4NTk0NDE3MDAwMDFdLCBbMzcuODY2NDQ0MTExMDAwMSwgLTEyMi4zMDU1NTY1Njg5OTk5OV0sIFszNy44NjU5MjczMjcwMDAxLCAtMTIyLjI5MzUzMTAxMjk5OTk5XSwgWzM3Ljg2NTg1MzY2MjA5MDgsIC0xMjIuMjkzNjE0NDY1MDMyMDFdLCBbMzcuODY5OTYwMTYzLCAtMTIyLjI5MTY1MDU2OV0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODY2ODgzNjMyNjE2LCAtMTIyLjI4NzAxNzUzMjk5NV0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg3MDIzMTQxNTA5MjEsIC0xMjIuMjkyMzI3NjM5MzQyXSwgWzM3Ljg2OTk2MDE2MywgLTEyMi4yOTE2NTA1NjldLCBbMzcuODU3ODE1OTEyLCAtMTIyLjI3OTk3NjAyMjAwMDAxXSwgWzM3Ljg2NjAyODU5MDY1MDM5NCwgLTEyMi4zMDA1MDM5MjAxMl0sIFszNy44NjMzNTM2NjgwMDAxLCAtMTIyLjI3MjExMjM4NF0sIFszNy44NTc2Mjk5OTUsIC0xMjIuMjY2ODAzMjhdLCBbMzcuODgxMTQ1MTE0LCAtMTIyLjMwMTg4MTg5MTAwMDAxXSwgWzM3Ljg1NjIwNjIwODAwMDEsIC0xMjIuMjg3OTc4MjAzXSwgWzM3Ljg3NzgzMzg5MjAwMDEwNSwgLTEyMi4yOTk3MTg3NTFdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg3MjE1NzgyNiwgLTEyMi4yNzUzNTQ2ODVdLCBbMzcuODU2MzY2NDYyLCAtMTIyLjI1Nzk5MjgxMzk5OTk5XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2ODg3NjIwNDAwMDEsIC0xMjIuMzAwMjg0NTA1XSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg1NzYwMDYyOTAwMDAwNCwgLTEyMi4yODI0MTE1NDhdLCBbMzcuODY2MTAzNjE4ODc1MSwgLTEyMi4zMDU2ODgxMzUwMzA5OV0sIFszNy44NTk1MzQ4MjAwMDAxLCAtMTIyLjI5NzI3OTI2OV0sIFszNy44NTg3NjkyNDYwMDAxLCAtMTIyLjI4Njc4MDYzNF0sIFszNy44NjY5MDc5OTYwMDAxLCAtMTIyLjI1ODc5ODY5N10sIFszNy44Njc3NTc1MzUwMDAxLCAtMTIyLjI1NzE3NTA4NzAwMDAxXSwgWzM3Ljg2OTc4MjYzNSwgLTEyMi4zMDExMjQ0MDIwMDAwMV0sIFszNy44ODIwMzUyNDcsIC0xMjIuMjk3NTQ1NTQzXSwgWzM3Ljg2NjM4MzE2MSwgLTEyMi4zMDI2ODA5Mjc5OTk5OV0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NzYwMTMzMjcwMDAxLCAtMTIyLjI3MzUwMTIwNl0sIFszNy44NzU2NTg5NjcsIC0xMjIuMjkwNjA2MDAyXSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODU4OTM1NjIxMDAwMSwgLTEyMi4yNTE5MjE3MTddLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44Njg0NjIzMjY5OTk5OTYsIC0xMjIuMjg3NjYyNTUyOTk5OTldLCBbMzcuODU1NDk5NDIwMDAwMSwgLTEyMi4yNjY4NTE1MDVdLCBbMzcuODU3ODE1OTEyLCAtMTIyLjI3OTk3NjAyMjAwMDAxXSwgWzM3Ljg3NTc2ODExLCAtMTIyLjI4OTc0OTIzOV0sIFszNy44Njg0ODkyNTQwMDAxLCAtMTIyLjI2Nzg2NzUyXSwgWzM3Ljg3ODkwNTQ2NiwgLTEyMi4yODI5OTgwNDI5OTk5OV0sIFszNy44NzU4OTEzNDgsIC0xMjIuMjg4Nzc2NzM3XSwgWzM3Ljg0OTUwNTg3NDQ2NDc5NiwgLTEyMi4yOTk5ODc3ODM1ODddLCBbMzcuODcyMzg5NTExMDAwMSwgLTEyMi4yNjg3Mjc3MjVdLCBbMzcuODcyMzg5NTExMDAwMSwgLTEyMi4yNjg3Mjc3MjVdLCBbMzcuODc1ODkxMzQ4LCAtMTIyLjI4ODc3NjczN10sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NTg3MTI3OTMwMDAxLCAtMTIyLjI4MDE1NTE4MV0sIFszNy44Nzk1ODAxMjQsIC0xMjIuMzAwMjYxODgyOTk5OTldLCBbMzcuODc2Mjc1MTQ3MDAwMSwgLTEyMi4yODYxNTg5NjddLCBbMzcuODY0MTkxNDk1MDAwMSwgLTEyMi4yNTg1NjQ1MjRdLCBbMzcuODY3MjY4NDY2OTk5OTk1LCAtMTIyLjI3MDIzOTU5Nzk5OTk5XSwgWzM3Ljg3OTQyNTE0ODAwMDEsIC0xMjIuMjk2MzU0MDhdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg3NDM2NjYzNiwgLTEyMi4zMDQ0NDk1NTIwMDAwMV0sIFszNy44ODA2NjY1OTUsIC0xMjIuMjk0ODg3MjQ3XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg1ODU5NTc2NzAwMDEwNCwgLTEyMi4yNTkzMzc4MzZdLCBbMzcuODU0MzE2Mzg1MDAwMTA0LCAtMTIyLjI3MTA4NDE1NF0sIFszNy44NzMwMjU5MjYsIC0xMjIuMjY4NDg1MjA4OTk5OTldLCBbMzcuODU3NjYxMjY4MDAwMSwgLTEyMi4yNTk0Njk4NTFdLCBbMzcuODc4OTI1OTg2MDAwMSwgLTEyMi4zMDM1Mjc3NzVdLCBbMzcuODc2ODg4NDc3MDAwMSwgLTEyMi4yNjY2NTczMzVdLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODY1Nzc5OCwgLTEyMi4yNjc1NzYwMDVdLCBbMzcuODc5MTI4MzAzMDAwMSwgLTEyMi4zMDI0NjUzMzldLCBbMzcuODcxNjg1NjQzLCAtMTIyLjI5Mjk2NTA5OTk5OTk5XSwgWzM3Ljg3ODc0MDUwNTAwMDEsIC0xMjIuMjk1MjQyNjI2XSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODkxNDMwNTM2LCAtMTIyLjI3ODE4NjgzN10sIFszNy44NTk1MzQ4MjAwMDAxLCAtMTIyLjI5NzI3OTI2OV0sIFszNy44NjgxNDg4MzMwMDAxLCAtMTIyLjI5MTgxMDY3Nzk5OTk5XSwgWzM3Ljg2Njk3MTQ2MSwgLTEyMi4yNzI1MDU0NDM5OTk5OV0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODg3NTM4NDc4MDAwMSwgLTEyMi4yNzc0MDM4MDc5OTk5OV0sIFszNy44NzA5NzMzNjcsIC0xMjIuMjc0OTM5NzhdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODU1MTg5NTM1MDAwMSwgLTEyMi4yNTk4MTMwOTddLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NDcxODk3ODUwMDAxLCAtMTIyLjI4MzExNjcxODk5OTk5XSwgWzM3Ljg3OTgzNDA4MTAwMDEsIC0xMjIuMzAzODIzNjI5XSwgWzM3Ljg2NzI2ODQ2Njk5OTk5NSwgLTEyMi4yNzAyMzk1OTc5OTk5OV0sIFszNy44NDgwMzUwNDMsIC0xMjIuMjg1MzQxNzcxXSwgWzM3Ljg3NDE0ODg3MywgLTEyMi4zMDU1NzczODc5OTk5OV0sIFszNy44NjMwNjY2NDYwMDAxLCAtMTIyLjI2NzI1NjcxXSwgWzM3Ljg2NjkzMDM2OSwgLTEyMi4yNjU4MDg2MjVdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44NjU0Mjc3Njk4MTI0LCAtMTIyLjI2NzcwMTU2MzI3NV0sIFszNy44Njk0MzkzNDcsIC0xMjIuMjg3MDQwNDE1XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg1MzMzNDc1MSwgLTEyMi4yOTAxMjcxNDVdLCBbMzcuODY0ODI4MjU0LCAtMTIyLjI2MDcxNTY0MV0sIFszNy44NTAxMDQyNzUsIC0xMjIuMjg1OTk4OTgxXSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NzIzMzE4LCAtMTIyLjI5OTA2MDI4NV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODY2MDI4NTkwNjUwMzk0LCAtMTIyLjMwMDUwMzkyMDEyXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODcxODg0NDEzMDAwMDA0LCAtMTIyLjMwMTI0NDU4NV0sIFszNy44Nzc1NDkzNzQwMDAxMDQsIC0xMjIuMjk0ODYyMDU2XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg1ODA3NDMxMDAwMDEsIC0xMjIuMjQzODU1MDU3XSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODcyMjc2Mzg2MDAwMSwgLTEyMi4yODgzMzYxMTVdLCBbMzcuODcxNjg1NjQzLCAtMTIyLjI5Mjk2NTA5OTk5OTk5XSwgWzM3Ljg2ODgzNzkyMjAwMDEwNCwgLTEyMi4yNjg2NDM2ODJdLCBbMzcuODc5NDI1MTQ4MDAwMSwgLTEyMi4yOTYzNTQwOF0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NzI0NDczMDkwMDAxLCAtMTIyLjI2NjA4MjAyMl0sIFszNy44Njk3MzkxMzcwMDAxLCAtMTIyLjMwMDgwMjg1NF0sIFszNy44NzU1NDEzNDMwMDAxLCAtMTIyLjMwNDgyNDY2NV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzczODU5ODUsIC0xMjIuMzAxODkxMDU3XSwgWzM3Ljg2NTkyNzMyNzAwMDEsIC0xMjIuMjkzNTMxMDEyOTk5OTldLCBbMzcuODczMDczMTkyLCAtMTIyLjI4MjIzNTg2M10sIFszNy44NTI4MzYxNTgwMDAxLCAtMTIyLjI2ODEzMzY5NzAwMDAxXSwgWzM3Ljg2MjE4NDU1NTAwMDEsIC0xMjIuMjkzNTAyODk0XSwgWzM3Ljg0NzE3ODE3MTM3Mjc5NiwgLTEyMi4yNzczNzgwODgxMTAwMV0sIFszNy44NzIxNDk3ODIwMDAxLCAtMTIyLjI4MjEzMjIzODk5OTk5XSwgWzM3Ljg2NTkyNzMyNzAwMDEsIC0xMjIuMjkzNTMxMDEyOTk5OTldLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44NTYwMjA5OTIsIC0xMjIuMjc5NjA1NTc0XSwgWzM3Ljg3MDE5OTE5NywgLTEyMi4yODU3Nzc3MzI5OTk5OV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg1NzEyMjQ1OCwgLTEyMi4yNTk1NDU0MDldLCBbMzcuODc0NzQ5MzE0LCAtMTIyLjI5NjM3NzkxOV0sIFszNy44NzAzNjkzMzQsIC0xMjIuMjk5NjQ4ODM0XSwgWzM3Ljg3MTQyNjg0LCAtMTIyLjMwMzUwODI5OTk5OTk5XSwgWzM3Ljg2MDQ2MTMwNTAwMDEsIC0xMjIuMjU5MDc1NDY3XSwgWzM3Ljg3MzY1MTQ5NSwgLTEyMi4zMDE4MTU5MzIwMDAwMV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NjY4MjA0MjA3OTY3MSwgLTEyMi4zMDM3MTk4MDc5MDMwMV0sIFszNy44NTUzMDA1NTQwMDAxLCAtMTIyLjI2NjQ5MzE4M10sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44NDY5NjU4MTIwMDAxLCAtMTIyLjI3MjI2MTE2Ml0sIFszNy44NjgzMDU3OTMwMDAwMDUsIC0xMjIuMjY2NTEyMDkzOTk5OTldLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg2ODQwOTM0ODAwMDEsIC0xMjIuMjYxNDUzNzc0XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44Njg2Mzg4NSwgLTEyMi4zMTM3MzMxNzIwMDAwMV0sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NjkzMTQ3NjMsIC0xMjIuMjk4MDkzMTQyOTk5OTldLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODU5NTM0ODIwMDAwMSwgLTEyMi4yOTcyNzkyNjldLCBbMzcuODY1ODA5NjUyMDAwMSwgLTEyMi4zMDE3MDg2MTddLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODY5NDMyMDc2MDAwMSwgLTEyMi4yODE4NDM0NTcwMDAwMV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2NjMyNDIxNTAwMDEsIC0xMjIuMjYzMzYxODg2XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODc2OTQ4MDU3MDAwMTEsIC0xMjIuMjgwNDcxNTQ3XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44NTgwNjQyODQwMDAxLCAtMTIyLjI4ODU3NTU2NV0sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XSwgWzM3Ljg4MTQ0MTExMTAwMDEsIC0xMjIuMjkwMDA3NDMxXSwgWzM3Ljg0OTY5MDU1ODAwMDEwNiwgLTEyMi4yNzgxNzcyNDM5OTk5OV0sIFszNy44Njk3ODI2MzUsIC0xMjIuMzAxMTI0NDAyMDAwMDFdLCBbMzcuODUyNDkyMDc0MDAwMTA0LCAtMTIyLjI3MDg4NDcxOV0sIFszNy44NjkzOTE5NywgLTEyMi4yNjc5MzIzNDNdLCBbMzcuODQ3NDIxMzk5OTk5OTk1LCAtMTIyLjI4MTMzOTE0M10sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg3MzQ0MjU1OTAwMDEwNCwgLTEyMi4yOTM1MzA4MTRdLCBbMzcuODc2NjA0MzA3LCAtMTIyLjI2ODg5NjA4MTAwMDAxXSwgWzM3Ljg4MTE1NjI5MzAwMDEsIC0xMjIuMjgyMDg3NTYyXSwgWzM3Ljg2NDg3NjI2MDAwMDEsIC0xMjIuMjY3NDc0NzkxXSwgWzM3Ljg3OTc3NzgxNTAwMDEwNCwgLTEyMi4yNzI3NjgxOF0sIFszNy44NDczMDEwMjQwMDAwMDQsIC0xMjIuMjgyMjMzODEyXSwgWzM3Ljg4NjA3NzY4NjAwMDEsIC0xMjIuMjY2NTcyOTgyOTk5OTldLCBbMzcuODcxMjYxOTcyMDAwMTA2LCAtMTIyLjI3NTI0NDg4Nzk5OTk5XSwgWzM3Ljg2OTYwNTgxOTAwMDEsIC0xMjIuMjczMzY2NzAyXSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NjUxMjk3MywgLTEyMi4yNTg0MTE3ODldLCBbMzcuODYwMjQ2MzAxMDAwMDk2LCAtMTIyLjI4OTI3NjA0Nl0sIFszNy44Nzg3NDA1MDUwMDAxLCAtMTIyLjI5NTI0MjYyNl0sIFszNy44NjcyMTkwMzMwMDAwMDUsIC0xMjIuMjYzNTQwODE3XSwgWzM3Ljg1NzY0NDAwNywgLTEyMi4yODg0NDA3MTM5OTk5OV0sIFszNy44NjA3OTE4MDYwMDAxLCAtMTIyLjI1MTA3MzIzNF0sIFszNy44Njk2MDU4MTkwMDAxLCAtMTIyLjI3MzM2NjcwMl0sIFszNy44NzE4NTQ0NDYsIC0xMjIuMjcwNjcxOTM3XSwgWzM3Ljg2OTQzOTM0NywgLTEyMi4yODcwNDA0MTVdLCBbMzcuODc3NTM1Mjg4MDAwMDA0LCAtMTIyLjI3NTk1MTIyNF0sIFszNy44NjYzODE3ODEsIC0xMjIuMjkxMjM0NDEyMDAwMDFdLCBbMzcuODU2OTE3NzgwMDAwMSwgLTEyMi4yNzk3ODk5MTddLCBbMzcuODQ3NDIxMzk5OTk5OTk1LCAtMTIyLjI4MTMzOTE0M10sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg2Nzg2Njc1MTAwMDEsIC0xMjIuMjk4ODQ3NTI5XSwgWzM3Ljg1MDA1ODkwOSwgLTEyMi4yOTA3ODMyMDddLCBbMzcuODcyODQxMjMyLCAtMTIyLjI2OTU4MjUzN10sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MDA1ODkwOSwgLTEyMi4yOTA3ODMyMDddLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44ODYxOTk4MjkwMDAxLCAtMTIyLjI4MDA2NjM1OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODcxNTU1MjU0LCAtMTIyLjI3MzAwMTM0Ml0sIFszNy44NjY2ODY3ODMsIC0xMjIuMjY3Njc3MzE0XSwgWzM3Ljg3NTE0ODUxNSwgLTEyMi4yODAyNzA2ODcwMDAwMV0sIFszNy44NzU4OTEzNDgsIC0xMjIuMjg4Nzc2NzM3XSwgWzM3Ljg2NjkxODAyOCwgLTEyMi4yOTYyMDkwNTNdLCBbMzcuODU4NDIwODc2LCAtMTIyLjI2NzczMzI2M10sIFszNy44NjY2ODY3ODMsIC0xMjIuMjY3Njc3MzE0XSwgWzM3Ljg2NjcwOTkyNTAwMDEsIC0xMjIuMjk3MjQ4NjhdLCBbMzcuODU5MzQyNTEyMDAwMTA0LCAtMTIyLjI2NzQ4NjExMTAwMDAxXSwgWzM3Ljg2OTY1MDY2LCAtMTIyLjI2NzQ5MDU0NV0sIFszNy44ODA0NzQxOTUsIC0xMjIuMjk1Nzk5MjE1XSwgWzM3Ljg4MDY0ODIzOSwgLTEyMi4yOTc2NjYzODZdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODUxNTg3MjMzMDAwMDA0LCAtMTIyLjI3MDc3ODI1MTAwMDAxXSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODU2MTg1OTUzMDAwMSwgLTEyMi4yNTk2NzM4OTg5OTk5OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NTk1Mzc4MTgsIC0xMjIuMjU5MjA2MDA3OTk5OTldLCBbMzcuODU5NTM3ODE4LCAtMTIyLjI1OTIwNjAwNzk5OTk5XSwgWzM3Ljg1NzA1Mzg0NDAwMDEsIC0xMjIuMjcxMzg1MDg2MDAwMDFdLCBbMzcuODU5OTgxMDA4MDAwMDA1LCAtMTIyLjI1MzMyNjgyNzAwMDAxXSwgWzM3Ljg3MDk3NDYwNjAwMDEsIC0xMjIuMjc3NTAyNDE4XSwgWzM3Ljg4MjI2MDI3MywgLTEyMi4yOTYzODY1NjFdLCBbMzcuODc2Njg5OTk3LCAtMTIyLjI4MjY0Njc3Ml0sIFszNy44NzU4OTEzNDgsIC0xMjIuMjg4Nzc2NzM3XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg1NDkxODcyOTAwMDEwNCwgLTEyMi4yODc1NjQzNjZdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODY2NzA5OTI1MDAwMSwgLTEyMi4yOTcyNDg2OF0sIFszNy44NjY5MTgwMjgsIC0xMjIuMjk2MjA5MDUzXSwgWzM3Ljg2ODIwMjAxMDAwMDEsIC0xMjIuMjk2NjI0NzUzOTk5OTldLCBbMzcuODY1MTI5NzMsIC0xMjIuMjU4NDExNzg5XSwgWzM3Ljg3NDM2NjYzNiwgLTEyMi4zMDQ0NDk1NTIwMDAwMV0sIFszNy44NjUxMzg3ODMwMDAxLCAtMTIyLjI2NTQ0MjAyMl0sIFszNy44NzU2NTg5NjcsIC0xMjIuMjkwNjA2MDAyXSwgWzM3Ljg2MjQ0NjE4Njk5OTk5NiwgLTEyMi4yNzE5OTg4OTM5OTk5OV0sIFszNy44NjUwMzc2OTksIC0xMjIuMjk3OTMyMzA0XSwgWzM3Ljg3NTY1ODk2NywgLTEyMi4yOTA2MDYwMDJdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg2MjE1NTU5NiwgLTEyMi4yNjcxNTE4NTM5OTk5OV0sIFszNy44NTQ1NDczNjksIC0xMjIuMjY2MzkzODM1XSwgWzM3Ljg3ODQ2ODA3NywgLTEyMi4zMDU3NjU3MTIwMDAwMV0sIFszNy44NjAzMzczNjAwMDAxLCAtMTIyLjI2NzA1MTM4NV0sIFszNy44ODAwMjQwODEsIC0xMjIuMjk4MDc1NTM5XSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODc5Nzk2OTM2LCAtMTIyLjI5OTE5Mjg0OV0sIFszNy44Nzk3OTY5MzYsIC0xMjIuMjk5MTkyODQ5XSwgWzM3Ljg2NTEzODc4MzAwMDEsIC0xMjIuMjY1NDQyMDIyXSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODc5Nzk2OTM2LCAtMTIyLjI5OTE5Mjg0OV0sIFszNy44Nzk3OTY5MzYsIC0xMjIuMjk5MTkyODQ5XSwgWzM3Ljg4MDI1MjYyODAwMDEsIC0xMjIuMjk2OTU2NTMxXSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODc5Nzk2OTM2LCAtMTIyLjI5OTE5Mjg0OV0sIFszNy44Nzk3OTY5MzYsIC0xMjIuMjk5MTkyODQ5XSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODc5Nzk2OTM2LCAtMTIyLjI5OTE5Mjg0OV0sIFszNy44Nzk3OTY5MzYsIC0xMjIuMjk5MTkyODQ5XSwgWzM3Ljg3OTc5NjkzNiwgLTEyMi4yOTkxOTI4NDldLCBbMzcuODc5MzY4MDUzMDAwMSwgLTEyMi4zMDEyODk0NDldLCBbMzcuODgwMjQ4MTUzMDAwMDA0LCAtMTIyLjMwNjMzOTI2ODk5OTk5XSwgWzM3Ljg2NzUxMzE2MSwgLTEyMi4yNjEyNzMxMDVdLCBbMzcuODgxNTgwNjg3MDAwMSwgLTEyMi4yOTk3NTI0OTI5OTk5OV0sIFszNy44NDY0Nzk3OTQwMDAxLCAtMTIyLjI2MTAxMTVdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODY3MjAwOTk3MDAwMTA0LCAtMTIyLjMwMjE1MTA1Mjk5OTk5XSwgWzM3Ljg0NzY3NDI2MjAwMDEwNSwgLTEyMi4yNzQ0OTU3MTRdLCBbMzcuODQ4MTQ0OTE5LCAtMTIyLjI3NTg0MzU4MV0sIFszNy44NjI3NjI5NDgwMDAxLCAtMTIyLjI3NjY0NTY0M10sIFszNy44Njc0OTUwODc0Njk2LCAtMTIyLjI5OTg2NzU3MDE0Ml0sIFszNy44NDc5NjM0ODI0MjQxLCAtMTIyLjI3Nzg3MzAyMDQwM10sIFszNy44NjIyNjY3NjUwMDAxLCAtMTIyLjI4MjQ3OTY5MV0sIFszNy44NjgyNTQ3NTksIC0xMjIuMjk5NzUxODI1XSwgWzM3Ljg3NjM4Mjk0LCAtMTIyLjI5NDQ4MzgzXSwgWzM3Ljg1NjAyMDk5MiwgLTEyMi4yNzk2MDU1NzRdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODY1NTMzNzg0LCAtMTIyLjI4Mzc0NzI4MV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzE0NTY0OTUwMDAxLCAtMTIyLjI5NDEyNzI5MTAwMDAxXSwgWzM3Ljg2NTQ2NzI2NjAwMDEsIC0xMjIuMjk1NzQyNTU1XSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODY0ODIzNDA2LCAtMTIyLjI5ODk3MTc0M10sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODY2NDY4NTc5MDAwMSwgLTEyMi4yOTgzOTY2MzFdLCBbMzcuODk2MDQ1NjUxMDAwMSwgLTEyMi4yNzU4MjgzODldLCBbMzcuODgxOTA4NjAzMDAwMSwgLTEyMi4yNzA0MzQ4MV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg2OTA1NjQ0NDAwMDEsIC0xMjIuMjcwNDM0NzA3XSwgWzM3Ljg2MDMzNzM2MDAwMDEsIC0xMjIuMjY3MDUxMzg1XSwgWzM3Ljg3MTg1NDQ0NiwgLTEyMi4yNzA2NzE5MzddLCBbMzcuODY5MzkxOTcsIC0xMjIuMjY3OTMyMzQzXSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODcyNTQ2MDEwMDAwMSwgLTEyMi4yNTM3NTAzMDhdLCBbMzcuODY0ODc2MjYwMDAwMSwgLTEyMi4yNjc0NzQ3OTFdLCBbMzcuODU1OTI3NTMyMDAwMSwgLTEyMi4yNTczMDM2NTVdLCBbMzcuODU3NDYzNzUyMDAwMSwgLTEyMi4yNjgwOTE1NDg5OTk5OV0sIFszNy44NzA5NzQ2MDYwMDAxLCAtMTIyLjI3NzUwMjQxOF0sIFszNy44NjA2MjU5NzgsIC0xMjIuMjcxODAxMjRdLCBbMzcuODc5MTI4MzAzMDAwMSwgLTEyMi4zMDI0NjUzMzldLCBbMzcuODY4NDIzNTEzLCAtMTIyLjI5NTUxNjE0OV0sIFszNy44NjYwMTQ1ODIsIC0xMjIuMjU4NjE2NDAyOTk5OTldLCBbMzcuODY3ODQzMTUyLCAtMTIyLjI5NTg3MzA3NF0sIFszNy44NzQzNjY2MzYsIC0xMjIuMzA0NDQ5NTUyMDAwMDFdLCBbMzcuODY2Njk4ODU2LCAtMTIyLjMwMDA2MDYxM10sIFszNy44NTg4NTgwNjQwMDAxLCAtMTIyLjI3MTU5NjE4Mzk5OTk5XSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODU0NzI4OTg3LCAtMTIyLjI2OTAxOTE3MjAwMDAxXSwgWzM3Ljg3NTg5MTM0OCwgLTEyMi4yODg3NzY3MzddLCBbMzcuODYyMTU1NTk2LCAtMTIyLjI2NzE1MTg1Mzk5OTk5XSwgWzM3Ljg1MzkwMTY2MjAwMDEwNSwgLTEyMi4yNzQyMzUzNzg5OTk5OV0sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NTIzNDY2NDYwMDAxLCAtMTIyLjI3MTk3MjQ2NjAwMDAxXSwgWzM3Ljg2ODI4MzUxMTAwMDEsIC0xMjIuMjU3NTA5MTMzXSwgWzM3Ljg1Njc3MDQ1OTAwMDEsIC0xMjIuMjc4ODMwMTcxMDAwMDFdLCBbMzcuODc2Mzc5Mjk4MDAwMSwgLTEyMi4yODUwMzAzN10sIFszNy44NDYyMzA3MzcsIC0xMjIuMjc0Mzg2NjM1XSwgWzM3Ljg1MjY1NTk1Njk5OTk5NiwgLTEyMi4yNzY3NDgzMTcwMDAwMV0sIFszNy44Nzk4ODQ3OTUwMDAxLCAtMTIyLjMwMzUwMzUxOF0sIFszNy44NzY2ODk5OTcsIC0xMjIuMjgyNjQ2NzcyXSwgWzM3Ljg2OTk3Njk2NzAwMDEwNiwgLTEyMi4yOTQ4Mjk1NjNdLCBbMzcuODU2MTg1OTUzMDAwMSwgLTEyMi4yNTk2NzM4OTg5OTk5OV0sIFszNy44Njc4OTgxMjcsIC0xMjIuMjc5NDY3Nzg3XSwgWzM3Ljg2Nzk5MzkwMzAwMDEwNSwgLTEyMi4yOTc2NjQzOThdLCBbMzcuODY2MzgxNzgxLCAtMTIyLjI5MTIzNDQxMjAwMDAxXSwgWzM3Ljg3NTU0MTM0MzAwMDEsIC0xMjIuMzA0ODI0NjY1XSwgWzM3Ljg0Njk0MzU0LCAtMTIyLjI4NDk5MDc2MV0sIFszNy44NDYwNDE5ODcsIC0xMjIuMjg0NjkyNDQ3OTk5OTldLCBbMzcuODcwMzY5MzM0LCAtMTIyLjI5OTY0ODgzNF0sIFszNy44NjQxOTE0OTUwMDAxLCAtMTIyLjI1ODU2NDUyNF0sIFszNy44OTEzMTMzMzYwMDAxLCAtMTIyLjI4MDMxMzg4OF0sIFszNy44NTM4MTUzNDUsIC0xMjIuMjY2MzAxOTI2XSwgWzM3Ljg1NDAyMjM3MSwgLTEyMi4yNzUzNjg1NzZdLCBbMzcuODY4NDA5MzQ4MDAwMSwgLTEyMi4yNjE0NTM3NzRdLCBbMzcuODcxNjg1NjQzLCAtMTIyLjI5Mjk2NTA5OTk5OTk5XSwgWzM3Ljg3MjMyOTYzMjAwMDEsIC0xMjIuMjY5MzEzMjQzXSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg1NTkyMTU5MjAwMDEsIC0xMjIuMjcyNzk1NzU0XSwgWzM3Ljg3NDA5MDY4NDAwMDEsIC0xMjIuMjk5NjI5NjU1XSwgWzM3Ljg3ODA3NzQ1MDA5NzEsIC0xMjIuMzA4MDI4MTYzMDc1MDFdLCBbMzcuODc0MzY2NjM2LCAtMTIyLjMwNDQ0OTU1MjAwMDAxXSwgWzM3Ljg1MzA4MjU1NDAxMDI5LCAtMTIyLjI5NjgzNzc2MDE0Nl0sIFszNy44NjgyMTE3OTgwMDAxMDQsIC0xMjIuMjU4MDMzODAxMDAwMDFdLCBbMzcuODY2Njg2NzgzLCAtMTIyLjI2NzY3NzMxNF0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44ODA0ODUzNjEwODA0OTUsIC0xMjIuMzA1MTY1NzA0Nzg3XSwgWzM3Ljg4MDkxNDk5NDAwMDEsIC0xMjIuMzAzMDU2MzIxXSwgWzM3Ljg2NjkwNzk5NjAwMDEsIC0xMjIuMjU4Nzk4Njk3XSwgWzM3Ljg2ODY5ODQ0MywgLTEyMi4yNTkxNTEyNjJdLCBbMzcuODU4ODU4MDY0MDAwMSwgLTEyMi4yNzE1OTYxODM5OTk5OV0sIFszNy44NzExMTQxNjgwMDAxMDUsIC0xMjIuMjk5MzQ4NzA2XSwgWzM3Ljg3MTI2MTk3MjAwMDEwNiwgLTEyMi4yNzUyNDQ4ODc5OTk5OV0sIFszNy44NzAxMTI2NTcwMDAxMSwgLTEyMi4yODQyNDg5MzM5OTk5OV0sIFszNy44NjQ4MjgyNTQsIC0xMjIuMjYwNzE1NjQxXSwgWzM3Ljg3NjgyMDQ0OSwgLTEyMi4yODkwOTM3MDJdLCBbMzcuODc2Njg5OTk3LCAtMTIyLjI4MjY0Njc3Ml0sIFszNy44Njk2MDU4MTkwMDAxLCAtMTIyLjI3MzM2NjcwMl0sIFszNy44NDYyMDQ0MzUwMDAxMDQsIC0xMjIuMjc2NzEzMjYyXSwgWzM3Ljg2MzUxMDUxLCAtMTIyLjI5NjIxNjYzMzk5OTk5XSwgWzM3Ljg4MDA4NjI4MiwgLTEyMi4zMDcyMjIzODRdLCBbMzcuODYwNDY5NzQ5MDAwMSwgLTEyMi4yODA0OTUyODhdLCBbMzcuODc5MzY4MDUzMDAwMSwgLTEyMi4zMDEyODk0NDldLCBbMzcuODYyMTk1OTk1LCAtMTIyLjI4MTA5Mjc4OF0sIFszNy44NzU1NDEzNDMwMDAxLCAtMTIyLjMwNDgyNDY2NV0sIFszNy44NzQzNjY2MzYsIC0xMjIuMzA0NDQ5NTUyMDAwMDFdLCBbMzcuODYwNDYxMzA1MDAwMSwgLTEyMi4yNTkwNzU0NjddLCBbMzcuODYwMjQ2MzAxMDAwMDk2LCAtMTIyLjI4OTI3NjA0Nl0sIFszNy44NzA2ODQzMjUwMDAxLCAtMTIyLjI3OTc2ODUyMzk5OTk5XSwgWzM3Ljg3MDQ4MTYxMDAwMDEsIC0xMjIuMzAwNTAyMDY2XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODYxMzk1ODAyMDAwMTA0LCAtMTIyLjI1ODk0MzQ1N10sIFszNy44NTM1NTA3MjYsIC0xMjIuMjc2OTMwODI3XSwgWzM3Ljg4Njg4MTIyOTAwMDAwNCwgLTEyMi4yOTY4NDcyMDYwMDAwMV0sIFszNy44NzMzMDA2NjMwMDAxLCAtMTIyLjI3MzE5NTUxOF0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NTQxNzE1NDQwMDAxLCAtMTIyLjI2OTE3ODE1NF0sIFszNy44NzkzNjgwNTMwMDAxLCAtMTIyLjMwMTI4OTQ0OV0sIFszNy44NTAxMDQyNzUsIC0xMjIuMjg1OTk4OTgxXSwgWzM3Ljg3MTU1NTI1NCwgLTEyMi4yNzMwMDEzNDJdLCBbMzcuODUzMjEwNzQ5NzQyNSwgLTEyMi4yOTcxNDQ3Mjk1NjAwMl0sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg3NjI3NzY5MTk5OTk5NSwgLTEyMi4zMDYzMjExMDZdLCBbMzcuODY4MzA1NzkzMDAwMDA1LCAtMTIyLjI2NjUxMjA5Mzk5OTk5XSwgWzM3Ljg2NDgyODI1NCwgLTEyMi4yNjA3MTU2NDFdLCBbMzcuODU3MTIyNDU4LCAtMTIyLjI1OTU0NTQwOV0sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NjQ2MzI3ODgwMDAxLCAtMTIyLjI5MzQ4NTM0N10sIFszNy44NzMxODkxMzYwMDAxLCAtMTIyLjMwNDA3Nzg2NV0sIFszNy44NTE0ODY4NTcwMDAxMDQsIC0xMjIuMjc4NTk0NDE3MDAwMDFdLCBbMzcuODY2ODIwNDIwNzk2NzEsIC0xMjIuMzAzNzE5ODA3OTAzMDFdLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NjA2NTQzMzEsIC0xMjIuMjUzMzk0NzA3OTk5OTldLCBbMzcuODY5OTgxMDg5MDAwMSwgLTEyMi4yNzA1NDg2MDFdLCBbMzcuODc4OTI1OTg2MDAwMSwgLTEyMi4zMDM1Mjc3NzVdLCBbMzcuODU3ODE1OTEyLCAtMTIyLjI3OTk3NjAyMjAwMDAxXSwgWzM3Ljg2NTY2MDIwNzQ4NzcsIC0xMjIuMjU0MDAwOTI0MzkzMDFdLCBbMzcuODc0OTgxMTY5MDAwMSwgLTEyMi4yOTUyNjU5OV0sIFszNy44NTI5NTgwNSwgLTEyMi4yNjAxMTY5NzJdLCBbMzcuODU1ODI2NDQ1LCAtMTIyLjI2MjQ1OTM1Nzk5OTk5XSwgWzM3Ljg2NTQ2NzI2NjAwMDEsIC0xMjIuMjk1NzQyNTU1XSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODY5NDM2ODAxMDAwMSwgLTEyMi4yODk1MjAyNTJdLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44Njg3NzQ0ODIsIC0xMjIuMjcyNzA0NDVdLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg1OTYxMjMzMDAwMDEsIC0xMjIuMjg5Nzc5MzE1XSwgWzM3Ljg1MTcxNjg3MDAwMDEwNCwgLTEyMi4yODY2MDM0ODJdLCBbMzcuODQ3ODEyODcyMDAwMTA1LCAtMTIyLjI5MTgxOTM2Mjk5OTk5XSwgWzM3Ljg3MDI4NzAxMjAwMDEwNSwgLTEyMi4yNzUxNDM1OTNdLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg1NjMwODQ2NSwgLTEyMi4yNzc0MzUxMTZdLCBbMzcuODczNDE0MTE0Njc0NCwgLTEyMi4zMDI5MTMzODE4NThdLCBbMzcuODczMTg5MTM2MDAwMSwgLTEyMi4zMDQwNzc4NjVdLCBbMzcuODY1NDU4MzkwMDAwMSwgLTEyMi4yNzAwMDc1NTg5OTk5OV0sIFszNy44NjQ4MjM0MDYsIC0xMjIuMjk4OTcxNzQzXSwgWzM3Ljg2NzIwMDk5NzAwMDEwNCwgLTEyMi4zMDIxNTEwNTI5OTk5OV0sIFszNy44Nzk1ODAxMjQsIC0xMjIuMzAwMjYxODgyOTk5OTldLCBbMzcuODUwNDI1MjYxMDAwMSwgLTEyMi4yODA1Njk0MDAwMDAwMl0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg3MjE1MTQ1NiwgLTEyMi4yNjg0MTM5MzFdLCBbMzcuODYyNDgzMjcsIC0xMjIuMjc4ODAwODg2XSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg1OTM0MjUxMjAwMDEwNCwgLTEyMi4yNjc0ODYxMTEwMDAwMV0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg3MzMwMDY2MzAwMDEsIC0xMjIuMjczMTk1NTE4XSwgWzM3Ljg2MzI3NTM1MjAwMDEsIC0xMjIuMjk3MzY0Njk1XSwgWzM3Ljg2MDQ2MTMwNTAwMDEsIC0xMjIuMjU5MDc1NDY3XSwgWzM3Ljg3Njk0ODA1NzAwMDExLCAtMTIyLjI4MDQ3MTU0N10sIFszNy44NjgyMTE3OTgwMDAxMDQsIC0xMjIuMjU4MDMzODAxMDAwMDFdLCBbMzcuODUwMTkxNDUwMDAwMSwgLTEyMi4yOTQ1MTI5OTYwMDAwMV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTA4MDcwMDEwMDAxLCAtMTIyLjI5MTAzNjgxOV0sIFszNy44NTEwMDg1NTAwMDAxLCAtMTIyLjI5MTEwNDAzNF0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MDI0MzU5MiwgLTEyMi4yOTEyMDE3NDVdLCBbMzcuODgxMzAwMDUyLCAtMTIyLjI4MjY3NDQwMjk5OTk5XSwgWzM3Ljg3ODg1NTcyLCAtMTIyLjI2OTgwNTk3N10sIFszNy44NjU2Nzc4ODQsIC0xMjIuMjU3MjY2NTY1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2OTQzNjgwMTAwMDEsIC0xMjIuMjg5NTIwMjUyXSwgWzM3Ljg2ODEwODQ4ODAwMDEwNCwgLTEyMi4yNTY3MTM1NzNdLCBbMzcuODU3ODg3NTYxOTk5OTk1LCAtMTIyLjI4NjU5NjU2Mjk5OTk5XSwgWzM3Ljg1NjU1NjQxNiwgLTEyMi4yNTY3OTM0MDI5OTk5OV0sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NTAxODM0NTEwMDAxLCAtMTIyLjI2MDQ5NTA0Mjk5OTk5XSwgWzM3Ljg1Mzk3MTkwODAwMDEwNSwgLTEyMi4yNDg1OTQ2OTldLCBbMzcuODYyMzEwODQ2MDAwMSwgLTEyMi4yNTAwOTU2OTk5OTk5OV0sIFszNy44NTg1MTgwNCwgLTEyMi4yODg3MjE2MDVdLCBbMzcuODY4Njk4NDQzLCAtMTIyLjI1OTE1MTI2Ml0sIFszNy44Njc3Mjc1MjAwMDAxLCAtMTIyLjI1NzM5MTQ1M10sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NjMwNjY2NDYwMDAxLCAtMTIyLjI2NzI1NjcxXSwgWzM3Ljg3NDE0NTgxMTAwMDEsIC0xMjIuMjY2MjkwNTM3XSwgWzM3Ljg1MzU1MDcyNiwgLTEyMi4yNzY5MzA4MjddLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NDcwMzgxMzQwMDAxLCAtMTIyLjI3NzQxMjU2Nzk5OTk5XSwgWzM3Ljg2OTY5MTg1NSwgLTEyMi4yNzI3OTkxNF0sIFszNy44Njg4NzYyMDQwMDAxLCAtMTIyLjMwMDI4NDUwNV0sIFszNy44Njg4NzYyMDQwMDAxLCAtMTIyLjMwMDI4NDUwNV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NzE2ODU2NDMsIC0xMjIuMjkyOTY1MDk5OTk5OTldLCBbMzcuODUyMjI2MzEyLCAtMTIyLjI5MTQ5NTQ0Mjk5OTk5XSwgWzM3Ljg3MDE0MDk3MTAwMDEsIC0xMjIuMjc2MjY5NjldLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NjY5MTgwMjgsIC0xMjIuMjk2MjA5MDUzXSwgWzM3Ljg4NDEwNDExOCwgLTEyMi4yNjkyMDcxNjJdLCBbMzcuODY5NzUwMDI3MDAwMSwgLTEyMi4yOTU5MzQ2MDI5OTk5OV0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODY5MzE0NzYzLCAtMTIyLjI5ODA5MzE0Mjk5OTk5XSwgWzM3Ljg3MTY4NTY0MywgLTEyMi4yOTI5NjUwOTk5OTk5OV0sIFszNy44NTIxNTQ0NjgsIC0xMjIuMjg2Njc2NzYzOTk5OTldLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44NTg3MTI3OTMwMDAxLCAtMTIyLjI4MDE1NTE4MV0sIFszNy44NzI4NDEyMzIsIC0xMjIuMjY5NTgyNTM3XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Mjg1NDgzMywgLTEyMi4yOTAxMDYzODcwMDAwMV0sIFszNy44NTQzOTczMzUsIC0xMjIuMjg3Mzk1OTA2XSwgWzM3Ljg1NDM5NzMzNSwgLTEyMi4yODczOTU5MDZdLCBbMzcuODc0MzY2NjM2LCAtMTIyLjMwNDQ0OTU1MjAwMDAxXSwgWzM3Ljg2MzY1NDM4MzAwMDAwNCwgLTEyMi4yOTAzNjMwMDRdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg2MTA5NDM5Njk5OTk5NSwgLTEyMi4yODk1NDU5NTEwMDAwMV0sIFszNy44NjAyNDYzMDEwMDAwOTYsIC0xMjIuMjg5Mjc2MDQ2XSwgWzM3Ljg3MzMwMDY2MzAwMDEsIC0xMjIuMjczMTk1NTE4XSwgWzM3Ljg3Mzk1NDczNiwgLTEyMi4yODIzMzg0Nzc5OTk5OV0sIFszNy44NzYzNzkyOTgwMDAxLCAtMTIyLjI4NTAzMDM3XSwgWzM3Ljg1NjIwNjIwODAwMDEsIC0xMjIuMjg3OTc4MjAzXSwgWzM3Ljg3NTU0MzE4NzAwMDEwNSwgLTEyMi4yOTE0NDg3MjldLCBbMzcuODYzNjU0MzgzMDAwMDA0LCAtMTIyLjI5MDM2MzAwNF0sIFszNy44NTQ3Mjg5ODcsIC0xMjIuMjY5MDE5MTcyMDAwMDFdLCBbMzcuODYxODI2MDQ0MDAwMTA0LCAtMTIyLjI2OTYyMjkzNl0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg2OTA1NjQ0NDAwMDEsIC0xMjIuMjcwNDM0NzA3XSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODYzMzUzNjY4MDAwMSwgLTEyMi4yNzIxMTIzODRdLCBbMzcuODYyMzI5NjE0MDAwMDA0LCAtMTIyLjI1ODgxMTQxNF0sIFszNy44NTUxODk1MzUwMDAxLCAtMTIyLjI1OTgxMzA5N10sIFszNy44Njg2OTg0NDMsIC0xMjIuMjU5MTUxMjYyXSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODY2OTA3OTk2MDAwMSwgLTEyMi4yNTg3OTg2OTddLCBbMzcuODYzNTI2MTk2MDAwMSwgLTEyMi4yNTUwMDQzNzJdLCBbMzcuODcxMjYxOTcyMDAwMTA2LCAtMTIyLjI3NTI0NDg4Nzk5OTk5XSwgWzM3Ljg2OTk2MDE2MywgLTEyMi4yOTE2NTA1NjldLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44Njc1MDU3OTQwMDAxLCAtMTIyLjI1NDI1MTM3NV0sIFszNy44NzEyNjE5NzIwMDAxMDYsIC0xMjIuMjc1MjQ0ODg3OTk5OTldLCBbMzcuODUyMzQ2NjQ2MDAwMSwgLTEyMi4yNzE5NzI0NjYwMDAwMV0sIFszNy44NDYyMDQ0MzUwMDAxMDQsIC0xMjIuMjc2NzEzMjYyXSwgWzM3Ljg4NTQxNTA5MjAwMDEsIC0xMjIuMjc0OTQ3NzEyOTk5OTldLCBbMzcuODU1NjY1MTA3MDAwMSwgLTEyMi4yNzQ0MTc4NjNdLCBbMzcuODcxMDUzOTA4MDAwMSwgLTEyMi4zMDE1MDQ1MTRdLCBbMzcuODcwMTY2OTczLCAtMTIyLjMwMDY5NTU3Nzk5OTk5XSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NjE3NDM5OTgwMDAxLCAtMTIyLjI5NTY1MDcwMjk5OTk5XSwgWzM3Ljg0OTY5NzQ0OCwgLTEyMi4yNzEwNTE4NDcwMDAwMV0sIFszNy44NTI1OTA3OTAwMDAxLCAtMTIyLjI4OTY5NTkyNzk5OTk5XSwgWzM3Ljg4MDU5NDIzOTAwMDEwNCwgLTEyMi4yOTY2NDM3MjddLCBbMzcuODcwNDM0MzI4LCAtMTIyLjI3NDAyMjcwNzk5OTk5XSwgWzM3Ljg1NjEzMzE2OSwgLTEyMi4yNzEyODE2ODIwMDAwMV0sIFszNy44Nzc5MzY4MzcwMDAxLCAtMTIyLjI5NTM5Mjk3OF0sIFszNy44NTMyODEwOTQwMDAxLCAtMTIyLjI3OTAxMTU2Nzk5OTk5XSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg2NzgzNDY3NiwgLTEyMi4yNjU5NTE0MTc5OTk5OV0sIFszNy44Njg0MTM5NTkwMDAxLCAtMTIyLjMwMjU0MTA5N10sIFszNy44NjM1MTA1MSwgLTEyMi4yOTYyMTY2MzM5OTk5OV0sIFszNy44NzI0NDczMDkwMDAxLCAtMTIyLjI2NjA4MjAyMl0sIFszNy44NjY2MTI5NDg5NTU3MDUsIC0xMjIuMjY3NjA0MzAzOTgzXSwgWzM3Ljg3NDE0NTgxMTAwMDEsIC0xMjIuMjY2MjkwNTM3XSwgWzM3Ljg2NDEyNjYzOTAwMDEsIC0xMjIuMjUwMjY4NDUxMDAwMDFdLCBbMzcuODgxMDA3MTgzMDAwMSwgLTEyMi4yODMyNDI2NTEwMDAwMV0sIFszNy44NjgzOTAzNjcwMDAxLCAtMTIyLjI1NDQyODIwMjk5OTk5XSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODY3MjA3NTM5LCAtMTIyLjI1NjUyOTM3N10sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg2NDI1OTkyMTk5OTk5NSwgLTEyMi4zMTMzNjA4MDhdLCBbMzcuODU2NDIwNDkwMDAwMSwgLTEyMi4yNjkwMTkzODVdLCBbMzcuODcyMjYxNTUyMDAwMTA0LCAtMTIyLjI2OTgzODI1N10sIFszNy44NjEwOTQzOTY5OTk5OTUsIC0xMjIuMjg5NTQ1OTUxMDAwMDFdLCBbMzcuODYzMjAyOTQwMDAwMSwgLTEyMi4yNzMyNzgxMTEwMDAwMV0sIFszNy44NzI0NDczMDkwMDAxLCAtMTIyLjI2NjA4MjAyMl0sIFszNy44NTk2MTIzMzAwMDAxLCAtMTIyLjI4OTc3OTMxNV0sIFszNy44NjcyNjM3MDgwMDAxLCAtMTIyLjI2Njc0NzAzNzk5OTk5XSwgWzM3Ljg1MzA4MjU1NDAxMDI5LCAtMTIyLjI5NjgzNzc2MDE0Nl0sIFszNy44NzM2NTE0OTUsIC0xMjIuMzAxODE1OTMyMDAwMDFdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODc4NzA0NDU0NTc4MjA1LCAtMTIyLjMwNDY0MTkwODc1N10sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44NjkwNTY0NDQwMDAxLCAtMTIyLjI3MDQzNDcwN10sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44Njk2MDU4MTkwMDAxLCAtMTIyLjI3MzM2NjcwMl0sIFszNy44NTczMTk4OTQwMDAxLCAtMTIyLjI2OTEyMjI1XSwgWzM3Ljg2MzgyOTEwOTAwMDEsIC0xMjIuMjgxNTUwMTA3OTk5OTldLCBbMzcuODkxODE2MDc5MDAwMSwgLTEyMi4yNjcxNDI5Mzc5OTk5OV0sIFszNy44NTI2NTU5NTY5OTk5OTYsIC0xMjIuMjc2NzQ4MzE3MDAwMDFdLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODY4NjI0NzU4MDAwMSwgLTEyMi4yODYwMjA2MDg5OTk5OV0sIFszNy44Njg0MTM5NTkwMDAxLCAtMTIyLjMwMjU0MTA5N10sIFszNy44NzI1NDYwOTMwMDAwMDQsIC0xMjIuMjk4MDIwNzRdLCBbMzcuODcxODU0NDQ2LCAtMTIyLjI3MDY3MTkzN10sIFszNy44NjgzMTkwNjIwMDAxMDQsIC0xMjIuMjY3MTcwODI3XSwgWzM3Ljg2Njk3MTQ2MSwgLTEyMi4yNzI1MDU0NDM5OTk5OV0sIFszNy44NjY0NDQxMTEwMDAxLCAtMTIyLjMwNTU1NjU2ODk5OTk5XSwgWzM3Ljg1NjE4NTk1MzAwMDEsIC0xMjIuMjU5NjczODk4OTk5OTldLCBbMzcuODY1ODcwMjQ2LCAtMTIyLjI1MTYwNTQyN10sIFszNy44NzA0MTA1NjMwMDAxLCAtMTIyLjI4MTkzNzk4NF0sIFszNy44NzAxMzM3OTEwMDAxLCAtMTIyLjI4MTUzMTM3NF0sIFszNy44NzIxNDk3ODIwMDAxLCAtMTIyLjI4MjEzMjIzODk5OTk5XSwgWzM3Ljg2MjQ0NjE4Njk5OTk5NiwgLTEyMi4yNzE5OTg4OTM5OTk5OV0sIFszNy44NzA1NDgyODYsIC0xMjIuMzE0NjM3NDk2XSwgWzM3Ljg2MzA2NjY0NjAwMDEsIC0xMjIuMjY3MjU2NzFdLCBbMzcuODY2ODIwNDIwNzk2NzEsIC0xMjIuMzAzNzE5ODA3OTAzMDFdLCBbMzcuODc0MjcwMDM0MDAwMSwgLTEyMi4yNjUzNzY5NDZdLCBbMzcuODY4NDk0MTQzMDAwMSwgLTEyMi4yNzQ5NTUxNThdLCBbMzcuODY1Mjc3MzMyMDAwMTA1LCAtMTIyLjI2NDM1MDQ1XSwgWzM3Ljg2NTcwMzg1NTk5OTk5NiwgLTEyMi4yOTQ2MzQzNjIwMDAwMV0sIFszNy44Njg0MTM5NTkwMDAxLCAtMTIyLjMwMjU0MTA5N10sIFszNy44NjgxMzAwNzgsIC0xMjIuMzAzNTAyNjQ2XSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODcxNDY0MjA2OTk5OTk1LCAtMTIyLjI2NTk3MzcyOV0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg2NTEyOTczLCAtMTIyLjI1ODQxMTc4OV0sIFszNy44Njg2OTg0NDMsIC0xMjIuMjU5MTUxMjYyXSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODc1MzA0MzMzLCAtMTIyLjI5MzE2Njc4N10sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NjAzMzczNjAwMDAxLCAtMTIyLjI2NzA1MTM4NV0sIFszNy44NTUzMDA1NTQwMDAxLCAtMTIyLjI2NjQ5MzE4M10sIFszNy44NzYyMTIxMDMwMDAxLCAtMTIyLjI4NjY0MTE3OV0sIFszNy44NzIyNTE2OTEsIC0xMjIuMjcwMTMxMTc1XSwgWzM3Ljg2NDAwMjUyNywgLTEyMi4yODEyODY4ODI5OTk5OV0sIFszNy44NzQzMDg2MTgsIC0xMjIuMjgyOTY0MjNdLCBbMzcuODcwMTEyNjU3MDAwMTEsIC0xMjIuMjg0MjQ4OTMzOTk5OTldLCBbMzcuODY0ODc2MjYwMDAwMSwgLTEyMi4yNjc0NzQ3OTFdLCBbMzcuODY1NzIwNzcxLCAtMTIyLjI1MzkwMjUyMV0sIFszNy44NzExNzAxMTcwMDAxMDUsIC0xMjIuMjY4Mjc5NjQ1XSwgWzM3Ljg1NTMwMDU1NDAwMDEsIC0xMjIuMjY2NDkzMTgzXSwgWzM3Ljg3NTU0MTM0MzAwMDEsIC0xMjIuMzA0ODI0NjY1XSwgWzM3Ljg2ODg2NzIwNDAwMDAwNCwgLTEyMi4yOTMyOTcxNzc5OTk5OV0sIFszNy44NTY0OTEzMjMwMDAxLCAtMTIyLjI2ODQ2MzMwOF0sIFszNy44NjgyMTE3OTgwMDAxMDQsIC0xMjIuMjU4MDMzODAxMDAwMDFdLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NzAzNjY1MTgwMDAwMDQsIC0xMjIuMzE4NDE2MzQzXSwgWzM3Ljg2MjExMDcyMjAwMDEwNCwgLTEyMi4yNTM1Mzk5OTVdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODY4ODc2MjA0MDAwMSwgLTEyMi4zMDAyODQ1MDVdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODU0MzE2Mzg1MDAwMTA0LCAtMTIyLjI3MTA4NDE1NF0sIFszNy44NTYyNzA5MjYsIC0xMjIuMjcwMjAwNjM1XSwgWzM3Ljg2ODA0ODkxNjAwMDEsIC0xMjIuMjU5MzA5MDYyMDAwMDFdLCBbMzcuODYwMTk2NDIwMDAwMSwgLTEyMi4yOTQwNTQxOTFdLCBbMzcuODcwNTgyNDYsIC0xMjIuMjcyODkzMTkzOTk5OTldLCBbMzcuODgxODAyNTM2MDAwMSwgLTEyMi4yOTg2Njc5NDc5OTk5OV0sIFszNy44NjgxMDg0ODgwMDAxMDQsIC0xMjIuMjU2NzEzNTczXSwgWzM3Ljg1MzAwODcwODAwMDEwNCwgLTEyMi4yODY5NTAyMTg5OTk5OV0sIFszNy44NTMwODI1NTQwMTAyOSwgLTEyMi4yOTY4Mzc3NjAxNDZdLCBbMzcuODUwNTMyMzY1LCAtMTIyLjI4NjE1MTA0OV0sIFszNy44NjMwNDg3MDcwMDAxMDQsIC0xMjIuMjk4NDAzODA0XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODU5OTc4NDU2MDAwMSwgLTEyMi4yNTEyMzI0NTIwMDAwMV0sIFszNy44NjA2NTQzMzEsIC0xMjIuMjUzMzk0NzA3OTk5OTldLCBbMzcuODYwNjU0MzMxLCAtMTIyLjI1MzM5NDcwNzk5OTk5XSwgWzM3Ljg2MjExMDcyMjAwMDEwNCwgLTEyMi4yNTM1Mzk5OTVdLCBbMzcuODYzOTE4MTQ0LCAtMTIyLjI1MzcyMTMxNV0sIFszNy44NTk5ODEwMDgwMDAwMDUsIC0xMjIuMjUzMzI2ODI3MDAwMDFdLCBbMzcuODYwNjU0MzMxLCAtMTIyLjI1MzM5NDcwNzk5OTk5XSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg4MDIyMjIxMiwgLTEyMi4yNjkzMjcxNzldLCBbMzcuODU0MzE2Mzg1MDAwMTA0LCAtMTIyLjI3MTA4NDE1NF0sIFszNy44NTc2NDQwMDcsIC0xMjIuMjg4NDQwNzEzOTk5OTldLCBbMzcuODY2OTA3OTk2MDAwMSwgLTEyMi4yNTg3OTg2OTddLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44Njg0MTM5NTkwMDAxLCAtMTIyLjMwMjU0MTA5N10sIFszNy44Njk5ODEwODkwMDAxLCAtMTIyLjI3MDU0ODYwMV0sIFszNy44NzMzMDA2NjMwMDAxLCAtMTIyLjI3MzE5NTUxOF0sIFszNy44NjY0Njg1NzkwMDAxLCAtMTIyLjI5ODM5NjYzMV0sIFszNy44NTQ5MTE5MTEsIC0xMjIuMjc5MzgxNTE1XSwgWzM3Ljg2ODMwNTc5MzAwMDAwNSwgLTEyMi4yNjY1MTIwOTM5OTk5OV0sIFszNy44NjE5NjYzOTgwMDAxLCAtMTIyLjMwMTE0NjYwN10sIFszNy44NjM5NzE0ODgwMDAxMDQsIC0xMjIuMjY3MzYzMTVdLCBbMzcuODQ5NzYxMjgzMDAwMSwgLTEyMi4yOTIyNDk5ODFdLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NTE1MTQ4NzIwMDAxLCAtMTIyLjI5MTI3MDQwNzAwMDAxXSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODUzNDgzMTE1MDAwMSwgLTEyMi4yOTE4OTI5OTJdLCBbMzcuODcwNDEwNTYzMDAwMSwgLTEyMi4yODE5Mzc5ODRdLCBbMzcuODQ5Njk3NDQ4LCAtMTIyLjI3MTA1MTg0NzAwMDAxXSwgWzM3Ljg1NTE4OTUzNTAwMDEsIC0xMjIuMjU5ODEzMDk3XSwgWzM3Ljg1MTAwODU1MDAwMDEsIC0xMjIuMjkxMTA0MDM0XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODUxNTE0ODcyMDAwMSwgLTEyMi4yOTEyNzA0MDcwMDAwMV0sIFszNy44NDk3NjEyODMwMDAxLCAtMTIyLjI5MjI0OTk4MV0sIFszNy44NDk3NjEyODMwMDAxLCAtMTIyLjI5MjI0OTk4MV0sIFszNy44NzQzNjY2MzYsIC0xMjIuMzA0NDQ5NTUyMDAwMDFdLCBbMzcuODQ3MTU3NTk4LCAtMTIyLjMwMDIxMTY0XSwgWzM3Ljg3NDE0ODg3MywgLTEyMi4zMDU1NzczODc5OTk5OV0sIFszNy44Njk0MzY4MDEwMDAxLCAtMTIyLjI4OTUyMDI1Ml0sIFszNy44NTcyMjU5NDgwMDAxLCAtMTIyLjI5MTkxNzU2NV0sIFszNy44NzgwOTM0NDgwMDAxLCAtMTIyLjI4NTIwMTU4XSwgWzM3Ljg0NzU1MTk3MzAwMDEsIC0xMjIuMjczMzk5NDE2XSwgWzM3Ljg2MTcyMzMwMSwgLTEyMi4yNTQ3OTU0MTc5OTk5OV0sIFszNy44NjcyNjMyNDMwMDAwMDQsIC0xMjIuMjkxNTIyNTAwMDAwMDFdLCBbMzcuODU0NDUzNjQ0LCAtMTIyLjI2OTk5MDk4OV0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2NzgwOTA0NDAwMDEwNCwgLTEyMi4yNTg5NzU5ODYwMDAwMV0sIFszNy44Njc5OTM5MDMwMDAxMDUsIC0xMjIuMjk3NjY0Mzk4XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODUyNzUxMjk3MDAwMTA0LCAtMTIyLjI4MzcyMDU4XSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODY3ODY2NzUxMDAwMSwgLTEyMi4yOTg4NDc1MjldLCBbMzcuODUyNTkwNzkwMDAwMSwgLTEyMi4yODk2OTU5Mjc5OTk5OV0sIFszNy44NjQ0NzM0ODYwMDAxLCAtMTIyLjI1ODIxNDY2XSwgWzM3Ljg1MjIyNjMxMiwgLTEyMi4yOTE0OTU0NDI5OTk5OV0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MjE0OTM2NiwgLTEyMi4yODU0MzA1ODhdLCBbMzcuODUyMTU0NDY4LCAtMTIyLjI4NjY3Njc2Mzk5OTk5XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODY3OTk1MDIwMDAwMSwgLTEyMi4yOTc2NjQ3NTVdLCBbMzcuODkzMjI3MTI4LCAtMTIyLjI3NzI2MTEzODk5OTk5XSwgWzM3Ljg1OTc2MTIwODAwMDEsIC0xMjIuMjU3MDI1MjA4OTk5OTldLCBbMzcuODcyNDQ3NDY5MDAwMSwgLTEyMi4yNzMwNzk4MzVdLCBbMzcuODcwMzAzNzM0MDAwMSwgLTEyMi4yNjgwMzU1MDNdLCBbMzcuODYxOTE5NjkxLCAtMTIyLjI3NjMyNTc1NV0sIFszNy44NzIzNDc3MDMwMDAxLCAtMTIyLjI2Njg2NDUwNl0sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg0ODQ1MTA4NjAwMDEsIC0xMjIuMjczNjEzMTddLCBbMzcuODUyNjU1OTU2OTk5OTk2LCAtMTIyLjI3Njc0ODMxNzAwMDAxXSwgWzM3Ljg1NjYzNDE5MzAwMDAwNSwgLTEyMi4yOTA1NDg3MTI5OTk5OV0sIFszNy44Njc5OTM5MDMwMDAxMDUsIC0xMjIuMjk3NjY0Mzk4XSwgWzM3Ljg1MjMyMjI3OTAwMDEsIC0xMjIuMjcxMTQ1MTk1XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjIxOTU5OTUsIC0xMjIuMjgxMDkyNzg4XSwgWzM3Ljg2MjE5NTk5NSwgLTEyMi4yODEwOTI3ODhdLCBbMzcuODQ5MDcwMDcyMDAwMSwgLTEyMi4yNzYwMTQ2ODRdLCBbMzcuODY5NTQwNzMyNDQ4OCwgLTEyMi4yODk1MTM2MzM1MjVdLCBbMzcuODgwMjUyNjI4MDAwMSwgLTEyMi4yOTY5NTY1MzFdLCBbMzcuODcxNjYyNjQxMDAwMSwgLTEyMi4yNjk0NDM5MDRdLCBbMzcuODY0MDAyNTI3LCAtMTIyLjI4MTI4Njg4Mjk5OTk5XSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg3ODkyNTk4NjAwMDEsIC0xMjIuMzAzNTI3Nzc1XSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg0Nzg5NDE2MTk5OTk5NiwgLTEyMi4yNzc3NjcwMTEwMDAwMV0sIFszNy44NjA5MTk3MTcwMDAxLCAtMTIyLjI2OTUyMzM1NjAwMDAxXSwgWzM3Ljg0ODE0NDkxOSwgLTEyMi4yNzU4NDM1ODFdLCBbMzcuODgwMzgzNzk1MDAwMSwgLTEyMi4yODU1OTYzMjldLCBbMzcuODc3MjMxNjQ0MDAwMSwgLTEyMi4yNzgyODY1MjVdLCBbMzcuODcyOTY0NTk0MDAwMSwgLTEyMi4zMDUyNDUzNTVdLCBbMzcuODczNjUxNDk1LCAtMTIyLjMwMTgxNTkzMjAwMDAxXSwgWzM3Ljg2NTg3MDI0NiwgLTEyMi4yNTE2MDU0MjddLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg2OTA4ODU1NjAwMDEsIC0xMjIuMjk5MjM4MDIyMDAwMDFdLCBbMzcuODY3ODY2NzUxMDAwMSwgLTEyMi4yOTg4NDc1MjldLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODczMDI1OTI2LCAtMTIyLjI2ODQ4NTIwODk5OTk5XSwgWzM3Ljg1MTYzMjUxMSwgLTEyMi4yODk0MDA4NzldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NjYxNDYyNDgwMDAxLCAtMTIyLjI0Njk3Mjc3Ml0sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg2ODg2NzIwNDAwMDAwNCwgLTEyMi4yOTMyOTcxNzc5OTk5OV0sIFszNy44NjU4MDk2NTIwMDAxLCAtMTIyLjMwMTcwODYxN10sIFszNy44NjUzNzk5MjYwMDAxLCAtMTIyLjI1NjUwNTE2NV0sIFszNy44NjQ4MjM0MDYsIC0xMjIuMjk4OTcxNzQzXSwgWzM3Ljg3MDk3NDYwNjAwMDEsIC0xMjIuMjc3NTAyNDE4XSwgWzM3Ljg3Mjk2NDU5NDAwMDEsIC0xMjIuMzA1MjQ1MzU1XSwgWzM3Ljg3NjM4Mjk0LCAtMTIyLjI5NDQ4MzgzXSwgWzM3Ljg3MzY1MTQ5NSwgLTEyMi4zMDE4MTU5MzIwMDAwMV0sIFszNy44NjU3MjE2ODIwMDAxLCAtMTIyLjI2MDg5Nzk1NzAwMDAxXSwgWzM3Ljg3NTQ3NjE2Njk5OTk5NSwgLTEyMi4yOTg5NzE5NV0sIFszNy44NjAwNzMyMzcwMDAxLCAtMTIyLjI2MjA3MzQ4NF0sIFszNy44Njk0MzY4MDEwMDAxLCAtMTIyLjI4OTUyMDI1Ml0sIFszNy44NjgyMDIwMTAwMDAxLCAtMTIyLjI5NjYyNDc1Mzk5OTk5XSwgWzM3Ljg2ODQyMzUxMywgLTEyMi4yOTU1MTYxNDldLCBbMzcuODQ3NDcxODY0MDg4Nzk2LCAtMTIyLjI5ODA3NjgzNTQ2OTk4XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2Nzk5NTAyMDAwMDEsIC0xMjIuMjk3NjY0NzU1XSwgWzM3Ljg2ODAxNzI4NDAwMDEsIC0xMjIuMzAzNzc2NDIyMDAwMDFdLCBbMzcuODY2NDQ0MTExMDAwMSwgLTEyMi4zMDU1NTY1Njg5OTk5OV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NjgwMTcyODQwMDAxLCAtMTIyLjMwMzc3NjQyMjAwMDAxXSwgWzM3Ljg1OTI5MTM1NSwgLTEyMi4yODI2NzkwOTYwMDAwMV0sIFszNy44NTkxMDQ3OTYwMDAwOTYsIC0xMjIuMjg2MjM5ODE2XSwgWzM3Ljg3MjMzMTgsIC0xMjIuMjk5MDYwMjg1XSwgWzM3Ljg3MDQxNTM1NCwgLTEyMi4yOTI1NTE1MTI5OTk5OV0sIFszNy44NTI3NTEyOTcwMDAxMDQsIC0xMjIuMjgzNzIwNThdLCBbMzcuODUxNjMyNTExLCAtMTIyLjI4OTQwMDg3OV0sIFszNy44NjU4MDk2NTIwMDAxLCAtMTIyLjMwMTcwODYxN10sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg1NzY2MTI2ODAwMDEsIC0xMjIuMjU5NDY5ODUxXSwgWzM3Ljg3ODc0MDUwNTAwMDEsIC0xMjIuMjk1MjQyNjI2XSwgWzM3Ljg3ODc0MDUwNTAwMDEsIC0xMjIuMjk1MjQyNjI2XSwgWzM3Ljg3NjY0NTM2OCwgLTEyMi4yOTkzNDg1ODNdLCBbMzcuODc5NTgwMTI0LCAtMTIyLjMwMDI2MTg4Mjk5OTk5XSwgWzM3Ljg3NTU0MTM0MzAwMDEsIC0xMjIuMzA0ODI0NjY1XSwgWzM3Ljg0ODQ1MTA4NjAwMDEsIC0xMjIuMjczNjEzMTddLCBbMzcuODU3NjkzMTE1MDAwMSwgLTEyMi4yODEwMzg4OTEwMDAwMV0sIFszNy44NjQyNjQxMjgwMDAxLCAtMTIyLjI3MjIxMDM2NzAwMDAxXSwgWzM3Ljg2ODQxMzk1OTAwMDEsIC0xMjIuMzAyNTQxMDk3XSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg3NjY4OTk5NywgLTEyMi4yODI2NDY3NzJdLCBbMzcuODY3ODA5MDQ0MDAwMTA0LCAtMTIyLjI1ODk3NTk4NjAwMDAxXSwgWzM3Ljg3MjM4OTUxMTAwMDEsIC0xMjIuMjY4NzI3NzI1XSwgWzM3Ljg2NTcyMTY4MjAwMDEsIC0xMjIuMjYwODk3OTU3MDAwMDFdLCBbMzcuODY2MzYyMzg1MDAwMSwgLTEyMi4yNzAxMjQ0MDg5OTk5OV0sIFszNy44NzIzMjk2MzIwMDAxLCAtMTIyLjI2OTMxMzI0M10sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XSwgWzM3Ljg1OTM0MjUxMjAwMDEwNCwgLTEyMi4yNjc0ODYxMTEwMDAwMV0sIFszNy44NTg0NjIyMTUsIC0xMjIuMjUzMTc2NjAxXSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg2MzkxODE0NCwgLTEyMi4yNTM3MjEzMTVdLCBbMzcuODY3MjAwOTk3MDAwMTA0LCAtMTIyLjMwMjE1MTA1Mjk5OTk5XSwgWzM3Ljg2NzI2ODQ2Njk5OTk5NSwgLTEyMi4yNzAyMzk1OTc5OTk5OV0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODcwNjUzNDE5MDAwMSwgLTEyMi4yODMzNjAxMzZdLCBbMzcuODQ0MzM2NjA1MDAwMSwgLTEyMi4yNzUxNzAwMDRdLCBbMzcuODY1OTI3MzI3MDAwMSwgLTEyMi4yOTM1MzEwMTI5OTk5OV0sIFszNy44NzAyMjM5ODI3ODQ3OSwgLTEyMi4yNzMxNzE2OTE2NjJdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY5MzAyODUzMDAwMSwgLTEyMi4yNzIyMzQwMjFdLCBbMzcuODY4OTQ3ODUyMDAwMTA1LCAtMTIyLjI2NzUwODA4M10sIFszNy44Njk4NDYyNzMwMDAxLCAtMTIyLjI2NjQyNzY0NV0sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NDc1NTE5NzMwMDAxLCAtMTIyLjI3MzM5OTQxNl0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44Nzg0NjgwNzcsIC0xMjIuMzA1NzY1NzEyMDAwMDFdLCBbMzcuODc1NTQxMzQzMDAwMSwgLTEyMi4zMDQ4MjQ2NjVdLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44Njc2NDk0MDIsIC0xMjIuMjk4Nzc3NzQ3XSwgWzM3Ljg3ODkwNTQ2NiwgLTEyMi4yODI5OTgwNDI5OTk5OV0sIFszNy44NjQyNTk5MjE5OTk5OTUsIC0xMjIuMzEzMzYwODA4XSwgWzM3Ljg2NzgwOTA0NDAwMDEwNCwgLTEyMi4yNTg5NzU5ODYwMDAwMV0sIFszNy44Njg3NzQ0ODIsIC0xMjIuMjcyNzA0NDVdLCBbMzcuODcwMjg3MDEyMDAwMTA1LCAtMTIyLjI3NTE0MzU5M10sIFszNy44NjExOTU0NTQwMDAwMDQsIC0xMjIuMjU5MzQwNjYxMDAwMDFdLCBbMzcuODcwNjg0MzI1MDAwMSwgLTEyMi4yNzk3Njg1MjM5OTk5OV0sIFszNy44NTE5NDExMDIwMDAxMDQsIC0xMjIuMjcwMDg1OTddLCBbMzcuODcyNzUwMTIyMDAwMTA2LCAtMTIyLjI4NDYyMDc3NV0sIFszNy44NjgyMDIwMTAwMDAxLCAtMTIyLjI5NjYyNDc1Mzk5OTk5XSwgWzM3Ljg1MzA4MjU1NDAxMDI5LCAtMTIyLjI5NjgzNzc2MDE0Nl0sIFszNy44NjU5NTc5ODc4NzA2LCAtMTIyLjI2NTU3MzI1MzU2XSwgWzM3Ljg2MzI1ODM4ODAwMDEwNSwgLTEyMi4yNTg2OTQ4NThdLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44Njg0Nzc3NTQwMDAwMDQsIC0xMjIuMjkzNTU4OTc1XSwgWzM3Ljg2Mjg1NDgzMywgLTEyMi4yOTAxMDYzODcwMDAwMV0sIFszNy44NjU3Nzk4LCAtMTIyLjI2NzU3NjAwNV0sIFszNy44NjAzMzczNjAwMDAxLCAtMTIyLjI2NzA1MTM4NV0sIFszNy44NTc2Mjk5OTUsIC0xMjIuMjY2ODAzMjhdLCBbMzcuODYwMzM3MzYwMDAwMSwgLTEyMi4yNjcwNTEzODVdLCBbMzcuODU4NTMyMTk5LCAtMTIyLjI2NjkwMjcxNV0sIFszNy44NTg1MzIxOTksIC0xMjIuMjY2OTAyNzE1XSwgWzM3Ljg1OTM0MjUxMjAwMDEwNCwgLTEyMi4yNjc0ODYxMTEwMDAwMV0sIFszNy44NTg1MzIxOTksIC0xMjIuMjY2OTAyNzE1XSwgWzM3Ljg2MDMzNzM2MDAwMDEsIC0xMjIuMjY3MDUxMzg1XSwgWzM3Ljg1NjcyNTI4MDk5OTk5NiwgLTEyMi4yNjY2ODgxOThdLCBbMzcuODU3NDYzNzUyMDAwMSwgLTEyMi4yNjgwOTE1NDg5OTk5OV0sIFszNy44NTY3MjUyODA5OTk5OTYsIC0xMjIuMjY2Njg4MTk4XSwgWzM3Ljg0OTQxMzU0OTAwMDEwNCwgLTEyMi4yOTg0NzIyMzg5OTk5OV0sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg1NjU1NjQxNiwgLTEyMi4yNTY3OTM0MDI5OTk5OV0sIFszNy44NzA4NDA2NzQwMDAxLCAtMTIyLjI3ODU1MjU3M10sIFszNy44NzU1NDEzNDMwMDAxLCAtMTIyLjMwNDgyNDY2NV0sIFszNy44NTgwNjUzNjUwMDAxLCAtMTIyLjI0NTI5NjA0M10sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODU2NzI1NTQ1MDAwMSwgLTEyMi4yNTU0ODc4ODIwMDAwMV0sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODU3MDQ0ODEsIC0xMjIuMjUzMDQyNjUyXSwgWzM3Ljg0OTUwMzYxNTAwMDEsIC0xMjIuMjY1NzM2NTQ1XSwgWzM3Ljg1MjIzMDA5OTM2MDIwNiwgLTEyMi4yODU4ODE3NzIyNzddLCBbMzcuODUzOTM1MDY4MDAwMTA1LCAtMTIyLjI4OTY2OTQ1OV0sIFszNy44NTAwNTg5MDksIC0xMjIuMjkwNzgzMjA3XSwgWzM3Ljg1MTUxNDg3MjAwMDEsIC0xMjIuMjkxMjcwNDA3MDAwMDFdLCBbMzcuODgwMTc0NDk1MTc3MywgLTEyMi4zMDY0MjMwNDAzMTRdLCBbMzcuODczNDQyNTU5MDAwMTA0LCAtMTIyLjI5MzUzMDgxNF0sIFszNy44NjYwMTQ1ODIsIC0xMjIuMjU4NjE2NDAyOTk5OTldLCBbMzcuODQ3MjE5NTc4MDAwMSwgLTEyMi4yODExNDE5MTNdLCBbMzcuODUwOTg3ODM4LCAtMTIyLjI1NDQ5MzE5NV0sIFszNy44NTA5ODc4MzgsIC0xMjIuMjU0NDkzMTk1XSwgWzM3Ljg2MTA5NDM5Njk5OTk5NSwgLTEyMi4yODk1NDU5NTEwMDAwMV0sIFszNy44NTExMzEzMjkwMDAxMDQsIC0xMjIuMjUzNDAwNTA5XSwgWzM3Ljg2MTM0MzQ2NDAwMDEsIC0xMjIuMjgwNzUxODVdLCBbMzcuODU5NzY1NzUyLCAtMTIyLjI3MTY5NTgxNV0sIFszNy44NzQ4MTkzMTMsIC0xMjIuMzAyMTkyNTY4XSwgWzM3Ljg3NTMyMjIwNCwgLTEyMi4zMDU5MDc0MjJdLCBbMzcuODcyMzg5NTExMDAwMSwgLTEyMi4yNjg3Mjc3MjVdLCBbMzcuODY3MjY4NDY2OTk5OTk1LCAtMTIyLjI3MDIzOTU5Nzk5OTk5XSwgWzM3Ljg4ODMxNTM2ODAwMDEsIC0xMjIuMjUxNDg3ODcyMDAwMDFdLCBbMzcuODcwNDEwNTYzMDAwMSwgLTEyMi4yODE5Mzc5ODRdLCBbMzcuODQ3ODk0MTYxOTk5OTk2LCAtMTIyLjI3Nzc2NzAxMTAwMDAxXSwgWzM3Ljg0Nzg5NDE2MTk5OTk5NiwgLTEyMi4yNzc3NjcwMTEwMDAwMV0sIFszNy44NTcwNDQ4MSwgLTEyMi4yNTMwNDI2NTJdLCBbMzcuODY3ODM0Njc2LCAtMTIyLjI2NTk1MTQxNzk5OTk5XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44Njc2NjIxODQwMDAwMDQsIC0xMjIuMjk5ODkxNzMyXSwgWzM3Ljg2NzgwOTA0NDAwMDEwNCwgLTEyMi4yNTg5NzU5ODYwMDAwMV0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg3MjMyOTYzMjAwMDEsIC0xMjIuMjY5MzEzMjQzXSwgWzM3Ljg2ODAyNDA2NzAwMDEsIC0xMjIuMjU5NTczNTk3MDAwMDFdLCBbMzcuODYyNDQ2MTg2OTk5OTk2LCAtMTIyLjI3MTk5ODg5Mzk5OTk5XSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODU3ODE1OTEyLCAtMTIyLjI3OTk3NjAyMjAwMDAxXSwgWzM3Ljg3MDIyMzk4Mjc4NDc5LCAtMTIyLjI3MzE3MTY5MTY2Ml0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44NTI3NTEyOTcwMDAxMDQsIC0xMjIuMjgzNzIwNThdLCBbMzcuODUwNDM2NzA5MDAwMSwgLTEyMi4yOTE4MTYyNTVdLCBbMzcuODczMTg5MTM2MDAwMSwgLTEyMi4zMDQwNzc4NjVdLCBbMzcuODU2NzI1MjgwOTk5OTk2LCAtMTIyLjI2NjY4ODE5OF0sIFszNy44NjkzOTE5NywgLTEyMi4yNjc5MzIzNDNdLCBbMzcuODQ2NzgzMDg1LCAtMTIyLjI5MTQ4Nzc4OV0sIFszNy44NTUzMDM2ODksIC0xMjIuMjkyNDcyMjAxMDAwMDFdLCBbMzcuODY4Nzc0NDgyLCAtMTIyLjI3MjcwNDQ1XSwgWzM3Ljg1ODQyOTE5LCAtMTIyLjI5MzQ5MDA1NjAwMDAxXSwgWzM3Ljg2ODQyMzUxMywgLTEyMi4yOTU1MTYxNDldLCBbMzcuODUzODE1MzQ1LCAtMTIyLjI2NjMwMTkyNl0sIFszNy44Njg4NjcyMDQwMDAwMDQsIC0xMjIuMjkzMjk3MTc3OTk5OTldLCBbMzcuODY4ODY3MjA0MDAwMDA0LCAtMTIyLjI5MzI5NzE3Nzk5OTk5XSwgWzM3Ljg2OTUzMDQ3NSwgLTEyMi4yOTcwNTAyMTI5OTk5OV0sIFszNy44NjY3MDk5MjUwMDAxLCAtMTIyLjI5NzI0ODY4XSwgWzM3Ljg1NjcyNTI4MDk5OTk5NiwgLTEyMi4yNjY2ODgxOThdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NjEyNTAwMzUwMDAxLCAtMTIyLjI2NzA0NzEyODk5OTk5XSwgWzM3Ljg3Mzg5MDQyMDAwMDEsIC0xMjIuMjY4NTgwMTM3OTk5OTldLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44NTE2MzI1MTEsIC0xMjIuMjg5NDAwODc5XSwgWzM3Ljg1MDA1ODkwOSwgLTEyMi4yOTA3ODMyMDddLCBbMzcuODUzOTA0MTczMDAwMDA0LCAtMTIyLjI1OTk4ODcyNV0sIFszNy44NDk4MzE4NjMwMDAxMDUsIC0xMjIuMjkwNTIxMjQyMDAwMDFdLCBbMzcuODY4NDg5MjU0MDAwMSwgLTEyMi4yNjc4Njc1Ml0sIFszNy44NjQ4Njg0ODMwMDAxLCAtMTIyLjI3NDU4MjU2OV0sIFszNy44NDg3NDk5NDAwMDAxLCAtMTIyLjI3MTM5NjI1NV0sIFszNy44NTk3NjU3NTIsIC0xMjIuMjcxNjk1ODE1XSwgWzM3Ljg2NTE3MTE1NSwgLTEyMi4yNzIzMDgyNDcwMDAwMV0sIFszNy44NDk2OTA1NTgwMDAxMDYsIC0xMjIuMjc4MTc3MjQzOTk5OTldLCBbMzcuODU5ODY2NjMwMDY2NzA1LCAtMTIyLjI1MjM4Mzk2Mjg0OTAxXSwgWzM3Ljg1NzI2MDUzNjAwMDEsIC0xMjIuMjg3OTM5MjkyXSwgWzM3Ljg1ODQ2MjIxNSwgLTEyMi4yNTMxNzY2MDFdLCBbMzcuODcwNDgxNjEwMDAwMSwgLTEyMi4zMDA1MDIwNjZdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODY3NTkzODQzMDAwMSwgLTEyMi4yNjc3NzM0MjhdLCBbMzcuODc5MjgzNzM5MDAwMSwgLTEyMi4yNjg4MjI4ODcwMDAwMV0sIFszNy44NzM2NTE0OTUsIC0xMjIuMzAxODE1OTMyMDAwMDFdLCBbMzcuODkyODgzMTE3MDAwMSwgLTEyMi4yNjc4MjE2NzVdLCBbMzcuODY5MjkzNDg2MDAwMDk2LCAtMTIyLjI1NDYwNTQ4Mjk5OTk5XSwgWzM3Ljg3MzE4OTEzNjAwMDEsIC0xMjIuMzA0MDc3ODY1XSwgWzM3Ljg3MzE4OTEzNjAwMDEsIC0xMjIuMzA0MDc3ODY1XSwgWzM3Ljg2NjEzOTQyNSwgLTEyMi4yOTg5MzE4OTM5OTk5OV0sIFszNy44NDkwNzQ0MjIwMDAxLCAtMTIyLjI4NTY3MDQ4N10sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NjkwOTY1OTYwMDAxLCAtMTIyLjI5MjExOTQzM10sIFszNy44NzIxNDk3ODIwMDAxLCAtMTIyLjI4MjEzMjIzODk5OTk5XSwgWzM3Ljg0OTA3MDA3MjAwMDEsIC0xMjIuMjc2MDE0Njg0XSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjE1MzAzMTYsIC0xMjIuMjcxODk1NTkyXSwgWzM3Ljg2NjQ0NDExMTAwMDEsIC0xMjIuMzA1NTU2NTY4OTk5OTldLCBbMzcuODY2OTcxNDYxLCAtMTIyLjI3MjUwNTQ0Mzk5OTk5XSwgWzM3Ljg1OTAwNjY3NDAwMDEsIC0xMjIuMjg0OTMxMTA2XSwgWzM3Ljg2NjEwMzYxODg3NTEsIC0xMjIuMzA1Njg4MTM1MDMwOTldLCBbMzcuODU4ODc3MDcyLCAtMTIyLjI5MTI2NDU0XSwgWzM3Ljg2MzUxMDUxLCAtMTIyLjI5NjIxNjYzMzk5OTk5XSwgWzM3Ljg2ODAxNzI4NDAwMDEsIC0xMjIuMzAzNzc2NDIyMDAwMDFdLCBbMzcuODU4NTE4MDQsIC0xMjIuMjg4NzIxNjA1XSwgWzM3Ljg2ODQ4OTI1NDAwMDEsIC0xMjIuMjY3ODY3NTJdLCBbMzcuODY2NDY4NTc5MDAwMSwgLTEyMi4yOTgzOTY2MzFdLCBbMzcuODYzMDY2NjQ2MDAwMSwgLTEyMi4yNjcyNTY3MV0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44Njk2OTYwOTMwMDAxLCAtMTIyLjI4NzQ5OTQ3Nzk5OTk5XSwgWzM3Ljg2NzUwNTc5NDAwMDEsIC0xMjIuMjU0MjUxMzc1XSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg1NDkxMTkxMSwgLTEyMi4yNzkzODE1MTVdLCBbMzcuODQ4NDUxMDg2MDAwMSwgLTEyMi4yNzM2MTMxN10sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2OTQzNjgwMTAwMDEsIC0xMjIuMjg5NTIwMjUyXSwgWzM3Ljg3MDU4NDUyMzAwMDAwNSwgLTEyMi4yNjU4ODM0ODZdLCBbMzcuODcwMzY2NTE4MDAwMDA0LCAtMTIyLjMxODQxNjM0M10sIFszNy44NjMxODg5NTIsIC0xMjIuMzEzNjk2ODQ3XSwgWzM3Ljg2MTM0MzQ2NDAwMDEsIC0xMjIuMjgwNzUxODVdLCBbMzcuODU5ODc3NjEzLCAtMTIyLjI4NTA5OTMwOV0sIFszNy44NjMxODg5NTIsIC0xMjIuMzEzNjk2ODQ3XSwgWzM3Ljg3MDQxMDU2MzAwMDEsIC0xMjIuMjgxOTM3OTg0XSwgWzM3Ljg3MDY4NDMyNTAwMDEsIC0xMjIuMjc5NzY4NTIzOTk5OTldLCBbMzcuODgwNDc0MTk1LCAtMTIyLjI5NTc5OTIxNV0sIFszNy44NzUzMjIyMDQsIC0xMjIuMzA1OTA3NDIyXSwgWzM3Ljg2MTk2NjM5ODAwMDEsIC0xMjIuMzAxMTQ2NjA3XSwgWzM3Ljg2NjAyNTQwNzAwMDEsIC0xMjIuMzE3NDk1NDIxXSwgWzM3Ljg2MzA0ODcwNzAwMDEwNCwgLTEyMi4yOTg0MDM4MDRdLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODY3MjE1NTczMDAwMSwgLTEyMi4zMDUxNTg1NzYwMDAwMV0sIFszNy44ODEwMzY0OCwgLTEyMi4zMDM0MTU0NjZdLCBbMzcuODQ4NTg0NzI1MDAwMSwgLTEyMi4yNzI2MjU2NTJdLCBbMzcuODQ2NjY4OTY5MDAwMSwgLTEyMi4yNzI0NjI1NjFdLCBbMzcuODY3MjYzMjQzMDAwMDA0LCAtMTIyLjI5MTUyMjUwMDAwMDAxXSwgWzM3Ljg2OTQ1MzE0NzAwMDEsIC0xMjIuMjcwOTQ5MzE1XSwgWzM3Ljg0Njk0MzU0LCAtMTIyLjI4NDk5MDc2MV0sIFszNy44NjgzNDg4MSwgLTEyMi4yNzYwNzk1MDhdLCBbMzcuODYzMjc1MzUyMDAwMSwgLTEyMi4yOTczNjQ2OTVdLCBbMzcuODY1MjYxMjAxMDAwMSwgLTEyMi4yOTY3ODM5MzldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODYxNTEzNjQ4LCAtMTIyLjI5Njc5ODg1MV0sIFszNy44NzcyMzE2NDQwMDAxLCAtMTIyLjI3ODI4NjUyNV0sIFszNy44NjU4MDk2NTIwMDAxLCAtMTIyLjMwMTcwODYxN10sIFszNy44NzE1NTUyNTQsIC0xMjIuMjczMDAxMzQyXSwgWzM3Ljg2NTcyMDc3MSwgLTEyMi4yNTM5MDI1MjFdLCBbMzcuODYxOTY2Mzk4MDAwMSwgLTEyMi4zMDExNDY2MDddLCBbMzcuODY5Njk2MDkzMDAwMSwgLTEyMi4yODc0OTk0Nzc5OTk5OV0sIFszNy44NjUzNzk5MjYwMDAxLCAtMTIyLjI1NjUwNTE2NV0sIFszNy44Njg0MjM1MTMsIC0xMjIuMjk1NTE2MTQ5XSwgWzM3Ljg2NzU5Mzg0MzAwMDEsIC0xMjIuMjY3NzczNDI4XSwgWzM3Ljg3MjA4OTIwNTAwMDEsIC0xMjIuMjg5ODEyOTQyMDAwMDFdLCBbMzcuODg0MTA0MTE4LCAtMTIyLjI2OTIwNzE2Ml0sIFszNy44NTg1OTU3NjcwMDAxMDQsIC0xMjIuMjU5MzM3ODM2XSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg1NTMwMzY4OSwgLTEyMi4yOTI0NzIyMDEwMDAwMV0sIFszNy44NzI3NTAxMjIwMDAxMDYsIC0xMjIuMjg0NjIwNzc1XSwgWzM3Ljg0OTY5MDU1ODAwMDEwNiwgLTEyMi4yNzgxNzcyNDM5OTk5OV0sIFszNy44NzAxOTkxOTcsIC0xMjIuMjg1Nzc3NzMyOTk5OTldLCBbMzcuODgxODk5OTg0LCAtMTIyLjI5NzA2ODI3NzAwMDAxXSwgWzM3Ljg1MzIxMDc0OTc0MjUsIC0xMjIuMjk3MTQ0NzI5NTYwMDJdLCBbMzcuODY2NjE0OTk1MDAwMSwgLTEyMi4yNjEwODcyMDZdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODUzMDA4NzA4MDAwMTA0LCAtMTIyLjI4Njk1MDIxODk5OTk5XSwgWzM3Ljg1MzIxODIxMDAwMDEsIC0xMjIuMjgwODEzMTg4XSwgWzM3Ljg2NDAwMjUyNywgLTEyMi4yODEyODY4ODI5OTk5OV0sIFszNy44Njg0MDkzNDgwMDAxLCAtMTIyLjI2MTQ1Mzc3NF0sIFszNy44NzA0MTUzNTQsIC0xMjIuMjkyNTUxNTEyOTk5OTldLCBbMzcuODY3MzY4NTE4LCAtMTIyLjI5Mzk5NTUwMDAwMDAxXSwgWzM3Ljg2NjY4Njc4MywgLTEyMi4yNjc2NzczMTRdLCBbMzcuODgwMDI0MDgxLCAtMTIyLjI5ODA3NTUzOV0sIFszNy44NzA1ODI0NiwgLTEyMi4yNzI4OTMxOTM5OTk5OV0sIFszNy44Njg2NDM2NjEwMDAxLCAtMTIyLjI5NDQwNTc1NF0sIFszNy44NjEyNTAwMzUwMDAxLCAtMTIyLjI2NzA0NzEyODk5OTk5XSwgWzM3Ljg2NjM5Njk1MTAwMDEsIC0xMjIuMjc3MDA5ODU3OTk5OTldLCBbMzcuODY1ODA5NjUyMDAwMSwgLTEyMi4zMDE3MDg2MTddLCBbMzcuODc0NTIzNzYxLCAtMTIyLjI5NzQ4MTMzNF0sIFszNy44NTY0MjA0OTAwMDAxLCAtMTIyLjI2OTAxOTM4NV0sIFszNy44NjU3MDM4NTU5OTk5OTYsIC0xMjIuMjk0NjM0MzYyMDAwMDFdLCBbMzcuODYzOTcxNDg4MDAwMTA0LCAtMTIyLjI2NzM2MzE1XSwgWzM3Ljg2MTcyMzMwMSwgLTEyMi4yNTQ3OTU0MTc5OTk5OV0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODQ4MjU3OTU1MDAwMSwgLTEyMi4yOTUxMDk5MTVdLCBbMzcuODU0MDI5Njc1LCAtMTIyLjI3MzIxMTI5XSwgWzM3Ljg1ODM1MDEyNzAwMDEsIC0xMjIuMjc1NjAyODM1XSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2OTMwMjg1MzAwMDEsIC0xMjIuMjcyMjM0MDIxXSwgWzM3Ljg2OTA5NjU5NjAwMDEsIC0xMjIuMjkyMTE5NDMzXSwgWzM3Ljg2NjAxNDU4MiwgLTEyMi4yNTg2MTY0MDI5OTk5OV0sIFszNy44NzUyMDQ5NzgwMDAxLCAtMTIyLjI5NDA5NDk0MV0sIFszNy44NjkzMDI4NTMwMDAxLCAtMTIyLjI3MjIzNDAyMV0sIFszNy44NzAzMDM3MzQwMDAxLCAtMTIyLjI2ODAzNTUwM10sIFszNy44NTU4MDk3OTcwMDAxMDYsIC0xMjIuMjU1MDA1NDUzXSwgWzM3Ljg1MzI4MTA5NDAwMDEsIC0xMjIuMjc5MDExNTY3OTk5OTldLCBbMzcuODU5MTE0MDgyMDAwMTA0LCAtMTIyLjI4OTMzMTE3M10sIFszNy44NjY4MjA0MjA3OTY3MSwgLTEyMi4zMDM3MTk4MDc5MDMwMV0sIFszNy44Nzc4Mjg3MjYwMDAxLCAtMTIyLjI3MzY5ODgyNl0sIFszNy44NTk1MzQ4MjAwMDAxLCAtMTIyLjI5NzI3OTI2OV0sIFszNy44NjAyNDYzMDEwMDAwOTYsIC0xMjIuMjg5Mjc2MDQ2XSwgWzM3Ljg1OTYxMjMzMDAwMDEsIC0xMjIuMjg5Nzc5MzE1XSwgWzM3Ljg3ODMwMjMzODAwMDAwNSwgLTEyMi4zMDY1NjU1MzVdLCBbMzcuODU0Mzk3MzM1LCAtMTIyLjI4NzM5NTkwNl0sIFszNy44NTQ5MTg3MjkwMDAxMDQsIC0xMjIuMjg3NTY0MzY2XSwgWzM3Ljg1NjIwNjIwODAwMDEsIC0xMjIuMjg3OTc4MjAzXSwgWzM3Ljg1NzY0NDAwNywgLTEyMi4yODg0NDA3MTM5OTk5OV0sIFszNy44NTkwMDY2NzQwMDAxLCAtMTIyLjI4NDkzMTEwNl0sIFszNy44NjcyMDA5OTcwMDAxMDQsIC0xMjIuMzAyMTUxMDUyOTk5OTldLCBbMzcuODY5MDk2NTk2MDAwMSwgLTEyMi4yOTIxMTk0MzNdLCBbMzcuODUxMDA4NTUwMDAwMSwgLTEyMi4yOTExMDQwMzRdLCBbMzcuODY4MjAyMDEwMDAwMSwgLTEyMi4yOTY2MjQ3NTM5OTk5OV0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NzExNzUyODUsIC0xMjIuMzA0NzM1NzU2XSwgWzM3Ljg1ODQyOTE5LCAtMTIyLjI5MzQ5MDA1NjAwMDAxXSwgWzM3Ljg2NzQ5NTA4NzQ2OTYsIC0xMjIuMjk5ODY3NTcwMTQyXSwgWzM3Ljg1MjE1NDQ2OCwgLTEyMi4yODY2NzY3NjM5OTk5OV0sIFszNy44NjU3MjIzMDUwMDAxLCAtMTIyLjMwMjEwNzg5M10sIFszNy44NjU4MDk2NTIwMDAxLCAtMTIyLjMwMTcwODYxN10sIFszNy44NjY2MDg4MzYwMDAxLCAtMTIyLjI1NDA3NTk3XSwgWzM3Ljg3MDM2NjUxODAwMDAwNCwgLTEyMi4zMTg0MTYzNDNdLCBbMzcuODc1MjA0OTc4MDAwMSwgLTEyMi4yOTQwOTQ5NDFdLCBbMzcuODgwODM0NTI1MDAwMSwgLTEyMi4yOTQwNDkxODc5OTk5OV0sIFszNy44Nzg1MDAzODQwMDAxLCAtMTIyLjI5NjQwMTE5M10sIFszNy44NTg1MzIxOTksIC0xMjIuMjY2OTAyNzE1XSwgWzM3Ljg1ODUzMjE5OSwgLTEyMi4yNjY5MDI3MTVdLCBbMzcuODY2MjY3MjE0MDAwMSwgLTEyMi4yOTk0NDMzMjRdLCBbMzcuODYzNjQxMTk0LCAtMTIyLjMxNzYzOTczMl0sIFszNy44NzU1MTQzMDMsIC0xMjIuMjcyMzU5NTExXSwgWzM3Ljg2OTM4MzQwNTAwMDEsIC0xMjIuMzAzNTAwMTQ5XSwgWzM3Ljg2NTAzNzY5OSwgLTEyMi4yOTc5MzIzMDRdLCBbMzcuODcwMTY2OTczLCAtMTIyLjMwMDY5NTU3Nzk5OTk5XSwgWzM3Ljg3MDM2OTMzNCwgLTEyMi4yOTk2NDg4MzRdLCBbMzcuODczNDQyNTU5MDAwMTA0LCAtMTIyLjI5MzUzMDgxNF0sIFszNy44NTQzMTYzODUwMDAxMDQsIC0xMjIuMjcxMDg0MTU0XSwgWzM3Ljg3NDA5MDY4NDAwMDEsIC0xMjIuMjk5NjI5NjU1XSwgWzM3Ljg4NTQ3NTEwOCwgLTEyMi4yNzU0MDA1NzcwMDAwMV0sIFszNy44Njg2NjM5NjkwMDAxLCAtMTIyLjI2OTk4MDIzNV0sIFszNy44NjQ4NzYyNjAwMDAxLCAtMTIyLjI2NzQ3NDc5MV0sIFszNy44NjgxNDg4MzMwMDAxLCAtMTIyLjI5MTgxMDY3Nzk5OTk5XSwgWzM3Ljg1NTIzMzk1OSwgLTEyMi4yNzcyNDEzNTZdLCBbMzcuODY3ODY2NzUxMDAwMSwgLTEyMi4yOTg4NDc1MjldLCBbMzcuODcyMTUxNDU2LCAtMTIyLjI2ODQxMzkzMV0sIFszNy44Njc5OTUwMjAwMDAxLCAtMTIyLjI5NzY2NDc1NV0sIFszNy44Njc4NDMxNTIsIC0xMjIuMjk1ODczMDc0XSwgWzM3Ljg1OTM0MjUxMjAwMDEwNCwgLTEyMi4yNjc0ODYxMTEwMDAwMV0sIFszNy44NjM2NTQzODMwMDAwMDQsIC0xMjIuMjkwMzYzMDA0XSwgWzM3Ljg0ODc0OTk0MDAwMDEsIC0xMjIuMjcxMzk2MjU1XSwgWzM3Ljg3MTA1Njg2MTk5OTk5NiwgLTEyMi4yNzQyNjMyOTZdLCBbMzcuODY2NjE0OTk1MDAwMSwgLTEyMi4yNjEwODcyMDZdLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODY4NDEzOTU5MDAwMSwgLTEyMi4zMDI1NDEwOTddLCBbMzcuODY4NjA4Mjg2MDk4NSwgLTEyMi4zMDEzMjg4OTg4NjddLCBbMzcuODY3NTEzMTYxLCAtMTIyLjI2MTI3MzEwNV0sIFszNy44NjYyNjcyMTQwMDAxLCAtMTIyLjI5OTQ0MzMyNF0sIFszNy44NTMyMTA3NDk3NDI1LCAtMTIyLjI5NzE0NDcyOTU2MDAyXSwgWzM3Ljg2NDg3NjI2MDAwMDEsIC0xMjIuMjY3NDc0NzkxXSwgWzM3Ljg3MjI5OTc0OCwgLTEyMi4yNjk1NDEyMzIwMDAwMV0sIFszNy44Njk4NzU3MDAwMDAxLCAtMTIyLjI4NjU1MDg0Nl0sIFszNy44NjcyMDc1MzksIC0xMjIuMjU2NTI5Mzc3XV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWluT3BhY2l0eTogMC41LAogICAgICAgICAgICAgICAgICAgIG1heFpvb206IDE4LAogICAgICAgICAgICAgICAgICAgIG1heDogMS4wLAogICAgICAgICAgICAgICAgICAgIHJhZGl1czogMTAsCiAgICAgICAgICAgICAgICAgICAgYmx1cjogMTUsCiAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQ6IG51bGwKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84NDg0YjQwNTQ1ZjE0MzYzODc0ZjIyOGZiYWJjYTIwYyk7CiAgICAgICAgCjwvc2NyaXB0Pg==" style="position:absolute;width:100%;height:100%;left:0;top:0;border:none !important;" webkitallowfullscreen=""></iframe></div></div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can confirm that the police stops in the dataset happened in Berkeley, and that most police calls happened in the Downtown Berkeley and West Berkeley areas.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Temporality">Temporality<a class="anchor-link" href="#Temporality">¶</a></h2><p>Temporality refers to how the data are situated in time and specifically to the date and time fields in the dataset. We seek to understand the following traits about these fields:</p>
<p><strong>What is the meaning of the date and time fields in the dataset?</strong></p>
<p>In the Calls and Stops dataset, the datetime fields represent when the call or stop was made by the police. However, the Stops dataset also originally had a datetime field recording when the case was entered into the database which we took out during data cleaning since we didn't think it would be useful for analysis.</p>
<p>In addition, we should be careful to note the timezone and Daylight Savings for datetime fields especially when dealing with data that comes from multiple locations.</p>
<p><strong>What representation do the date and time fields have in the data?</strong></p>
<p>Although the US uses the MM/DD/YYYY format, many other countries use the DD/MM/YYYY format. There are still more formats in use around the world and it's important to recognize these differences when analyzing data.</p>
<p>In the Calls and Stops dataset, the dates came in the MM/DD/YYYY format.</p>
<p><strong>Are there strange timestamps that might represent null values?</strong></p>
<p>Some programs use placeholder datetimes instead of null values. For example, Excel's default date is Jan 1st, 1990 and on Excel for Mac, it's Jan 1st, 1904. Many applications will generate a default datetime of 12:00am Jan 1st, 1970 or 11:59pm Dec 31st, 1969 since this is the <a href="https://www.wikiwand.com/en/Unix_time#/Encoding_time_as_a_number">Unix Epoch for timestamps</a>. If you notice multiple instances of these timestamps in your data, you should take caution and double check your data sources. Neither Calls nor Stops dataset contain any of these suspicious values.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/05'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Faithfulness">Faithfulness<a class="anchor-link" href="#Faithfulness">¶</a></h2><p>We describe a dataset as "faithful" if we believe it accurately captures reality. Typically, untrustworthy datasets contain:</p>
<p><strong>Unrealistic or incorrect values</strong></p>
<p>For example, dates in the future, locations that don't exist, negative counts, or large outliers.</p>
<p><strong>Violations of obvious dependencies</strong></p>
<p>For example, age and birthday for individuals don't match.</p>
<p><strong>Hand-entered data</strong></p>
<p>As we have seen, these are typically filled with spelling errors and inconsistencies.</p>
<p><strong>Clear signs of data falsification</strong></p>
<p>For example, repeated names, fake looking email addresses, or repeated use of uncommon names or fields.</p>
<p>Notice the many similarities to data cleaning. As we have mentioned, we often go back and forth between data cleaning and EDA, especially when determining data faithfulness. For example, visualizations often help us identify strange entries in the data.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/calls.csv'</span><span class="p">)</span>
<span class="n">calls</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>CASENO</th>
<th>OFFENSE</th>
<th>EVENTDT</th>
<th>EVENTTM</th>
<th>...</th>
<th>BLKADDR</th>
<th>Latitude</th>
<th>Longitude</th>
<th>Day</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>17091420</td>
<td>BURGLARY AUTO</td>
<td>07/23/2017 12:00:00 AM</td>
<td>06:00</td>
<td>...</td>
<td>2500 LE CONTE AVE</td>
<td>37.876965</td>
<td>-122.260544</td>
<td>Sunday</td>
</tr>
<tr>
<th>1</th>
<td>17038302</td>
<td>BURGLARY AUTO</td>
<td>07/02/2017 12:00:00 AM</td>
<td>22:00</td>
<td>...</td>
<td>BOWDITCH STREET &amp; CHANNING WAY</td>
<td>37.867209</td>
<td>-122.256554</td>
<td>Sunday</td>
</tr>
<tr>
<th>2</th>
<td>17049346</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>08/20/2017 12:00:00 AM</td>
<td>23:20</td>
<td>...</td>
<td>2900 CHANNING WAY</td>
<td>37.867948</td>
<td>-122.250664</td>
<td>Sunday</td>
</tr>
<tr>
<th>3</th>
<td>17091319</td>
<td>THEFT MISD. (UNDER $950)</td>
<td>07/09/2017 12:00:00 AM</td>
<td>04:15</td>
<td>...</td>
<td>2100 RUSSELL ST</td>
<td>37.856719</td>
<td>-122.266672</td>
<td>Sunday</td>
</tr>
<tr>
<th>4</th>
<td>17044238</td>
<td>DISTURBANCE</td>
<td>07/30/2017 12:00:00 AM</td>
<td>01:16</td>
<td>...</td>
<td>TELEGRAPH AVENUE &amp; DURANT AVE</td>
<td>37.867816</td>
<td>-122.258994</td>
<td>Sunday</td>
</tr>
</tbody>
</table>
<p>5 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">'CASENO'</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a1ebb2898&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/eda_faithfulness_4_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice the unexpected clusters at 17030000 and 17090000. By plotting the distribution of case numbers, we can quickly see anomalies in the data. In this case, we might guess that two different teams of police use different sets of case numbers for their calls.</p>
<p>Exploring the data often reveals anomalies; if fixable, we can then apply data cleaning techniques.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Data-Visualization">Data Visualization<a class="anchor-link" href="#Data-Visualization">¶</a></h1><blockquote><p>There is a magic in graphs. The profile of a curve reveals in a ﬂash a whole
situation — the life history of an epidemic, a panic, or an era of
prosperity. The curve informs the mind, awakens the imagination, convinces.</p>
<p>― Henry D. Hubbard</p>
</blockquote>
<p>Data visualization is an essential tool for data science at every step of
analysis, from data cleaning to EDA to communicating conclusions and
predictions. Because human minds are highly developed for visual perception, a
well-chosen plot can often reveal trends and anomalies in the data much more
efficiently than a textual description.</p>
<p>To effectively use data visualizations, you must be proficient with both the
programming tools to generate plots and the principles of visualization. In
this chapter we will introduce <code>seaborn</code> and <code>matplotlib</code>, our tools of choice
for creating plots. We will also learn how to spot misleading visualizations
and how to improve visualizations using data transformations, smoothing, and
dimensionality reduction.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-Quantitative-Data">Visualizing Quantitative Data<a class="anchor-link" href="#Visualizing-Quantitative-Data">¶</a></h2><p>We generally use different types of charts to visualize quantitative (numerical) data and qualitative (ordinal or nominal) data.</p>
<p>For quantitative data, we most often use histograms, box plots, and scatter plots.</p>
<p>We can use the <a href="http://seaborn.pydata.org/">seaborn plotting library</a> to create these plots in Python. We will use a dataset containing information about passengers aboard the Titanic.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import seaborn and apply its plotting styles</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Load the dataset and drop N/A values to make plot function calls simpler</span>
<span class="n">ti</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'titanic'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># This table is too large to fit onto a page so we'll output sliders to</span>
<span class="c1"># pan through different sections.</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(182 rows, 15 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Histograms">Histograms<a class="anchor-link" href="#Histograms">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the dataset contains one row for every passenger. Each row includes the age of the passenger and the amount the passenger paid for a ticket. Let's visualize the ages using a histogram. We can use seaborn's <code>distplot</code> function:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Adding a semi-colon at the end tells Jupyter not to output the</span>
<span class="c1"># usual &lt;matplotlib.axes._subplots.AxesSubplot&gt; line</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="s1">'age'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, seaborn's <code>distplot</code> function will output a smoothed curve that roughly fits the distribution. We can also add a rugplot which marks each individual point on the x-axis:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="s1">'age'</span><span class="p">],</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_10_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also plot the distribution itself. Adjusting the number of bins shows that there were a number of children on board.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="s1">'age'</span><span class="p">],</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Box-plots">Box plots<a class="anchor-link" href="#Box-plots">¶</a></h3><p>Box plots are a convenient way to see where most of the data lie. Typically, we use the 25th and 75th percentiles of the data as the start and endpoints of the box and draw a line within the box for the 50th percentile (the median). We draw two "whiskers" that extend to show the the remaining data except outliers, which are marked as individual points outside the whiskers.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We typically use the Inter-Quartile Range (IQR) to determine which points are considered outliers for the box plot. The IQR is the difference between the 75th percentile of the data and the 25th percentile.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="s1">'fare'</span><span class="p">],</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">iqr</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">-</span> <span class="n">lower</span>
<span class="n">iqr</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>60.299999999999997</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Values greater than 1.5 <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.509ex" style="vertical-align: 0.019ex; margin-bottom: -0.19ex;" viewBox="0 -576.1 778.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-155-Title">
<title id="MathJax-SVG-155-Title">\times</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-D7" x="0" y="0"></use>
</g>
</svg></span> IQR above the 75th percentile and less than 1.5 <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.808ex" height="1.509ex" style="vertical-align: 0.019ex; margin-bottom: -0.19ex;" viewBox="0 -576.1 778.5 649.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-156-Title">
<title id="MathJax-SVG-156-Title">\times</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-D7" x="0" y="0"></use>
</g>
</svg></span> IQR below the 25th percentile are considered outliers and we can see them marked indivdiually on the boxplot above:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">upper_cutoff</span> <span class="o">=</span> <span class="n">upper</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
<span class="n">lower_cutoff</span> <span class="o">=</span> <span class="n">lower</span> <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">iqr</span>
<span class="n">upper_cutoff</span><span class="p">,</span> <span class="n">lower_cutoff</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(180.44999999999999, -60.749999999999986)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although histograms show the entire distribution at once, box plots are often easier to understand when we split the data by different categories. For example, we can make one box plot for each passenger type:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'who'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_20_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The separate box plots are much easier to understand than the overlaid histogram below which plots the same data:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ti</span><span class="p">[</span><span class="s1">'who'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'woman'</span><span class="p">,</span> <span class="s1">'fare'</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ti</span><span class="p">[</span><span class="s1">'who'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'man'</span><span class="p">,</span> <span class="s1">'fare'</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ti</span><span class="p">[</span><span class="s1">'who'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'child'</span><span class="p">,</span> <span class="s1">'fare'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_22_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Brief-Aside-on-Using-Seaborn">Brief Aside on Using Seaborn<a class="anchor-link" href="#Brief-Aside-on-Using-Seaborn">¶</a></h3><p>You may have noticed that the <code>boxplot</code> call to make separate box plots for the <code>who</code> column was simpler than the equivalent code to make an overlaid histogram. Although <code>sns.distplot</code> takes in an array or Series of data, most other seaborn functions allow you to pass in a DataFrame and specify which column to plot on the x and y axes. For example:</p>
<div class="highlight"><pre><span></span><span class="c1"># Plots the `fare` column of the `ti` DF on the x-axis</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
<p>When the column is categorical (the <code>'who'</code> column contained <code>'woman'</code>, <code>'man'</code>, and <code>'child'</code>), seaborn will automatically split the data by category before plotting. This means we don't have to filter out each category ourselves like we did for <code>sns.distplot</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># fare (numerical) on the x-axis,</span>
<span class="c1"># who (nominal) on the y-axis</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'who'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_24_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scatter-Plots">Scatter Plots<a class="anchor-link" href="#Scatter-Plots">¶</a></h3><p>Scatter plots are used to compare two quantitative variables. We can compare the <code>age</code> and <code>fare</code> columns of our Titanic dataset using a scatter plot.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_26_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default seaborn will also fit a regression line to our scatterplot and bootstrap the scatterplot to create a 95% confidence interval around the regression line shown as the light blue shading around the line above. In this case, the regression line doesn't seem to fit the scatter plot very well so we can turn off the regression.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_28_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can color the points using a categorical variable. Let's use the <code>who</code> column once more:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'who'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_quantitative_30_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From this plot we can see that all passengers below the age of 18 or so were marked as <code>child</code>. There doesn't seem to be a noticable split between male and female passenger fares, although the two most expensive tickets were purchased by males.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-Qualitative-Data">Visualizing Qualitative Data<a class="anchor-link" href="#Visualizing-Qualitative-Data">¶</a></h2><p>For qualitative or categorical data, we most often use bar charts and dot charts. We will show how to create these plots using <code>seaborn</code> and the Titanic survivors dataset.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Import seaborn and apply its plotting styles</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>

<span class="c1"># Load the dataset</span>
<span class="n">ti</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'titanic'</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># This table is too large to fit onto a page so we'll output sliders to</span>
<span class="c1"># pan through different sections.</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">ti</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(891 rows, 15 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bar-Charts">Bar Charts<a class="anchor-link" href="#Bar-Charts">¶</a></h3><p>In <code>seaborn</code>, there are two types of bar charts. The first type uses the <code>countplot</code> method to count up the number of times each category appears in a column.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Counts how many passengers survived and didn't survive and</span>
<span class="c1"># draws bars with corresponding heights</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'alive'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_6_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'class'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># As with box plots, we can break down each category further using color</span>
<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'alive'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'class'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>barplot</code> method, on the other hand, groups the DataFrame by a categorical column and plots the height of the bars according to the average of a numerical column within each group.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># For each set of alive/not alive passengers, compute and plot the average age.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'alive'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_10_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The height of each bar can be computed by grouping the original DataFrame and averaging the <code>age</code> column:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ti</span><span class="p">[[</span><span class="s1">'alive'</span><span class="p">,</span> <span class="s1">'age'</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'alive'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>age</th>
</tr>
<tr>
<th>alive</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>no</th>
<td>30.626179</td>
</tr>
<tr>
<th>yes</th>
<td>28.343690</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By default, the <code>barplot</code> method will also compute a bootstrap 95% confidence interval for each averaged value, marked as the black lines in the bar chart above. The confidence intervals show that if the dataset contained a random sample of Titanic passengers, the difference between passenger age for those that survived and those that didn't is not statistically significant at the 5% significance level.</p>
<p>These confidence intervals take long to generate when we have larger datasets so it is sometimes useful to turn them off:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'alive'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Dot-Charts">Dot Charts<a class="anchor-link" href="#Dot-Charts">¶</a></h3><p>Dot charts are similar to bar charts. Instead of plotting bars, dot charts mark a single point at the end of where a bar would go. We use the <code>pointplot</code> method to make dot charts in <code>seaborn</code>. Like the <code>barplot</code> method, the <code>pointplot</code> method also automatically groups the DataFrame and computes the average of a separate numerical variable, marking 95% confidence intervals as vertical lines centered on each point.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># For each set of alive/not alive passengers, compute and plot the average age.</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'alive'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Dot charts are most useful when comparing changes across categories:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shows the proportion of survivors for each passenger class</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'class'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'survived'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shows the proportion of survivors for each passenger class,</span>
<span class="c1"># split by whether the passenger was an adult male</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'class'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'survived'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'adult_male'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_qualitative_19_0.png">
</div>
</div>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Customizing-Plots-using-matplotlib">Customizing Plots using <code>matplotlib</code><a class="anchor-link" href="#Customizing-Plots-using-matplotlib">¶</a></h2><p>Although <code>seaborn</code> allows us to quickly create many types of plots, it does not give us fine-grained control over the chart. For example, we cannot use <code>seaborn</code> to modify a plot's title, change x or y-axis labels, or add annotations to a plot. Instead, we must use the <code>matplotlib</code> library that <code>seaborn</code> is based off of.</p>
<p><code>matplotlib</code> provides basic building blocks for creating plots in Python. Although it gives great control, it is also more verbose—recreating the <code>seaborn</code> plots from the previous sections in <code>matplotlib</code> would take many lines of code. In fact, we can think of <code>seaborn</code> as a set of useful shortcuts to create <code>matplotlib</code> plots. Although we prefer to prototype plots in <code>seaborn</code>, in order to customize plots for publication we will need to learn basic pieces of <code>matplotlib</code>.</p>
<p>Before we look at our first simple example, we must activate matplotlib support in the notebook:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This line allows matplotlib plots to appear as images in the notebook</span>
<span class="c1"># instead of in a separate window.</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># plt is a commonly used shortcut for matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Customizing-Figures-and-Axes">Customizing Figures and Axes<a class="anchor-link" href="#Customizing-Figures-and-Axes">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to create a plot in <code>matplotlib</code>, we create a <em>figure</em>, then add an <em>axes</em> to the figure. In <code>matplotlib</code>, an axes is a single chart, and figures can contain multiple axes in a tablular layout. An axes contains <em>marks</em>, the lines or patches drawn on the plot.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a figure</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

<span class="c1"># Add an axes to the figure. The second and third arguments create a table</span>
<span class="c1"># with 1 row and 1 column. The first argument places the axes in the first</span>
<span class="c1"># cell of the table.</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Create a line plot on the axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># Show the plot. This will automatically get called in a Jupyter notebook</span>
<span class="c1"># so we'll omit it in future cells</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To customize the plot, we can use other methods on the axes object:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Setting the label kwarg lets us generate a legend</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sin(x)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'cos(x)'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Sinusoids'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a shortcut, <code>matplotlib</code> has plotting methods on the <code>plt</code> module itself that will automatically initialize a figure and axes.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Shorthand to create figure and axes and call ax.plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># When plt methods are called multiple times in the same cell, the</span>
<span class="c1"># existing figure and axes are reused.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>plt</code> module has analogous methods to an axes, so we can recreate one of the plots above using <code>plt</code> shorthands.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'sin(x)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'cos(x)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Shorthand for ax.set_title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Sinusoids'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>

<span class="c1"># Set the x and y-axis limits</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Customizing-Marks">Customizing Marks<a class="anchor-link" href="#Customizing-Marks">¶</a></h3><p>To change properties of the plot marks themselves (e.g. the lines in the plot above), we can pass additional arguments into <code>plt.plot</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'purple'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_15_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Checking the <code>matplotlib</code> documentation is the easiest way to figure out which arguments are available for each method. Another way is to store the returned line object:</p>
<pre><code>In [1]: line, = plot([1,2,3])

</code></pre>
<p>These line objects have a lot of properties you can control, here's the full list using tab-completion in IPython:</p>
<pre><code>In [2]: line.set
line.set                     line.set_drawstyle           line.set_mec
line.set_aa                  line.set_figure              line.set_mew
line.set_agg_filter          line.set_fillstyle           line.set_mfc
line.set_alpha               line.set_gid                 line.set_mfcalt
line.set_animated            line.set_label               line.set_ms
line.set_antialiased         line.set_linestyle           line.set_picker
line.set_axes                line.set_linewidth           line.set_pickradius
line.set_c                   line.set_lod                 line.set_rasterized
line.set_clip_box            line.set_ls                  line.set_snap
line.set_clip_on             line.set_lw                  line.set_solid_capstyle
line.set_clip_path           line.set_marker              line.set_solid_joinstyle
line.set_color               line.set_markeredgecolor     line.set_transform
line.set_contains            line.set_markeredgewidth     line.set_url
line.set_dash_capstyle       line.set_markerfacecolor     line.set_visible
line.set_dashes              line.set_markerfacecoloralt  line.set_xdata
line.set_dash_joinstyle      line.set_markersize          line.set_ydata
line.set_data                line.set_markevery           line.set_zorder


</code></pre>
<p>But the <code>setp</code> call (short for set property) can be very useful, especially
while working interactively because it contains introspection support, so you
can learn about the valid calls as you work:</p>
<pre><code>In [7]: line, = plot([1,2,3])

In [8]: setp(line, 'linestyle')
  linestyle: [ ``'-'`` | ``'--'`` | ``'-.'`` | ``':'`` | ``'None'`` | ``' '`` | ``''`` ]         and any drawstyle in combination with a linestyle, e.g. ``'steps--'``.         

In [9]: setp(line)
  agg_filter: unknown
  alpha: float (0.0 transparent through 1.0 opaque)         
  animated: [True | False]         
  antialiased or aa: [True | False]
  ...
  ... much more output omitted
  ...

</code></pre>
<p>In the first form, it shows you the valid values for the 'linestyle' property,
and in the second it shows you all the acceptable properties you can set on the
line object.  This makes it easy to discover how to customize your figures
to get the visual results you need.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Aribitrary-text-and-LaTeX-support">Aribitrary text and LaTeX support<a class="anchor-link" href="#Aribitrary-text-and-LaTeX-support">¶</a></h3><p>In matplotlib, text can be added either relative to an individual axis object
or to the whole figure.</p>
<p>These commands add text to the Axes:</p>
<ul>
<li><code>set_title()</code> - add a title</li>
<li><code>set_xlabel()</code> - add an axis label to the x-axis</li>
<li><code>set_ylabel()</code> - add an axis label to the y-axis</li>
<li><code>text()</code> - add text at an arbitrary location</li>
<li><code>annotate()</code> - add an annotation, with optional arrow</li>
</ul>
<p>And these act on the whole figure:</p>
<ul>
<li><code>figtext()</code> - add text at an arbitrary location</li>
<li><code>suptitle()</code> - add a title</li>
</ul>
<p>And any text field can contain LaTeX expressions for mathematics, as long as
they are enclosed in <code>$</code> signs.</p>
<p>This example illustrates all of them:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">'bold figure suptitle'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.85</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'axes title'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'xlabel'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'ylabel'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">'boxed italics text in data coords'</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">'italic'</span><span class="p">,</span>
        <span class="n">bbox</span><span class="o">=</span><span class="p">{</span><span class="s1">'facecolor'</span><span class="p">:</span><span class="s1">'red'</span><span class="p">,</span> <span class="s1">'alpha'</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">'pad'</span><span class="p">:</span><span class="mi">10</span><span class="p">})</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">'an equation: $E=mc^2$'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'unicode: Institut für Festkörperphysik'</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">'colored text in axes coords'</span><span class="p">,</span>
        <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">'bottom'</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">'right'</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">'green'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>


<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'o'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'annotate'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
            <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Customizing-a-seaborn-plot-using-matplotlib">Customizing a <code>seaborn</code> plot using <code>matplotlib</code><a class="anchor-link" href="#Customizing-a-seaborn-plot-using-matplotlib">¶</a></h3><p>Now that we've seen how to use <code>matplotlib</code> to customize a plot, we can use the same methods to customize <code>seaborn</code> plots since <code>seaborn</code> creates plots using <code>matplotlib</code> behind-the-scenes.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Load seaborn</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>

<span class="c1"># Load dataset</span>
<span class="n">ti</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'titanic'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ti</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>survived</th>
<th>pclass</th>
<th>sex</th>
<th>age</th>
<th>...</th>
<th>deck</th>
<th>embark_town</th>
<th>alive</th>
<th>alone</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>1</td>
<td>female</td>
<td>38.0</td>
<td>...</td>
<td>C</td>
<td>Cherbourg</td>
<td>yes</td>
<td>False</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>1</td>
<td>female</td>
<td>35.0</td>
<td>...</td>
<td>C</td>
<td>Southampton</td>
<td>yes</td>
<td>False</td>
</tr>
<tr>
<th>2</th>
<td>0</td>
<td>1</td>
<td>male</td>
<td>54.0</td>
<td>...</td>
<td>E</td>
<td>Southampton</td>
<td>no</td>
<td>True</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>3</td>
<td>female</td>
<td>4.0</td>
<td>...</td>
<td>G</td>
<td>Southampton</td>
<td>yes</td>
<td>False</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>1</td>
<td>female</td>
<td>58.0</td>
<td>...</td>
<td>C</td>
<td>Southampton</td>
<td>yes</td>
<td>True</td>
</tr>
</tbody>
</table>
<p>5 rows × 15 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll start with this plot:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'who'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_22_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the plot needs a title and better labels for the x and y-axes. In addition, the two people with the most expensive fares survived, so we can annotate them on our plot.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'fare'</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'who'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ti</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Fare Paid vs. Age of Passenger, Colored by Passenger Type'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Age of Passenger'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Fare in USD'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">'Both survived'</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">500</span><span class="p">),</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">420</span><span class="p">),</span>
             <span class="n">arrowprops</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">'black'</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.05</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_matplotlib_24_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In practice, we use <code>seaborn</code> to quickly explore the data and then turn to <code>matplotlib</code> for fine-tuning once we decide on the plots to use in a paper or presentation.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualization-Principles">Visualization Principles<a class="anchor-link" href="#Visualization-Principles">¶</a></h2><p>Now that we have the tools to create and alter plots, we turn to key principles for data visualization. Much like other parts of data science, it is difficult to precisely assign a number that measures how effective a specific visualization is. Still, there are general principles that make visualizations much more effective at showing trends in the data. We discuss six categories of principles: scale, conditioning, perception, transformation, context, and smoothing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Scale">Principles of Scale<a class="anchor-link" href="#Principles-of-Scale">¶</a></h3><p>Principles of scale relate to the choice of x and y-axis used to plot the data.</p>
<p>In a 2015 US Congressional hearing, representative Chaffetz discussed an investigation of Planned Parenthood programs. He presented the following plot that originally appeared in a report by Americans United for Life. It compares the number of abortion and cancer screening procedures, both of which are offered by Planned Parenthood. (The full report is available at <a href="https://oversight.house.gov/interactivepage/plannedparenthood">https://oversight.house.gov/interactivepage/plannedparenthood</a>.)</p>
<p>What is suspicious about this plot? How many data points are plotted?</p>
<p><img alt="viz_planned_parenthood.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_planned_parenthood.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This plot violates principles of scale; it doesn't make good choices for its x and y-axis.</p>
<p>When we select the x and y-axis for our plot, we should keep a consistent scale across the entire axis. However, the plot above has different scales for the Abortion and Cancer Screening lines—the start of the Abortion line and end of the Cancer Screening line lie close to each other on the y-axis but represent vastly different numbers. In addition, only points from 2006 and 2013 are plotted but the x-axis contains unnecessary tick marks for every year in between.</p>
<p>To improve this plot, we should re-plot the points on the same y-axis scale:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/plannedparenthood.csv"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="s1">'year'</span><span class="p">],</span> <span class="n">pp</span><span class="p">[</span><span class="s1">'screening'</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Cancer'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pp</span><span class="p">[</span><span class="s1">'year'</span><span class="p">],</span> <span class="n">pp</span><span class="p">[</span><span class="s1">'abortion'</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s2">"solid"</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">"o"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Abortion'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Planned Parenthood Procedures'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"Year"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Service"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">2006</span><span class="p">,</span> <span class="mi">2013</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the change in number of Abortions is very small compared to the large drop in the number of Cancer Screenings. Instead of the number of procedures, we might instead be interested in the percent change in number.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">percent_change</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'percent_change'</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">pp</span><span class="p">[</span><span class="s1">'screening'</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">pp</span><span class="p">[</span><span class="s1">'screening'</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">pp</span><span class="p">[</span><span class="s1">'abortion'</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">pp</span><span class="p">[</span><span class="s1">'abortion'</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'procedure'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'cancer'</span><span class="p">,</span> <span class="s1">'abortion'</span><span class="p">],</span>
    <span class="s1">'type'</span><span class="p">:</span> <span class="p">[</span><span class="s1">'percent_change'</span><span class="p">,</span> <span class="s1">'percent_change'</span><span class="p">],</span>
<span class="p">})</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'procedure'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'percent_change'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">percent_change</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Percent Change in Number of Procedures'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Percent Change'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'black'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When selecting the x and y-axis limits we prefer to focus on the region with the bulk of the data, especially when working with long-tailed data. Consider the following plot and its zoomed in version to its right:</p>
<p><img alt="viz_zoom.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_zoom.png"></p>
<p>The plot on the right is much more helpful for making sense of the dataset. If needed, we can make multiple plots of different regions of the data to show the entire range of data. Later in this section, we discuss data transformations which also help visualize long-tailed data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Conditioning">Principles of Conditioning<a class="anchor-link" href="#Principles-of-Conditioning">¶</a></h3><p>Principles of conditioning give us techniques to show distributions and relationships between subgroups of our data.</p>
<p>The US Bureau of Labor Statistics oversees scientific surveys related to the economic health of the US. Their website contains a tool to generate reports using this data that was used to generate this chart comparing median weekly earnings split by sex.</p>
<p>Which comparisons are easiest to make using this plot? Are these the comparisons that are most interesting or important?</p>
<p><img alt="viz_earnings.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_earnings.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This plot lets us see at a glance that weekly earnings tend to increase with more education. However, it is difficult to tell exactly how much each level of education increases earnings and it is even more difficult to compare male and female weekly earnings at the same education level. We can uncover both these trends by using a dot chart instead of a bar chart.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">cps</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/edInc2.csv"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"educ"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"income"</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">"gender"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cps</span><span class="p">)</span>

<span class="n">ticks</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"&lt;HS"</span><span class="p">,</span> <span class="s2">"HS"</span><span class="p">,</span> <span class="s2">"&lt;BA"</span><span class="p">,</span> <span class="s2">"BA"</span><span class="p">,</span> <span class="s2">"&gt;BA"</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Education"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Income"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"2014 Median Weekly Earnings</span><span class="se">\n</span><span class="s2">Full-Time Workers over 25 years old"</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The lines connecting the points more clearly shows the relatively large effect of having a BA degree on weekly earnings. Placing the points for males and females directly above each other makes it much easier to see that the wage gap between males and females tends to increase with higher education levels.</p>
<p>To aid comparison of two subgroups within your data, align markers along the x or y-axis and use different colors or markers for different subgroups. Lines tend to show trends in data more clearly than bars and are a useful choice for both ordinal and numerical data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Perception">Principles of Perception<a class="anchor-link" href="#Principles-of-Perception">¶</a></h3><p>Human perception has specific properties that are important to consider in visualization design. The first important property of human perception is that we perceive some colors more strongly than others, especially green colors. In addition, we perceive lighter shaded areas as larger than darker shaded ones. For example, in the weekly earnings plot that we just discussed, the lighter bars seem to draw more attention than the darker colored ones:</p>
<p><img alt="viz_earnings.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_earnings.png"></p>
<p>Practically speaking, you should ensure that your charts' color palettes are <em>perceptually uniform</em>. This means that, for example, the perceived intensity of the color won't change in between bars in a bar chart. For quantitative data, you have two choices: if your data progress from low to high and you want to emphasize large values, use a <em>sequential</em> color scheme which assigns lighter colors to large values. If both low and high values should be emphasized, use a <em>diverging</em> color scheme which assigns ligher colors to values closer to the center.</p>
<p><code>seaborn</code> comes with many useful color palettes built-in. You can browse its documentation to learn how to switch between color palettes: <a href="http://seaborn.pydata.org/tutorial/color_palettes.html">http://seaborn.pydata.org/tutorial/color_palettes.html</a></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A second important property of human perception is that we are generally more accurate when we compare lengths and less accurate when we compare areas. Consider the following chart of the GDP of African countries.</p>
<p><img alt="viz_gdp.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_gdp.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By numerical value, South Africa has twice the GDP of Algeria but it's not easy to tell from the plot above. Instead, we can plot the GDPs on a dot plot:</p>
<p><img alt="viz_gdp_v2.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_gdp_v2.png"></p>
<p>This is much more clear because it allows us to compare lengths instead of areas. Pie charts and three-dimensional charts are difficult to interpret for the same reason; we tend to avoid these charts in practice.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our third and final property of perception is that the human eye has difficulty with changing baselines. Consider the following stacked area chart that plots carbon dioxide emissions over time split by country.</p>
<p><img alt="https://github.com/DS-100/textbook/raw/master/assets/viz_emissions.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_emissions.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is difficult to see whether the UK's emissions have increased or decreased over time because the of <em>jiggling baseline</em> problem: the baseline (bottom line) of the area jiggles up and down. It is also difficult to compare whether the UK's emissions are greater than China's emissions when the two heights are similar (in year 2000, for example).</p>
<p>Similar issues of jiggling baselines appear in stacked bar charts. In the plot below, it is difficult to compare the number of 15-64 year olds between Germany and Mexico.</p>
<p><img alt="https://github.com/DS-100/textbook/raw/master/assets/viz_bar_stacked.jpeg" src="https://github.com/DS-100/textbook/raw/master/assets/viz_bar_stacked.jpeg"></p>
<p>We can often improve a stacked area or bar chart by switching to a line chart. Here's the data of emissions over time plotted as lines instead of areas:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">co2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/CAITcountryCO2.csv"</span><span class="p">,</span> <span class="n">skiprows</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
                  <span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Country"</span><span class="p">,</span> <span class="s2">"Year"</span><span class="p">,</span> <span class="s2">"CO2"</span><span class="p">])</span>
<span class="n">last_year</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">Year</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">f</span><span class="s2">"Country != 'World' and Country != 'European Union (15)' and Year == </span><span class="si">{last_year}</span><span class="s2">"</span>
<span class="n">top14_lasty</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'CO2'</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">14</span><span class="p">]</span>
<span class="n">top14</span> <span class="o">=</span> <span class="n">co2</span><span class="p">[</span><span class="n">co2</span><span class="o">.</span><span class="n">Country</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top14_lasty</span><span class="o">.</span><span class="n">Country</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">co2</span><span class="o">.</span><span class="n">Year</span> <span class="o">&gt;=</span> <span class="mi">1950</span><span class="p">)]</span>

<span class="kn">from</span> <span class="nn">cycler</span> <span class="k">import</span> <span class="n">cycler</span>

<span class="n">linestyles</span> <span class="o">=</span> <span class="p">([</span><span class="s1">'-'</span><span class="p">,</span> <span class="s1">'--'</span><span class="p">,</span> <span class="s1">':'</span><span class="p">,</span> <span class="s1">'-.'</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">)[:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">'colorblind'</span><span class="p">)[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">lines_c</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'linestyle'</span><span class="p">,</span> <span class="n">linestyles</span><span class="p">)</span>
<span class="n">color_c</span> <span class="o">=</span> <span class="n">cycler</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,</span> <span class="n">colors</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">lines_c</span> <span class="o">*</span> <span class="n">color_c</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span><span class="s1">'Year'</span><span class="p">,</span> <span class="s1">'CO2'</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">top14</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Country'</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">x</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="s2">"Emissions [Million Tons]"</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This plot does not jiggle the baseline so it is much easier to compare emissions between countries. We can also more clearly see which countries increased emissions the most.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualization-Principles-Continued">Visualization Principles Continued<a class="anchor-link" href="#Visualization-Principles-Continued">¶</a></h2><p>In this section, we discuss principles of visualization for transformation, context, and smoothing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Transformation">Principles of Transformation<a class="anchor-link" href="#Principles-of-Transformation">¶</a></h3><p>The principles of data transformation give us useful ways to alter data for visualization in order to more effectively reveal trends. We most commonly apply data transformations to reveal patterns in skewed data and non-linear relationships between variables.</p>
<p>The plot below shows the distribution of ticket fares for each passenger aboard the Titanic. As you can see, the distribution is skewed right.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">ti</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'titanic'</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ti</span><span class="p">[</span><span class="s1">'fare'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Fares for Titanic Passengers'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Fare in USD'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_4_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although this histogram shows the all the fares, it is difficult to see detailed patterns in the data since the fares are clumped on the left side of the histogram. To remedy this, we can take the natural log of the fares before plotting them:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">ti</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ti</span><span class="p">[</span><span class="s1">'fare'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'fare'</span><span class="p">]),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'log(Fares) for Titanic Passengers'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'log(Fare) in USD'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Density'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_6_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see from the plot of the log data that the distribution of fares has a mode at roughly <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.533ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 4535 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-157-Title">
<title id="MathJax-SVG-157-Title"> e^2 = \$7.40 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="659" y="513"></use>
 <use xlink:href="#MJMAIN-3D" x="1198" y="0"></use>
 <use xlink:href="#MJMAIN-24" x="2254" y="0"></use>
<g transform="translate(2754,0)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span> and a smaller mode at roughly <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.975ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 5586.3 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-158-Title">
<title id="MathJax-SVG-158-Title"> e^{3.4} = \$30.00 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="1749" y="0"></use>
 <use xlink:href="#MJMAIN-24" x="2805" y="0"></use>
<g transform="translate(3305,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
</g>
</g>
</svg></span>. Why does plotting the natural log of the data help with skew? The logarithms of large numbers tend be close to the logarithms of small numbers:</p>
<table>
<thead><tr>
<th>value</th>
<th>log(value)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0.00</td>
</tr>
<tr>
<td>10</td>
<td>2.30</td>
</tr>
<tr>
<td>50</td>
<td>3.91</td>
</tr>
<tr>
<td>100</td>
<td>4.60</td>
</tr>
<tr>
<td>500</td>
<td>6.21</td>
</tr>
<tr>
<td>1000</td>
<td>6.90</td>
</tr>
</tbody>
</table>
<p>This means that taking the logarithm of right-tailed data will bring large values close to small values. This helps see patterns where the majority of the data lie.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In fact, the logarithm is considered the Swiss army knife of data tranformation—it also helps us see the nature of non-linear relationships between variables in the data. In 1619, Kepler recorded down the following set of data to discover his Third Law of Planetary Motion:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">planets</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"data/planets.data"</span><span class="p">,</span> <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">comment</span><span class="o">=</span><span class="s2">"#"</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">planets</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>planet</th>
<th>mean_dist</th>
<th>period</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Mercury</td>
<td>0.389</td>
<td>87.77</td>
</tr>
<tr>
<th>1</th>
<td>Venus</td>
<td>0.724</td>
<td>224.70</td>
</tr>
<tr>
<th>2</th>
<td>Earth</td>
<td>1.000</td>
<td>365.25</td>
</tr>
<tr>
<th>3</th>
<td>Mars</td>
<td>1.524</td>
<td>686.95</td>
</tr>
<tr>
<th>4</th>
<td>Jupiter</td>
<td>5.200</td>
<td>4332.62</td>
</tr>
<tr>
<th>5</th>
<td>Saturn</td>
<td>9.510</td>
<td>10759.20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we plot the mean distance to the sun against the period of the orbit, we can see a relationship that doesn't quite look linear:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'mean_dist'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'period'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">planets</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;seaborn.axisgrid.FacetGrid at 0x1a1f54aba8&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_11_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, if we take the natural log of both mean distance and period, we obtain the following plot:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'mean_dist'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'period'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">planets</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]),</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;seaborn.axisgrid.FacetGrid at 0x1a1f693da0&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_13_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see a near-perfect linear relationship between the logged values of mean distance and period. What does this mean? Since we believe there's a linear relationship between the logged values, we can derive:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="68.589ex" height="12.509ex" style="vertical-align: -5.671ex;" viewBox="0 -2944.1 29531.2 5385.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-159-Title">
<title id="MathJax-SVG-159-Title">
\begin{aligned}
\log(period) &amp;= m \log(dist) + b \\
period &amp;= e^{m \log(dist) + b} &amp; \text{Taking the exponent of both sides} \\
period &amp;= e^b dist^m \\
period &amp;= C \cdot dist^m
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2053)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1279" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1669" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="2172" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="2639" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="3090" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="3436" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="3921" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4445" y="0"></use>
</g>
<g transform="translate(2058,558)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="503" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="970" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="1421" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="1767" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="2252" y="0"></use>
</g>
<g transform="translate(2058,-854)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="503" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="970" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="1421" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="1767" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="2252" y="0"></use>
</g>
<g transform="translate(2058,-2154)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="503" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="970" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="1421" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="1767" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="2252" y="0"></use>
</g>
</g>
<g transform="translate(4824,0)">
<g transform="translate(0,2053)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-6D" x="1334" y="0"></use>
<g transform="translate(2379,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3658" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="4048" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="4571" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="4917" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="5386" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5748" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="6359" y="0"></use>
 <use xlink:href="#MJMATHI-62" x="7360" y="0"></use>
</g>
<g transform="translate(0,558)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,412)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="0" y="0"></use>
<g transform="translate(787,0)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6C"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6F" x="278" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-67" x="779" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="2393" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-64" x="2783" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="3306" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-73" x="3652" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="4121" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="4483" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="4872" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-62" x="5651" y="0"></use>
</g>
</g>
</g>
<g transform="translate(0,-854)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-62" x="659" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-64" x="2204" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="2727" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="3073" y="0"></use>
<g transform="translate(3542,0)">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="511" y="583"></use>
</g>
</g>
<g transform="translate(0,-2154)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2316" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="2817" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="3341" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="3686" y="0"></use>
<g transform="translate(4156,0)">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6D" x="511" y="583"></use>
</g>
</g>
</g>
<g transform="translate(14614,0)">
<g transform="translate(0,558)">
 <use xlink:href="#MJMAIN-54"></use>
 <use xlink:href="#MJMAIN-61" x="722" y="0"></use>
 <use xlink:href="#MJMAIN-6B" x="1223" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1751" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2030" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2586" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3337" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="3726" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="4283" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="4977" y="0"></use>
 <use xlink:href="#MJMAIN-78" x="5422" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="5950" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="6507" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="7007" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7564" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="8008" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="8565" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="9204" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="9705" y="0"></use>
 <use xlink:href="#MJMAIN-62" x="10261" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="10818" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="11318" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="11708" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="12514" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="12909" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="13187" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="13744" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="14188" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>We replaced <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.021ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 870.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-160-Title">
<title id="MathJax-SVG-160-Title"> e^b </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-62" x="659" y="513"></use>
</g>
</svg></span> with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-161-Title">
<title id="MathJax-SVG-161-Title"> C </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> in the last step to represent <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.021ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 870.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-162-Title">
<title id="MathJax-SVG-162-Title"> e^b </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-62" x="659" y="513"></use>
</g>
</svg></span> as a constant. The algebraic manipulation above shows that when two variables have a polynomial relationship, the log of the two variables has a linear relationship. In fact, we can find the degree of the polynomial by examining the slope of the line. In this case, the slope is 1.5 which gives us Kepler's third law: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.917ex" height="2.843ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -934.9 6853.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-163-Title">
<title id="MathJax-SVG-163-Title"> period \propto dist^{1.5} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="503" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="970" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="1421" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="1767" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="2252" y="0"></use>
 <use xlink:href="#MJMAIN-221D" x="3053" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="4110" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="4633" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="4979" y="0"></use>
<g transform="translate(5448,0)">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
<g transform="translate(361,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</g>
</svg></span>.</p>
<p>By a similar derivation we can also show that if the relationship between the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.937ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2556 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-164-Title">
<title id="MathJax-SVG-164-Title"> \log(y) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6F" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1279" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2166" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-165-Title">
<title id="MathJax-SVG-165-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is linear, the two variables have an exponential relationship: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.656ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2865.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-166-Title">
<title id="MathJax-SVG-166-Title"> y = a^x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
<g transform="translate(1831,0)">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="748" y="513"></use>
</g>
</g>
</svg></span>.</p>
<p>Thus, we can use the logarithm to reveal patterns in right-tailed data and common non-linear relationships between variables.</p>
<p>Other common data transformations include the Box-Cox transformation and polynomial transforms.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Context">Principles of Context<a class="anchor-link" href="#Principles-of-Context">¶</a></h3><p>It is important to add as much relevant context as possible to any plot you plan to share more broadly. For example, the following plot shows its data clearly but provides little context to help understand what is being plotted.</p>
<p><img alt="https://github.com/DS-100/textbook/raw/master/assets/viz_538_before.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_538_before.png"></p>
<p>To provide context, we add a title, caption, axes labels, units for the axes, and labels for the plotted lines.</p>
<p><img alt="https://github.com/DS-100/textbook/raw/master/assets/viz_538_after.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_538_after.png"></p>
<p>(<a href="https://www.dataquest.io/blog/making-538-plots/">This blog post</a> explains how to make these modifications using <code>matplotlib</code>.)</p>
<p>In general, we provide context for a plot through:</p>
<ul>
<li>Plot title</li>
<li>Axes labels</li>
<li>Reference lines and markers for important values</li>
<li>Labels for interesting points and unusual observations</li>
<li>Captions that describe the data and its important features</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Principles-of-Smoothing">Principles of Smoothing<a class="anchor-link" href="#Principles-of-Smoothing">¶</a></h3><p>Smoothing allows us to more clearly visualize data when we have many data points. We've actually already seen an instance of smoothing: histograms are a type of smoothing for rugplots. This rugplot shows each age of the passengers in the Titanic.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ages</span> <span class="o">=</span> <span class="n">ti</span><span class="p">[</span><span class="s1">'age'</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a20c05b38&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_17_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are many marks that make it difficult to tell where the data lie. In addition, some of the points overlap, making it impossible to see how many points lie at 0. This issue is called <em>overplotting</em> and we generally avoid it whenever possible.</p>
<p>To reveal the distribution of the data, we can replace groups of marks with a bar that is taller when more points are in the group. Smoothing refers to this process of replacing sets of points with appropriate markers; we choose not to show every single point in the dataset in order to reveal broader trends.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a23c384e0&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_19_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've also seen that <code>seaborn</code> will plot a smooth curve over a histogram by default.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a23d89780&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_21_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is another form of smoothing called <em>kernel density estimation</em> (KDE). Instead of grouping points together and plotting bars, KDE places a curve on each point and combines the individual curves to create a final estimation of the distribution. Consider the rugplot below that shows three points.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_23_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To perform KDE, we place a Gaussian (normal) distribution on each point:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">norm</span>

<span class="k">def</span> <span class="nf">gaussians</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
    <span class="n">x_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">point</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">point</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">]</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">point</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sd</span><span class="p">)</span> <span class="k">for</span> <span class="n">xs</span><span class="p">,</span> <span class="n">point</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">points</span><span class="p">)]</span>
    <span class="k">if</span> <span class="n">scale</span><span class="p">:</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">ys</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="k">for</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">y_vals</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>

<span class="k">for</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">gaussians</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_25_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The area under each Gaussian curve is equal to 1. Since we will sum multiple curves together, we scale each curve so that when added together the area under all the curves is equal to 1.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">for</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">gaussians</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_27_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we add the curves together to create a final smooth estimate for the distribution:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_29_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By following this procedure, we can use KDE to smooth many points.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Show the original unsmoothed points</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="c1"># Show the smooth estimation of the distribution</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ages</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_31_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Kernel-Density-Estimation-Details">Kernel Density Estimation Details<a class="anchor-link" href="#Kernel-Density-Estimation-Details">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the previous examples of KDE, we placed a miniature Gaussian curve on each point and added the Gaussians together.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">for</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">gaussians</span><span class="p">(</span><span class="n">points</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_34_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are free to adjust the width of the Gaussians. For example, we can make each Gaussian narrower. This is called decreasing the <em>bandwidth</em> of the kernel estimation.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">for</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">gaussians</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">sd</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_36_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When we add these narrower Gaussians together, we create a more detailed final estimation.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_38_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot the KDE for Titanic passenger ages using a lower bandwidth</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_39_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just like adjusting bins for a histogram, we typically adjust the bandwidth until we believe the final plot shows the distribution without distracting the viewer with too much detail.</p>
<p>Although we have placed a Gaussian at each point so far, we can easily select other functions to estimate each point. This is called changing the <em>kernel</em> of the kernel density estimation. Previously, we've used a Gaussian kernel. Now, we'll use a triangular kernel which places a pair of stepwise sloped lines at each point:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">'tri'</span><span class="p">,</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x1a26eb3908&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_41_1.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot the KDE for Titanic passenger ages using a triangular kernel</span>
<span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span> <span class="n">kernel</span><span class="o">=</span><span class="s1">'tri'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_42_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Usually we'll use a Gaussian kernel unless we have a specific reason to use a different kernel.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Smoothing-a-Scatter-Plot">Smoothing a Scatter Plot<a class="anchor-link" href="#Smoothing-a-Scatter-Plot">¶</a></h4><p>We can also smooth two-dimensional plots when we encounter the problem of overplotting.</p>
<p>The following example comes from a dataset released by the Cherry Blossom Run, an annual 10-mile run in Washington D.C. Each runner can report their age and their race time; we've plotted all the reported data points in the scatter plot below.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">runners</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'data/cherryBlossomMen.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">runners</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>year</th>
<th>place</th>
<th>age</th>
<th>time</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1999</td>
<td>1</td>
<td>28.0</td>
<td>2819.0</td>
</tr>
<tr>
<th>1</th>
<td>1999</td>
<td>2</td>
<td>24.0</td>
<td>2821.0</td>
</tr>
<tr>
<th>2</th>
<td>1999</td>
<td>3</td>
<td>27.0</td>
<td>2823.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>70066</th>
<td>2012</td>
<td>7190</td>
<td>56.0</td>
<td>8840.0</td>
</tr>
<tr>
<th>70067</th>
<td>2012</td>
<td>7191</td>
<td>35.0</td>
<td>8850.0</td>
</tr>
<tr>
<th>70069</th>
<td>2012</td>
<td>7193</td>
<td>48.0</td>
<td>9059.0</td>
</tr>
</tbody>
</table>
<p>70045 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'time'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">runners</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_46_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So many points lie on top of each other that it's difficult to see any trend at all!</p>
<p>We can smooth the scatter plot using kernel density estimation in two dimensions. When KDE is applied to a two-dimensional plot, we place a three-dimensional Gaussian at each point. In three dimensions, the Gaussian looks like a mountain pointing out of the page.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Plot three points</span>
<span class="n">two_d_points</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'x'</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s1">'y'</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]})</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">two_d_points</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_48_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Place a Gaussian at each point and use a contour plot to show each one</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">two_d_points</span><span class="p">[</span><span class="s1">'x'</span><span class="p">],</span> <span class="n">two_d_points</span><span class="p">[</span><span class="s1">'y'</span><span class="p">],</span> <span class="n">bw</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_49_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Just like we've previously seen, we scale each Gaussian and add them together to obtain a final contour plot for the scatter plot.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">two_d_points</span><span class="p">[</span><span class="s1">'x'</span><span class="p">],</span> <span class="n">two_d_points</span><span class="p">[</span><span class="s1">'y'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_51_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The resulting plot shows the downward sloping trend of the three points. Similarly, we can apply a KDE to smooth out the scatter plot of runner ages and times:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">runners</span><span class="p">[</span><span class="s1">'age'</span><span class="p">],</span> <span class="n">runners</span><span class="p">[</span><span class="s1">'time'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">70</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/viz_principles_2_53_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that most of our runners were between 25 and 50 years old, and that most runners took between 4000 and 7000 seconds (roughly between 1 and 2 hours) to finish the race.</p>
<p>We can see more clearly that there is a suspicious group of runners that are between zero and ten years old. We might want to double check that our data for those ages was recorded properly.</p>
<p>We can also see a slight upward trend in the time taken to finish the race as runner age increases.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/06'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Philosophy-for-Data-Visualization">Philosophy for Data Visualization<a class="anchor-link" href="#Philosophy-for-Data-Visualization">¶</a></h2><p>Unfortunately, many charts in the world at large do not adhere to our
principles for data visualization. Here is a page of charts that appear on the
first page of a Google search for "good data visualization" conducted in Spring
of 2018. How many poorly made charts can you spot?</p>
<p><img alt="https://github.com/DS-100/textbook/raw/master/assets/viz_google.png" src="https://github.com/DS-100/textbook/raw/master/assets/viz_google.png"></p>
<p>Effective data visualization reveals the data. All of our principles for
visualization aim to make the data more understandable for the viewer. Data
visualization is sometimes used to mislead and misinform. When done properly,
however, data visualization is one of our greatest tools for discovering,
revealing, and communicating trends and anomalies in our data.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/07'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Web-Technologies">Web Technologies<a class="anchor-link" href="#Web-Technologies">¶</a></h1><p>Before the Internet, data scientists had to physically move hard disk drives to
share data with others. Now, we can freely retrieve datasets from computers
across the world.</p>
<p>Although we use the Internet to download and share data files, the web pages on
the Internet themselves contain huge amounts of information as text, images,
and videos. By learning web technologies, we can use the Web as a data source.
In this chapter, we introduce HTTP, the primary communication protocol for the
Web, and XML/HTML, the primary document formats for web pages.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/07'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="HTTP">HTTP<a class="anchor-link" href="#HTTP">¶</a></h2><p>HTTP (AKA <strong>H</strong>yper<strong>T</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol) is a <em>request-response</em> protocol that allows one computer to talk to another over the Internet.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Requests-and-Responses">Requests and Responses<a class="anchor-link" href="#Requests-and-Responses">¶</a></h2><p>The Internet allows computers to send text to one another, but does not impose any restrictions on what that text contains. HTTP defines a structure on the text communication between one computer (client) and another (server). In this protocol, a client submits a <em>request</em> to a server, a specially formatted text message. The server sends a text <em>response</em> back to the client.</p>
<p>The command line tool <code>curl</code> gives us a simple way to send HTTP requests. In the output below, lines starting with <code>&gt;</code> indicate the text sent in our request; the remaining lines are the server's response.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span>$ curl -v https://httpbin.org/html
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<pre><code>&gt; GET /html HTTP/1.1
&gt; Host: httpbin.org
&gt; User-Agent: curl/7.55.1
&gt; Accept: */*
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Connection: keep-alive
&lt; Server: meinheld/0.6.1
&lt; Date: Wed, 11 Apr 2018 18:15:03 GMT
&lt; 
&lt;html&gt;
  &lt;body&gt;
    &lt;h1&gt;Herman Melville - Moby-Dick&lt;/h1&gt;
    &lt;p&gt;
      Availing himself of the mild...
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running the <code>curl</code> command above causes the client's computer to construct a text message that looks like:</p>
<pre><code>GET /html HTTP/1.1
Host: httpbin.org
User-Agent: curl/7.55.1
Accept: */*
{blank_line}</code></pre>
<p>This message follows a specific format: it starts with <code>GET /html HTTP/1.1</code> which indicates that the message is an HTTP <code>GET</code> request to the <code>/html</code> page. Each of the three lines that follow form HTTP headers, optional information that <code>curl</code> sends to the server. The HTTP headers have the format <code>{name}: {value}</code>. Finally, the blank line at the end of the message tells the server that the message ends after three headers. Note that we've marked the blank line with <code>{blank_line}</code> in the snippet above; in the actual message <code>{blank_line}</code> is replaced with a blank line.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The client's computer then uses the Internet to send this message to the <code>https://httpbin.org</code> web server. The server processes the request, and sends the following response:</p>
<pre><code>HTTP/1.1 200 OK
Connection: keep-alive
Server: meinheld/0.6.1
Date: Wed, 11 Apr 2018 18:15:03 GMT
{blank_line}</code></pre>
<p>The first line of the response states that the request completed successfully. The following three lines form the HTTP response headers, optional information that the server sends back to the client. Finally, the blank line at the end of the message tells the client that the server has finished sending its response headers and will next send the response body:</p>
<pre><code>&lt;html&gt;
  &lt;body&gt;
    &lt;h1&gt;Herman Melville - Moby-Dick&lt;/h1&gt;
    &lt;p&gt;
      Availing himself of the mild...
    &lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This HTTP protocol is used in almost every application that interacts with the Internet. For example, visiting <a href="https://httpbin.org/html">https://httpbin.org/html</a> in your web browser makes the same basic HTTP request as the <code>curl</code> command above. Instead of displaying the response as plain text as we have above, your browser recognizes that the text is an HTML document and will display it accordingly.</p>
<p>In practice, we will not write out full HTTP requests in text. Instead, we use tools like <code>curl</code> or Python libraries to construct requests for us.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="In-Python">In Python<a class="anchor-link" href="#In-Python">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The Python <strong>requests</strong> library allows us to make HTTP requests in Python. The code below makes the same HTTP request as running <code>curl -v https://httpbin.org/html</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://httpbin.org/html"</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">response</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;Response [200]&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Request">The Request<a class="anchor-link" href="#The-Request">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's take a closer look at the request we made. We can access the original request using <code>response</code> object; we display the request's HTTP headers below:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">request</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">request</span>
<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">request</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span> <span class="c1"># The headers in the response are stored as a dictionary.</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'</span><span class="si">{key}</span><span class="s1">: </span><span class="si">{request.headers[key]}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>User-Agent: python-requests/2.12.4
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Every HTTP request has a type. In this case, we used a <code>GET</code> request which retrieves information from a server.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">request</span><span class="o">.</span><span class="n">method</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'GET'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Response">The Response<a class="anchor-link" href="#The-Response">¶</a></h3><p>Let's examine the response we received from the server. First, we will print the response's HTTP headers.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'</span><span class="si">{key}</span><span class="s1">: </span><span class="si">{response.headers[key]}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Connection: keep-alive
Server: gunicorn/19.7.1
Date: Wed, 25 Apr 2018 18:32:51 GMT
Content-Type: text/html; charset=utf-8
Content-Length: 3741
Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true
X-Powered-By: Flask
X-Processed-Time: 0
Via: 1.1 vegur
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An HTTP response contains a status code, a special number that indicates whether the request succeeded or failed. The status code <code>200</code> indicates that the request succeeded.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>200</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we display the first 100 characters of the response's content (the entire response content is too long to display nicely here).</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">[:</span><span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n  &lt;head&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n      &lt;h1&gt;Herman Melville - Moby-Dick&lt;/h1&gt;\n\n     '</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Types-of-Requests">Types of Requests<a class="anchor-link" href="#Types-of-Requests">¶</a></h2><p>The request we made above was a <code>GET</code> HTTP request. There are multiple HTTP request types; the most important two are <code>GET</code> and <code>POST</code> requests.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="GET-Requests">GET Requests<a class="anchor-link" href="#GET-Requests">¶</a></h3><p>The <code>GET</code> request is used to retrieve information from the server. Since your web browser makes <code>GET</code> request whenever you enter in a URL into its address bar, <code>GET</code> requests are the most common type of HTTP requests.</p>
<p><code>curl</code> uses <code>GET</code> requests by default, so running <code>curl https://www.google.com/</code> makes a <code>GET</code> request to <code>https://www.google.com/</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="POST-Request">POST Request<a class="anchor-link" href="#POST-Request">¶</a></h3><p>The <code>POST</code> request is used to send information from the client to the server. For example, some web pages contain forms for the user to fill out—a login form, for example. After clicking the "Submit" button, most web browsers will make a <code>POST</code> request to send the form data to the server for processing.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look an example of a <code>POST</code> request that sends <code>'sam'</code> as the parameter <code>'name'</code>. This one can be done by running <strong><code>curl -d 'name=sam' https://httpbin.org/post</code></strong> on the command line.</p>
<p>Notice that our request has a body this time (filled with the parameters of the <code>POST</code> request), and the content of the response is different from our <code>GET</code> response from before.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like HTTP headers, the data sent in a <code>POST</code> request uses a key-value format. In Python, we can make a <code>POST</code> request by using <code>requests.post</code> and passing in a dictionary as an argument.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="s2">"https://httpbin.org/post"</span><span class="p">,</span>
                              <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">'name'</span><span class="p">:</span> <span class="s1">'sam'</span><span class="p">})</span>
<span class="n">post_response</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;Response [200]&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The server will respond with a status code to indicate whether the <code>POST</code> request successfully completed. In addition, the server will usually send a response body to display to the client.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_response</span><span class="o">.</span><span class="n">status_code</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>200</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">post_response</span><span class="o">.</span><span class="n">text</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'{\n  "args": {}, \n  "data": "", \n  "files": {}, \n  "form": {\n    "name": "sam"\n  }, \n  "headers": {\n    "Accept": "*/*", \n    "Accept-Encoding": "gzip, deflate", \n    "Connection": "close", \n    "Content-Length": "8", \n    "Content-Type": "application/x-www-form-urlencoded", \n    "Host": "httpbin.org", \n    "User-Agent": "python-requests/2.12.4"\n  }, \n  "json": null, \n  "origin": "136.152.143.72", \n  "url": "https://httpbin.org/post"\n}\n'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Types-of-Response-Status-Codes">Types of Response Status Codes<a class="anchor-link" href="#Types-of-Response-Status-Codes">¶</a></h2><p>The previous HTTP responses had the HTTP status code <code>200</code>. This status code indicates that the request completed successfully. There are hundreds of other HTTP status codes. Thankfully, they are grouped into categories to make them easier to remember:</p>
<ul>
<li><strong>100s</strong> - Informational: More input is expected from client or server <em>(e.g. 100 Continue, 102 Processing)</em></li>
<li><strong>200s</strong> - Success: The client's request was successful <em>(e.g. 200 OK, 202 Accepted)</em></li>
<li><strong>300s</strong> - Redirection: Requested URL is located elsewhere; May need user's further action <em>(e.g. 300 Multiple Choices, 301 Moved Permanently)</em></li>
<li><strong>400s</strong> - Client Error: Client-side error <em>(e.g. 400 Bad Request, 403 Forbidden, 404 Not Found)</em></li>
<li><strong>500s</strong> - Server Error: Server-side error or server is incapable of performing the request <em>(e.g. 500 Internal Server Error, 503 Service Unavailable)</em></li>
</ul>
<p>We can look at examples of some of these errors.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This page doesn't exist, so we get a 404 page not found error</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://www.youtube.com/404errorwow"</span>
<span class="n">errorResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">errorResponse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;Response [404]&gt;
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This specific page results in a 500 server error</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">"https://httpstat.us/500"</span>
<span class="n">serverResponse</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">serverResponse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;Response [500]&gt;
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have introduced the HTTP protocol, the basic communication method for applications that use the Web. Although the protocol specifies a specific text format, we typically turn to other tools to make HTTP requests for us, such as the command line tool <code>curl</code> and the Python library <code>requests</code>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/08'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Working-with-Text">Working with Text<a class="anchor-link" href="#Working-with-Text">¶</a></h1><p>A great quantity of data resides not as numbers in CSVs but as free-form text
in books, documents, blog posts, and Internet comments. While numerical and
categorical data are often collected from physical phenomena, textual data
arises from human communication and expression. As with most types of data,
there are a multitude of techniques for working with text that would take
multiple books to explain in full detail. In this chapter, we introduce a small
subset of these techniques that provide a variety of useful operations for
working with text: Python string manipulation and regular expressions.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/08'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python-String-Methods">Python String Methods<a class="anchor-link" href="#Python-String-Methods">¶</a></h2><p>Python provides a variety of methods for basic string manipulation. Although simple, these methods form the primitives that piece together to form more complex string operations. We will introduce Python's string methods in the context of a common use case for working with text: data cleaning.</p>
<h2 id="Cleaning-Text-Data">Cleaning Text Data<a class="anchor-link" href="#Cleaning-Text-Data">¶</a></h2><p>Data often comes from several different sources that each implements its own way of encoding information. In the following example, we have one table that records the state that a county belongs to and another that records the population of the county.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'County'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'De Witt County'</span><span class="p">,</span>
        <span class="s1">'Lac qui Parle County'</span><span class="p">,</span>
        <span class="s1">'Lewis and Clark County'</span><span class="p">,</span>
        <span class="s1">'St John the Baptist Parish'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'State'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'IL'</span><span class="p">,</span>
        <span class="s1">'MN'</span><span class="p">,</span>
        <span class="s1">'MT'</span><span class="p">,</span>
        <span class="s1">'LA'</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">})</span>
<span class="n">population</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'County'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'DeWitt  '</span><span class="p">,</span>
        <span class="s1">'Lac Qui Parle'</span><span class="p">,</span>
        <span class="s1">'Lewis &amp; Clark'</span><span class="p">,</span>
        <span class="s1">'St. John the Baptist'</span><span class="p">,</span>
    <span class="p">],</span>
    <span class="s1">'Population'</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">'16,798'</span><span class="p">,</span>
        <span class="s1">'8,067'</span><span class="p">,</span>
        <span class="s1">'55,716'</span><span class="p">,</span>
        <span class="s1">'43,044'</span><span class="p">,</span>
    <span class="p">]</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>County</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>De Witt County</td>
<td>IL</td>
</tr>
<tr>
<th>1</th>
<td>Lac qui Parle County</td>
<td>MN</td>
</tr>
<tr>
<th>2</th>
<td>Lewis and Clark County</td>
<td>MT</td>
</tr>
<tr>
<th>3</th>
<td>St John the Baptist Parish</td>
<td>LA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">population</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>County</th>
<th>Population</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>DeWitt</td>
<td>16,798</td>
</tr>
<tr>
<th>1</th>
<td>Lac Qui Parle</td>
<td>8,067</td>
</tr>
<tr>
<th>2</th>
<td>Lewis &amp; Clark</td>
<td>55,716</td>
</tr>
<tr>
<th>3</th>
<td>St. John the Baptist</td>
<td>43,044</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would naturally like to join the <code>state</code> and <code>population</code> tables using the <code>County</code> column. Unfortunately, not a single county is spelled the same in the two tables. This example is illustrative of the following common issues in text data:</p>
<ol>
<li>Capitalization: <code>qui</code> vs <code>Qui</code></li>
<li>Different punctuation conventions: <code>St.</code> vs <code>St</code> </li>
<li>Omission of words: <code>County</code>/<code>Parish</code> is absent in the <code>population</code> table</li>
<li>Use of whitespace: <code>DeWitt</code> vs <code>De Witt</code></li>
<li>Different abbreviation conventions: <code>&amp;</code> vs <code>and</code></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="String-Methods">String Methods<a class="anchor-link" href="#String-Methods">¶</a></h2><p>Python's string methods allow us to start resolving these issues. These methods are conveniently defined on all Python strings and thus do not require importing other modules. Although it is worth familiarizing yourself with <a href="https://docs.python.org/3/library/stdtypes.html#string-methods">the complete list of string methods</a>, we describe a few of the most commonly used methods in the table below.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>Method</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>str[x:y]</code></td>
<td>Slices <code>str</code>, returning indices x (inclusive) to y (not inclusive)</td>
</tr>
<tr>
<td><code>str.lower()</code></td>
<td>Returns a copy of a string with all letters converted to lowercase</td>
</tr>
<tr>
<td><code>str.replace(a, b)</code></td>
<td>Replaces all instances of the substring <code>a</code> in <code>str</code> with the substring <code>b</code></td>
</tr>
<tr>
<td><code>str.split(a)</code></td>
<td>Returns substrings of <code>str</code> split at a substring <code>a</code></td>
</tr>
<tr>
<td><code>str.strip()</code></td>
<td>Removes leading and trailing whitespace from <code>str</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We select the string for St. John the Baptist parish from the <code>state</code> and <code>population</code> tables and apply string methods to remove capitalization, punctuation, and <code>county</code>/<code>parish</code> occurrences.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">john1</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s1">'County'</span><span class="p">]</span>
<span class="n">john2</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">'County'</span><span class="p">]</span>

<span class="p">(</span><span class="n">john1</span>
 <span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 <span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'stjohnthebaptist'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Applying the same set of methods to <code>john2</code> allows us to verify that the two strings are now identical.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">john1</span>
 <span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 <span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'stjohnthebaptist'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Satisfied, we create a method called <code>clean_county</code> that normalizes an input county.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">clean_county</span><span class="p">(</span><span class="n">county</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">county</span>
            <span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
            <span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may now verify that the <code>clean_county</code> method produces matching counties for all the counties in both tables:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">([</span><span class="n">clean_county</span><span class="p">(</span><span class="n">county</span><span class="p">)</span> <span class="k">for</span> <span class="n">county</span> <span class="ow">in</span> <span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]],</span>
 <span class="p">[</span><span class="n">clean_county</span><span class="p">(</span><span class="n">county</span><span class="p">)</span> <span class="k">for</span> <span class="n">county</span> <span class="ow">in</span> <span class="n">population</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(['dewitt', 'lacquiparle', 'lewisandclark', 'stjohnthebaptist'],
 ['dewitt', 'lacquiparle', 'lewisandclark', 'stjohnthebaptist'])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Because each county in both tables has the same transformed representation, we may successfully join the two tables using the transformed county names.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="String-Methods-in-pandas">String Methods in pandas<a class="anchor-link" href="#String-Methods-in-pandas">¶</a></h2><p>In the code above we used a loop to transform each county name. <code>pandas</code> Series objects provide a convenient way to apply string methods to each item in the series. First, the series of county names in the <code>state</code> table:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0                De Witt County
1          Lac qui Parle County
2        Lewis and Clark County
3    St John the Baptist Parish
Name: County, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>.str</code> property on <code>pandas</code> Series exposes the same string methods as Python does. Calling a method on the <code>.str</code> property calls the method on each item in the series.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0                de witt county
1          lac qui parle county
2        lewis and clark county
3    st john the baptist parish
Name: County, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This allows us to transform each string in the series without using a loop.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0              dewitt
1         lacquiparle
2       lewisandclark
3    stjohnthebaptist
Name: County, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We save the transformed counties back into their originating tables:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">population</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="s1">'County'</span><span class="p">]</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' parish'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' county'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&amp;'</span><span class="p">,</span> <span class="s1">'and'</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
 <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, the two tables contain the same string representation of the counties:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>County</th>
<th>State</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>dewitt</td>
<td>IL</td>
</tr>
<tr>
<th>1</th>
<td>lacquiparle</td>
<td>MN</td>
</tr>
<tr>
<th>2</th>
<td>lewisandclark</td>
<td>MT</td>
</tr>
<tr>
<th>3</th>
<td>stjohnthebaptist</td>
<td>LA</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">population</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>County</th>
<th>Population</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>dewitt</td>
<td>16,798</td>
</tr>
<tr>
<th>1</th>
<td>lacquiparle</td>
<td>8,067</td>
</tr>
<tr>
<th>2</th>
<td>lewisandclark</td>
<td>55,716</td>
</tr>
<tr>
<th>3</th>
<td>stjohnthebaptist</td>
<td>43,044</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is simple to join these tables once the counties match.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">state</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">population</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'County'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>County</th>
<th>State</th>
<th>Population</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>dewitt</td>
<td>IL</td>
<td>16,798</td>
</tr>
<tr>
<th>1</th>
<td>lacquiparle</td>
<td>MN</td>
<td>8,067</td>
</tr>
<tr>
<th>2</th>
<td>lewisandclark</td>
<td>MT</td>
<td>55,716</td>
</tr>
<tr>
<th>3</th>
<td>stjohnthebaptist</td>
<td>LA</td>
<td>43,044</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Python's string methods form a set of simple and useful operations for string manipulation. <code>pandas</code> Series implement the same methods that apply the underlying Python method to each string in the series.</p>
<p>You may find the complete docs on Python's <code>string</code> methods <a href="https://docs.python.org/3/library/stdtypes.html#string-methods">here</a> and the docs on Pandas <code>str</code> methods <a href="https://pandas.pydata.org/pandas-docs/stable/text.html#method-summary">here</a>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/08'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regular-Expressions">Regular Expressions<a class="anchor-link" href="#Regular-Expressions">¶</a></h2><p>In this section we introduce regular expressions, an important tool to specify patterns in strings.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Motivation">Motivation<a class="anchor-link" href="#Motivation">¶</a></h2><p>In a larger piece of text, many useful substrings come in a specific format. For instance, the sentence below contains a U.S. phone number.</p>
<p><code>"give me a call, my number is 123-456-7890."</code></p>
<p>The phone number contains the following pattern:</p>
<ol>
<li>Three numbers</li>
<li>Followed by a dash</li>
<li>Followed by three numbers</li>
<li>Followed by a dash</li>
<li>Followed by four Numbers</li>
</ol>
<p>Given a free-form segment of text, we might naturally wish to detect and extract the phone numbers. We may also wish to extract specific pieces of the phone numbers—for example, by extracting the area code we may deduce the locations of individuals mentioned in the text.</p>
<p>To detect whether a string contains a phone number, we may attempt to write a method like the following:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">is_phone_number</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    
    <span class="n">digits</span> <span class="o">=</span> <span class="s1">'0123456789'</span>
    
    <span class="k">def</span> <span class="nf">is_not_digit</span><span class="p">(</span><span class="n">token</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">digits</span> 
    
    <span class="c1"># Three numbers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_not_digit</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
    
    <span class="c1"># Followed by a dash</span>
    <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'-'</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="c1"># Followed by three numbers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_not_digit</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
        
    <span class="c1"># Followed by a dash    </span>
    <span class="k">if</span> <span class="n">string</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">'-'</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    
    <span class="c1"># Followed by four numbers</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_not_digit</span><span class="p">(</span><span class="n">string</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
            <span class="k">return</span> <span class="kc">False</span>
    
    <span class="k">return</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_phone_number</span><span class="p">(</span><span class="s2">"382-384-3840"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">is_phone_number</span><span class="p">(</span><span class="s2">"phone number"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The code above is unpleasant and verbose. Rather than manually loop through the characters of the string, we would prefer to specify a pattern and command Python to match the pattern.</p>
<p><strong>Regular expressions</strong> (often abbreviated <strong>regex</strong>) conveniently solve this exact problem by allowing us to create general patterns for strings. Using a regular expression, we may re-implement the <code>is_phone_number</code> method in two short lines of Python:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">is_phone_number</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{4}</span><span class="s2">"</span>
    <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="n">string</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

<span class="n">is_phone_number</span><span class="p">(</span><span class="s2">"382-384-3840"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the code above, we use the regex <code>[0-9]{3}-[0-9]{3}-[0-9]{4}</code> to match phone numbers. Although cryptic at a first glance, the syntax of regular expressions is fortunately much simpler to learn than the Python language itself; we introduce nearly all of the syntax in this section alone.</p>
<p>We will also introduce the built-in Python module <code>re</code> that performs string operations using regexes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regex-Syntax">Regex Syntax<a class="anchor-link" href="#Regex-Syntax">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We start with the syntax of regular expressions. In Python, regular expressions are most commonly stored as raw strings. Raw strings behave like normal Python strings without special handling for backslashes.</p>
<p>For example, to store the string <code>hello \ world</code> in a normal Python string, we must write:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Backslashes need to be escaped in normal Python strings</span>
<span class="n">some_string</span> <span class="o">=</span> <span class="s1">'hello </span><span class="se">\\</span><span class="s1"> world'</span>
<span class="nb">print</span><span class="p">(</span><span class="n">some_string</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>hello \ world
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using a raw string removes the need to escape the backslash:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Note the `r` prefix on the string</span>
<span class="n">some_raw_string</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'hello \ world'</span>
<span class="nb">print</span><span class="p">(</span><span class="n">some_raw_string</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>hello \ world
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since backslashes appear often in regular expressions, we will use raw strings for all regexes in this section.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Literals">Literals<a class="anchor-link" href="#Literals">¶</a></h3><p>A <strong>literal</strong> character in a regular expression matches the character itself. For example, the regex <code>r"a"</code> will match any <code>"a"</code> in <code>"Say! I like green eggs and ham!"</code>. All alphanumeric characters and most punctuation characters are regex literals.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">show_regex_match</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">regex</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Prints the string with the regex match highlighted.</span>
<span class="sd">    """</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">f</span><span class="s1">'(</span><span class="si">{regex}</span><span class="s1">)'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'\033[1;30;43m\1\033[m'</span><span class="p">,</span> <span class="n">text</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># The show_regex_match method highlights all regex matches in the input string</span>
<span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"green"</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Say! I like green eggs and ham!"</span><span class="p">,</span> <span class="n">regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Say! I like <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">green</span> eggs and ham!
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Say! I like green eggs and ham!"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"a"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>S<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">a</span>y! I like green eggs <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">a</span>nd h<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">a</span>m!
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the example above we observe that regular expressions can match patterns that appear anywhere in the input string. In Python, this behavior differs depending on the method used to match the regex—some methods only return a match if the regex appears at the start of the string; some methods return a match anywhere in the string.</p>
<p>Notice also that the <code>show_regex_match</code> method highlights all occurrences of the regex in the input string. Again, this differs depending on the Python method used—some methods return all matches while some only return the first match.</p>
<p>Regular expressions are case-sensitive. In the example below, the regex only matches the lowercase <code>s</code> in <code>eggs</code>, not the uppercase <code>S</code> in <code>Say</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Say! I like green eggs and ham!"</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"s"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Say! I like green egg<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">s</span> and ham!
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Wildcard-Character">Wildcard Character<a class="anchor-link" href="#Wildcard-Character">¶</a></h3><p>Some characters have special meaning in a regular expression. These meta characters allow regexes to match a variety of patterns.</p>
<p>In a regular expression, the period character <code>.</code> matches any character except a newline.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 382-384-3840."</span><span class="p">,</span> <span class="sa">r</span><span class="s2">".all"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">Call</span> me at 382-384-3840.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To match only the literal period character we must escape it with a backslash:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 382-384-3840."</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"\."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at 382-384-3840<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By using the period character to mark the parts of a pattern that vary, we construct a regex to match phone numbers. For example, we may take our original phone number <code>382-384-3840</code> and replace the numbers with <code>.</code>, leaving the dashes as literals. This results in the regex <code>...-...-....</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 382-384-3840."</span><span class="p">,</span> <span class="s2">"...-...-...."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">382-384-3840</span>.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the period character matches all characters, however, the following input string will produce a spurious match.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"My truck is not-all-blue."</span><span class="p">,</span> <span class="s2">"...-...-...."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>My truck is <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">not-all-blue</span>.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Character-Classes">Character Classes<a class="anchor-link" href="#Character-Classes">¶</a></h3><p>A <strong>character class</strong> matches a specified set of characters, allowing us to create more restrictive matches than the <code>.</code> character alone. To create a character class, wrap the set of desired characters in brackets <code>[ ]</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your gray shirt."</span><span class="p">,</span> <span class="s2">"gr[ae]y"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">gray</span> shirt.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your grey shirt."</span><span class="p">,</span> <span class="s2">"gr[ae]y"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">grey</span> shirt.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Does not match; a character class only matches one character from a set</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your graey shirt."</span><span class="p">,</span> <span class="s2">"gr[ae]y"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your graey shirt.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># In this example, repeating the character class will match</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your graey shirt."</span><span class="p">,</span> <span class="s2">"gr[ae][ae]y"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">graey</span> shirt.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In a character class, the <code>.</code> character is treated as a literal, not as a wildcard.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your grey shirt."</span><span class="p">,</span> <span class="s2">"irt[.]"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your grey sh<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">irt.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are a few special shorthand notations we can use for commonly used character classes:</p>
<table>
<thead><tr>
<th>Shorthand</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>[0-9]</td>
<td>All the digits</td>
</tr>
<tr>
<td>[a-z]</td>
<td>Lowercase letters</td>
</tr>
<tr>
<td>[A-Z]</td>
<td>Uppercase letters</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"I like your gray shirt."</span><span class="p">,</span> <span class="s2">"y[a-z]y"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>I like your gray shirt.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Character classes allow us to create a more specific regex for phone numbers.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We replaced every `.` character in ...-...-.... with [0-9] to restrict</span>
<span class="c1"># matches to digits.</span>
<span class="n">phone_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'[0-9][0-9][0-9]-[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]'</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 382-384-3840."</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">382-384-3840</span>.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Now we no longer match this string:</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"My truck is not-all-blue."</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>My truck is not-all-blue.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Negated-Character-Classes">Negated Character Classes<a class="anchor-link" href="#Negated-Character-Classes">¶</a></h3><p>A <strong>negated character class</strong> matches any character <strong>except</strong> the characters in the class. To create a negated character class, wrap the negated characters in <code>[^ ]</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"The car parked in the garage."</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"[^c]ar"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>The car <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">par</span>ked in the <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">gar</span>age.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Quantifiers">Quantifiers<a class="anchor-link" href="#Quantifiers">¶</a></h3><p>To create a regex to match phone numbers, we wrote:</p>
<pre><code>[0-9][0-9][0-9]-[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]</code></pre>
<p>This matches 3 digits, a dash, 3 more digits, a dash, and 4 more digits.</p>
<p>Quantifiers allow us to match multiple consecutive appearances of a pattern. We specify the number of repetitions by placing the number in curly braces <code>{ }</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'[0-9]</span><span class="si">{3}</span><span class="s1">-[0-9]</span><span class="si">{3}</span><span class="s1">-[0-9]</span><span class="si">{4}</span><span class="s1">'</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 382-384-3840."</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">382-384-3840</span>.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># No match</span>
<span class="n">phone_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'[0-9]</span><span class="si">{3}</span><span class="s1">-[0-9]</span><span class="si">{3}</span><span class="s1">-[0-9]</span><span class="si">{4}</span><span class="s1">'</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at 12-384-3840."</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at 12-384-3840.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A quantifier always modifies the character or character class to its immediate left. The following table shows the complete syntax for quantifiers.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>Quantifier</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>{m, n}</td>
<td>Match the preceding character m to n times.</td>
</tr>
<tr>
<td>{m}</td>
<td>Match the preceding character exactly m times.</td>
</tr>
<tr>
<td>{m,}</td>
<td>Match the preceding character at least m times.</td>
</tr>
<tr>
<td>{,n}</td>
<td>Match the preceding character at most n times.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Shorthand Quantifiers</strong></p>
<p>Some commonly used quantifiers have a shorthand:</p>
<table>
<thead><tr>
<th>Symbol</th>
<th>Quantifier</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td>*</td>
<td>{0,}</td>
<td>Match the preceding character 0 or more times</td>
</tr>
<tr>
<td>+</td>
<td>{1,}</td>
<td>Match the preceding character 1 or more times</td>
</tr>
<tr>
<td>?</td>
<td>{0,1}</td>
<td>Match the preceding charcter 0 or 1 times</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use the <code>*</code> character instead of <code>{0,}</code> in the following examples.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 3 a's</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s1">'He screamed "Aaaah!" as the cart took a plunge.'</span><span class="p">,</span> <span class="s2">"Aa*h!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>He screamed "<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">Aaaah!</span>" as the cart took a plunge.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Lots of a's</span>
<span class="n">show_regex_match</span><span class="p">(</span>
    <span class="s1">'He screamed "Aaaaaaaaaaaaaaaaaaaah!" as the cart took a plunge.'</span><span class="p">,</span>
    <span class="s2">"Aa*h!"</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>He screamed "<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">Aaaaaaaaaaaaaaaaaaaah!</span>" as the cart took a plunge.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># No lowercase a's</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s1">'He screamed "Ah!" as the cart took a plunge.'</span><span class="p">,</span> <span class="s2">"Aa*h!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>He screamed "<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">Ah!</span>" as the cart took a plunge.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Quantifiers are greedy</strong></p>
<p>Quantifiers will always return the longest match possible. This sometimes results in surprising behavior:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We tried to match 311 and 911 but matched the ` and ` as well because</span>
<span class="c1"># `&lt;311&gt; and &lt;911&gt;` is the longest match possible for `&lt;.+&gt;`.</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Remember the numbers &lt;311&gt; and &lt;911&gt;"</span><span class="p">,</span> <span class="s2">"&lt;.+&gt;"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Remember the numbers <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">&lt;311&gt; and &lt;911&gt;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In many cases, using a more specific character class prevents these false matches:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Remember the numbers &lt;311&gt; and &lt;911&gt;"</span><span class="p">,</span> <span class="s2">"&lt;[0-9]+&gt;"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Remember the numbers <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">&lt;311&gt;</span> and <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">&lt;911&gt;</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Anchoring">Anchoring<a class="anchor-link" href="#Anchoring">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Sometimes a pattern should only match at the beginning or end of a string.  The special character <code>^</code> anchors the regex to match only if the pattern appears at the beginning of the string; the special character <code>$</code> anchors the regex to match only if the pattern occurs at the end of the string.  For example the regex <code>well$</code> only matches an appearance of <code>well</code> at the end of the string.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">show_regex_match</span><span class="p">(</span><span class="s1">'well, well, well'</span><span class="p">,</span> <span class="sa">r</span><span class="s2">"well$"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>well, well, <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">well</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using both <code>^</code> and <code>$</code> requires the regex to match the full string.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone_regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"^[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{4}</span><span class="s2">$"</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s1">'382-384-3840'</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">382-384-3840</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># No match</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s1">'You can call me at 382-384-3840.'</span><span class="p">,</span> <span class="n">phone_regex</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>You can call me at 382-384-3840.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Escaping-Meta-Characters">Escaping Meta Characters<a class="anchor-link" href="#Escaping-Meta-Characters">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All regex meta characters have special meaning in a regular expression. To match meta characters as literals, we escape them using the <code>\</code> character.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># `[` is a meta character and requires escaping</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at [382-384-3840]."</span><span class="p">,</span> <span class="s2">"\["</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at <span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">[</span>382-384-3840].
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># `.` is a meta character and requires escaping</span>
<span class="n">show_regex_match</span><span class="p">(</span><span class="s2">"Call me at [382-384-3840]."</span><span class="p">,</span> <span class="s2">"\."</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Call me at [382-384-3840]<span class="ansi-black-intense-fg ansi-yellow-bg ansi-bold">.</span>
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reference-Tables">Reference Tables<a class="anchor-link" href="#Reference-Tables">¶</a></h2><p>We have now covered the most important pieces of regex syntax and meta characters. For a more complete reference, we include the tables below.</p>
<p><strong>Meta Characters</strong></p>
<p>This table includes most of the important <em>meta characters</em>, which help us specify certain patterns we want to match in a string.</p>
<table>
<thead><tr>
<th></th>
<th>Description</th>
<th>Example</th>
<th>Matches</th>
<th>Doesn't Match</th>
</tr>
</thead>
<tbody>
<tr>
<td>.</td>
<td>Any character except \n</td>
<td>...</td>
<td>abc</td>
<td>ab<br>abcd</td>
</tr>
<tr>
<td>[ ]</td>
<td>Any character inside brackets</td>
<td>[cb.]ar</td>
<td>car<br>.ar</td>
<td>jar</td>
</tr>
<tr>
<td>[^ ]</td>
<td>Any character <em>not</em> inside brackets</td>
<td>[^b]ar</td>
<td>car<br>par</td>
<td>bar<br>ar</td>
</tr>
<tr>
<td>*</td>
<td>≥ 0 or more of last symbol</td>
<td>[pb]*ark</td>
<td>bbark<br>ark</td>
<td>dark</td>
</tr>
<tr>
<td>+</td>
<td>≥ 1 or more of last symbol</td>
<td>[pb]+ark</td>
<td>bbpark<br>bark</td>
<td>dark<br>ark</td>
</tr>
<tr>
<td>?</td>
<td>0 or 1 of last symbol</td>
<td>s?he</td>
<td>she<br>he</td>
<td>the</td>
</tr>
<tr>
<td>{<em>n</em>}</td>
<td>Exactly <em>n</em> of last symbol</td>
<td>hello{3}</td>
<td>hellooo</td>
<td>hello</td>
</tr>
<tr>
<td>|</td>
<td>Pattern before or after bar</td>
<td>we|[ui]s</td>
<td>we<br>us<br>is</td>
<td>e<br>s</td>
</tr>
<tr>
<td>\</td>
<td>Escapes next character</td>
<td><code>\[hi\]</code></td>
<td>[hi]</td>
<td>hi</td>
</tr>
<tr>
<td>^</td>
<td>Beginning of line</td>
<td>^ark</td>
<td>ark two</td>
<td>dark</td>
</tr>
<tr>
<td><span>$</span></td>
<td>End of line</td>
<td>ark$</td>
<td>noahs ark</td>
<td>noahs arks</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Shorthand Character Sets</strong></p>
<p>Some commonly used character sets have shorthands.</p>
<table>
<thead><tr>
<th>Bracket Form</th>
<th>Shorthand</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>[a-zA-Z0-9]</td>
<td>\w</td>
<td>Alphanumeric character</td>
</tr>
<tr>
<td>[^a-zA-Z0-9]</td>
<td>\W</td>
<td>Not an alphanumeric character</td>
</tr>
<tr>
<td>[0-9]</td>
<td>\d</td>
<td>Digit</td>
</tr>
<tr>
<td>[^0-9]</td>
<td>\D</td>
<td>Not a digit</td>
</tr>
<tr>
<td>[\t\n\f\r\p{Z}]</td>
<td>\s</td>
<td>Whitespace</td>
</tr>
<tr>
<td>[^\t\n\f\r\p{Z}]</td>
<td>\S</td>
<td>Not whitespace</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Almost all programming languages have a library to match patterns using regular expressions, making them useful regardless of the specific language. In this section, we introduce regex syntax and the most useful meta characters.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/08'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regex-and-Python">Regex and Python<a class="anchor-link" href="#Regex-and-Python">¶</a></h2><p>In this section, we introduce regex usage in Python using the built-in <code>re</code> module. Since we only cover a few of the most commonly used methods, you will find it useful to consult <a href="https://docs.python.org/3/library/re.html">the official documentation on the <code>re</code> module</a> as well.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="re.search"><code>re.search</code><a class="anchor-link" href="#re.search">¶</a></h2><p><code>re.search(pattern, string)</code> searches for a match of the regex <code>pattern</code> anywhere in <code>string</code>. It returns a truthy match object if the pattern is found; it returns <code>None</code> if not.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{4}</span><span class="s2">"</span>
<span class="n">text</span>  <span class="o">=</span> <span class="s2">"Call me at 382-384-3840."</span>
<span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">phone_re</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
<span class="n">match</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;_sre.SRE_Match object; span=(11, 23), match='382-384-3840'&gt;</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the returned match object has a variety of useful properties, we most commonly use <code>re.search</code> to test whether a pattern appears in a string.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">phone_re</span><span class="p">,</span> <span class="n">text</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Found a match!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Found a match!
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">phone_re</span><span class="p">,</span> <span class="s1">'Hello world'</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"No match; this won't print"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another commonly used method, <code>re.match(pattern, string)</code>, behaves the same as <code>re.search</code> but only checks for a match at the start of <code>string</code> instead of a match anywhere in the string.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="re.findall"><code>re.findall</code><a class="anchor-link" href="#re.findall">¶</a></h2><p>We use <code>re.findall(pattern, string)</code> to extract substrings that match a regex. This method returns a list of all matches of <code>pattern</code> in <code>string</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gmail_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'[a-zA-Z0-9]+@gmail\.com'</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">From: email1@gmail.com</span>
<span class="s1">To: email2@yahoo.com and email3@gmail.com</span>
<span class="s1">'''</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">gmail_re</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>['email1@gmail.com', 'email3@gmail.com']</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regex-Groups">Regex Groups<a class="anchor-link" href="#Regex-Groups">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using <strong>regex groups</strong>, we specify subpatterns to extract from a regex by wrapping the subpattern in parentheses <code>( )</code>. When a regex contains regex groups, <code>re.findall</code> returns a list of tuples that contain the subpattern contents.</p>
<p>For example, the following familiar regex extracts phone numbers from a string:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phone_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{3}</span><span class="s2">-[0-9]</span><span class="si">{4}</span><span class="s2">"</span>
<span class="n">text</span>  <span class="o">=</span> <span class="s2">"Sam's number is 382-384-3840 and Mary's is 123-456-7890."</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">phone_re</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>['382-384-3840', '123-456-7890']</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To split apart the individual three or four digit components of a phone number, we can wrap each digit group in parentheses.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Same regex with parentheses around the digit groups</span>
<span class="n">phone_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">"([0-9]</span><span class="si">{3}</span><span class="s2">)-([0-9]</span><span class="si">{3}</span><span class="s2">)-([0-9]</span><span class="si">{4}</span><span class="s2">)"</span>
<span class="n">text</span>  <span class="o">=</span> <span class="s2">"Sam's number is 382-384-3840 and Mary's is 123-456-7890."</span>
<span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">phone_re</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[('382', '384', '3840'), ('123', '456', '7890')]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As promised, <code>re.findall</code> returns a list of tuples containing the individual components of the matched phone numbers.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="re.sub"><code>re.sub</code><a class="anchor-link" href="#re.sub">¶</a></h2><p><code>re.sub(pattern, replacement, string)</code> replaces all occurrences of <code>pattern</code> with <code>replacement</code> in the provided <code>string</code>. This method behaves like the Python string method <code>str.sub</code> but uses a regex to match patterns.</p>
<p>In the code below, we alter the dates to have a common format by substituting the date separators with a dash.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">messy_dates</span> <span class="o">=</span> <span class="s1">'03/12/2018, 03.13.18, 03/14/2018, 03:15:2018'</span>
<span class="n">regex</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'[/.:]'</span>
<span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="n">regex</span><span class="p">,</span> <span class="s1">'-'</span><span class="p">,</span> <span class="n">messy_dates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>'03-12-2018, 03-13-18, 03-14-2018, 03-15-2018'</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="re.split"><code>re.split</code><a class="anchor-link" href="#re.split">¶</a></h2><p><code>re.split(pattern, string)</code> splits the input <code>string</code> each time the regex <code>pattern</code> appears. This method behaves like the Python string method <code>str.split</code> but uses a regex to make the split.</p>
<p>In the code below, we use <code>re.split</code> to split chapter names from their page numbers in a table of contents for a book.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">toc</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">PLAYING PILGRIMS============3</span>
<span class="s1">A MERRY CHRISTMAS===========13</span>
<span class="s1">THE LAURENCE BOY============31</span>
<span class="s1">BURDENS=====================55</span>
<span class="s1">BEING NEIGHBORLY============76</span>
<span class="s1">'''</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># First, split into individual lines</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="n">toc</span><span class="p">)</span>
<span class="n">lines</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>['PLAYING PILGRIMS============3',
 'A MERRY CHRISTMAS===========13',
 'THE LAURENCE BOY============31',
 'BURDENS=====================55',
 'BEING NEIGHBORLY============76']</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Then, split into chapter title and page number</span>
<span class="n">split_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'=+'</span> <span class="c1"># Matches any sequence of = characters</span>
<span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">split_re</span><span class="p">,</span> <span class="n">line</span><span class="p">)</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>[['PLAYING PILGRIMS', '3'],
 ['A MERRY CHRISTMAS', '13'],
 ['THE LAURENCE BOY', '31'],
 ['BURDENS', '55'],
 ['BEING NEIGHBORLY', '76']]</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regex-and-pandas">Regex and pandas<a class="anchor-link" href="#Regex-and-pandas">¶</a></h2><p>Recall that <code>pandas</code> Series objects have a <code>.str</code> property that supports string manipulation using Python string methods. Conveniently, the <code>.str</code> property also supports some functions from the <code>re</code> module. We demonstrate basic regex usage in <code>pandas</code>, leaving the complete method list to <a href="https://pandas.pydata.org/pandas-docs/stable/text.html">the <code>pandas</code> documentation on string methods</a>.</p>
<p>We've stored the text of the first five sentences of the novel <em>Little Women</em> in the DataFrame below. We can use the string methods that <code>pandas</code> provides to extract the spoken dialog in each sentence.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">text</span> <span class="o">=</span> <span class="s1">'''</span>
<span class="s1">"Christmas won't be Christmas without any presents," grumbled Jo, lying on the rug.</span>
<span class="s1">"It's so dreadful to be poor!" sighed Meg, looking down at her old dress.</span>
<span class="s1">"I don't think it's fair for some girls to have plenty of pretty things, and other girls nothing at all," added little Amy, with an injured sniff.</span>
<span class="s1">"We've got Father and Mother, and each other," said Beth contentedly from her corner.</span>
<span class="s1">The four young faces on which the firelight shone brightened at the cheerful words, but darkened again as Jo said sadly, "We haven't got Father, and shall not have him for a long time."</span>
<span class="s1">'''</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">little</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">'sentences'</span><span class="p">:</span> <span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">little</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sentences</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>"Christmas won't be Christmas without any pres...</td>
</tr>
<tr>
<th>1</th>
<td>"It's so dreadful to be poor!" sighed Meg, loo...</td>
</tr>
<tr>
<th>2</th>
<td>"I don't think it's fair for some girls to hav...</td>
</tr>
<tr>
<th>3</th>
<td>"We've got Father and Mother, and each other,"...</td>
</tr>
<tr>
<th>4</th>
<td>The four young faces on which the firelight sh...</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since spoken dialog lies within double quotation marks, we create a regex that captures a double quotation mark, a sequence of any characters except a double quotation mark, and the closing quotation mark.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">quote_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'"[^"]+"'</span>
<span class="n">little</span><span class="p">[</span><span class="s1">'sentences'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">quote_re</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0    ["Christmas won't be Christmas without any pre...
1                     ["It's so dreadful to be poor!"]
2    ["I don't think it's fair for some girls to ha...
3     ["We've got Father and Mother, and each other,"]
4    ["We haven't got Father, and shall not have hi...
Name: sentences, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the <code>Series.str.findall</code> method returns a list of matches, <code>pandas</code> also provides <code>Series.str.extract</code> and <code>Series.str.extractall</code> method to extract matches into a Series or DataFrame. These methods require the regex to contain at least one regex group.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Extract text within double quotes</span>
<span class="n">quote_re</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">'"([^"]+)"'</span>
<span class="n">spoken</span> <span class="o">=</span> <span class="n">little</span><span class="p">[</span><span class="s1">'sentences'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">quote_re</span><span class="p">)</span>
<span class="n">spoken</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0    Christmas won't be Christmas without any prese...
1                         It's so dreadful to be poor!
2    I don't think it's fair for some girls to have...
3         We've got Father and Mother, and each other,
4    We haven't got Father, and shall not have him ...
Name: sentences, dtype: object</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can add this series as a column of the <code>little</code> DataFrame:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">little</span><span class="p">[</span><span class="s1">'dialog'</span><span class="p">]</span> <span class="o">=</span> <span class="n">spoken</span>
<span class="n">little</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sentences</th>
<th>dialog</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>"Christmas won't be Christmas without any pres...</td>
<td>Christmas won't be Christmas without any prese...</td>
</tr>
<tr>
<th>1</th>
<td>"It's so dreadful to be poor!" sighed Meg, loo...</td>
<td>It's so dreadful to be poor!</td>
</tr>
<tr>
<th>2</th>
<td>"I don't think it's fair for some girls to hav...</td>
<td>I don't think it's fair for some girls to have...</td>
</tr>
<tr>
<th>3</th>
<td>"We've got Father and Mother, and each other,"...</td>
<td>We've got Father and Mother, and each other,</td>
</tr>
<tr>
<th>4</th>
<td>The four young faces on which the firelight sh...</td>
<td>We haven't got Father, and shall not have him ...</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can confirm that our string manipulation behaves as expected for the last sentence in our DataFrame by printing the original and extracted text:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">little</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'sentences'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>The four young faces on which the firelight shone brightened at the cheerful words, but darkened again as Jo said sadly, "We haven't got Father, and shall not have him for a long time."
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">little</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s1">'dialog'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>We haven't got Father, and shall not have him for a long time.
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>The <code>re</code> module in Python provides a useful group of methods for manipulating text using regular expressions. When working with DataFrames, we often use the analogous string manipulation methods implemented in <code>pandas</code>.</p>
<p>For the complete documentation on the <code>re</code> module, see <a href="https://docs.python.org/3/library/re.html">https://docs.python.org/3/library/re.html</a></p>
<p>For the complete documentation on <code>pandas</code> string methods, see <a href="https://pandas.pydata.org/pandas-docs/stable/text.html">https://pandas.pydata.org/pandas-docs/stable/text.html</a></p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/09'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Relational-Databases-and-SQL">Relational Databases and SQL<a class="anchor-link" href="#Relational-Databases-and-SQL">¶</a></h1><p>Thus far we have worked with datasets that are stored as text files on a
computer. While useful for analysis of small datasets, using text files to
store data presents challenges for many real-world use cases.</p>
<p>Many datasets are collected by multiple people—a team of data scientists, for
example. If the data are stored in text files, however, the team will likely
have to send and download new versions of the files each time the data are
updated. Text files alone do not provide a consistent point of data retrieval
for multiple analysts to use. This issue, among others, makes text files
difficult to use for larger datasets or teams.</p>
<p>We often turn to relational database management systems (RDBMSs) to store data,
such as MySQL or PostgreSQL. To work with these systems, we use a query
language called SQL instead of Python. In this chapter, we discuss the
relational database model and introduce SQL.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/09'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Relational-Model">The Relational Model<a class="anchor-link" href="#The-Relational-Model">¶</a></h2><p>A <strong>database</strong> is an organized collection of data. In the past, data was stored in specialized data structures that were designed for specific tasks. For example, airlines might record flight bookings in a different format than a bank managing an account ledger. In 1969, Ted Codd introduced the relational model as a general method of storing data. Data is stored in two-dimensional tables called <strong>relations</strong>, consisting of individual observations in each row (commonly referred to as <strong>tuples</strong>). Each tuple is a structured data item that represents the relationship between certain <strong>attributes</strong> (columns). Each attribute of a relation has a name and data type.</p>
<p>Consider the <code>purchases</code> relation below:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p><header style="text-align:center"><strong>purchases</strong></header><p></p>
<table border="1" class="DataFrame">
<thead>
<tr>
<td><b>name</b></td>
<td><b>product</b></td>
<td><b>retailer</b></td>
<td><b>date purchased</b></td>
</tr>
</thead>
<tbody><tr>
<td>Samantha</td>
<td>iPod</td>
<td>Best Buy</td>
<td>June 3, 2016</td>
</tr>
<tr>
<td>Timothy</td>
<td>Chromebook</td>
<td>Amazon</td>
<td>July 8, 2016</td>
</tr>
<tr>
<td>Jason</td>
<td>Surface Pro</td>
<td>Target</td>
<td>October 2, 2016</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <code>purchases</code>, each tuple represents the relationship between the <code>name</code>, <code>product</code>, <code>retailer</code>, and <code>date purchased</code> attributes.</p>
<p>A relation's <em>schema</em> contains its column names, data types, and constraints. For example, the schema of the <code>purchases</code> table states that the columns are <code>name</code>, <code>product</code>, <code>retailer</code>, and <code>date purchased</code>; it also states that each column contains text.</p>
<p>The following <code>prices</code> relation shows the price of certain gadgets at a few retail stores:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p></p><header style="text-align:center"><strong>prices</strong></header><p></p>
<table border="1" class="DataFrame">
<thead>
<tr>
<td><b>retailer</b></td>
<td><b>product</b></td>
<td><b>price</b></td>
</tr>
</thead>
<tbody><tr>
<td>Best Buy</td>
<td>Galaxy S9</td>
<td>719.00</td>
</tr>
<tr>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<td>Amazon</td>
<td>iPad</td>
<td>450.00</td>
</tr>
<tr>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
<tr>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
<tr>
<td>Target</td>
<td>Surface Pro</td>
<td>799.00</td>
</tr>
<tr>
<td>Target</td>
<td>Google Pixel 2</td>
<td>659.00</td>
</tr>
<tr>
<td>Walmart</td>
<td>Chromebook</td>
<td>238.79</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then reference both tables simultaneously to determine how much Samantha, Timothy, and Jason paid for their respective gadgets (assuming prices at each store stay constant over time). Together, the two tables form a <strong>relational database</strong>, which is a collection of one or more relations.
The schema of the entire database is the set of schemas of the individual relations in the database.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Relational-Database-Management-Systems">Relational Database Management Systems<a class="anchor-link" href="#Relational-Database-Management-Systems">¶</a></h2><p>A relational database can be simply described as a set of tables containing rows of individual data entries. A relational database management system (RDBMSs) provides an interface to a relational database. <a href="https://www.wikiwand.com/en/Oracle_Database">Oracle</a>, <a href="https://www.wikiwand.com/en/MySQL">MySQL</a>, and <a href="https://www.wikiwand.com/en/PostgreSQL">PostgreSQL</a> are three of the most commonly used RDBMSs used in practice today.</p>
<p>Relational database management systems give users the ability to add, edit, and remove data from databases. These systems provide several key benefits over using a collection of text files to store data, including:</p>
<ol>
<li>Reliable data storage: RDBMSs protect against data corruption from system failures or crashes.</li>
<li>Performance: RDBMSs often store data more efficiently than text files and have well-developed algorithms for querying data.</li>
<li>Data management: RDBMSs implement access control, preventing unauthorized users from accessing sensitive datasets.</li>
<li>Data consistency: RDBMSs can impose constraints on the data entered—for example, that a column <code>GPA</code> only contains floats between 0.0 and 4.0.</li>
</ol>
<p>To work with data stored in a RDBMS, we use the SQL programming language.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="RDBMS-vs.-pandas">RDBMS vs. pandas<a class="anchor-link" href="#RDBMS-vs.-pandas">¶</a></h2><p>How do RDBMSs and the <code>pandas</code> Python package differ? First, <code>pandas</code> is not concerned about data storage. Although DataFrames can read and write from multiple data formats, <code>pandas</code> does not dictate how the data are actually stored on the underlying computer like a RDBMS does. Second, <code>pandas</code> primarily provides methods for manipulating data while RDBMSs handle both data storage and data manipulation, making them more suitable for larger datasets. A typical rule of thumb is to use a RDBMS for datasets larger than several gigabytes. Finally, <code>pandas</code> requires knowledge of Python in order to use, whereas RDBMSs require knowledge of SQL. Since SQL is simpler to learn than Python, RDBMSs allow less technical users to store and query data, a handy trait.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/09'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>

<span class="c1"># Delete the database if it already exists</span>
<span class="n">dbfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"sql_basics.db"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">dbfile</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">dbfile</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
    

<span class="kn">import</span> <span class="nn">sqlalchemy</span>

<span class="c1"># pd.read_sql takes in a parameter for a SQLite engine, which we create below</span>
<span class="n">sqlite_uri</span> <span class="o">=</span> <span class="s2">"sqlite:///sql_basics.db"</span>
<span class="n">sqlite_engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_uri</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="c1"># Creating a table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">CREATE TABLE prices(</span>
<span class="s2">    retailer TEXT,</span>
<span class="s2">    product TEXT,</span>
<span class="s2">    price FLOAT);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="c1"># Inserting records into the table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">INSERT INTO prices VALUES </span>
<span class="s2">  ('Best Buy', 'Galaxy S9', 719.00),</span>
<span class="s2">  ('Best Buy', 'iPod', 200.00),</span>
<span class="s2">  ('Amazon', 'iPad', 450.00),</span>
<span class="s2">  ('Amazon', 'Battery pack',  24.87),</span>
<span class="s2">  ('Amazon', 'Chromebook', 249.99),</span>
<span class="s2">  ('Target', 'iPod', 215.00),</span>
<span class="s2">  ('Target', 'Surface Pro', 799.00),</span>
<span class="s2">  ('Target', 'Google Pixel 2', 659.00),</span>
<span class="s2">  ('Walmart', 'Chromebook', 238.79);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">prices</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="s1">'Best Buy'</span><span class="p">,</span> <span class="s1">'Galaxy S9'</span><span class="p">,</span> <span class="mf">719.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Best Buy'</span><span class="p">,</span> <span class="s1">'iPod'</span><span class="p">,</span> <span class="mf">200.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Amazon'</span><span class="p">,</span> <span class="s1">'iPad'</span><span class="p">,</span> <span class="mf">450.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Amazon'</span><span class="p">,</span> <span class="s1">'Battery pack'</span><span class="p">,</span> <span class="mf">24.87</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Amazon'</span><span class="p">,</span> <span class="s1">'Chromebook'</span><span class="p">,</span> <span class="mf">249.99</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Target'</span><span class="p">,</span> <span class="s1">'iPod'</span><span class="p">,</span> <span class="mf">215.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Target'</span><span class="p">,</span> <span class="s1">'Surface Pro'</span><span class="p">,</span> <span class="mf">799.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Target'</span><span class="p">,</span> <span class="s1">'Google Pixel 2'</span><span class="p">,</span> <span class="mf">659.00</span><span class="p">],</span>
                   <span class="p">[</span><span class="s1">'Walmart'</span><span class="p">,</span> <span class="s1">'Chromebook'</span><span class="p">,</span> <span class="mf">238.79</span><span class="p">]],</span>
                 <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'retailer'</span><span class="p">,</span> <span class="s1">'product'</span><span class="p">,</span> <span class="s1">'price'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SQL">SQL<a class="anchor-link" href="#SQL">¶</a></h2><p><strong>SQL</strong> (Structured Query Language) is a programming language that has operations to define, logically organize, manipulate, and perform calculations on data stored in a relational database management system (RDBMS).</p>
<p>SQL is a declarative language. This means that the user only needs to specify <em>what</em> kind of data they want, not <em>how</em> to obtain it. An example is shown below, with an imperative example for comparison:</p>
<ul>
<li><strong>Declarative</strong>: Compute the table with columns "x" and "y" from table "A" where the values in "y" are greater than 100.00.</li>
<li><strong>Imperative</strong>: For each record in table "A", check if the record contains a value of "y" greater than 100. If so, then store the record's "x" and "y" attributes in a new table. Return the new table.</li>
</ul>
<p>In this chapter, we will write SQL queries as Python strings, then use <code>pandas</code> to execute the SQL query and read the result into a <code>pandas</code> DataFrame. As we walk through the basics of SQL syntax, we'll also occasionally show <code>pandas</code> equivalents for comparison purposes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Executing-SQL-Queries-through-pandas">Executing SQL Queries through <code>pandas</code><a class="anchor-link" href="#Executing-SQL-Queries-through-pandas">¶</a></h3><p>To execute SQL queries from Python, we will connect to a database using the <a href="http://docs.sqlalchemy.org/en/latest/core/tutorial.html">sqlalchemy</a> library. Then we can use the <code>pandas</code> function <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_sql.html">pd.read_sql</a> to execute SQL queries through this connection.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sqlalchemy</span>

<span class="c1"># pd.read_sql takes in a parameter for a SQLite engine, which we create below</span>
<span class="n">sqlite_uri</span> <span class="o">=</span> <span class="s2">"sqlite:///sql_basics.db"</span>
<span class="n">sqlite_engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_uri</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This database contains one relation: <code>prices</code>. To display the relation we run a SQL query. Calling <code>read_sql</code> will execute the SQL query on the RDBMS, then return the results in a <code>pandas</code> DataFrame.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT * </span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
<td>Galaxy S9</td>
<td>719.00</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>2</th>
<td>Amazon</td>
<td>iPad</td>
<td>450.00</td>
</tr>
<tr>
<th>3</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>4</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
<tr>
<th>5</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
<tr>
<th>6</th>
<td>Target</td>
<td>Surface Pro</td>
<td>799.00</td>
</tr>
<tr>
<th>7</th>
<td>Target</td>
<td>Google Pixel 2</td>
<td>659.00</td>
</tr>
<tr>
<th>8</th>
<td>Walmart</td>
<td>Chromebook</td>
<td>238.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Later in this section we will compare SQL queries with <code>pandas</code> method calls so we've created an identical DataFrame in <code>pandas</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prices</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
<td>Galaxy S9</td>
<td>719.00</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>2</th>
<td>Amazon</td>
<td>iPad</td>
<td>450.00</td>
</tr>
<tr>
<th>3</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>4</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
<tr>
<th>5</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
<tr>
<th>6</th>
<td>Target</td>
<td>Surface Pro</td>
<td>799.00</td>
</tr>
<tr>
<th>7</th>
<td>Target</td>
<td>Google Pixel 2</td>
<td>659.00</td>
</tr>
<tr>
<th>8</th>
<td>Walmart</td>
<td>Chromebook</td>
<td>238.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SQL-Syntax">SQL Syntax<a class="anchor-link" href="#SQL-Syntax">¶</a></h2><p>All SQL queries take the general form below:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">[</span><span class="k">DISTINCT</span><span class="p">]</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">expression</span> <span class="n">list</span><span class="o">&gt;</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">relation</span><span class="o">&gt;</span>
<span class="p">[</span><span class="k">WHERE</span> <span class="o">&lt;</span><span class="n">predicate</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">[</span><span class="k">GROUP</span> <span class="k">BY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">list</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">[</span><span class="k">HAVING</span> <span class="o">&lt;</span><span class="n">predicate</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">[</span><span class="k">ORDER</span> <span class="k">BY</span> <span class="o">&lt;</span><span class="k">column</span> <span class="n">list</span><span class="o">&gt;</span><span class="p">]</span>
<span class="p">[</span><span class="k">LIMIT</span> <span class="o">&lt;</span><span class="nb">number</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
<p>Note that:</p>
<ol>
<li><strong>Everything in [square brackets] is optional.</strong> A valid SQL query only needs a <code>SELECT</code> and a <code>FROM</code> statement.</li>
<li><strong>SQL SYNTAX IS GENERALLY WRITTEN IN CAPITAL LETTERS.</strong> Although capitalization isn't required, it is common practice to write SQL syntax in capital letters. It also helps to visually structure your query for others to read.</li>
<li><code>FROM</code> query blocks can reference one or more tables, although in this section we will only look at one table at a time for simplicity.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="SELECT-and-FROM">SELECT and FROM<a class="anchor-link" href="#SELECT-and-FROM">¶</a></h3><p>The two mandatory statements in a SQL query are:</p>
<ul>
<li><code>SELECT</code> indicates the columns that we want to view.</li>
<li><code>FROM</code> indicates the tables from which we are selecting these columns.</li>
</ul>
<p>To display the entire <code>prices</code> table, we run:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT * </span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
<td>Galaxy S9</td>
<td>719.00</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>2</th>
<td>Amazon</td>
<td>iPad</td>
<td>450.00</td>
</tr>
<tr>
<th>3</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>4</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
<tr>
<th>5</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
<tr>
<th>6</th>
<td>Target</td>
<td>Surface Pro</td>
<td>799.00</td>
</tr>
<tr>
<th>7</th>
<td>Target</td>
<td>Google Pixel 2</td>
<td>659.00</td>
</tr>
<tr>
<th>8</th>
<td>Walmart</td>
<td>Chromebook</td>
<td>238.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>SELECT *</code> returns every column in the original relation. To display only the retailers that are represented in <code>prices</code>, we add the <code>retailer</code> column to the <code>SELECT</code> statement.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT retailer</span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
</tr>
<tr>
<th>2</th>
<td>Amazon</td>
</tr>
<tr>
<th>3</th>
<td>Amazon</td>
</tr>
<tr>
<th>4</th>
<td>Amazon</td>
</tr>
<tr>
<th>5</th>
<td>Target</td>
</tr>
<tr>
<th>6</th>
<td>Target</td>
</tr>
<tr>
<th>7</th>
<td>Target</td>
</tr>
<tr>
<th>8</th>
<td>Walmart</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we want a list of unique retailers, we can call the <code>DISTINCT</code> function to omit repeated values.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT DISTINCT(retailer)</span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
</tr>
<tr>
<th>1</th>
<td>Amazon</td>
</tr>
<tr>
<th>2</th>
<td>Target</td>
</tr>
<tr>
<th>3</th>
<td>Walmart</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This would be the functional equivalent of the following <code>pandas</code> code:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prices</span><span class="p">[</span><span class="s1">'retailer'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array(['Best Buy', 'Amazon', 'Target', 'Walmart'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each RDBMS comes with its own set of functions that can be applied to attributes in the <code>SELECT</code> list, such as comparison operators, mathematical functions and operators, and string functions and operators. In Data 100 we use PostgreSQL, a mature RDBMS that comes with hundreds of such functions. The complete list is available <a href="https://www.postgresql.org/docs/9.2/static/functions.html">here</a>. Keep in mind that each RDBMS has a different set of functions for use in <code>SELECT</code>.</p>
<p>The following code converts all retailer names to uppercase and halves the product prices.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT</span>
<span class="s2">    UPPER(retailer) AS retailer_caps,</span>
<span class="s2">    product,</span>
<span class="s2">    price / 2 AS half_price</span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer_caps</th>
<th>product</th>
<th>half_price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>BEST BUY</td>
<td>Galaxy S9</td>
<td>359.500</td>
</tr>
<tr>
<th>1</th>
<td>BEST BUY</td>
<td>iPod</td>
<td>100.000</td>
</tr>
<tr>
<th>2</th>
<td>AMAZON</td>
<td>iPad</td>
<td>225.000</td>
</tr>
<tr>
<th>3</th>
<td>AMAZON</td>
<td>Battery pack</td>
<td>12.435</td>
</tr>
<tr>
<th>4</th>
<td>AMAZON</td>
<td>Chromebook</td>
<td>124.995</td>
</tr>
<tr>
<th>5</th>
<td>TARGET</td>
<td>iPod</td>
<td>107.500</td>
</tr>
<tr>
<th>6</th>
<td>TARGET</td>
<td>Surface Pro</td>
<td>399.500</td>
</tr>
<tr>
<th>7</th>
<td>TARGET</td>
<td>Google Pixel 2</td>
<td>329.500</td>
</tr>
<tr>
<th>8</th>
<td>WALMART</td>
<td>Chromebook</td>
<td>119.395</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that we can <strong>alias</strong> the columns (assign another name) with <code>AS</code> so that the columns appear with this new name in the output table. This does not modify the names of the columns in the source relation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="WHERE">WHERE<a class="anchor-link" href="#WHERE">¶</a></h3><p>The <code>WHERE</code> clause allows us to specify certain constraints for the returned data; these constraints are often referred to as <strong>predicates</strong>. For example, to retrieve only gadgets that are under $500:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT *</span>
<span class="s2">FROM prices</span>
<span class="s2">WHERE price &lt; 500</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>1</th>
<td>Amazon</td>
<td>iPad</td>
<td>450.00</td>
</tr>
<tr>
<th>2</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>3</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
<tr>
<th>4</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
<tr>
<th>5</th>
<td>Walmart</td>
<td>Chromebook</td>
<td>238.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also use the operators <code>AND</code>, <code>OR</code>, and <code>NOT</code> to further constrain our SQL query. To find an item on Amazon without a battery pack under $300, we write:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT *</span>
<span class="s2">FROM prices</span>
<span class="s2">WHERE retailer = 'Amazon'</span>
<span class="s2">    AND NOT product = 'Battery pack'</span>
<span class="s2">    AND price &lt; 300</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The equivalent operation in <code>pandas</code> is:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prices</span><span class="p">[(</span><span class="n">prices</span><span class="p">[</span><span class="s1">'retailer'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Amazon'</span><span class="p">)</span> 
   <span class="o">&amp;</span> <span class="o">~</span><span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="s1">'product'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Battery pack'</span><span class="p">)</span>
   <span class="o">&amp;</span> <span class="p">(</span><span class="n">prices</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">300</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>4</th>
<td>Amazon</td>
<td>Chromebook</td>
<td>249.99</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There's a subtle difference that's worth noting: the index of the Chromebook in the SQL query is 0, whereas the corresponding index in the DataFrame is 4. This is because SQL queries always return a new table with indices counting up from 0, whereas <code>pandas</code> subsets a portion of the DataFrame <code>prices</code> and returns it with the original indices. We can use <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reset_index.html">pd.DataFrame.reset_index</a> to reset the indices in <code>pandas</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Aggregate-Functions">Aggregate Functions<a class="anchor-link" href="#Aggregate-Functions">¶</a></h3><p>So far, we've only worked with data from the existing rows in the table; that is, all of our returned tables have been some subset of the entries found in the table. But to conduct data analysis, we'll want to compute aggregate values over our data. In SQL, these are called <strong>aggregate functions</strong>.</p>
<p>If we want to find the average price of all gadgets in the <code>prices</code> relation:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT AVG(price) AS avg_price</span>
<span class="s2">FROM prices</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>avg_price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>395.072222</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Equivalently, in <code>pandas</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prices</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>395.0722222222222</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A complete list of PostgreSQL aggregate functions can be found <a href="https://www.postgresql.org/docs/9.2/static/functions.html">here</a>. Though we're using PostgreSQL as our primary version of SQL in Data 100, keep in mind that there are many other variations of SQL (MySQL, SQLite, etc.) that use different function names and have different functions available.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="GROUP-BY-and-HAVING">GROUP BY and HAVING<a class="anchor-link" href="#GROUP-BY-and-HAVING">¶</a></h3><p>With aggregate functions, we can execute more complicated SQL queries. To operate on more granular aggregate data, we can use the following two clauses:</p>
<ul>
<li><code>GROUP BY</code> takes a list of columns and groups the table like the <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html">pd.DataFrame.groupby</a> function in <code>pandas</code>.</li>
<li><code>HAVING</code> is functionally similar to <code>WHERE</code>, but is used exclusively to apply predicates to aggregated data. (Note that in order to use <code>HAVING</code>, it must be preceded by a <code>GROUP BY</code> clause.)</li>
</ul>
<p><strong>Important</strong>: When using <code>GROUP BY</code>, all columns in the <code>SELECT</code> clause must be either listed in the <code>GROUP BY</code> clause or have an aggregate function applied to them.</p>
<p>We can use these statements to find the maximum price at each retailer.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT retailer, MAX(price) as max_price</span>
<span class="s2">FROM prices</span>
<span class="s2">GROUP BY retailer</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>max_price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Amazon</td>
<td>450.00</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>719.00</td>
</tr>
<tr>
<th>2</th>
<td>Target</td>
<td>799.00</td>
</tr>
<tr>
<th>3</th>
<td>Walmart</td>
<td>238.79</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's say we have a client with expensive taste and only want to find retailers that sell gadgets over $700. Note that we must use <code>HAVING</code> to define predicates on aggregated columns; we can't use <code>WHERE</code> to filter an aggregated column. To compute a list of retailers and accompanying prices that satisfy our needs, we run:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT retailer, MAX(price) as max_price</span>
<span class="s2">FROM prices</span>
<span class="s2">GROUP BY retailer</span>
<span class="s2">HAVING max_price &gt; 700</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>max_price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Best Buy</td>
<td>719.0</td>
</tr>
<tr>
<th>1</th>
<td>Target</td>
<td>799.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For comparison, we recreate the same table in <code>pandas</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_prices</span> <span class="o">=</span> <span class="n">prices</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'retailer'</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">max_prices</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">max_prices</span><span class="p">[</span><span class="s1">'price'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">700</span><span class="p">,</span> <span class="p">[</span><span class="s1">'price'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>price</th>
</tr>
<tr>
<th>retailer</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>Best Buy</th>
<td>719.0</td>
</tr>
<tr>
<th>Target</th>
<td>799.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ORDER-BY-and-LIMIT">ORDER BY and LIMIT<a class="anchor-link" href="#ORDER-BY-and-LIMIT">¶</a></h3><p>These clauses allow us to control the presentation of the data:</p>
<ul>
<li><code>ORDER BY</code> lets us present the data in lexicographic order of column values. By default, ORDER BY uses ascending order (<code>ASC</code>) but we can specify descending order using <code>DESC</code>.</li>
<li><code>LIMIT</code> controls how many tuples are displayed.</li>
</ul>
<p>Let's display the three cheapest items in our <code>prices</code> table:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT *</span>
<span class="s2">FROM prices</span>
<span class="s2">ORDER BY price ASC</span>
<span class="s2">LIMIT 3</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>2</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that we didn't have to include the <code>ASC</code> keyword since <code>ORDER BY</code> returns data in ascending order by default.
For comparison, in <code>pandas</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">prices</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">'price'</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>retailer</th>
<th>product</th>
<th>price</th>
</tr>
</thead>
<tbody>
<tr>
<th>3</th>
<td>Amazon</td>
<td>Battery pack</td>
<td>24.87</td>
</tr>
<tr>
<th>1</th>
<td>Best Buy</td>
<td>iPod</td>
<td>200.00</td>
</tr>
<tr>
<th>5</th>
<td>Target</td>
<td>iPod</td>
<td>215.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>(Again, we see that the indices are out of order in the <code>pandas</code> DataFrame. As before, <code>pandas</code> returns a view on our DataFrame <code>prices</code>, whereas SQL is displaying a new table each time that we execute a query.)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conceptual-SQL-Evaluation">Conceptual SQL Evaluation<a class="anchor-link" href="#Conceptual-SQL-Evaluation">¶</a></h3><p>Clauses in a SQL query are executed in a specific order. Unfortunately, this order differs from the order that the clauses are written in a SQL query. From first executed to last:</p>
<ol>
<li><code>FROM</code>: One or more source tables</li>
<li><code>WHERE</code>: Apply selection qualifications (eliminate rows)</li>
<li><code>GROUP BY</code>: Form groups and aggregate</li>
<li><code>HAVING</code>: Eliminate groups</li>
<li><code>SELECT</code>: Select columns</li>
</ol>
<p><strong>Note on <code>WHERE</code> vs. <code>HAVING</code></strong>: Since the <code>WHERE</code> clause is processed before applying <code>GROUP BY</code>, the <code>WHERE</code> clause cannot make use of aggregated values. To define predicates based on aggregated values, we must use the <code>HAVING</code> clause.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have introduced SQL syntax and the most important SQL statements needed to conduct data analysis using a relational database management system.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/09'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">sqlalchemy</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Delete the database if it already exists.</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="k">import</span> <span class="n">Path</span>
<span class="n">dbfile</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"sql_joins.db"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">dbfile</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="n">dbfile</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>

<span class="n">sqlite_uri</span> <span class="o">=</span> <span class="s2">"sqlite:///sql_joins.db"</span>
<span class="n">sqlite_engine</span> <span class="o">=</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">create_engine</span><span class="p">(</span><span class="n">sqlite_uri</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Make names table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">CREATE TABLE names(</span>
<span class="s2">    cat_id INTEGER PRIMARY KEY,</span>
<span class="s2">    name TEXT);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>

<span class="c1"># Populate names table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">INSERT INTO names VALUES </span>
<span class="s2">(0, "Apricot"),</span>
<span class="s2">(1, "Boots"),</span>
<span class="s2">(2, "Cally"),</span>
<span class="s2">(4, "Eugene");</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Make colors table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">CREATE TABLE colors(</span>
<span class="s2">    cat_id INTEGER PRIMARY KEY,</span>
<span class="s2">    color TEXT);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>

<span class="c1"># Populate colors table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">INSERT INTO colors VALUES </span>
<span class="s2">(0, "orange"),</span>
<span class="s2">(1, "black"),</span>
<span class="s2">(2, "calico"),</span>
<span class="s2">(3, "white");</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Make ages table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">CREATE TABLE ages(</span>
<span class="s2">    cat_id INTEGER PRIMARY KEY,</span>
<span class="s2">    age INT);</span>
<span class="s2">"""</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>

<span class="c1"># Populate ages table</span>
<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">INSERT INTO ages VALUES </span>
<span class="s2">(0, 4),</span>
<span class="s2">(1, 3),</span>
<span class="s2">(2, 9),</span>
<span class="s2">(4, 20);</span>
<span class="s2">"""</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sqlite_engine</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="SQL-Joins">SQL Joins<a class="anchor-link" href="#SQL-Joins">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In <code>pandas</code> we use the <code>pd.merge</code> method to join two tables using matching values in their columns. For example:</p>
<div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">table1</span><span class="p">,</span> <span class="n">table2</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'commmon_column'</span><span class="p">)</span>
</pre></div>
<p>In this section, we introduce SQL joins. SQL joins are used to combine multiple tables in a relational database.</p>
<p>Suppose we are cat store owners with a database for the cats we have in our store. We have <strong>two</strong> different tables: <code>names</code> and <code>colors</code>. The <code>names</code> table contains the columns <code>cat_id</code>, a unique number assigned to each cat, and <code>name</code>, the name for the cat. The <code>colors</code> table contains the columns <code>cat_id</code> and <code>color</code>, the color of each cat.</p>
<p>Note that there are some missing rows from both tables - a row with <code>cat_id</code> 3 is missing from the <code>names</code> table, and a row with <code>cat_id</code> 4 is missing from the <code>colors</code> table.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div style="display: flex">
<div style="margin-right: 2em">
<header style="text-align:center"><strong>names</strong></header>
<table>
<thead>
<tr>
<th>cat_id</th>
<th>name</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Apricot</td>
</tr>
<tr>
<td>1</td>
<td>Boots</td>
</tr>
<tr>
<td>2</td>
<td>Cally</td>
</tr>
<tr>
<td>4</td>
<td>Eugene</td>
</tr>
</tbody>
</table>
</div>
<div>
<header style="text-align:center"><strong>colors</strong></header>
<table>
<thead>
<tr>
<th>cat_id</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<td>1</td>
<td>black</td>
</tr>
<tr>
<td>2</td>
<td>calico</td>
</tr>
<tr>
<td>3</td>
<td>white</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To compute the color of the cat named Apricot, we have to use information in both tables. We can <em>join</em> the tables on the <code>cat_id</code> column, creating a new table with both <code>name</code> and <code>color</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Joins">Joins<a class="anchor-link" href="#Joins">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A join combines tables by matching values in their columns.</p>
<p>There are four main types of joins: inner joins, outer joins, left joins, and right joins. Although all four combine tables, each one treats non-matching values differently.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Inner-Join">Inner Join<a class="anchor-link" href="#Inner-Join">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Definition:</b> In an inner join, the final table only contains rows that have matching columns in <strong>both</strong> tables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Inner Join" src="https://www.w3schools.com/sql/img_innerjoin.gif"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Example:</b> We would like to join the <code>names</code> and <code>colors</code> tables together to match each cat with its color. Since both tables contain a <code>cat_id</code> column that is the unique identifier for a cat, we can use an inner join on the <code>cat_id</code> column.</p>
<p><b>SQL:</b> To write an inner join in SQL we modify our <code>FROM</code> clause to use the following syntax:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">TABLE_1</span><span class="o">&gt;</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="n">TABLE_2</span><span class="o">&gt;</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>
</pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="k">AS</span> <span class="n">N</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">colors</span> <span class="k">AS</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>cat_id</th>
<th>name</th>
<th>cat_id</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Apricot</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>Boots</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>Cally</td>
<td>2</td>
<td>calico</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You may verify that each cat name is matched with its color. Notice that the cats with <code>cat_id</code> 3 and 4 are not present in our resulting table because the <code>colors</code> table doesn't have a row with <code>cat_id</code> 4 and the <code>names</code> table doesn't have a row with <code>cat_id</code> 3. In an inner join, if a row doesn't have a matching value in the other table, the row is not included in the final result.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assuming we have a DataFrame called <code>names</code> and a DataFrame called <code>colors</code>, we can conduct an inner join in <code>pandas</code> by writing:</p>
<div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">'inner'</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">'cat_id'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Full/Outer-Join">Full/Outer Join<a class="anchor-link" href="#Full/Outer-Join">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Definition:</b> In a full join (sometimes called an outer join), <strong>all records from both tables</strong> are included in the joined table. If a row doesn't have a match in the other table, the missing values are filled in with <code>NULL</code>.</p>
<p><img alt="Full outer join" src="https://www.w3schools.com/sql/img_fulljoin.gif"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Example:</b> As before, we join the <code>names</code> and <code>colors</code> tables together to match each cat with its color. This time, we want to keep all rows in either table even if there isn't a match.</p>
<p><b>SQL:</b> To write an outer join in SQL we modify our <code>FROM</code> clause to use the following syntax:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">TABLE_1</span><span class="o">&gt;</span>
    <span class="k">FULL</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="n">TABLE_2</span><span class="o">&gt;</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>
</pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="n">N</span>
    <span class="k">FULL</span> <span class="k">JOIN</span> <span class="n">colors</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>cat_id</th>
<th>name</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Apricot</td>
<td>orange</td>
</tr>
<tr>
<td>1</td>
<td>Boots</td>
<td>black</td>
</tr>
<tr>
<td>2</td>
<td>Cally</td>
<td>calico</td>
</tr>
<tr>
<td>3</td>
<td>NULL</td>
<td>white</td>
</tr>
<tr>
<td>4</td>
<td>Eugene</td>
<td>NULL</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the final output contains the entries with <code>cat_id</code> 3 and 4. If a row does not have a match, it is still included in the final output and any missing values are filled in with <code>NULL</code>.</p>
<p>In <code>pandas</code>:</p>
<pre><code>pd.merge(names, colors, how='outer', on='cat_id')</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Left-Join">Left Join<a class="anchor-link" href="#Left-Join">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Definition:</b> In a left join, all records from the <strong>left table</strong> are included in the joined table. If a row doesn't have a match in the right table, the missing values are filled in with <code>NULL</code>.</p>
<p><img alt="left join" src="https://www.w3schools.com/sql/img_leftjoin.gif"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Example:</b> As before, we join the <code>names</code> and <code>colors</code> tables together to match each cat with its color. This time, we want to keep all the cat names even if a cat doesn't have a matching color.</p>
<p><b>SQL:</b> To write an left join in SQL we modify our <code>FROM</code> clause to use the following syntax:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">TABLE_1</span><span class="o">&gt;</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="n">TABLE_2</span><span class="o">&gt;</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>
</pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="n">N</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">colors</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>cat_id</th>
<th>name</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Apricot</td>
<td>orange</td>
</tr>
<tr>
<td>1</td>
<td>Boots</td>
<td>black</td>
</tr>
<tr>
<td>2</td>
<td>Cally</td>
<td>calico</td>
</tr>
<tr>
<td>4</td>
<td>Eugene</td>
<td>NULL</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the final output includes all four cat names. Three of the <code>cat_id</code>s in the <code>names</code> relation had matching <code>cat_id</code>s in the <code>colors</code> table and one did not (Eugene). The cat name that did not have a matching color has <code>NULL</code> as its color.</p>
<p>In <code>pandas</code>:</p>
<pre><code>pd.merge(names, colors, how='left', on='cat_id')</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Right-Join">Right Join<a class="anchor-link" href="#Right-Join">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Definition:</b> In a right join, all records from the <strong>right table</strong> are included in the joined table. If a row doesn't have a match in the left table, the missing values are filled in with <code>NULL</code>.</p>
<p><img alt="right join" src="https://www.w3schools.com/sql/img_rightjoin.gif"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><b>Example:</b> As before, we join the <code>names</code> and <code>colors</code> tables together to match each cat with its color. This time, we want to keep all the cat color even if a cat doesn't have a matching name.</p>
<p><b>SQL:</b> To write a right join in SQL we modify our <code>FROM</code> clause to use the following syntax:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="p">...</span>
<span class="k">FROM</span> <span class="o">&lt;</span><span class="n">TABLE_1</span><span class="o">&gt;</span>
    <span class="k">RIGHT</span> <span class="k">JOIN</span> <span class="o">&lt;</span><span class="n">TABLE_2</span><span class="o">&gt;</span>
    <span class="k">ON</span> <span class="o">&lt;</span><span class="p">...</span><span class="o">&gt;</span>
</pre></div>
<p>For example:</p>
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">color</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="n">N</span>
    <span class="k">RIGHT</span> <span class="k">JOIN</span> <span class="n">colors</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>cat_id</th>
<th>name</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Apricot</td>
<td>orange</td>
</tr>
<tr>
<td>1</td>
<td>Boots</td>
<td>black</td>
</tr>
<tr>
<td>2</td>
<td>Cally</td>
<td>calico</td>
</tr>
<tr>
<td>3</td>
<td>NULL</td>
<td>white</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This time, observe that the final output includes all four cat colors. Three of the <code>cat_id</code>s in the <code>colors</code> relation had matching <code>cat_id</code>s in the <code>names</code> table and one did not (white). The cat color that did not have a matching name has <code>NULL</code> as its name.</p>
<p>You may also notice that a right join produces the same result a left join with the table order swapped. That is, <code>names</code> left joined with <code>colors</code> is the same as <code>colors</code> right joined with <code>names</code>. Because of this, some SQL engines (such as SQLite) do not support right joins.</p>
<p>In <code>pandas</code>:</p>
<pre><code>pd.merge(names, colors, how='right', on='cat_id')</code></pre>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Implicit-Inner-Joins">Implicit Inner Joins<a class="anchor-link" href="#Implicit-Inner-Joins">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are typically multiple ways to accomplish the same task in SQL just as there are multiple ways to accomplish the same task in Python. We point out one other method for writing an inner join that appears in practice called an <em>implicit join</em>. Recall that we previously wrote the following to conduct an inner join:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="k">AS</span> <span class="n">N</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">colors</span> <span class="k">AS</span> <span class="k">C</span>
    <span class="k">ON</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>An implicit inner join has a slightly different syntax. Notice in particular that the <code>FROM</code> clause uses a comma to select from two tables and that the query includes a <code>WHERE</code> clause to specify the join condition.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="k">AS</span> <span class="n">N</span><span class="p">,</span> <span class="n">colors</span> <span class="k">AS</span> <span class="k">C</span>
<span class="k">WHERE</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When multiple tables are specified in the <code>FROM</code> clause, SQL creates a table containing every combination of rows from each table. For example:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT *</span>
<span class="s2">FROM names N, colors C</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>cat_id</th>
<th>name</th>
<th>cat_id</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Apricot</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>Apricot</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>2</th>
<td>0</td>
<td>Apricot</td>
<td>2</td>
<td>calico</td>
</tr>
<tr>
<th>3</th>
<td>0</td>
<td>Apricot</td>
<td>3</td>
<td>white</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>Boots</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>5</th>
<td>1</td>
<td>Boots</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>6</th>
<td>1</td>
<td>Boots</td>
<td>2</td>
<td>calico</td>
</tr>
<tr>
<th>7</th>
<td>1</td>
<td>Boots</td>
<td>3</td>
<td>white</td>
</tr>
<tr>
<th>8</th>
<td>2</td>
<td>Cally</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>9</th>
<td>2</td>
<td>Cally</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>10</th>
<td>2</td>
<td>Cally</td>
<td>2</td>
<td>calico</td>
</tr>
<tr>
<th>11</th>
<td>2</td>
<td>Cally</td>
<td>3</td>
<td>white</td>
</tr>
<tr>
<th>12</th>
<td>4</td>
<td>Eugene</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>13</th>
<td>4</td>
<td>Eugene</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>14</th>
<td>4</td>
<td>Eugene</td>
<td>2</td>
<td>calico</td>
</tr>
<tr>
<th>15</th>
<td>4</td>
<td>Eugene</td>
<td>3</td>
<td>white</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This operation is often called a <em>Cartesian product</em>: each row in the first table is paired with every row in the second table. Notice that many rows contain cat colors that are not matched properly with their names. The additional <code>WHERE</code>  clause in the implicit join filters out rows that do not have matching <code>cat_id</code> values.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="k">SELECT</span> <span class="o">*</span>
<span class="k">FROM</span> <span class="k">names</span> <span class="k">AS</span> <span class="n">N</span><span class="p">,</span> <span class="n">colors</span> <span class="k">AS</span> <span class="k">C</span>
<span class="k">WHERE</span> <span class="n">N</span><span class="p">.</span><span class="n">cat_id</span> <span class="o">=</span> <span class="k">C</span><span class="p">.</span><span class="n">cat_id</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>cat_id</th>
<th>name</th>
<th>cat_id</th>
<th>color</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>Apricot</td>
<td>0</td>
<td>orange</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>Boots</td>
<td>1</td>
<td>black</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>Cally</td>
<td>2</td>
<td>calico</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Joining-Multiple-Tables">Joining Multiple Tables<a class="anchor-link" href="#Joining-Multiple-Tables">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To join multiple tables, extend the <code>FROM</code> clause with additional <code>JOIN</code> operators. For example, the following table <code>ages</code> includes data about each cat's age.</p>
<table>
<thead><tr>
<th>cat_id</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>1</td>
<td>3</td>
</tr>
<tr>
<td>2</td>
<td>9</td>
</tr>
<tr>
<td>4</td>
<td>20</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To conduct an inner join on the <code>names</code>, <code>colors</code>, and <code>ages</code> table, we write:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Joining three tables</span>

<span class="n">sql_expr</span> <span class="o">=</span> <span class="s2">"""</span>
<span class="s2">SELECT name, color, age</span>
<span class="s2">    FROM names n</span>
<span class="s2">    INNER JOIN colors c ON n.cat_id = c.cat_id</span>
<span class="s2">    INNER JOIN ages a ON n.cat_id = a.cat_id;</span>
<span class="s2">"""</span>
<span class="n">pd</span><span class="o">.</span><span class="n">read_sql</span><span class="p">(</span><span class="n">sql_expr</span><span class="p">,</span> <span class="n">sqlite_engine</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>name</th>
<th>color</th>
<th>age</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>Apricot</td>
<td>orange</td>
<td>4</td>
</tr>
<tr>
<th>1</th>
<td>Boots</td>
<td>black</td>
<td>3</td>
</tr>
<tr>
<th>2</th>
<td>Cally</td>
<td>calico</td>
<td>9</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have covered the four main types of SQL joins: inner, full, left, and right joins. We use all four joins to combine information in separate relations, and each join differs only in how it handles non-matching rows in the input tables.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/10'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Modeling-and-Estimation">Modeling and Estimation<a class="anchor-link" href="#Modeling-and-Estimation">¶</a></h1><blockquote><p>Essentially, all models are wrong, but some are useful.</p>
<p>— <a href="https://www.wikiwand.com/en/George_E._P._Box">George Box, Statistician (1919-2013)</a></p>
</blockquote>
<p>We have covered question formulation, data cleaning, and exploratory data
analysis, the first three steps of the data science lifecycle. We have also
seen that EDA often reveals relationships between variables in our dataset. How
do we decide whether a relationship is real or spurious? How do we use these
relationships to make reliable predictions about the future? To answer these
questions we will need the mathematical tools for modeling and estimation.</p>
<p>A model is an <strong>idealized</strong> representation of a system. For example, if we drop
a ball off the Leaning Tower of Pisa, we expect the ball to drop to the ground
because we have a model of gravity. Our model of gravity also allows us to
predict how long it will take the ball to hit the ground using the laws of
projectile motion.</p>
<p>This model represents our system but is simplistic—for example, it leaves out
the effects of air resistance, the gravitational effects of other celestial
bodies, and the buoyancy of air. Because of these unconsidered factors, our
model will almost always make incorrect predictions in real life! Still, the
simple model of gravity is accurate enough in so many situations that it's
widely used and taught today.</p>
<p>In data science, we often use data to create models to estimate how the world
will behave in the future. How do we choose a model? How do we decide whether
we need a more complicated model? We will explore these questions in this
chapter.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/10'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Models">Models<a class="anchor-link" href="#Models">¶</a></h2><p>In the United States, many diners will leave a tip for their waiter or waitress as the diners pay for the meal. Although it is customary to offer <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-167-Title">
<title id="MathJax-SVG-167-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> of the total bill as tip, perhaps some restaurants have more generous patrons than others.</p>
<p>One particular waiter was so interested in how much tip he could expect to get that he collected a simple random sample of information about the tables he served.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>total_bill</th>
<th>tip</th>
<th>sex</th>
<th>smoker</th>
<th>day</th>
<th>time</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>16.99</td>
<td>1.01</td>
<td>Female</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>2</td>
</tr>
<tr>
<th>1</th>
<td>10.34</td>
<td>1.66</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
</tr>
<tr>
<th>2</th>
<td>21.01</td>
<td>3.50</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>241</th>
<td>22.67</td>
<td>2.00</td>
<td>Male</td>
<td>Yes</td>
<td>Sat</td>
<td>Dinner</td>
<td>2</td>
</tr>
<tr>
<th>242</th>
<td>17.82</td>
<td>1.75</td>
<td>Male</td>
<td>No</td>
<td>Sat</td>
<td>Dinner</td>
<td>2</td>
</tr>
<tr>
<th>243</th>
<td>18.78</td>
<td>3.00</td>
<td>Female</td>
<td>No</td>
<td>Thur</td>
<td>Dinner</td>
<td>2</td>
</tr>
</tbody>
</table>
<p>244 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can plot a histogram of the tip amounts:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Tip Amount in Dollars'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Dollar'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_simple_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are already some interesting patterns in the data. For example, there is a clear mode at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1001 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-168-Title">
<title id="MathJax-SVG-168-Title">\$2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</svg></span> and most tips seem to be in multiples of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.297ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2280.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-169-Title">
<title id="MathJax-SVG-169-Title">\$0.50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span>.</p>
<p>For now, we are most interested in the percent tip: the tip amount divided by the bill amount. We can create a column in our DataFrame for this variable and show its distribution.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_simple_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like one table left our waiter a tip of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-170-Title">
<title id="MathJax-SVG-170-Title">70\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>! However, most of the tips percentages are under <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-171-Title">
<title id="MathJax-SVG-171-Title">30\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>. Let's zoom into that part of the distribution.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_simple_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can the distribution is roughly centered at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-172-Title">
<title id="MathJax-SVG-172-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> with another potential mode at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-173-Title">
<title id="MathJax-SVG-173-Title">20\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>. Suppose our waiter is interested in predicting how much percent tip he will get from a given table. To address this question, we can create a model for how much tip the waiter will get.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Simple-Model">A Simple Model<a class="anchor-link" href="#A-Simple-Model">¶</a></h3><p>The simplest model possible is to completely ignore the data and state that since the convention in the U.S. is to give <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-174-Title">
<title id="MathJax-SVG-174-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> tip, the waiter will always get <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-175-Title">
<title id="MathJax-SVG-175-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> tip from his tables. While simple, let's use this model to define some variables that we'll use later on.</p>
<p>This model assumes that there is one true percentage tip that all tables, past and future, will give the waiter. This is the <em>population parameter</em> for the percent tip, which we will denote by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-176-Title">
<title id="MathJax-SVG-176-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>.</p>
<p>After making this assumption, our model then says that our guess for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-177-Title">
<title id="MathJax-SVG-177-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-178-Title">
<title id="MathJax-SVG-178-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>. We will use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-179-Title">
<title id="MathJax-SVG-179-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to represent our estimate.</p>
<p>In mathematical notation, our model states that:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-180-Title">
<title id="MathJax-SVG-180-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span><p>Normally, we would denote our constant model as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.47ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4077.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-181-Title">
<title id="MathJax-SVG-181-Title"> f_\theta(x) = \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1884" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2551" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3608" y="0"></use>
</g>
</svg></span> where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-182-Title">
<title id="MathJax-SVG-182-Title"> \theta =15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span>, but since our model is not a function of any independent variables, we represent our estimate as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-183-Title">
<title id="MathJax-SVG-183-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Later, we will use the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.434ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2339.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-184-Title">
<title id="MathJax-SVG-184-Title">f_\boldsymbol\theta(x)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1950" y="0"></use>
</g>
</svg></span> notation for more complicated models.</p>
<p>This model is obviously wrong—if the model were accurate, every table in our dataset should have given the waiter exactly <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-185-Title">
<title id="MathJax-SVG-185-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> tip. However, this model will probably make a reasonable guess for most scenarios. In fact, if we had no data on previous tables and their percent tips this model would be a good choice. Still, the question remains: what if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-186-Title">
<title id="MathJax-SVG-186-Title">10\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> is a better estimate? Or <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-187-Title">
<title id="MathJax-SVG-187-Title">20\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>? Without data, we are mostly limited to blind guesses.</p>
<p>However, since our waiter's dataset was sampled at random from our population of interest, our sample will likely resemble the population. This key insight allows us to use our sample to evaluate the accuracy of our model. In particular, we can use the sample of tip percentages to decide whether <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-188-Title">
<title id="MathJax-SVG-188-Title">10\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-189-Title">
<title id="MathJax-SVG-189-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-190-Title">
<title id="MathJax-SVG-190-Title">20\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>, or some other percent is the best choice for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-191-Title">
<title id="MathJax-SVG-191-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Loss-Function-Intuition">Loss Function Intuition<a class="anchor-link" href="#Loss-Function-Intuition">¶</a></h3><p>The distribution of tip percents from our dataset is replicated below for convenience.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_simple_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's suppose we are trying to compare two choices for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-192-Title">
<title id="MathJax-SVG-192-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-193-Title">
<title id="MathJax-SVG-193-Title">10\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.261ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1834.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-194-Title">
<title id="MathJax-SVG-194-Title">15\%</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="1001" y="0"></use>
</g>
</svg></span>. We can mark both of these choices on our distribution:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'darkblue'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta = 10$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'goldenrod'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta = 15$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_simple_15_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Intuitively, it looks like choosing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-195-Title">
<title id="MathJax-SVG-195-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> makes more sense than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-196-Title">
<title id="MathJax-SVG-196-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> given our dataset. Why is this? When we look at the points in our data, we can see that more points fall close to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-197-Title">
<title id="MathJax-SVG-197-Title">15</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</svg></span> than they do to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-198-Title">
<title id="MathJax-SVG-198-Title">10</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</svg></span>.</p>
<p>Although in this case it is clear that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-199-Title">
<title id="MathJax-SVG-199-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> is a better choice than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-200-Title">
<title id="MathJax-SVG-200-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span>, it is not so clear whether <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-201-Title">
<title id="MathJax-SVG-201-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> is a better choice than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-202-Title">
<title id="MathJax-SVG-202-Title"> \theta = 16 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</svg></span>. By assigning a specific number that measures how "good" a given choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-203-Title">
<title id="MathJax-SVG-203-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is, we make precise choices between different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-204-Title">
<title id="MathJax-SVG-204-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. This is a mathematical function that takes in a value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-205-Title">
<title id="MathJax-SVG-205-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and the points in our dataset, outputting a single number that we will use to select the best value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-206-Title">
<title id="MathJax-SVG-206-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that we can.</p>
<p>We call this function a <em>loss function</em>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/10'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loss-Functions">Loss Functions<a class="anchor-link" href="#Loss-Functions">¶</a></h2><p>For now, our model assumes that there is a single population tip percentage <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-207-Title">
<title id="MathJax-SVG-207-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>. We are trying to estimate this parameter, and we use the variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-208-Title">
<title id="MathJax-SVG-208-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to denote our estimate. Since our sample of tips is a random sample drawn from the population, we believe that using our sample to create a best estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-209-Title">
<title id="MathJax-SVG-209-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> will give a value close to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-210-Title">
<title id="MathJax-SVG-210-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>.</p>
<p>To precisely decide which value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-211-Title">
<title id="MathJax-SVG-211-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is best, we need to define a <em>loss function</em>. A loss function is a mathematical function that takes in an estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-212-Title">
<title id="MathJax-SVG-212-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and the points in our dataset <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.957ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 5578.6 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-213-Title">
<title id="MathJax-SVG-213-Title">y_1, y_2, \ldots, y_n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2C" x="944" y="0"></use>
<g transform="translate(1389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2333" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2779" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4118" y="0"></use>
<g transform="translate(4563,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</svg></span>. It outputs a single number that we can use to choose between two different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-214-Title">
<title id="MathJax-SVG-214-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. In mathematical notation, we want to create the function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.263ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10877 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-215-Title">
<title id="MathJax-SVG-215-Title"> L(\theta, y_1, y_2, \ldots, y_n) =\ \ldots </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
<g transform="translate(1985,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2930" y="0"></use>
<g transform="translate(3375,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4319" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="4764" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6103" y="0"></use>
<g transform="translate(6549,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7564" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8231" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="9704" y="0"></use>
</g>
</svg></span><p>By convention, the loss function outputs lower values for preferable values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-216-Title">
<title id="MathJax-SVG-216-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and larger values for worse values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-217-Title">
<title id="MathJax-SVG-217-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. In the previous section, we compared <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-218-Title">
<title id="MathJax-SVG-218-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-219-Title">
<title id="MathJax-SVG-219-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'darkblue'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta = 10$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'goldenrod'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta = 15$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_4_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-220-Title">
<title id="MathJax-SVG-220-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> falls closer to most of the points, our loss function should output a small value for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-221-Title">
<title id="MathJax-SVG-221-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> and a larger value for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-222-Title">
<title id="MathJax-SVG-222-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span>.</p>
<p>Let's use this intuition to create a loss function.</p>
<h3 id="Our-First-Loss-Function:-Mean-Squared-Error">Our First Loss Function: Mean Squared Error<a class="anchor-link" href="#Our-First-Loss-Function:-Mean-Squared-Error">¶</a></h3><p>We would like our choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-223-Title">
<title id="MathJax-SVG-223-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to fall close to the points in our dataset. Thus, we can define a loss function that outputs a larger value as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-224-Title">
<title id="MathJax-SVG-224-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> gets further away from the points in the dataset. We start with a simple loss function called the <em>mean squared error</em>. Here's the idea:</p>
<ol>
<li>We select a value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-225-Title">
<title id="MathJax-SVG-225-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</li>
<li>For each value in our dataset, take the squared difference between the value and theta: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.733ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 3760.2 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-226-Title">
<title id="MathJax-SVG-226-Title"> (y_i - \theta)^2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2447" y="0"></use>
<g transform="translate(2916,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg></span> . Squaring the difference in a simple way to convert negative differences into positive ones. We want to do this because if our point <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.362ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3169.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-227-Title">
<title id="MathJax-SVG-227-Title"> y_i = 14 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
<g transform="translate(2168,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-228-Title">
<title id="MathJax-SVG-228-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-229-Title">
<title id="MathJax-SVG-229-Title"> \theta = 18 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-38" x="500" y="0"></use>
</g>
</g>
</svg></span> are equally far away from the point and are thus equally "bad".</li>
<li>To compute the final loss, take the average of each of the individual squared differences.</li>
</ol>
<p>This gives us a final loss function of:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.452ex" height="15.843ex" style="vertical-align: -7.338ex;" viewBox="0 -3661.7 28611.2 6821.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-230-Title">
<title id="MathJax-SVG-230-Title">
\begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&amp;= \text{average}\left\{ (y_1 - \theta)^2, (y_2 - \theta)^2, \ldots, (y_n - \theta)^2 \right\} \\
&amp;= \frac{1}{n} \left((y_1 - \theta)^2 + (y_2 - \theta)^2 + \ldots + (y_n - \theta)^2 \right) \\
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2685)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
<g transform="translate(1985,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2930" y="0"></use>
<g transform="translate(3375,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4319" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="4764" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6103" y="0"></use>
<g transform="translate(6549,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7564" y="0"></use>
</g>
</g>
<g transform="translate(7943,0)">
<g transform="translate(0,2685)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-76" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1029" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1473" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1866" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2366" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2867" y="0"></use>
</g>
<g transform="translate(4812,0)">
 <use xlink:href="#MJSZ1-7B" x="0" y="-1"></use>
 <use xlink:href="#MJMAIN-28" x="583" y="0"></use>
<g transform="translate(973,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2139" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3140" y="0"></use>
<g transform="translate(3609,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4453" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4898" y="0"></use>
<g transform="translate(5287,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6454" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7455" y="0"></use>
<g transform="translate(7924,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8768" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="9213" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="10552" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10997" y="0"></use>
<g transform="translate(11387,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="12624" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="13625" y="0"></use>
<g transform="translate(14094,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJSZ1-7D" x="14938" y="-1"></use>
</g>
</g>
<g transform="translate(0,690)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2294,0)">
 <use xlink:href="#MJSZ1-28"></use>
 <use xlink:href="#MJMAIN-28" x="458" y="0"></use>
<g transform="translate(848,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2014" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3015" y="0"></use>
<g transform="translate(3484,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4550" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5551" y="0"></use>
<g transform="translate(5940,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="7107" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="8108" y="0"></use>
<g transform="translate(8577,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9643" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="10643" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="12038" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13039" y="0"></use>
<g transform="translate(13428,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="14666" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="15666" y="0"></use>
<g transform="translate(16136,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJSZ1-29" x="16979" y="-1"></use>
</g>
</g>
<g transform="translate(0,-1873)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Creating a Python function to compute the loss is simple to do:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how this loss function behaves. Suppose we have a dataset only containing one point, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.617ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3279.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-231-Title">
<title id="MathJax-SVG-231-Title"> y_1 = 14 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1222" y="0"></use>
<g transform="translate(2278,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg></span>. We can try different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-232-Title">
<title id="MathJax-SVG-232-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and see what the loss function outputs for each value.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">try_thetas</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">mse_loss</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_vals</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thetas</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">rf</span><span class="s1">'$ </span><span class="se">\t</span><span class="s1">heta = </span><span class="si">{theta}</span><span class="s1"> $'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">f</span><span class="s1">'Loss = {loss_fn(theta, y_vals):.2f}'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlims</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="n">try_thetas</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
           <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can also interactively try different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-233-Title">
<title id="MathJax-SVG-233-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> below. You should understand why the loss for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-234-Title">
<title id="MathJax-SVG-234-Title"> \theta = 11 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span> is many times higher than the loss for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-235-Title">
<title id="MathJax-SVG-235-Title"> \theta = 13 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">try_thetas_interact</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">mse_loss</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_vals</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlims</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Loss for theta = </span><span class="si">{theta}</span><span class="s1">: {loss_fn(theta, y_vals):.2f}'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mse_interact</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">xlims</span><span class="p">):</span>
    <span class="n">plot</span> <span class="o">=</span> <span class="n">interactive</span><span class="p">(</span><span class="n">try_thetas_interact</span><span class="p">,</span> <span class="n">theta</span><span class="o">=</span><span class="n">theta</span><span class="p">,</span>
                       <span class="n">y_vals</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span> <span class="n">xlims</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">xlims</span><span class="p">),</span>
                       <span class="n">loss_fn</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="n">mse_loss</span><span class="p">))</span>
    <span class="n">plot</span><span class="o">.</span><span class="n">children</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">layout</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="s1">'240px'</span>
    <span class="k">return</span> <span class="n">plot</span>
    
<span class="n">mse_interact</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we hoped, our loss is larger as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-236-Title">
<title id="MathJax-SVG-236-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is further away from our data and is smallest when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-237-Title">
<title id="MathJax-SVG-237-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> falls exactly onto our data point. Let's now see how our mean squared error behaves when we have five points instead of one. Our data this time are: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.132ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11681.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-238-Title">
<title id="MathJax-SVG-238-Title"> \{ 12.1, 12.8, 14.9, 16.3, 17.2 \} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2280" y="0"></use>
<g transform="translate(2725,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4505" y="0"></use>
<g transform="translate(4950,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6730" y="0"></use>
<g transform="translate(7176,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8956" y="0"></use>
<g transform="translate(9401,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="11181" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">try_thetas</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
           <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">],</span>
           <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Of the values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-239-Title">
<title id="MathJax-SVG-239-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> we tried <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-240-Title">
<title id="MathJax-SVG-240-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> has the lowest loss. However, a value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-241-Title">
<title id="MathJax-SVG-241-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> in between 14 and 15 might have an even lower loss than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-242-Title">
<title id="MathJax-SVG-242-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span>. See if you can find a better value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-243-Title">
<title id="MathJax-SVG-243-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> using the interactive plot below.</p>
<p>(How might we know for certain whether we've found the best value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-244-Title">
<title id="MathJax-SVG-244-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>? We will tackle this issue soon.)</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mse_interact</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
             <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">],</span>
             <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The mean squared error seems to be doing its job by penalizing values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-245-Title">
<title id="MathJax-SVG-245-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that are far away from the center of the data. Let's now see what the loss function outputs on the original dataset of tip percents. For reference, the original distribution of tip percents is plotted below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's try some values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-246-Title">
<title id="MathJax-SVG-246-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">try_thetas</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
           <span class="n">y_vals</span><span class="o">=</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span>
           <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As before, we've created an interactive widget to test different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-247-Title">
<title id="MathJax-SVG-247-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mse_interact</span><span class="p">(</span><span class="n">theta</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
             <span class="n">y_vals</span><span class="o">=</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span>
             <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like the best value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-248-Title">
<title id="MathJax-SVG-248-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that we've tried so far is 16.00. This is slightly above our original blind guess of 15% tip. It appears that our waiter gets a bit more tip than we originally thought.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Shorthand">A Shorthand<a class="anchor-link" href="#A-Shorthand">¶</a></h3><p>We have defined our first loss function, the mean squared error (MSE). It computes high loss for values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-249-Title">
<title id="MathJax-SVG-249-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that are further away from the center of the data. Mathematically, this loss function is defined as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.029ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 15943.2 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-250-Title">
<title id="MathJax-SVG-250-Title">
\begin{aligned}
L(\theta, y_1, y_2, \ldots, y_n)
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
<g transform="translate(1985,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2930" y="0"></use>
<g transform="translate(3375,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4319" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="4764" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6103" y="0"></use>
<g transform="translate(6549,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7564" y="0"></use>
</g>
</g>
<g transform="translate(7943,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>The loss function will compute different losses whenever we change either <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-251-Title">
<title id="MathJax-SVG-251-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> or <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.957ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 5578.6 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-252-Title">
<title id="MathJax-SVG-252-Title"> y_1, y_2, \ldots, y_n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2C" x="944" y="0"></use>
<g transform="translate(1389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2333" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2779" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4118" y="0"></use>
<g transform="translate(4563,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</svg></span>. We've seen this happen when we tried different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-253-Title">
<title id="MathJax-SVG-253-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and when we added new data points (changing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.957ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 5578.6 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-254-Title">
<title id="MathJax-SVG-254-Title"> y_1, y_2, \ldots, y_n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2C" x="944" y="0"></use>
<g transform="translate(1389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2333" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2779" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4118" y="0"></use>
<g transform="translate(4563,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</svg></span>).</p>
<p>As a shorthand, we can define the vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.76ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8077.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-255-Title">
<title id="MathJax-SVG-255-Title"> \textbf{y} = [ y_1, y_2, \ldots, y_n ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3164" y="0"></use>
<g transform="translate(3609,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4554" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="4999" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6338" y="0"></use>
<g transform="translate(6783,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7798" y="0"></use>
</g>
</svg></span>. Then, we can write MSE as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.484ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 10972.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-256-Title">
<title id="MathJax-SVG-256-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Finding-the-Best-Value-of-$-\theta-$">Finding the Best Value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-257-Title">
<title id="MathJax-SVG-257-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span><a class="anchor-link" href="#Finding-the-Best-Value-of-$-\theta-$">¶</a></h3><p>So far, we have found the best value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-258-Title">
<title id="MathJax-SVG-258-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> by simply trying out a bunch of values and then picking the one with the least loss. Although this method works decently well, we can find a better method by using the properties of our loss function.</p>
<p>For the time being, let's return to our example with five points: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.61ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13179.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-259-Title">
<title id="MathJax-SVG-259-Title"> \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4000" y="0"></use>
<g transform="translate(4445,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6225" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8450" y="0"></use>
<g transform="translate(8895,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="10675" y="0"></use>
<g transform="translate(11120,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12900" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">try_thetas</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
           <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">],</span>
           <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_24_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the plots above, we've used integer <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-260-Title">
<title id="MathJax-SVG-260-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values in between 12 and 17. When we change <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-261-Title">
<title id="MathJax-SVG-261-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, the loss seems to start high (at 10.92), decrease until <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-262-Title">
<title id="MathJax-SVG-262-Title"> \theta = 15 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span>, then increase again. We can see that the loss changes as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-263-Title">
<title id="MathJax-SVG-263-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> changes, so let's make a plot comparing the loss to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-264-Title">
<title id="MathJax-SVG-264-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for each of the six <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-265-Title">
<title id="MathJax-SVG-265-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>s we've tried.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">losses</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Loss vs. $ \theta $ when $\bf</span><span class="si">{y}</span><span class="s1">$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $ Values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_26_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The scatter plot shows the downward, then upward trend that we noticed before. We can try more values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-266-Title">
<title id="MathJax-SVG-266-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to see a complete curve that shows how the loss changes as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-267-Title">
<title id="MathJax-SVG-267-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> changes.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">losses</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Loss vs. $ \theta $ when $\bf</span><span class="si">{y}</span><span class="s1">$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $ Values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_28_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plot above shows that in fact, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-268-Title">
<title id="MathJax-SVG-268-Title"> \theta = 15</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> was not the best choice; a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-269-Title">
<title id="MathJax-SVG-269-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> of around 14.7 would have gotten a lower loss! We can use calculus to find that minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-270-Title">
<title id="MathJax-SVG-270-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> exactly. First, we start with our loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.484ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 10972.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-271-Title">
<title id="MathJax-SVG-271-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>And plug in our points <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.61ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13179.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-272-Title">
<title id="MathJax-SVG-272-Title"> \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4000" y="0"></use>
<g transform="translate(4445,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6225" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8450" y="0"></use>
<g transform="translate(8895,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="10675" y="0"></use>
<g transform="translate(11120,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12900" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="81.143ex" height="5.176ex" style="vertical-align: -1.79ex; margin-bottom: -0.215ex;" viewBox="0 -1365.4 34936.3 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-273-Title">
<title id="MathJax-SVG-273-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \big((12.1 - \theta)^2 + (12.8 - \theta)^2 + (14.9 - \theta)^2 + (16.3 - \theta)^2 + (17.2 - \theta)^2 \big)\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-73)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,-73)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJSZ1-28" x="2294" y="-1"></use>
 <use xlink:href="#MJMAIN-28" x="2753" y="0"></use>
<g transform="translate(3142,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5144" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6145" y="0"></use>
<g transform="translate(6615,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="7680" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8681" y="0"></use>
<g transform="translate(9070,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="11073" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="12073" y="0"></use>
<g transform="translate(12543,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="13608" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14609" y="0"></use>
<g transform="translate(14999,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="17001" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="18002" y="0"></use>
<g transform="translate(18471,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="19537" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="20537" y="0"></use>
<g transform="translate(20927,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="22929" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="23930" y="0"></use>
<g transform="translate(24399,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="25465" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="26466" y="0"></use>
<g transform="translate(26855,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="28857" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="29858" y="0"></use>
<g transform="translate(30328,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJSZ1-29" x="31171" y="-1"></use>
</g>
</g>
</g>
</g>
</svg></span><p>To find the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-274-Title">
<title id="MathJax-SVG-274-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes this function, we compute the derivative with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-275-Title">
<title id="MathJax-SVG-275-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="87.769ex" height="10.843ex" style="vertical-align: -4.636ex; margin-bottom: -0.202ex;" viewBox="0 -2585.3 37789.2 4668.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-276-Title">
<title id="MathJax-SVG-276-Title">
\begin{aligned}
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&amp;= \frac{1}{n} \big(-2(12.1 - \theta) - 2(12.8 - \theta) - 2(14.9 - \theta) - 2(16.3 - \theta) -2(17.2 - \theta) \big)\\
&amp;= - \frac{2}{n} \big((12.1 - \theta) + (12.8 - \theta) + (14.9 - \theta) + (16.3 - \theta) + (17.2 - \theta) \big)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1103)">
<g transform="translate(120,0)">
<rect stroke="none" width="1157" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-2202" x="294" y="676"></use>
<g transform="translate(60,-736)">
 <use xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="1397" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2078" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2468" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2937" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3382" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3990" y="0"></use>
</g>
</g>
<g transform="translate(4369,0)">
<g transform="translate(0,1103)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJSZ1-28" x="2294" y="-1"></use>
 <use xlink:href="#MJMAIN-2212" x="2975" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="3976" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4476" y="0"></use>
<g transform="translate(4866,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6868" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7868" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8338" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8950" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="9950" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10451" y="0"></use>
<g transform="translate(10840,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="12843" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="13843" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14313" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="14925" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="15925" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="16426" y="0"></use>
<g transform="translate(16815,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="18818" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="19818" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="20288" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="20899" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="21900" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="22401" y="0"></use>
<g transform="translate(22790,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="24792" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="25793" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="26263" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="26874" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="27875" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="28376" y="0"></use>
<g transform="translate(28765,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="30767" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="31768" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="32238" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="32627" y="-1"></use>
</g>
<g transform="translate(0,-1299)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJSZ1-28" x="3073" y="-1"></use>
 <use xlink:href="#MJMAIN-28" x="3531" y="0"></use>
<g transform="translate(3921,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5923" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6924" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7393" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8005" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9005" y="0"></use>
<g transform="translate(9395,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="11397" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="12398" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12867" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13479" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14480" y="0"></use>
<g transform="translate(14869,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="16872" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="17872" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18342" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18954" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="19954" y="0"></use>
<g transform="translate(20344,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="22346" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="23347" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="23816" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="24428" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="25429" y="0"></use>
<g transform="translate(25818,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="27820" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="28821" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="29291" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="29680" y="-1"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Then, we find the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-277-Title">
<title id="MathJax-SVG-277-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> where the derivative is zero:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="73.005ex" height="19.843ex" style="vertical-align: -9.338ex;" viewBox="0 -4522.8 31432.6 8543.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-278-Title">
<title id="MathJax-SVG-278-Title">
\begin{aligned}
0 &amp;= - \frac{2}{n} \big((12.1 - \theta) + (12.8 - \theta) + (14.9 - \theta) + (16.3 - \theta) + (17.2 - \theta) \big) \\
0 &amp;= (12.1 - \theta) + (12.8 - \theta) + (14.9 - \theta) + (16.3 - \theta) + (17.2 - \theta) \\
5 \theta &amp;= 12.1 + 12.8 + 14.9 + 16.3 + 17.2 \\
\theta &amp;= \frac{12.1 + 12.8 + 14.9 + 16.3 + 17.2}{5} \\
\theta &amp;= 14.66
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-30" x="469" y="3084"></use>
 <use xlink:href="#MJMAIN-30" x="469" y="1286"></use>
<g transform="translate(0,-65)">
 <use xlink:href="#MJMAIN-35" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-3B8" x="500" y="-1919"></use>
 <use xlink:href="#MJMATHI-3B8" x="500" y="-3729"></use>
</g>
<g transform="translate(959,0)">
<g transform="translate(0,3084)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJSZ1-28" x="3073" y="-1"></use>
 <use xlink:href="#MJMAIN-28" x="3531" y="0"></use>
<g transform="translate(3921,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5923" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6924" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7393" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8005" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9005" y="0"></use>
<g transform="translate(9395,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="11397" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="12398" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12867" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13479" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14480" y="0"></use>
<g transform="translate(14869,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="16872" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="17872" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18342" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18954" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="19954" y="0"></use>
<g transform="translate(20344,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="22346" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="23347" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="23816" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="24428" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="25429" y="0"></use>
<g transform="translate(25818,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="27820" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="28821" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="29291" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="29680" y="-1"></use>
</g>
<g transform="translate(0,1286)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3725" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="4726" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5196" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5807" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6808" y="0"></use>
<g transform="translate(7197,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="9200" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="10200" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10670" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="11282" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12282" y="0"></use>
<g transform="translate(12672,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="14674" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="15675" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="16144" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="16756" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="17757" y="0"></use>
<g transform="translate(18146,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="20148" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="21149" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21619" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="22230" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="23231" y="0"></use>
<g transform="translate(23621,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="25623" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="26624" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="27093" y="0"></use>
</g>
<g transform="translate(0,-65)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3336" y="0"></use>
<g transform="translate(4337,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="6339" y="0"></use>
<g transform="translate(7339,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9342" y="0"></use>
<g transform="translate(10342,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="12345" y="0"></use>
<g transform="translate(13345,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(0,-1919)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="13911" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2002" y="0"></use>
<g transform="translate(3002,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5005" y="0"></use>
<g transform="translate(6005,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8008" y="0"></use>
<g transform="translate(9008,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="11011" y="0"></use>
<g transform="translate(12011,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-35" x="6705" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-3729)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1780" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've found the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-279-Title">
<title id="MathJax-SVG-279-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, and as expected, it is between 14 and 15. We denote the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-280-Title">
<title id="MathJax-SVG-280-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes the loss <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-281-Title">
<title id="MathJax-SVG-281-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>.</p>
<p>Turn your attention to the second-to-last line of the simplification above:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.323ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 16069.6 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-282-Title">
<title id="MathJax-SVG-282-Title"> \hat{\theta} = \frac{12.1 + 12.8 + 14.9 + 16.3 + 17.2}{5} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
<g transform="translate(1640,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="13911" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2002" y="0"></use>
<g transform="translate(3002,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5005" y="0"></use>
<g transform="translate(6005,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8008" y="0"></use>
<g transform="translate(9008,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="11011" y="0"></use>
<g transform="translate(12011,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-35" x="6705" y="-687"></use>
</g>
</g>
</g>
</svg></span><p>Notice that this is a familiar expression: it is the average of the five data points. Could this be a pattern for all values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-283-Title">
<title id="MathJax-SVG-283-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span>?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Minimizing-Value-of-the-Mean-Squared-Error">The Minimizing Value of the Mean Squared Error<a class="anchor-link" href="#The-Minimizing-Value-of-the-Mean-Squared-Error">¶</a></h3><p>We have seen that different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-284-Title">
<title id="MathJax-SVG-284-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> produce different losses when using mean squared error as our loss function. The arithmetic above hints that the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-285-Title">
<title id="MathJax-SVG-285-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes the loss is the mean of all of the data points. To confirm this, we turn back to the definition of our loss function. Instead of plugging in points, we take the derivative with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-286-Title">
<title id="MathJax-SVG-286-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> of the loss function as-is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.032ex" height="21.176ex" style="vertical-align: -9.741ex; margin-bottom: -0.263ex;" viewBox="0 -4809.9 13360.9 9117.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-287-Title">
<title id="MathJax-SVG-287-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\frac{\partial}{\partial \theta} L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n} -2(y_i - \theta) \\
&amp;= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(1396,3129)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
<g transform="translate(0,66)">
<g transform="translate(120,0)">
<rect stroke="none" width="1157" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-2202" x="294" y="676"></use>
<g transform="translate(60,-736)">
 <use xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="1397" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2078" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2468" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2937" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3382" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3990" y="0"></use>
</g>
</g>
<g transform="translate(4369,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4850" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5351" y="0"></use>
<g transform="translate(5740,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6797" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7798" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8268" y="0"></use>
</g>
<g transform="translate(0,-2997)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7600" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Notice that we have left the variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-288-Title">
<title id="MathJax-SVG-288-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> untouched. We are no longer working with the previous example dataset of five points; this equation can be used with any dataset with any number of points.</p>
<p>Now, we set the derivative equal to zero and solve for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-289-Title">
<title id="MathJax-SVG-289-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to find the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-290-Title">
<title id="MathJax-SVG-290-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> as before:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.101ex" height="39.843ex" style="vertical-align: -19.338ex;" viewBox="0 -8828.4 14251.9 17154.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-291-Title">
<title id="MathJax-SVG-291-Title">
\begin{aligned}
-\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) &amp;= 0 \\
\sum_{i = 1}^{n} (y_i - \theta) &amp;= 0 \\
\sum_{i = 1}^{n} y_i - \sum_{i = 1}^{n} \theta &amp;= 0 \\
\sum_{i = 1}^{n} \theta &amp;= \sum_{i = 1}^{n} y_i \\
n \cdot \theta &amp;= y_1 + \ldots + y_n \\
\theta &amp;= \frac{y_1 + \ldots + y_n}{n} \\
\theta &amp;= \text{mean} (\textbf{y})
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,7142)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(1905,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3350" y="0"></use>
<g transform="translate(3739,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4796" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="5797" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6266" y="0"></use>
</g>
<g transform="translate(1905,4079)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
 <use xlink:href="#MJMAIN-28" x="1444" y="0"></use>
<g transform="translate(1834,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2891" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3891" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4361" y="0"></use>
</g>
<g transform="translate(906,1017)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
<g transform="translate(1611,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2668" y="0"></use>
<g transform="translate(3668,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMATHI-3B8" x="5280" y="0"></use>
</g>
<g transform="translate(4575,-2046)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
 <use xlink:href="#MJMATHI-3B8" x="1611" y="0"></use>
</g>
<g transform="translate(4863,-4344)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1323" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-3B8" x="6186" y="-6159"></use>
 <use xlink:href="#MJMATHI-3B8" x="6186" y="-7957"></use>
</g>
<g transform="translate(6645,0)">
<g transform="translate(0,7142)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,4079)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,1017)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,-2046)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(2945,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(0,-4344)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2500" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="3501" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4896" y="0"></use>
<g transform="translate(5896,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(0,-6159)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5697" height="60" x="0" y="220"></rect>
<g transform="translate(60,725)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2B" x="1166" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2167" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3562" y="0"></use>
<g transform="translate(4562,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-6E" x="2548" y="-686"></use>
</g>
</g>
</g>
<g transform="translate(0,-7957)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-65" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1278" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1778" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3669" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4058" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4666" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Lo and behold, we see that there is a single value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-292-Title">
<title id="MathJax-SVG-292-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that gives the least MSE no matter what the dataset is. For the mean squared error, we can set <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-293-Title">
<title id="MathJax-SVG-293-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> equal to the mean of the dataset and be confident knowing that we have minimized the loss.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Back-to-the-Original-Dataset">Back to the Original Dataset<a class="anchor-link" href="#Back-to-the-Original-Dataset">¶</a></h3><p>We no longer have to test out different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-294-Title">
<title id="MathJax-SVG-294-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> as we did before. We can compute the mean tip percentage in one go:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>16.08025817225047</pre>
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">30</span><span class="p">),</span> <span class="n">rug</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">16.08</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'darkblue'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta = 16.08$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Distribution of tip percent'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Percent Tip Amount'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Percent'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_loss_functions_34_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h3><p>First, we restricted our model to only make a single number as its prediction for all tables. Next, we assume that the waiter's dataset of tips is similar to the population distribution of tip percentages. If this assumption holds, predicting <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.233ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 3114 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-295-Title">
<title id="MathJax-SVG-295-Title"> 16.08\% </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="2280" y="0"></use>
</g>
</svg></span> will give us the most accurate predictions that we can given our data.</p>
<p>To be more precise, we say that the model is accurate if it minimizes the squared difference between the predictions and the actual values.</p>
<p>Although our model is simple, it illustrates concepts that we'll see over and over again. Future chapters will introduce complicated models. Still, we will discuss each model's assumptions, define loss functions, and find the model that minimizes the loss. It is very helpful to understand this process for simple models before attempting to understand complex ones.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/10'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">compare_mse_abs</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span> <span class="n">xlims</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_vals</span><span class="p">)</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">thetas</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thetas</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span>
                    <span class="n">label</span><span class="o">=</span><span class="n">rf</span><span class="s1">'$ </span><span class="se">\t</span><span class="s1">heta = </span><span class="si">{theta}</span><span class="s1"> $'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE = {mse_loss(theta, y_vals):.2f}</span><span class="se">\n</span><span class="s1">'</span>
                  <span class="n">f</span><span class="s1">'MAE = {abs_loss(theta, y_vals):.2f}'</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlims</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Absolute-and-Huber-Loss">Absolute and Huber Loss<a class="anchor-link" href="#Absolute-and-Huber-Loss">¶</a></h2><p>Previously, we said that our model is accurate if it minimizes the squared difference between the predictions and the actual values. We used the mean squared error (MSE) loss to capture this measure of accuracy:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.484ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 10972.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-296-Title">
<title id="MathJax-SVG-296-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>We used a simple model that always predicts the same number:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.955ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2564.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-297-Title">
<title id="MathJax-SVG-297-Title"> \theta = C </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="1803" y="0"></use>
</g>
</svg></span><p>Where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-298-Title">
<title id="MathJax-SVG-298-Title"> C </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> is some constant. When we optimize this constant model using MSE, we found that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-299-Title">
<title id="MathJax-SVG-299-Title"> C </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> will always be the mean of the data points. When applied to the tips dataset, we found that the constant model should predict <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.233ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 3114 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-300-Title">
<title id="MathJax-SVG-300-Title"> 16.08\% </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="2280" y="0"></use>
</g>
</svg></span> since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.233ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 3114 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-301-Title">
<title id="MathJax-SVG-301-Title"> 16.08\% </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-25" x="2280" y="0"></use>
</g>
</svg></span> is the mean of the tip percents.</p>
<p>Now, we will keep our model the same but switch to a different loss function: the mean absolute error (MAE). Instead taking the squared difference for each point and our prediction, this loss function takes the absolute difference:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.301ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 10462.9 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-302-Title">
<title id="MathJax-SVG-302-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n} |y_i - \theta| \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="4072" y="0"></use>
<g transform="translate(4350,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5407" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6408" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="6878" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-MSE-and-MAE">Comparing MSE and MAE<a class="anchor-link" href="#Comparing-MSE-and-MAE">¶</a></h3><p>To get a better sense of how the MSE and MAE compare, let's compare their losses on different datasets. First, we'll use our dataset of one point: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.128ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3499.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-303-Title">
<title id="MathJax-SVG-303-Title"> \textbf{y} = [14] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3221" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">compare_mse_abs</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">],</span>
                <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">17</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the MSE is usually higher than the MAE since the error is squared. Let's see what happens when have five points: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.61ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13179.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-304-Title">
<title id="MathJax-SVG-304-Title"> \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4000" y="0"></use>
<g transform="translate(4445,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6225" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8450" y="0"></use>
<g transform="translate(8895,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="10675" y="0"></use>
<g transform="translate(11120,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12900" y="0"></use>
</g>
</svg></span></p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">compare_mse_abs</span><span class="p">(</span><span class="n">thetas</span><span class="o">=</span><span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">],</span>
                <span class="n">y_vals</span><span class="o">=</span><span class="p">[</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">],</span>
                <span class="n">xlims</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remember that the actual loss values themselves are not very interesting to us; they are only useful for comparing different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-305-Title">
<title id="MathJax-SVG-305-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Once we choose a loss function, we will look for the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-306-Title">
<title id="MathJax-SVG-306-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that produces the least loss. Thus, we are interested in whether the loss functions are minimized by different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-307-Title">
<title id="MathJax-SVG-307-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>So far, the two loss functions seem to agree on the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-308-Title">
<title id="MathJax-SVG-308-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values that produce the least loss for the values that we've tried. If we look a bit closer, however, we will start to see some differences. We first take the losses and plot them against <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-309-Title">
<title id="MathJax-SVG-309-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for each of the six <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-310-Title">
<title id="MathJax-SVG-310-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values we tried.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">mse_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
<span class="n">abs_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">mse_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MSE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">abs_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MAE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Loss vs. $ \theta $ when $ \bf</span><span class="si">{y}</span><span class="s1">$$= [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $ Values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we compute more values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-311-Title">
<title id="MathJax-SVG-311-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> so that the curve is smooth:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">mse_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
<span class="n">abs_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">mse_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MSE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">abs_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MAE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Loss vs. $ \theta $ when $ \bf</span><span class="si">{y}</span><span class="s1">$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $ Values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we zoom into the region between 1.5 and 5 on the y-axis to see the difference in minima more clearly. We've marked the minima with dotted lines.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">17.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">mse_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
<span class="n">abs_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">mse_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MSE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">abs_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MAE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Minima of MSE'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">y_vals</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Minima of MAE'</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Loss vs. $ \theta $ when $ \bf</span><span class="si">{y}</span><span class="s1">$$ = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $ Values'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_15_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've found empirically that the MSE and MAE can be minimized by different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-312-Title">
<title id="MathJax-SVG-312-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for the same dataset. However, we don't have a good sense of when they will differ and more importantly, why they differ.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Outliers">Outliers<a class="anchor-link" href="#Outliers">¶</a></h3><p>One difference that we can see in the plots of loss vs. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-313-Title">
<title id="MathJax-SVG-313-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> above lies in the shape of the loss curves. Plotting the MSE results in a parabolic curve resulting from the squared term in the loss function.</p>
<p>Plotting the MAE, on the other hand, results in what looks like a connected series of lines. This makes sense when we consider that the absolute value function is linear, so taking the average of many absolute value functions should produce a semi-linear function.</p>
<p>Since the MSE has a squared error term, it will be more sensitive to outliers. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-314-Title">
<title id="MathJax-SVG-314-Title"> \theta = 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> and a point lies at 110, that point's error term for MSE will be <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.427ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 8794.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-315-Title">
<title id="MathJax-SVG-315-Title"> (10 - 110)^2 = 10000 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1612" y="0"></use>
<g transform="translate(2613,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
<g transform="translate(4114,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="5236" y="0"></use>
<g transform="translate(6292,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2002" y="0"></use>
</g>
</g>
</svg></span> whereas in the MAE, that point's error term will be <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.532ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7118 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-316-Title">
<title id="MathJax-SVG-316-Title"> |10 - 110| = 100 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1501" y="0"></use>
<g transform="translate(2502,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="4003" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4560" y="0"></use>
<g transform="translate(5616,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
</g>
</svg></span>. We can illustrate this by taking a set of three points <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.846ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6391.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-317-Title">
<title id="MathJax-SVG-317-Title"> \textbf{y} = [ 12, 13, 14 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3221" y="0"></use>
<g transform="translate(3666,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4667" y="0"></use>
<g transform="translate(5112,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="6113" y="0"></use>
</g>
</svg></span> and plotting the loss vs. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-318-Title">
<title id="MathJax-SVG-318-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> curves for MSE and MAE.</p>
<p>Use the slider below to move the third point further away from the rest of the data and observe what happens to the loss curves. (We've scaled the curves to keep both in view since the MSE has larger values than the MAE.)</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">compare_mse_abs_curves</span><span class="p">(</span><span class="n">y3</span><span class="o">=</span><span class="mi">14</span><span class="p">):</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">26.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="n">y3</span><span class="p">])</span>
    
    <span class="n">mse_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    <span class="n">abs_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    <span class="n">mse_abs_diff</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">mse_losses</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">abs_losses</span><span class="p">)</span>
    <span class="n">mse_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss</span> <span class="o">-</span> <span class="n">mse_abs_diff</span> <span class="k">for</span> <span class="n">loss</span> <span class="ow">in</span> <span class="n">mse_losses</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">26.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Points'</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">mse_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MSE'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">abs_losses</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'MAE'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">11.5</span><span class="p">,</span> <span class="mf">26.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">abs_losses</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="nb">min</span><span class="p">(</span><span class="n">abs_losses</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">interact</span><span class="p">(</span><span class="n">compare_mse_abs_curves</span><span class="p">,</span> <span class="n">y3</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">25</span><span class="p">));</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've shown the curves for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.617ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3279.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-319-Title">
<title id="MathJax-SVG-319-Title"> y_3 = 14 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1222" y="0"></use>
<g transform="translate(2278,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.617ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3279.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-320-Title">
<title id="MathJax-SVG-320-Title"> y_3 = 25 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1222" y="0"></use>
<g transform="translate(2278,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span> below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">compare_mse_abs_curves</span><span class="p">(</span><span class="n">y3</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_21_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">compare_mse_abs_curves</span><span class="p">(</span><span class="n">y3</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_22_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we move the point further away from the rest of the data, the MSE curve moves with it. When <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.617ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3279.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-321-Title">
<title id="MathJax-SVG-321-Title"> y_3 = 14 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1222" y="0"></use>
<g transform="translate(2278,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
</g>
</svg></span>, both MSE and MAE will be minimized by the same value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-322-Title">
<title id="MathJax-SVG-322-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-323-Title">
<title id="MathJax-SVG-323-Title"> \theta = 13 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</svg></span>. However, when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.617ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 3279.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-324-Title">
<title id="MathJax-SVG-324-Title"> y_3 = 25 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1222" y="0"></use>
<g transform="translate(2278,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
</g>
</svg></span>, the MSE curve will tell us that the best <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-325-Title">
<title id="MathJax-SVG-325-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is around 16.7 while the MAE will still say that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-326-Title">
<title id="MathJax-SVG-326-Title"> \theta = 13 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</svg></span> is best.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Minimizing-the-MAE">Minimizing the MAE<a class="anchor-link" href="#Minimizing-the-MAE">¶</a></h3><p>Now that we have a qualitative sense of how the MSE and MAE differ, we can minimize the MAE to make this difference more precise. As before, we will take the derivative of the loss function with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-327-Title">
<title id="MathJax-SVG-327-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and set it equal to zero.</p>
<p>This time, however, we have to deal with the fact that the absolute function is not always differentiable. When <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-328-Title">
<title id="MathJax-SVG-328-Title"> x &gt; 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3E" x="850" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1906" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.593ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 4130.2 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-329-Title">
<title id="MathJax-SVG-329-Title"> \frac{\partial}{\partial x} |x| = 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="926" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="371" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="1166" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1444" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2017" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2573" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3629" y="0"></use>
</g>
</svg></span>. When <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-330-Title">
<title id="MathJax-SVG-330-Title"> x &lt; 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3C" x="850" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1906" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.401ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 4908.7 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-331-Title">
<title id="MathJax-SVG-331-Title"> \frac{\partial}{\partial x} |x| = -1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="926" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="371" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="1166" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1444" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2017" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2573" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3629" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="4408" y="0"></use>
</g>
</svg></span>. Although <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.623ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1129.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-332-Title">
<title id="MathJax-SVG-332-Title"> |x| </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="851" y="0"></use>
</g>
</svg></span> is not technicaly differentiable at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2407.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-333-Title">
<title id="MathJax-SVG-333-Title"> x = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="850" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1906" y="0"></use>
</g>
</svg></span>, we will set <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.593ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 4130.2 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-334-Title">
<title id="MathJax-SVG-334-Title"> \frac{\partial}{\partial x} |x| = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="926" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="371" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="1166" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1444" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2017" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2573" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3629" y="0"></use>
</g>
</svg></span> so that the equations are easier to work with.</p>
<p>Recall that the equation for the MAE is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.462ex" height="14.843ex" style="vertical-align: -6.838ex;" viewBox="0 -3446.4 23879.5 6390.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-335-Title">
<title id="MathJax-SVG-335-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}|y_i - \theta|\\
&amp;= \frac{1}{n} \left( \sum_{y_i &lt; \theta}|y_i - \theta| + \sum_{y_i = \theta}|y_i - \theta| + \sum_{y_i &gt; \theta}|y_i - \theta| \right)\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1790)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,1790)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="4072" y="0"></use>
<g transform="translate(4350,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5407" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6408" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="6878" y="0"></use>
</g>
<g transform="translate(0,-1458)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2294,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3C" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="2457" y="0"></use>
<g transform="translate(2736,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3793" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="4793" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="5263" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5763" y="0"></use>
<g transform="translate(6764,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="8429" y="0"></use>
<g transform="translate(8708,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="9765" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="10765" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="11235" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="11736" y="0"></use>
<g transform="translate(12736,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="14401" y="0"></use>
<g transform="translate(14680,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="15737" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="16738" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="17207" y="0"></use>
 <use xlink:href="#MJSZ4-29" x="17486" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In the line above, we've split up the summation into three separate summations: one that has one term for each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2638.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-336-Title">
<title id="MathJax-SVG-336-Title"> y_i &lt; \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3C" x="1112" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2168" y="0"></use>
</g>
</svg></span>, one for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2638.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-337-Title">
<title id="MathJax-SVG-337-Title"> y_i = \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2168" y="0"></use>
</g>
</svg></span>, and one for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2638.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-338-Title">
<title id="MathJax-SVG-338-Title"> y_i &gt; \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3E" x="1112" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2168" y="0"></use>
</g>
</svg></span>. Why make the summation seemingly more complicated? If we know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.128ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2638.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-339-Title">
<title id="MathJax-SVG-339-Title"> y_i &lt; \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3C" x="1112" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2168" y="0"></use>
</g>
</svg></span> we also know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.424ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4918.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-340-Title">
<title id="MathJax-SVG-340-Title"> |y_i - \theta| &lt; 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1335" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2805" y="0"></use>
 <use xlink:href="#MJMAIN-3C" x="3362" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="4418" y="0"></use>
</g>
</svg></span> and thus <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.772ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 6790.6 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-341-Title">
<title id="MathJax-SVG-341-Title"> \frac{\partial}{\partial \theta} |y_i - \theta| = -1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="853" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="319" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="1093" y="0"></use>
<g transform="translate(1371,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2428" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3429" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3899" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4455" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5511" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="6290" y="0"></use>
</g>
</svg></span> from before. A similar logic holds for each term above to make taking the derivative much easier.</p>
<p>Now, we take the derivative with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-342-Title">
<title id="MathJax-SVG-342-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and set it equal to zero:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.058ex" height="26.176ex" style="vertical-align: -12.505ex;" viewBox="0 -5886.2 18538.9 11270.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-343-Title">
<title id="MathJax-SVG-343-Title">
\begin{aligned}
\frac{1}{n} \left( \sum_{y_i &lt; \theta}(-1) + \sum_{y_i = \theta}(0) + \sum_{y_i &gt; \theta}(1) \right) &amp;= 0 \\
\sum_{y_i &lt; \theta}(-1) + \sum_{y_i &gt; \theta}(1) &amp;= 0 \\
-\sum_{y_i &lt; \theta}(1) + \sum_{y_i &gt; \theta}(1) &amp;= 0 \\
\sum_{y_i &lt; \theta}(1) &amp;= \sum_{y_i &gt; \theta}(1) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,4047)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
<g transform="translate(960,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3C" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2290" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="2680" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3458" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3959" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4571" y="0"></use>
<g transform="translate(5571,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7070" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="7459" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7960" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8571" y="0"></use>
<g transform="translate(9572,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="11070" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="11460" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11960" y="0"></use>
 <use xlink:href="#MJSZ4-29" x="12350" y="0"></use>
</g>
</g>
<g transform="translate(6546,1398)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3C" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1498" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1887" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2666" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3166" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3778" y="0"></use>
<g transform="translate(4779,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="6277" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="6667" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7167" y="0"></use>
</g>
<g transform="translate(6379,-1251)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(945,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3C" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2443" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2833" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3333" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3945" y="0"></use>
<g transform="translate(4945,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="6444" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="6833" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7334" y="0"></use>
</g>
<g transform="translate(11325,-3901)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3C" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1498" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1887" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2388" y="0"></use>
</g>
</g>
<g transform="translate(14093,0)">
<g transform="translate(0,4047)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,1398)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,-1251)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
<g transform="translate(0,-3901)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="26" y="0"></use>
<g transform="translate(0,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-69" x="604" y="-304"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="870" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1649" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2832" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3221" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3722" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>What does the result above mean? On the left hand side, we have one term for each data point less than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-344-Title">
<title id="MathJax-SVG-344-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. On the right, we have one for each data point greater than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-345-Title">
<title id="MathJax-SVG-345-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Then, in order to satisfy the equation we need to pick a value for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-346-Title">
<title id="MathJax-SVG-346-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that has the same number of smaller and larger points. This is the definition for the <em>median</em> of a set of numbers. Thus, the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-347-Title">
<title id="MathJax-SVG-347-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for the MAE is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.772ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6360.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-348-Title">
<title id="MathJax-SVG-348-Title"> \theta = \text{median} (\textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-65" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="1278" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1834" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2113" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2613" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4973" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="5363" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5970" y="0"></use>
</g>
</svg></span>.</p>
<p>When we have an odd number of points, the median is simply the middle point when the points are arranged in sorted order. We can see that in the example below with five points, the loss is minimized when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-349-Title">
<title id="MathJax-SVG-349-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> lies at the median:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">points_and_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">abs_loss</span><span class="p">):</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">abs_losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Points'</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">abs_losses</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_26_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, when we have an even number of points, the loss is minimized when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-350-Title">
<title id="MathJax-SVG-350-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is any value in between the two central points.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_28_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is not the case when we use the MSE:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]),</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">16</span><span class="p">),</span> <span class="n">mse_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_30_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MSE-and-MAE-Comparison">MSE and MAE Comparison<a class="anchor-link" href="#MSE-and-MAE-Comparison">¶</a></h3><p>Our investigation and the derivation above show that the MSE is easier to differentiate but is more sensitive to outliers than the MAE. The minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-351-Title">
<title id="MathJax-SVG-351-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for MSE is the mean of the data points, and the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-352-Title">
<title id="MathJax-SVG-352-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for the MAE is the median of the data points. Notice that the median is robust to outliers while the mean is not! This phenomenon arises from our construction of the two loss functions.</p>
<p>We have also seen that the MSE will be minimized by a unique value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-353-Title">
<title id="MathJax-SVG-353-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, whereas the mean absolute value can be minimized by multiple values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-354-Title">
<title id="MathJax-SVG-354-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> when there are an even number of data points.</p>
<p>In the examples so far, the ability to differentiate the loss function isn't that useful since we know the exact minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-355-Title">
<title id="MathJax-SVG-355-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> in both cases. However, the ability to differentiate the loss function becomes very important once we start using complicated models. For complicated models, we will not be able to differentiate the loss function by hand and will need a computer to minimize the loss function for us. We will return to this issue when we cover gradient descent and numerical optimization.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Huber-Loss">The Huber Loss<a class="anchor-link" href="#The-Huber-Loss">¶</a></h3><p>A third loss function called the Huber loss combines both the MSE and MAE to create a loss function that is differentiable <em>and</em> robust to outliers. The Huber loss accomplishes this by behaving like the MSE function for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-356-Title">
<title id="MathJax-SVG-356-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values close to the minimum and switching to the absolute loss for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-357-Title">
<title id="MathJax-SVG-357-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values far from the minimum.</p>
<p>As usual, we create a loss function by taking the mean of the Huber losses for each point in our dataset.</p>
<p>Let's see what the Huber loss function outputs for a dataset of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.128ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3499.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-358-Title">
<title id="MathJax-SVG-358-Title"> \textbf{y} = [14] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3221" y="0"></use>
</g>
</svg></span> as we vary <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-359-Title">
<title id="MathJax-SVG-359-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">huber_loss</span><span class="p">(</span><span class="n">est</span><span class="p">,</span> <span class="n">y_obs</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">est</span> <span class="o">-</span> <span class="n">y_obs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">,</span> 
                    <span class="p">(</span><span class="n">est</span> <span class="o">-</span> <span class="n">y_obs</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                    <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>

<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">huber_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Huber Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s2">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Observation"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Choice for $\theta$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'huber_loss.pdf'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_33_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the Huber loss is smooth, unlike the MAE. The Huber loss also increases at a linear rate, unlike the quadratic rate of the mean squared loss.</p>
<p>The Huber loss does have a drawback, however. Notice that it transitions from the MSE to the MAE once <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-360-Title">
<title id="MathJax-SVG-360-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> gets far enough from the point. We can tweak this "far enough" to get different loss curves. For example, we can make it transition once <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-361-Title">
<title id="MathJax-SVG-361-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is just one unit away from the observation:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">huber_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Huber Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s2">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Observation"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Choice for $\theta$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'huber_loss.pdf'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_35_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Or we can make it transition when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-362-Title">
<title id="MathJax-SVG-362-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is ten units away from the observation:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">huber_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Huber Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">14</span><span class="p">]),</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="n">colors</span><span class="o">=</span><span class="s2">"r"</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Observation"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Choice for $\theta$"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">"Loss"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">'huber_loss.pdf'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/modeling_abs_huber_37_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This choice results in a different loss curve and can thus result in different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-363-Title">
<title id="MathJax-SVG-363-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. If we want to use the Huber loss function, we have the additional task of setting this transition point to a suitable value.</p>
<p>The Huber loss function is defined mathematically as follows:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.813ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 21877.9 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-364-Title">
<title id="MathJax-SVG-364-Title">
L_\alpha(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    \frac{1}{2}(y_i - \theta)^2 &amp;  | y_i - \theta | \le \alpha \\
    \alpha ( |y_i - \theta| - \frac{1}{2}\alpha ) &amp; \text{otherwise}
\end{cases}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B1" x="963" y="-213"></use>
 <use xlink:href="#MJMAIN-28" x="1234" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1623" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2093" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2538" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3146" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3813" y="0"></use>
<g transform="translate(4591,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(5996,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(7607,0)">
 <use xlink:href="#MJSZ4-7B"></use>
<g transform="translate(973,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,766)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="713" y="0"></use>
<g transform="translate(1103,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2160" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3161" y="0"></use>
<g transform="translate(3630,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="640" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1030" y="0"></use>
<g transform="translate(1308,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2365" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3366" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3835" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4336" y="0"></use>
<g transform="translate(5114,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-3B1" x="6051" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6691" y="0"></use>
</g>
</g>
<g transform="translate(8070,0)">
<g transform="translate(0,766)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1335" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2805" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="3362" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4418" y="0"></use>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-74" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1446" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-77" x="2283" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3006" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3284" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3679" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>It is more complex than the previous loss functions because it combines both MSE and MAE. The additional parameter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-365-Title">
<title id="MathJax-SVG-365-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> sets the point where the Huber loss transitions from the MSE to the absolute loss.</p>
<p>Attempting to take the derivative of the Huber loss function is tedious and does not result in an elegant result like the MSE and MAE. Instead, we can use a computational method called gradient descent to find minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-366-Title">
<title id="MathJax-SVG-366-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/11'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Gradient-Descent-and-Numerical-Optimization">Gradient Descent and Numerical Optimization<a class="anchor-link" href="#Gradient-Descent-and-Numerical-Optimization">¶</a></h1><p>In order to use a dataset for estimation and prediction, we need to precisely
define our model and select a loss function. For example, in the tip percentage
dataset, our model assumed that there was a single tip percentage that does not
vary by table. Then, we decided to use the mean squared error loss function and
found the model that minimized the loss function.</p>
<p>We also found that there are simple expressions that minimize the MSE and the
mean absolute error loss functions: the mean and the median. However, as our models
and loss functions become more complicated we will no longer be able to find
useful algebraic expressions for the models that minimize the loss. For
example, the Huber loss has useful properties but is difficult to differentiate
by hand.</p>
<p>We can use the computer to address this issue using gradient descent, a
computational method of minimizing loss functions.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/11'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">points_and_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">):</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">rugplot</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Points'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Tip Percent'</span><span class="p">)</span>
    
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">losses</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">loss_fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Loss-Minimization-Using-a-Program">Loss Minimization Using a Program<a class="anchor-link" href="#Loss-Minimization-Using-a-Program">¶</a></h2><p>Let us return to our constant model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.955ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2564.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-367-Title">
<title id="MathJax-SVG-367-Title">
\theta = C
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="1803" y="0"></use>
</g>
</svg></span><p>We will use the mean squared error loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.484ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 10972.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-368-Title">
<title id="MathJax-SVG-368-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>For simplicity, we will use the dataset <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.563ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9284.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-369-Title">
<title id="MathJax-SVG-369-Title"> \textbf{y} = [ 12, 13, 15, 16, 17 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3221" y="0"></use>
<g transform="translate(3666,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4667" y="0"></use>
<g transform="translate(5112,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6113" y="0"></use>
<g transform="translate(6558,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="7559" y="0"></use>
<g transform="translate(8004,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="9005" y="0"></use>
</g>
</svg></span>. We know from our analytical approach in a previous chapter that the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-370-Title">
<title id="MathJax-SVG-370-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for the MSE is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.876ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6835.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-371-Title">
<title id="MathJax-SVG-371-Title"> \text{mean}(\textbf{y}) = 14.6 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-65" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1278" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1778" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2335" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3332" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3999" y="0"></use>
<g transform="translate(5055,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1279" y="0"></use>
</g>
</g>
</svg></span>. Let's see whether we can find the same value by writing a program.</p>
<p>If we write the program well, we will be able to use the same program on any loss function in order to find the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-372-Title">
<title id="MathJax-SVG-372-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, including the mathematically complicated Huber loss:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.813ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 21877.9 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-373-Title">
<title id="MathJax-SVG-373-Title">
L_\alpha(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    \frac{1}{2}(y_i - \theta)^2 &amp;  | y_i - \theta | \le \alpha \\
    \alpha ( |y_i - \theta| - \frac{1}{2}\alpha ) &amp; \text{otherwise}
\end{cases}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B1" x="963" y="-213"></use>
 <use xlink:href="#MJMAIN-28" x="1234" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1623" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2093" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2538" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3146" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3813" y="0"></use>
<g transform="translate(4591,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(5996,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(7607,0)">
 <use xlink:href="#MJSZ4-7B"></use>
<g transform="translate(973,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,766)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="713" y="0"></use>
<g transform="translate(1103,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2160" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3161" y="0"></use>
<g transform="translate(3630,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="640" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1030" y="0"></use>
<g transform="translate(1308,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2365" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3366" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3835" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4336" y="0"></use>
<g transform="translate(5114,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-3B1" x="6051" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6691" y="0"></use>
</g>
</g>
<g transform="translate(8070,0)">
<g transform="translate(0,766)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1335" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2805" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="3362" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4418" y="0"></use>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-74" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1446" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-77" x="2283" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3006" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3284" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3679" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>First, we create a rug plot of the data points. To the right of the rug plot we plot the MSE for different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-374-Title">
<title id="MathJax-SVG-374-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_basics_4_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>How might we write a program to automatically find the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-375-Title">
<title id="MathJax-SVG-375-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>? The simplest method is to compute the loss for many values <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-376-Title">
<title id="MathJax-SVG-376-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Then, we can return the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-377-Title">
<title id="MathJax-SVG-377-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> value that resulted in the least loss.</p>
<p>We define a function called <code>simple_minimize</code> that takes in a loss function, an array of data points, and an array of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-378-Title">
<title id="MathJax-SVG-378-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values to try.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">simple_minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">thetas</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Returns the value of theta in thetas that produces the least loss</span>
<span class="sd">    on a given dataset.</span>
<span class="sd">    '''</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">thetas</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">losses</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we can define a function to compute the MSE and pass it into <code>simple_minimize</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">dataset</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">simple_minimize</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>14.599999999999991</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is close to the expected value:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Compute the minimizing theta using the analytical formula</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>14.6</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can define a function to compute the Huber loss and plot the loss against <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-379-Title">
<title id="MathJax-SVG-379-Title">\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">huber_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">dataset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">&lt;</span> <span class="n">alpha</span><span class="p">,</span>
                 <span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">dataset</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                 <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">huber_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_basics_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we can see that the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-380-Title">
<title id="MathJax-SVG-380-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> should be close to 15, we do not have an analytical method of finding <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-381-Title">
<title id="MathJax-SVG-381-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> directly for the Huber loss. Instead, we can use our <code>simple_minimize</code> function.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_minimize</span><span class="p">(</span><span class="n">huber_loss</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>14.999999999999989</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can return to our original dataset of tip percentages and find the best value for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-382-Title">
<title id="MathJax-SVG-382-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> using the Huber loss.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>total_bill</th>
<th>tip</th>
<th>sex</th>
<th>smoker</th>
<th>day</th>
<th>time</th>
<th>size</th>
<th>pcttip</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>16.99</td>
<td>1.01</td>
<td>Female</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>2</td>
<td>5.944673</td>
</tr>
<tr>
<th>1</th>
<td>10.34</td>
<td>1.66</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
<td>16.054159</td>
</tr>
<tr>
<th>2</th>
<td>21.01</td>
<td>3.50</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
<td>16.658734</td>
</tr>
<tr>
<th>3</th>
<td>23.68</td>
<td>3.31</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>2</td>
<td>13.978041</td>
</tr>
<tr>
<th>4</th>
<td>24.59</td>
<td>3.61</td>
<td>Female</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>4</td>
<td>14.680765</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">points_and_loss</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">huber_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_basics_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_minimize</span><span class="p">(</span><span class="n">huber_loss</span><span class="p">,</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>15.499999999999988</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that using the Huber loss gives us <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.589ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 3697.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-383-Title">
<title id="MathJax-SVG-383-Title"> \hat{\theta} = 15.5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
<g transform="translate(1917,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span>. We can now compare the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-384-Title">
<title id="MathJax-SVG-384-Title">\hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> values for MSE, MAE, and Huber loss.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"               MSE: theta_hat = {tips['pcttip'].mean():.2f}"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"               MAE: theta_hat = {tips['pcttip'].median():.2f}"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"        Huber loss: theta_hat = 15.50"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>               MSE: theta_hat = 16.08
               MAE: theta_hat = 15.48
        Huber loss: theta_hat = 15.50
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the Huber loss is closer to the MAE since it is less affected by the outliers on the right side of the tip percentage distribution:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_basics_23_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Issues-with-simple_minimize">Issues with <code>simple_minimize</code><a class="anchor-link" href="#Issues-with-simple_minimize">¶</a></h2><p>Although <code>simple_minimize</code> allows us to minimize loss functions, it has some flaws that make it unsuitable for general purpose use. Its primary issue is that it only works with predetermined values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-385-Title">
<title id="MathJax-SVG-385-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to test. For example, in this code snippet we used above, we had to manually define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-386-Title">
<title id="MathJax-SVG-386-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values in between 12 and 18.</p>
<div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">])</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">simple_minimize</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
<p>How did we know to examine the range between 12 and 18? We had to inspect the plot of the loss function manually and see that there was a minima in that range. This process becomes impractical as we add extra complexity to our models. In addition, we manually specified a step size of 0.1 in the code above. However, if the optimal value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-387-Title">
<title id="MathJax-SVG-387-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> were 12.043, our <code>simple_minimize</code> function would round to 12.00, the nearest multiple of 0.1.</p>
<p>We can solve both of these issues at once by using a method called <em>gradient descent</em>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/11'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">):</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">loss_fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">plot_theta_on_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">default_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">theta</span><span class="p">],</span> <span class="p">[</span><span class="n">loss</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="n">default_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>

<span class="k">def</span> <span class="nf">plot_tangent_on_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">):</span>
    <span class="n">slope</span> <span class="o">=</span> <span class="p">((</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span> <span class="o">+</span> <span class="n">eps</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="o">-</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">eps</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">))</span>
             <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">eps</span><span class="p">))</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">theta</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="p">(</span><span class="n">xs</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">],</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gradient-Descent">Gradient Descent<a class="anchor-link" href="#Gradient-Descent">¶</a></h2><p>We are interested in creating a function that can minimize a loss function without forcing the user to predetermine which values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-388-Title">
<title id="MathJax-SVG-388-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to try. In other words, while the <code>simple_minimize</code> function has the following signature:</p>
<div class="highlight"><pre><span></span><span class="n">simple_minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
<p>We would like a function that has the following signature:</p>
<div class="highlight"><pre><span></span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
</pre></div>
<p>This function needs to automatically find the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-389-Title">
<title id="MathJax-SVG-389-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> value no matter how small or large it is. We will use a technique called gradient descent to implement this new <code>minimize</code> function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Intuition">Intuition<a class="anchor-link" href="#Intuition">¶</a></h3><p>As with loss functions, we will discuss the intuition for gradient descent first, then formalize our understanding with mathematics.</p>
<p>Since the <code>minimize</code> function is not given values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-390-Title">
<title id="MathJax-SVG-390-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to try, we start by picking a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-391-Title">
<title id="MathJax-SVG-391-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> anywhere we'd like. Then, we can iteratively improve the estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-392-Title">
<title id="MathJax-SVG-392-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. To improve an estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-393-Title">
<title id="MathJax-SVG-393-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, we look at the slope of the loss function at that choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-394-Title">
<title id="MathJax-SVG-394-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>For example, suppose we are using MSE for the simple dataset <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.61ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13179.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-395-Title">
<title id="MathJax-SVG-395-Title"> \textbf{y} = [ 12.1, 12.8, 14.9, 16.3, 17.2 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4000" y="0"></use>
<g transform="translate(4445,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6225" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8450" y="0"></use>
<g transform="translate(8895,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="10675" y="0"></use>
<g transform="translate(11120,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12900" y="0"></use>
</g>
</svg></span> and our current choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-396-Title">
<title id="MathJax-SVG-396-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is 12.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_6_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'd like to choose a new value for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-397-Title">
<title id="MathJax-SVG-397-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that decreases the loss. To do this, we look at the slope of the loss function at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-398-Title">
<title id="MathJax-SVG-398-Title">\theta= 12 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">plot_tangent_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The slope is negative, which means that increasing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-399-Title">
<title id="MathJax-SVG-399-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> will decrease the loss.</p>
<p>If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.323ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3583.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-400-Title">
<title id="MathJax-SVG-400-Title">\theta = 16.5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span> on the other hand, the slope of the loss function is positive:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">plot_tangent_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mf">16.5</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_10_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>When the slope is positive, decreasing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-401-Title">
<title id="MathJax-SVG-401-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> will decrease the loss.</p>
<p>The slope of the tangent line tells us which direction to move <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-402-Title">
<title id="MathJax-SVG-402-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> in order to decrease the loss. If the slope is negative, we want <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-403-Title">
<title id="MathJax-SVG-403-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> to move in the positive direction. If the slope is positive, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-404-Title">
<title id="MathJax-SVG-404-Title">\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> should move in the negative direction. Mathematically, we write:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.708ex" height="5.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1508.9 11499.4 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-405-Title">
<title id="MathJax-SVG-405-Title">
\theta^{(t+1)} = \theta^{(t)} - \frac{\partial}{\partial \theta} L(\theta^{(t)}, \textbf{y})
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5212" y="0"></use>
<g transform="translate(5991,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1157" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-2202" x="294" y="676"></use>
<g transform="translate(60,-736)">
 <use xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="7610" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8291" y="0"></use>
<g transform="translate(8681,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="10057" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="10502" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11109" y="0"></use>
</g>
</svg></span><p>Where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.196ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1376 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-406-Title">
<title id="MathJax-SVG-406-Title"> \theta^{(t)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span> is the current estimate and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2280.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-407-Title">
<title id="MathJax-SVG-407-Title"> \theta^{(t+1)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</svg></span> is the next estimate.</p>
<p>For the MSE, we have:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.297ex" height="21.176ex" style="vertical-align: -9.741ex; margin-bottom: -0.263ex;" viewBox="0 -4809.9 13475.2 9117.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-408-Title">
<title id="MathJax-SVG-408-Title">
\begin{aligned}
L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - \theta)^2\\
\frac{\partial}{\partial \hat{\theta}} L(\theta, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n} -2(y_i - \theta) \\
&amp;= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(1511,3129)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
<g transform="translate(0,66)">
<g transform="translate(120,0)">
<rect stroke="none" width="1271" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-2202" x="351" y="676"></use>
<g transform="translate(60,-999)">
 <use xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(567,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="1511" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2192" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2582" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3051" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3496" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4104" y="0"></use>
</g>
</g>
<g transform="translate(4483,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6352" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4850" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5351" y="0"></use>
<g transform="translate(5740,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6797" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7798" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8268" y="0"></use>
</g>
<g transform="translate(0,-2997)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7600" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>When <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.619ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 3711 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-409-Title">
<title id="MathJax-SVG-409-Title"> \theta^{(t)} = 12 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="1653" y="0"></use>
<g transform="translate(2710,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span>, we can compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.929ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 10733.3 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-410-Title">
<title id="MathJax-SVG-410-Title"> -\frac{2}{n} \sum_{i = 1}^{n} (y_i - \theta) = -5.2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
<g transform="translate(1729,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="4034" y="0"></use>
<g transform="translate(4424,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5481" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6482" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6951" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7619" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8675" y="0"></use>
<g transform="translate(9453,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
</g>
</g>
</svg></span>. Thus, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.382ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 11789.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-411-Title">
<title id="MathJax-SVG-411-Title"> \theta^{(t+1)} = 12 - (-5.2) = 17.2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4837" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5838" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6227" y="0"></use>
<g transform="translate(7006,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8285" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8953" y="0"></use>
<g transform="translate(10009,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
</g>
</svg></span>.</p>
<p>We've plotted the old value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-412-Title">
<title id="MathJax-SVG-412-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> as a green outlined circle and the new value as a filled in circle on the loss curve below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                   <span class="n">edgecolor</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-413-Title">
<title id="MathJax-SVG-413-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> went in the right direction, it ended up as far away from the minimum as it started. We can remedy this by multiplying the slope by a small constant before subtracting it from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-414-Title">
<title id="MathJax-SVG-414-Title"> \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Our final update formula is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.875ex" height="5.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1508.9 12862.9 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-415-Title">
<title id="MathJax-SVG-415-Title">
\theta^{(t+1)} = \theta^{(t)} - \alpha \cdot \frac{\partial}{\partial \theta} L(\theta^{(t)}, \textbf{y})
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5212" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6213" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="7076" y="0"></use>
<g transform="translate(7354,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1157" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-2202" x="294" y="676"></use>
<g transform="translate(60,-736)">
 <use xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="8973" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9655" y="0"></use>
<g transform="translate(10044,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="11420" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="11865" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12473" y="0"></use>
</g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-416-Title">
<title id="MathJax-SVG-416-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> is a small constant. For example, if we set <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.558ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3254.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-417-Title">
<title id="MathJax-SVG-417-Title"> \alpha = 0.3 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="918" y="0"></use>
<g transform="translate(1974,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="779" y="0"></use>
</g>
</g>
</svg></span>, this is the new <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2280.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-418-Title">
<title id="MathJax-SVG-418-Title"> \theta^{(t+1)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">plot_one_gd_iter</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
    <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">grad_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">18</span><span class="p">),</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">new_theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'old theta: </span><span class="si">{theta}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'new theta: </span><span class="si">{new_theta}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">grad_mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: 12
new theta: 13.596
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_15_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-419-Title">
<title id="MathJax-SVG-419-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values for successive iterations of this process. Notice that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-420-Title">
<title id="MathJax-SVG-420-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> changes more slowly as it gets closer to the minimum loss because the slope is also smaller.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mf">13.60</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">grad_mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: 13.6
new theta: 14.236
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_17_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mf">14.24</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">grad_mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: 14.24
new theta: 14.492
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_18_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="mf">14.49</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">grad_mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: 14.49
new theta: 14.592
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_descent_define_19_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradient-Descent-Analysis">Gradient Descent Analysis<a class="anchor-link" href="#Gradient-Descent-Analysis">¶</a></h3><p>We now have the full algorithm for gradient descent:</p>
<ol>
<li>Choose a starting value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-421-Title">
<title id="MathJax-SVG-421-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> (0 is a common choice).</li>
<li>Compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.564ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 7131.8 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-422-Title">
<title id="MathJax-SVG-422-Title"> \theta - \alpha \cdot \frac{\partial}{\partial \theta} L(\theta, \textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="691" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="1692" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2555" y="0"></use>
<g transform="translate(2833,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="853" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="319" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMATHI-4C" x="4149" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4830" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="5220" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5689" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="6134" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6742" y="0"></use>
</g>
</svg></span> and store this as the new value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-423-Title">
<title id="MathJax-SVG-423-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</li>
<li>Repeat until <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-424-Title">
<title id="MathJax-SVG-424-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> doesn't change between iterations.</li>
</ol>
<p>You will more commonly see the gradient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.939ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1265.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-425-Title">
<title id="MathJax-SVG-425-Title"> \nabla_\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
</svg></span> in place of the partial derivative <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.539ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 1093.3 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-426-Title">
<title id="MathJax-SVG-426-Title"> \frac{\partial}{\partial \theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="853" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="319" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="567" y="0"></use>
</g>
</g>
</g>
</svg></span>. The two notations are essentially equivalent, but since the gradient notation is more common we will use it in the gradient update formula from now on:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.57ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 12731.4 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-427-Title">
<title id="MathJax-SVG-427-Title">
\theta^{(t+1)} = \theta^{(t)} - \alpha \cdot \nabla_\theta L(\theta^{(t)}, \textbf{y})
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5212" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6213" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="7076" y="0"></use>
<g transform="translate(7576,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMATHI-4C" x="8842" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9523" y="0"></use>
<g transform="translate(9913,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="11289" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="11734" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12341" y="0"></use>
</g>
</svg></span><p>To review notation:</p>
<ul>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.196ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1376 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-428-Title">
<title id="MathJax-SVG-428-Title"> \theta^{(t)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span> is the current estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-429-Title">
<title id="MathJax-SVG-429-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> at the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-430-Title">
<title id="MathJax-SVG-430-Title">t</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span>th iteration.</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2280.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-431-Title">
<title id="MathJax-SVG-431-Title"> \theta^{(t+1)} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</svg></span> is the next choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-432-Title">
<title id="MathJax-SVG-432-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-433-Title">
<title id="MathJax-SVG-433-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> is called the learning rate, usually set to a small constant. Sometimes it is useful to start with a larger <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-434-Title">
<title id="MathJax-SVG-434-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> and decrease it over time. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-435-Title">
<title id="MathJax-SVG-435-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> changes between iterations, we use the variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.314ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 996.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-436-Title">
<title id="MathJax-SVG-436-Title"> \alpha^t </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="905" y="513"></use>
</g>
</svg></span> to mark that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-437-Title">
<title id="MathJax-SVG-437-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> varies over time <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-438-Title">
<title id="MathJax-SVG-438-Title"> t </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span>.</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.972ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 5154.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-439-Title">
<title id="MathJax-SVG-439-Title"> \nabla_\theta L(\theta^{(t)}, \textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
<g transform="translate(2336,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="3712" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4157" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4765" y="0"></use>
</g>
</svg></span> is the partial derivative / gradient of the loss function with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-440-Title">
<title id="MathJax-SVG-440-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> at time <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-441-Title">
<title id="MathJax-SVG-441-Title">t</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span>.</li>
</ul>
<p>You can now see the importance of choosing a differentiable loss function: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.867ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4248.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-442-Title">
<title id="MathJax-SVG-442-Title"> \nabla_\theta L(\theta, \textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</svg></span> is a crucial part of the gradient descent algorithm. (While it is possible to estimate the gradient by computing the difference in loss for two slightly different values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-443-Title">
<title id="MathJax-SVG-443-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> and dividing by the distance between <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-444-Title">
<title id="MathJax-SVG-444-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> values, this typically increases the runtime of gradient descent so significantly that it becomes impractical to use.)</p>
<p>The gradient algorithm is simple yet powerful since we can use it for many types of models and many types of loss functions. It is the computational tool of choice for fitting many important models, including linear regression on large datasets and neural networks.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-the-minimize-Function">Defining the <code>minimize</code> Function<a class="anchor-link" href="#Defining-the-minimize-Function">¶</a></h3><p>Now we return to our original task: defining the <code>minimize</code> function. We will have to change our function signature slightly since we now need to compute the gradient of the loss function.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Uses gradient descent to minimize loss_fn. Returns the minimizing value of</span>
<span class="sd">    theta_hat once theta_hat changes less than 0.001 between iterations.</span>
<span class="sd">    '''</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'theta: </span><span class="si">{theta:.2f}</span><span class="s1"> | loss: {loss_fn(theta, dataset):.2f}'</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">grad_loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">)</span>
        <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">gradient</span>
        
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_theta</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_theta</span>
        
        <span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then we can define functions to compute our MSE and its gradient:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we can use the <code>minimize</code> function to compute the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-445-Title">
<title id="MathJax-SVG-445-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.61ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13179.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-446-Title">
<title id="MathJax-SVG-446-Title"> \textbf{y} = [12.1, 12.8, 14.9, 16.3, 17.2] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4000" y="0"></use>
<g transform="translate(4445,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6225" y="0"></use>
<g transform="translate(6670,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="8450" y="0"></use>
<g transform="translate(8895,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="10675" y="0"></use>
<g transform="translate(11120,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12900" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
theta = minimize(mse, grad_mse, np.array([12.1, 12.8, 14.9, 16.3, 17.2]))
print(f'Minimizing theta: {theta}')
print()
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: 0.00 | loss: 218.76
theta: 5.86 | loss: 81.21
theta: 9.38 | loss: 31.70
theta: 11.49 | loss: 13.87
theta: 12.76 | loss: 7.45
theta: 13.52 | loss: 5.14
theta: 13.98 | loss: 4.31
theta: 14.25 | loss: 4.01
theta: 14.41 | loss: 3.90
theta: 14.51 | loss: 3.86
theta: 14.57 | loss: 3.85
theta: 14.61 | loss: 3.85
theta: 14.63 | loss: 3.84
theta: 14.64 | loss: 3.84
theta: 14.65 | loss: 3.84
theta: 14.65 | loss: 3.84
theta: 14.66 | loss: 3.84
theta: 14.66 | loss: 3.84
Minimizing theta: 14.658511131035242

Wall time: 1.99 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that gradient quickly finds the same solution as the analytic method:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">([</span><span class="mf">12.1</span><span class="p">,</span> <span class="mf">12.8</span><span class="p">,</span> <span class="mf">14.9</span><span class="p">,</span> <span class="mf">16.3</span><span class="p">,</span> <span class="mf">17.2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>14.66</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Minimizing-the-Huber-loss">Minimizing the Huber loss<a class="anchor-link" href="#Minimizing-the-Huber-loss">¶</a></h3><p>Now, we can apply gradient descent to minimize the Huber loss on our dataset of tip percentages.</p>
<p>The Huber loss is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.186ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 21177.3 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-447-Title">
<title id="MathJax-SVG-447-Title">
L_\delta(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    \frac{1}{2}(y_i - \theta)^2 &amp;  | y_i - \theta | \le \delta \\
     \delta (|y_i - \theta| - \frac{1}{2} \delta ) &amp; \text{otherwise}
\end{cases}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B4" x="963" y="-231"></use>
 <use xlink:href="#MJMAIN-28" x="1100" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1490" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1959" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2404" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3012" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3679" y="0"></use>
<g transform="translate(4458,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(5863,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(7474,0)">
 <use xlink:href="#MJSZ4-7B"></use>
<g transform="translate(973,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,766)">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="713" y="0"></use>
<g transform="translate(1103,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2160" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3161" y="0"></use>
<g transform="translate(3630,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMATHI-3B4" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="451" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="841" y="0"></use>
<g transform="translate(1119,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2176" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3177" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3646" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4147" y="0"></use>
<g transform="translate(4925,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-3B4" x="5862" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6313" y="0"></use>
</g>
</g>
<g transform="translate(7692,0)">
<g transform="translate(0,766)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1335" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2805" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="3362" y="0"></use>
 <use xlink:href="#MJMATHI-3B4" x="4418" y="0"></use>
</g>
<g transform="translate(0,-767)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-74" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1446" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-77" x="2283" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3006" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3284" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3679" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>The gradient of the Huber loss is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="52.66ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 22672.8 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-448-Title">
<title id="MathJax-SVG-448-Title">
\nabla_{\theta} L_\delta(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^n \begin{cases}
    -(y_i - \theta) &amp;  | y_i - \theta | \le \delta \\
    - \delta \cdot \text{sign} (y_i - \theta) &amp; \text{otherwise}
\end{cases}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
<g transform="translate(1265,0)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B4" x="963" y="-231"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2366" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2755" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3225" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3670" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4277" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4945" y="0"></use>
<g transform="translate(5723,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(7128,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(8739,0)">
 <use xlink:href="#MJSZ3-7B"></use>
<g transform="translate(917,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,601)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="778" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2225" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3225" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3695" y="0"></use>
</g>
<g transform="translate(0,-650)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-3B4" x="778" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="1452" y="0"></use>
<g transform="translate(1952,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-69" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="673" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1173" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3682" y="0"></use>
<g transform="translate(4072,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5129" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6130" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6599" y="0"></use>
</g>
</g>
<g transform="translate(7978,0)">
<g transform="translate(0,601)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1335" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2805" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="3362" y="0"></use>
 <use xlink:href="#MJMATHI-3B4" x="4418" y="0"></use>
</g>
<g transform="translate(0,-650)">
 <use xlink:href="#MJMAIN-6F"></use>
 <use xlink:href="#MJMAIN-74" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1446" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1891" y="0"></use>
 <use xlink:href="#MJMAIN-77" x="2283" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3006" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3284" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3679" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>(Note that in previous definitions of Huber loss we used the variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-449-Title">
<title id="MathJax-SVG-449-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> to denote the transition point. To avoid confusion with the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-450-Title">
<title id="MathJax-SVG-450-Title"> \alpha </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> used in gradient descent, we replace the transition point parameter of the Huber loss with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.049ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 451.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-451-Title">
<title id="MathJax-SVG-451-Title"> \delta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B4" x="0" y="0"></use>
</g>
</svg></span>.)</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">huber_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">dataset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">delta</span><span class="p">,</span>
                 <span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">dataset</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">,</span>
                 <span class="n">delta</span> <span class="o">*</span> <span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="n">delta</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">))</span>
    <span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_huber_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">delta</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">theta</span> <span class="o">-</span> <span class="n">dataset</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">d</span> <span class="o">&lt;=</span> <span class="n">delta</span><span class="p">,</span>
                 <span class="o">-</span><span class="p">(</span><span class="n">dataset</span> <span class="o">-</span> <span class="n">theta</span><span class="p">),</span>
                 <span class="o">-</span><span class="n">delta</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">dataset</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's minimize the Huber loss on the tips dataset:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
theta = minimize(huber_loss, grad_huber_loss, tips['pcttip'], progress=False)
print(f'Minimizing theta: {theta}')
print()
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Minimizing theta: 15.506849531471964

Wall time: 210 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h3><p>Gradient descent gives us a generic way to minimize a loss function when we cannot solve for the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-452-Title">
<title id="MathJax-SVG-452-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> analytically. As our models and loss functions increase in complexity, we will turn to gradient descent as our tool of choice to fit models.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/11'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># import ipywidgets as widgets</span>
<span class="c1"># from ipywidgets import interact, interactive, fixed, interact_manual</span>
<span class="c1"># import nbinteract as nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="p">[</span><span class="s1">'pcttip'</span><span class="p">]</span> <span class="o">=</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">]</span> <span class="o">/</span> <span class="n">tips</span><span class="p">[</span><span class="s1">'total_bill'</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">abs_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">quartic_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">5000</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span> <span class="o">+</span> <span class="mi">12</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span> <span class="o">+</span> <span class="mi">23</span><span class="p">)</span>
                   <span class="o">*</span> <span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span> <span class="o">-</span> <span class="mi">14</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span> <span class="o">-</span> <span class="mi">15</span><span class="p">)</span> <span class="o">+</span> <span class="mi">7</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_quartic_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="mi">2500</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">9</span><span class="o">*</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
                      <span class="o">-</span> <span class="mi">529</span><span class="o">*</span><span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">-</span> <span class="mi">327</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">xlim</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">):</span>
    <span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
    <span class="n">losses</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span> <span class="k">for</span> <span class="n">theta</span> <span class="ow">in</span> <span class="n">thetas</span><span class="p">]</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">losses</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">loss_fn</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_theta_on_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">default_args</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">'$ \theta $'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">theta</span><span class="p">],</span> <span class="p">[</span><span class="n">loss</span><span class="p">],</span> <span class="o">**</span><span class="p">{</span><span class="o">**</span><span class="n">default_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">})</span>
    
<span class="k">def</span> <span class="nf">plot_connected_thetas</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta_1</span><span class="p">,</span> <span class="n">theta_2</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta_1</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta_2</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="n">loss_1</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta_1</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">loss_2</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta_2</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">theta_1</span><span class="p">,</span> <span class="n">theta_2</span><span class="p">],</span> <span class="p">[</span><span class="n">loss_1</span><span class="p">,</span> <span class="n">loss_2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">plot_one_gd_iter</span><span class="p">(</span><span class="n">y_vals</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">2.5</span><span class="p">):</span>
    <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">grad_loss</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">xkcd_rgb</span><span class="p">[</span><span class="s1">'green'</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">new_theta</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'old theta: </span><span class="si">{theta}</span><span class="s1">'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'new theta: </span><span class="si">{new_theta[0]}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Convexity">Convexity<a class="anchor-link" href="#Convexity">¶</a></h2><p>Gradient descent provides a general method for minimizing a function. As we observe for the Huber loss, gradient descent is especially useful when the function's minimum is difficult to find analytically.</p>
<h2 id="Gradient-Descent-Finds-Local-Minima">Gradient Descent Finds Local Minima<a class="anchor-link" href="#Gradient-Descent-Finds-Local-Minima">¶</a></h2><p>Unfortunately, gradient descent does not always find the globally minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-453-Title">
<title id="MathJax-SVG-453-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Consider the following gradient descent run using an initial <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.322ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 3583.1 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-454-Title">
<title id="MathJax-SVG-454-Title"> \theta = -21 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1803" y="0"></use>
<g transform="translate(2582,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span> on the loss function below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">quartic_loss</span><span class="p">)</span>
<span class="n">plot_theta_on_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_6_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">,</span> <span class="n">grad_quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: -21
new theta: -9.944999999999999
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_7_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mf">9.9</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">,</span> <span class="n">grad_quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: -9.9
new theta: -12.641412
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_8_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.6</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">,</span> <span class="n">grad_quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: -12.6
new theta: -14.162808
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_9_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_one_gd_iter</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mf">14.2</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">,</span> <span class="n">grad_quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>old theta: -14.2
new theta: -14.497463999999999
</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_10_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On this loss function and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-455-Title">
<title id="MathJax-SVG-455-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> value, gradient descent converges to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.131ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4362.1 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-456-Title">
<title id="MathJax-SVG-456-Title"> \theta = -14.5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1803" y="0"></use>
<g transform="translate(2582,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span>, producing a loss of roughly 8. However, the global minimum for this loss function is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.514ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2804.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-457-Title">
<title id="MathJax-SVG-457-Title"> \theta = 18 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
<g transform="translate(1803,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-38" x="500" y="0"></use>
</g>
</g>
</svg></span>, corresponding to a loss of nearly zero. From this example, we observe that gradient descent finds a <em>local minimum</em> which may not necessarily have the same loss as the <em>global minimum</em>.</p>
<p>Luckily, a number of useful loss functions have identical local and global minima. Consider the familiar mean squared error loss function, for example:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Running gradient descent on this loss function with an appropriate learning rate will always find the globally optimal <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-458-Title">
<title id="MathJax-SVG-458-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> since the sole local minimum is also the global minimum.</p>
<p>The mean absolute error sometimes has multiple local minima. However, all the local minima produce the globally lowest loss possible.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">abs_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On this loss function, gradient descent will converge to one of the local minima in the range <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.461ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2781.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-459-Title">
<title id="MathJax-SVG-459-Title"> [-1, 1] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1057" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2503" y="0"></use>
</g>
</svg></span>. Since all of these local minima have the lowest loss possible for this function, gradient descent will still return an optimal choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-460-Title">
<title id="MathJax-SVG-460-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Definition-of-Convexity">Definition of Convexity<a class="anchor-link" href="#Definition-of-Convexity">¶</a></h2><p>For some functions, any local minimum is also a global minimum. This set of functions are called <strong>convex functions</strong> since they curve upward. For a constant model, the MSE, MAE, and Huber loss are all convex.</p>
<p>With an appropriate learning rate, gradient descent finds the globally optimal <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-461-Title">
<title id="MathJax-SVG-461-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for convex loss functions. Because of this useful property, we prefer to fit our models using convex loss functions unless we have a good reason not to.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Formally, a function <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 550.5 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-462-Title">
<title id="MathJax-SVG-462-Title">f</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
</g>
</svg></span> is convex if and only if it satisfies the following inequality for all possible function inputs <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.23ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 529.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-463-Title">
<title id="MathJax-SVG-463-Title">a</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.998ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 429.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-464-Title">
<title id="MathJax-SVG-464-Title">b</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-62" x="0" y="0"></use>
</g>
</svg></span>, for all <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.333ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3587.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-465-Title">
<title id="MathJax-SVG-465-Title">t \in [0, 1]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="639" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1584" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1863" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2363" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2808" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3309" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.48ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 16137.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-466-Title">
<title id="MathJax-SVG-466-Title">tf(a) + (1-t)f(b) \geq f(ta + (1-t)b)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-66" x="361" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="912" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1301" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1831" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2442" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3443" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3832" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4555" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="5556" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5917" y="0"></use>
 <use xlink:href="#MJMATHI-66" x="6307" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6857" y="0"></use>
 <use xlink:href="#MJMATHI-62" x="7247" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7676" y="0"></use>
 <use xlink:href="#MJMAIN-2265" x="8344" y="0"></use>
 <use xlink:href="#MJMATHI-66" x="9400" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9950" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="10340" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="10701" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="11453" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12454" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="12843" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="13566" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="14567" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14928" y="0"></use>
 <use xlink:href="#MJMATHI-62" x="15318" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15747" y="0"></use>
</g>
</svg></span><p>This inequality states that all lines connecting two points of the function must reside on or above the function itself. For the loss function at the start of the section, we can easily find such a line that appears below the graph:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">quartic_loss</span><span class="p">)</span>
<span class="n">plot_connected_thetas</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">quartic_loss</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus, this loss function is non-convex.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For MSE, all lines connecting two points of the graph appear above the graph. We plot one such line below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">])</span>
<span class="n">plot_loss</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">(</span><span class="o">-</span><span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">),</span> <span class="n">mse</span><span class="p">)</span>
<span class="n">plot_connected_thetas</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="o">-</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="n">mse</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/gradient_convexity_21_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The mathematical definition of convexity gives us a precise way of determining whether a function is convex. In this textbook, we will omit mathematical proofs of convexity and will instead state whether a chosen loss function is convex.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>For a convex function, any local minimum is also a global minimum. This useful property allows gradient descent to efficiently find the globally optimal model parameters for a given loss function. While gradient descent will converge to a local minimum for non-convex loss functions, these local minima are not guaranteed to be globally optimal.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/11'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Brief-Review">A Brief Review<a class="anchor-link" href="#A-Brief-Review">¶</a></h2><p>We initially fit our model to the tips dataset by finding the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-467-Title">
<title id="MathJax-SVG-467-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimized the MSE loss function, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.323ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 11333.4 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-468-Title">
<title id="MathJax-SVG-468-Title">L(\theta, \textbf{y}) = \frac{1}{n} \sum_{i=1}^{n}(y_i - \theta)^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3260" y="0"></use>
<g transform="translate(4038,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
<g transform="translate(5268,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7573" y="0"></use>
<g transform="translate(7962,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="9019" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="10020" y="0"></use>
<g transform="translate(10489,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg></span>. To calculate the minimizing value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-469-Title">
<title id="MathJax-SVG-469-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>, we took the derivative of the MSE, set it equal to zero, and solved for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-470-Title">
<title id="MathJax-SVG-470-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>. We found that the optimal <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-471-Title">
<title id="MathJax-SVG-471-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> was simply the mean of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-472-Title">
<title id="MathJax-SVG-472-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> values in our dataset.</p>
<p>However, for more complicated models and loss functions, there may not be simple algebraic expressions that yield the loss-minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-473-Title">
<title id="MathJax-SVG-473-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> values. Instead, we use the gradient descent algorithm to iteratively improve <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-474-Title">
<title id="MathJax-SVG-474-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> until convergence at a loss minimum. To complete an iteration of gradient descent, we calculate the following:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.57ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 12731.4 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-475-Title">
<title id="MathJax-SVG-475-Title">
{\theta}^{(t+1)} = \theta^{(t)} - \alpha \cdot \nabla_{\theta} L(\theta^{(t)}, \textbf{y})
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,432)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5212" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6213" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="7076" y="0"></use>
<g transform="translate(7576,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMATHI-4C" x="8842" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9523" y="0"></use>
<g transform="translate(9913,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="11289" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="11734" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12341" y="0"></use>
</g>
</svg></span><p>In this equation:</p>
<ul>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.196ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1376 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-476-Title">
<title id="MathJax-SVG-476-Title">\theta^{(t)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span> is our current estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-477-Title">
<title id="MathJax-SVG-477-Title">\theta^*</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> at the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-478-Title">
<title id="MathJax-SVG-478-Title">t</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span>th iteration</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-479-Title">
<title id="MathJax-SVG-479-Title">\alpha</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> is the learning rate</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.867ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4248.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-480-Title">
<title id="MathJax-SVG-480-Title">\nabla_{\theta} L(\theta, \textbf{y})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</svg></span> is the gradient of the loss function</li>
<li>We compute the next estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.296ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2280.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-481-Title">
<title id="MathJax-SVG-481-Title">\theta^{(t+1)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</svg></span> by subtracting the product of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-482-Title">
<title id="MathJax-SVG-482-Title">\alpha</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.867ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4248.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-483-Title">
<title id="MathJax-SVG-483-Title">\nabla_{\theta} L(\theta, \textbf{y})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</svg></span> computed at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.196ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1376 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-484-Title">
<title id="MathJax-SVG-484-Title">\theta^{(t)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Limitations-of-Gradient-Descent">Limitations of Gradient Descent<a class="anchor-link" href="#Limitations-of-Gradient-Descent">¶</a></h2><p>In the expression above, we calculate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.867ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4248.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-485-Title">
<title id="MathJax-SVG-485-Title">\nabla_{\theta}L(\theta, \textbf{y})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</svg></span> using the average gradient of the loss function <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.842ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2946 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-486-Title">
<title id="MathJax-SVG-486-Title">\ell(\theta, y_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="807" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1276" y="0"></use>
<g transform="translate(1721,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2556" y="0"></use>
</g>
</svg></span> across the entire dataset as a single batch. For this reason, this gradient update rule is often referred to as <strong>batch gradient descent</strong>.</p>
<p>For example, the gradient of the MSE loss first requires us to find the gradient of the squared loss, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.53ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10130.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-487-Title">
<title id="MathJax-SVG-487-Title">\nabla_{\theta} \ell(\theta, y_i) = -2 (y_i - \theta)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMAIN-2113" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1682" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2072" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2541" y="0"></use>
<g transform="translate(2987,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3821" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4489" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5545" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="6324" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6824" y="0"></use>
<g transform="translate(7214,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="8271" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="9271" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9741" y="0"></use>
</g>
</svg></span>, for each of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-488-Title">
<title id="MathJax-SVG-488-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> observations in our dataset. The final gradient loss is the average of the individual gradients as the derivation below shows:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.726ex" height="21.176ex" style="vertical-align: -9.741ex; margin-bottom: -0.263ex;" viewBox="0 -4809.9 13229.3 9117.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-489-Title">
<title id="MathJax-SVG-489-Title">
\begin{align}
\nabla_{\theta} L(\theta, \textbf{y}) &amp;= -\frac{2}{n} \sum_{i=1}^{n}(y_i - \theta) \\
&amp;= \frac{1}{n} \sum_{i=1}^{n}-2(y_i - \theta) \\
&amp;= \frac{1}{n} \sum_{i=1}^{n} \nabla_{\theta} \ell(\theta, y_i)
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</g>
<g transform="translate(4237,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7600" y="0"></use>
</g>
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4850" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5351" y="0"></use>
<g transform="translate(5740,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6797" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="7798" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8268" y="0"></use>
</g>
<g transform="translate(0,-2997)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(4072,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="5337" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5755" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6144" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6614" y="0"></use>
<g transform="translate(7059,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7894" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Thus, for each iteration of batch gradient descent, we must compute the loss on every point in the dataset. Since datasets can contain many points, batch gradient descent can take a prohibitive amount of time to converge.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Stochastic-Gradient-Descent">Stochastic Gradient Descent<a class="anchor-link" href="#Stochastic-Gradient-Descent">¶</a></h2><p>To circumvent the difficulty of computing a gradient across the entire training set, <strong>stochastic gradient descent</strong> approximates the overall gradient using a single randomly chosen data point. Since the observation is chosen randomly, we expect that using the gradient at each individual observation will eventually converge the algorithm to the same parameters as batch gradient descent. The modified update formula for stochastic gradient descent is presented below, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.566ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2827 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-490-Title">
<title id="MathJax-SVG-490-Title">l(\theta, y_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="298" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="688" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1157" y="0"></use>
<g transform="translate(1602,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2437" y="0"></use>
</g>
</svg></span> is the loss function for a single data point.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.805ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 11971.7 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-491-Title">
<title id="MathJax-SVG-491-Title">
\theta^{(t+1)} = \theta^{(t)} - \alpha \nabla_\theta \ell(\theta^{(t)}, y_i)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2558" y="0"></use>
<g transform="translate(3614,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5212" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6213" y="0"></use>
<g transform="translate(6853,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="8119" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8536" y="0"></use>
<g transform="translate(8926,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="10302" y="0"></use>
<g transform="translate(10747,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11582" y="0"></use>
</g>
</svg></span><p>Returning back to our example using the MSE, we approximate the gradient of the mean squared error using the gradient of the squared loss of one data point.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.366ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 10491 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-492-Title">
<title id="MathJax-SVG-492-Title">
\begin{align}
\nabla_{\theta}L(\theta, \textbf{y}) &amp;\approx \nabla_{\theta} \ell(\theta, y_i) \\
&amp;= -2(y_i - \theta)
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
</g>
</g>
<g transform="translate(4237,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-2248" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="2599" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3017" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3406" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3876" y="0"></use>
<g transform="translate(4321,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5156" y="0"></use>
</g>
<g transform="translate(0,-700)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2112" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2613" y="0"></use>
<g transform="translate(3002,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4059" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="5060" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5529" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Stochastic gradient descent relies on the random selection of individual observations. This is statistically founded since the randomness means that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.816ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11115.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-493-Title">
<title id="MathJax-SVG-493-Title">E[\nabla_{\theta}\ell(\theta, y_i)] = \nabla_{\theta}L(\theta, \textbf{y})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="764" y="0"></use>
<g transform="translate(1043,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="2308" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2725" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="3115" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3584" y="0"></use>
<g transform="translate(4030,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4864" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5254" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5810" y="0"></use>
<g transform="translate(6867,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMATHI-4C" x="8132" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8814" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="9203" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="9673" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="10118" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10725" y="0"></use>
</g>
</svg></span>. In practice, we choose these random data points by shuffling the training data and iteratively selecting from the shuffled data. An iteration through all <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-494-Title">
<title id="MathJax-SVG-494-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> observations of the shuffled data is called an <strong>epoch</strong>; at the end of every epoch, we reshuffle the data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Visualizing-Stochastic-Gradient-Descent">Visualizing Stochastic Gradient Descent<a class="anchor-link" href="#Visualizing-Stochastic-Gradient-Descent">¶</a></h3><p>Below are visual examples of loss minimization in batch gradient descent and stochastic gradient descent.</p>
<p><img alt="" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/gd.png">
<img alt="" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/sgd.png"></p>
<p>At each iteration of batch gradient descent, we move in the direction of the true gradient of the loss function, which is depicted by the ellipses. On the other hand, each iteration of stochastic gradient descent may not lead us in the direction of the true gradient; however, the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-495-Title">
<title id="MathJax-SVG-495-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> parameters eventually converge to the minima of the loss function. Although stochastic gradient descent typically takes more iterations to converge than batch gradient descent, it often converges more quickly because it spends significantly less time computing the update at each iteration.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Defining-a-Function-for-Stochastic-Gradient-Descent">Defining a Function for Stochastic Gradient Descent<a class="anchor-link" href="#Defining-a-Function-for-Stochastic-Gradient-Descent">¶</a></h3><p>As we previously did for batch gradient descent, we define a function that computes the stochastic gradient descent of the loss function. It will be similar to our <code>minimize</code> function but we will need to implement the random selection of one observation at each iteration.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">minimize_sgd</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Uses stochastic gradient descent to minimize loss_fn.</span>
<span class="sd">    Returns the minimizing value of theta once theta changes</span>
<span class="sd">    less than 0.001 between iterations.</span>
<span class="sd">    """</span>
    <span class="n">NUM_OBS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NUM_OBS</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">rand_obs</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">gradient</span> <span class="o">=</span> <span class="n">grad_loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">rand_obs</span><span class="p">)</span>
            <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">gradient</span>
        
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_theta</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">new_theta</span>
        
            <span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mini-batch-Gradient-Descent">Mini-batch Gradient Descent<a class="anchor-link" href="#Mini-batch-Gradient-Descent">¶</a></h2><p><strong>Mini-batch gradient descent</strong> strikes a balance between batch gradient descent and stochastic gradient descent by increasing the number of observations that we select at each iteration. In mini-batch gradient descent, we take a simple random sample of observations called a mini-batch. We use the average of the gradients of their loss functions to construct an estimate of the true gradient of the cross entropy loss. Since our sample is randomly selected, the expectation of this estimate is equal to the true gradient. This is illustrated in the approximation for the gradient of the loss function, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.543ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 664.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-496-Title">
<title id="MathJax-SVG-496-Title">\mathcal{B}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJCAL-42" x="0" y="0"></use>
</g>
</svg></span> is the mini-batch of data points that we randomly sample from the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-497-Title">
<title id="MathJax-SVG-497-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> observations.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.549ex" height="6.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1437.2 13153 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-498-Title">
<title id="MathJax-SVG-498-Title">
\nabla_\theta L(\theta, \textbf{y}) \approx \frac{1}{|\mathcal{B}|} \sum_{i\in\mathcal{B}}\nabla_{\theta}\ell(\theta, y_i)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
 <use xlink:href="#MJMATHI-4C" x="1265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1946" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2336" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2805" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3251" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3858" y="0"></use>
 <use xlink:href="#MJMAIN-2248" x="4525" y="0"></use>
<g transform="translate(5304,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1341" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="420" y="676"></use>
<g transform="translate(60,-771)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJCAL-42" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="943" y="0"></use>
</g>
</g>
</g>
<g transform="translate(7330,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(129,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJCAL-42" x="1013" y="0"></use>
</g>
</g>
<g transform="translate(8941,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="1178" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="10207" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10624" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="11014" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="11483" y="0"></use>
<g transform="translate(11928,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12763" y="0"></use>
</g>
</svg></span><p>As with stochastic gradient descent, we perform mini-batch gradient descent by shuffling our training data and selecting mini-batches by iterating through the shuffled data. After each epoch, we re-shuffle our data and select new mini-batches.</p>
<p>While we have made the distinction between stochastic and mini-batch gradient descent in this textbook, stochastic gradient descent is sometimes used as an umbrella term that encompasses the selection of a mini-batch of any size.</p>
<h3 id="Selecting-the-Mini-Batch-Size">Selecting the Mini-Batch Size<a class="anchor-link" href="#Selecting-the-Mini-Batch-Size">¶</a></h3><p>Mini-batch gradient descent is most optimal when running on a Graphical Processing Unit (GPU) or on distributed systems. Since computations on these hardware machines can be executed in parallel, using a mini-batch can increase the accuracy of the gradient without increasing computation time. Depending on the memory of the GPU, the mini-batch size is often set between 10 and 100 observations.</p>
<h3 id="Defining-a-Function-for-Mini-Batch-Gradient-Descent">Defining a Function for Mini-Batch Gradient Descent<a class="anchor-link" href="#Defining-a-Function-for-Mini-Batch-Gradient-Descent">¶</a></h3><p>A function for mini-batch gradient descent requires the ability to select a batch size. Below is a function that implements this feature.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">minimize_mini_batch</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Uses mini-batch gradient descent to minimize loss_fn.</span>
<span class="sd">    Returns the minimizing value of theta once theta changes</span>
<span class="sd">    less than 0.001 between iterations.</span>
<span class="sd">    """</span>
    <span class="n">NUM_OBS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">minibatch_size</span> <span class="o">&lt;</span> <span class="n">NUM_OBS</span>
    
    <span class="n">theta</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">NUM_OBS</span><span class="p">,</span> <span class="n">minibatch_size</span><span class="p">):</span>
            <span class="n">mini_batch</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">i</span><span class="o">+</span><span class="n">minibatch_size</span><span class="p">]</span>
            <span class="n">gradient</span> <span class="o">=</span> <span class="n">grad_loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">mini_batch</span><span class="p">)</span>
            <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">gradient</span>
            
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_theta</span> <span class="o">-</span> <span class="n">theta</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.001</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">new_theta</span>
            
            <span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We use batch gradient descent to iteratively improve model parameters until the model achieves minimal loss. Since batch gradient descent is computationally intractable with large datasets, we often use stochastic gradient descent to fit models instead. Furthermore, when using a GPU, mini-batch gradient descent can converge more quickly than stochastic gradient descent for the same computational cost. For large datasets, stochastic gradient descent and mini-batch gradient descent are often preferred to batch gradient descent for their faster computation times.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/12'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Probability-and-Generalization">Probability and Generalization<a class="anchor-link" href="#Probability-and-Generalization">¶</a></h1><p>So far, we have used datasets for estimation and prediction by defining a model, selecting a loss function, and minimizing the loss function for the dataset we have on hand. For example, we defined a constant model and the mean squared error loss function for the tips dataset and found that the mean tip percentage of the dataset minimized the MSE.</p>
<p>Even though we now have models that reflect our data, we have no way of generalizing our observations to the larger population. To address the issue of generalization, we will first introduce random variables as a way of representing population data, and we will use expectation and variance to summarize a random variable's distribution. Then, we will introduce the expected loss as a method of analyzing the relationship between a population and sample.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/12'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Variables">Random Variables<a class="anchor-link" href="#Random-Variables">¶</a></h2><p>Almost all real-world phenomena contain some degree of randomness, making data generation and collection inherently random processes. Since we fit our models on these data, our models also contain randomness. To represent these random processes mathematically, we use random variables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A <strong>random variable</strong> is an algebraic variable that represents a numerical value determined by a probabilistic event. We typically use capital letters like <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-499-Title">
<title id="MathJax-SVG-499-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> or <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-500-Title">
<title id="MathJax-SVG-500-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> to denote a random variable. Although random variables can represent either discrete (i.e. the number of heads in 10 coin flips) or continuous (i.e. the amount of time we wait at a bus stop) quantities, we will only use discrete random variables for the purposes of this textbook.</p>
<p>We must always specify what a given random variable represents. For example, we may write that the random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-501-Title">
<title id="MathJax-SVG-501-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represents the number of heads in 10 coin flips. The definition of a random variable determines the values it can take on. In this example, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-502-Title">
<title id="MathJax-SVG-502-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> may only take on values between <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-503-Title">
<title id="MathJax-SVG-503-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1001 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-504-Title">
<title id="MathJax-SVG-504-Title"> 10 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</svg></span>.</p>
<p>We must also be able to determine the probability that the random variable takes on each value. For example, the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-505-Title">
<title id="MathJax-SVG-505-Title"> X = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2186" y="0"></use>
</g>
</svg></span> is written as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.551ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 8417.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-506-Title">
<title id="MathJax-SVG-506-Title"> P(X = 0) = (0.5)^{10} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3828" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4495" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5551" y="0"></use>
<g transform="translate(5941,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
<g transform="translate(7220,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
<g transform="translate(389,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Probability-Mass-Functions">Probability Mass Functions<a class="anchor-link" href="#Probability-Mass-Functions">¶</a></h3><p>The <strong>probability mass function (PMF)</strong> or the <strong>distribution</strong> of a random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-507-Title">
<title id="MathJax-SVG-507-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> yields the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-508-Title">
<title id="MathJax-SVG-508-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> takes on each of its possible values. If we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-509-Title">
<title id="MathJax-SVG-509-Title">\mathbb{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-58" x="0" y="0"></use>
</g>
</svg></span> be the set of values that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-510-Title">
<title id="MathJax-SVG-510-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> can take on and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-511-Title">
<title id="MathJax-SVG-511-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> be a particular value in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-512-Title">
<title id="MathJax-SVG-512-Title">\mathbb{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-58" x="0" y="0"></use>
</g>
</svg></span>, the PMF of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-513-Title">
<title id="MathJax-SVG-513-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> must satisfy the following rules:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.42ex" height="5.676ex" style="vertical-align: -3.171ex;" viewBox="0 -1078.4 8791.9 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-514-Title">
<title id="MathJax-SVG-514-Title">
1) \sum_{x \in \mathbb{X}} P(X = x) = 1
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="500" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(28,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-58" x="1240" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-50" x="2667" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3419" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="3808" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4939" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="5995" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6567" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7235" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8291" y="0"></use>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.224ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 15165.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-515-Title">
<title id="MathJax-SVG-515-Title">
2) \text{ For all } x \in \mathbb{X}, 0 \leq P(X = x) \leq 1
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="500" y="0"></use>
<g transform="translate(890,0)">
 <use xlink:href="#MJMAIN-46" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="903" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1404" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2046" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="2547" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="2825" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="4244" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="5094" y="0"></use>
 <use xlink:href="#MJAMS-58" x="6039" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6762" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="7207" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="7985" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="9041" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9793" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="10182" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11313" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="12369" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12941" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="13609" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="14665" y="0"></use>
</g>
</svg></span><p>The first rule states that the probabilities for all possible values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-516-Title">
<title id="MathJax-SVG-516-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> sum to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-517-Title">
<title id="MathJax-SVG-517-Title"> 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>The second rule states that each individual probability for a given value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-518-Title">
<title id="MathJax-SVG-518-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> must be between <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-519-Title">
<title id="MathJax-SVG-519-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-520-Title">
<title id="MathJax-SVG-520-Title"> 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>Suppose we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-521-Title">
<title id="MathJax-SVG-521-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represent the result of one roll from a fair six-sided die. We know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.29ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8305.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-522-Title">
<title id="MathJax-SVG-522-Title"> X \in \{1, 2, 3, 4, 5, 6\} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-7B" x="2075" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2576" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3076" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="3521" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4022" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="4467" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4967" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="5413" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5913" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="6358" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6859" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="7304" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="7804" y="0"></use>
</g>
</svg></span> and that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.162ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 19875.3 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-523-Title">
<title id="MathJax-SVG-523-Title"> P(X = 1) = P(X = 2) = \ldots = P(X = 6) = \frac{1}{6} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3828" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4495" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5551" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6303" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6692" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7822" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8879" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9379" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10046" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="11103" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="12553" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="13609" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14361" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="14750" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="15881" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="16937" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17437" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="18105" y="0"></use>
<g transform="translate(18883,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="84" y="-589"></use>
</g>
</g>
</g>
</svg></span>. We can plot the PMF of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-524-Title">
<title id="MathJax-SVG-524-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as a probability distribution:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">xk</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">pk</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span>
<span class="n">dice</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'dice'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">pk</span><span class="p">))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">dice</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="s1">'ro'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dice</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$P(X = x)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">12</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="s1">'0'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{12}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{6}</span><span class="s1">$'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'PMF of $X$'</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/prob_random_vars_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Joint-Distributions">Joint Distributions<a class="anchor-link" href="#Joint-Distributions">¶</a></h3><p>The notion of PMFs for single random variables extends naturally to joint distributions for multiple random variables; in particular, the <em>joint distribution</em> of a set of random variables yields the probability that these random variables simultaneously take on a specific set of values.</p>
<p>As an example, let the random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-525-Title">
<title id="MathJax-SVG-525-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represent the number of heads in 10 coin flips, and let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-526-Title">
<title id="MathJax-SVG-526-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> represent the number of tails in the same set of 10 coin flips. We can note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.907ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 21057 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-527-Title">
<title id="MathJax-SVG-527-Title">P(X=0, Y=10) = P(X=10, Y=0) = (0.5)^{10}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3828" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4273" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5314" y="0"></use>
<g transform="translate(6370,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7371" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8039" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="9095" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9846" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="10236" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11366" y="0"></use>
<g transform="translate(12422,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="13423" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="13869" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14910" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="15966" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="16467" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="17134" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="18190" y="0"></use>
<g transform="translate(18580,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
<g transform="translate(19859,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
<g transform="translate(389,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</g>
</svg></span>. Meanwhile <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.125ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9095.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-528-Title">
<title id="MathJax-SVG-528-Title">P(X=6, Y=6) = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3828" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4273" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5314" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="6370" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6871" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7538" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="8594" y="0"></use>
</g>
</svg></span> since we cannot possibly have 6 heads and 6 tails in 10 coin flips.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Marginal-Distributions">Marginal Distributions<a class="anchor-link" href="#Marginal-Distributions">¶</a></h4><p>Sometimes, we have the joint distribution for two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-529-Title">
<title id="MathJax-SVG-529-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-530-Title">
<title id="MathJax-SVG-530-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>, but we want to find the <em>marginal distribution</em> for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-531-Title">
<title id="MathJax-SVG-531-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>. In other words, we would like to find the PMF of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-532-Title">
<title id="MathJax-SVG-532-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> given the joint distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-533-Title">
<title id="MathJax-SVG-533-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-534-Title">
<title id="MathJax-SVG-534-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>. To find the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-535-Title">
<title id="MathJax-SVG-535-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> takes on a particular value, we must consider all possible values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-536-Title">
<title id="MathJax-SVG-536-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> (denoted by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-537-Title">
<title id="MathJax-SVG-537-Title">\mathbb{Y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-59" x="0" y="0"></use>
</g>
</svg></span>) that can simultaneously happen with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-538-Title">
<title id="MathJax-SVG-538-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and sum over all of these joint probabilities:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.579ex" height="5.843ex" style="vertical-align: -2.338ex;" viewBox="0 -1508.9 14888.1 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-539-Title">
<title id="MathJax-SVG-539-Title">
\begin{aligned}
\sum_{y \in \mathbb{Y}} P(X=x, Y=y) &amp;= P(X=x)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,447)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(54,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="497" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-59" x="1165" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="1611" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2362" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3882" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4938" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5511" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="5956" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6997" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="8053" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8551" y="0"></use>
</g>
</g>
<g transform="translate(8930,0)">
<g transform="translate(0,447)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2475" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3605" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4661" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5234" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>We can prove this identity as follows:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="59.089ex" height="15.176ex" style="vertical-align: -7.005ex;" viewBox="0 -3518.2 25440.9 6534.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-540-Title">
<title id="MathJax-SVG-540-Title">
\begin{aligned}
\sum_{y \in \mathbb{Y}} P(X=x, Y=y) &amp;= \sum_{y \in \mathbb{Y}} P(X=x) \times P(Y=y \; \vert \; X=x)\\
&amp;= P(X=x) \times \sum_{y \in \mathbb{Y}} P(Y=y \; \vert \; X=x)\\
&amp;= P(X=x)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2422)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(54,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="497" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-59" x="1165" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="1611" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2362" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3882" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4938" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5511" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="5956" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6997" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="8053" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8551" y="0"></use>
</g>
</g>
<g transform="translate(8930,0)">
<g transform="translate(0,2422)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(54,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="497" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-59" x="1165" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-50" x="2945" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3696" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4086" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5216" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="6272" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6845" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="7457" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="8457" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9209" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="9598" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10640" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="11696" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="12471" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="13027" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14158" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="15214" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15786" y="0"></use>
</g>
<g transform="translate(0,-176)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2475" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3605" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4661" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5234" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="5845" y="0"></use>
<g transform="translate(6846,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(54,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="497" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-59" x="1165" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-50" x="8457" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9209" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="9598" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10640" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="11696" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="12471" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="13027" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14158" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="15214" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15786" y="0"></use>
</g>
<g transform="translate(0,-2623)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2475" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3605" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4661" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5234" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>In the last line of this proof, we treated <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.119ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4356.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-541-Title">
<title id="MathJax-SVG-541-Title">Y \; \vert \; X = x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1041" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1597" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2727" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3784" y="0"></use>
</g>
</svg></span> as a random variable with some unknown PMF. This is important since we used the property that the probabilities in a PMF sum to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-542-Title">
<title id="MathJax-SVG-542-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>, which means that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.361ex" height="3.343ex" style="vertical-align: -1.338ex;" viewBox="0 -863.1 12211.1 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-543-Title">
<title id="MathJax-SVG-543-Title">\sum_{y\in \mathbb{Y}} P(Y = y \; \vert \; X = x) = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="497" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-59" x="1165" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="2657" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3409" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4840" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="5896" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="6671" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="7227" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8358" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="9414" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9986" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10654" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="11710" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Independence">Independence<a class="anchor-link" href="#Independence">¶</a></h4><p>Two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-544-Title">
<title id="MathJax-SVG-544-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-545-Title">
<title id="MathJax-SVG-545-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent if the value of one random variable has no influence on the value of the second. Consider the coin flipping example earlier in the section where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-546-Title">
<title id="MathJax-SVG-546-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represents the number of heads in 10 coin flips, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-547-Title">
<title id="MathJax-SVG-547-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> represents the number of tails in the same set of 10 coin flips. In this instance, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-548-Title">
<title id="MathJax-SVG-548-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-549-Title">
<title id="MathJax-SVG-549-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are not independent; if we know <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-550-Title">
<title id="MathJax-SVG-550-Title">X = 5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="2186" y="0"></use>
</g>
</svg></span>, then we know for certain that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.034ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2598.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-551-Title">
<title id="MathJax-SVG-551-Title">Y = 5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="2097" y="0"></use>
</g>
</svg></span>. However if we did not know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-552-Title">
<title id="MathJax-SVG-552-Title">X = 5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="2186" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-553-Title">
<title id="MathJax-SVG-553-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> could have been any value from 0 to 10.</p>
<p>As another example, let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-554-Title">
<title id="MathJax-SVG-554-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> be the same as before, but <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-555-Title">
<title id="MathJax-SVG-555-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> now represents the number of sixes in a set of 10 dice rolls. Since the result of the coin flips has no effect on the dice rolls, we can say that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-556-Title">
<title id="MathJax-SVG-556-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-557-Title">
<title id="MathJax-SVG-557-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent in this example; knowing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-558-Title">
<title id="MathJax-SVG-558-Title">X = 5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="2186" y="0"></use>
</g>
</svg></span> tells us nothing about the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-559-Title">
<title id="MathJax-SVG-559-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Example:</strong> Suppose we have a small dataset of four people:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"Name"</span><span class="p">:[</span><span class="s2">"Carol"</span><span class="p">,</span><span class="s2">"Bob"</span><span class="p">,</span><span class="s2">"John"</span><span class="p">,</span><span class="s2">"Dave"</span><span class="p">],</span> <span class="s1">'Age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">50</span><span class="p">]}</span>
<span class="n">people</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">people</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Age</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>50</td>
<td>Carol</td>
</tr>
<tr>
<th>1</th>
<td>52</td>
<td>Bob</td>
</tr>
<tr>
<th>2</th>
<td>51</td>
<td>John</td>
</tr>
<tr>
<th>3</th>
<td>50</td>
<td>Dave</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Suppose we sample two people from this dataset with replacement. If the random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-560-Title">
<title id="MathJax-SVG-560-Title"> Z </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span> represents the difference between the ages of the first and second persons in the sample, what is the PMF of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-561-Title">
<title id="MathJax-SVG-561-Title"> Z </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span>?</p>
<p>To approach this problem, we define two new random variables. We define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-562-Title">
<title id="MathJax-SVG-562-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the age of the first person and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-563-Title">
<title id="MathJax-SVG-563-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the age of the second. Then, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.373ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4896.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-564-Title">
<title id="MathJax-SVG-564-Title"> Z = X - Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3132" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4133" y="0"></use>
</g>
</svg></span>. Then, we find the joint probability distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-565-Title">
<title id="MathJax-SVG-565-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-566-Title">
<title id="MathJax-SVG-566-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>: the probability of each value that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-567-Title">
<title id="MathJax-SVG-567-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-568-Title">
<title id="MathJax-SVG-568-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> can take on simultaneously. In this case, note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-569-Title">
<title id="MathJax-SVG-569-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-570-Title">
<title id="MathJax-SVG-570-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent and identically distributed; the two random variables represent two independent draws from the same dataset, and the first draw has no influence on the second. For example, the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-571-Title">
<title id="MathJax-SVG-571-Title"> X = 51 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-572-Title">
<title id="MathJax-SVG-572-Title"> Y = 50 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.861ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 14148.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-573-Title">
<title id="MathJax-SVG-573-Title"> P(X = 51, Y = 50) = \frac{1}{4} \cdot \frac{2}{4} = \frac{2}{16} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
<g transform="translate(3327,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4328" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4773" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5815" y="0"></use>
<g transform="translate(6871,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7872" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8539" y="0"></use>
<g transform="translate(9318,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="84" y="-600"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="10531" y="0"></use>
<g transform="translate(10810,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="84" y="-600"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="12024" y="0"></use>
<g transform="translate(12802,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="335" y="629"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>. In a similar way, we get:</p>
<table>
<tbody><tr>
<th></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-574-Title">
<title id="MathJax-SVG-574-Title">Y=50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-575-Title">
<title id="MathJax-SVG-575-Title">Y=51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-576-Title">
<title id="MathJax-SVG-576-Title">Y=52</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-577-Title">
<title id="MathJax-SVG-577-Title">X=50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>4/16</td>
<td>2/16</td>
<td>2/16</td>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-578-Title">
<title id="MathJax-SVG-578-Title">X=51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>2/16</td>
<td>1/16</td>
<td>1/16</td>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-579-Title">
<title id="MathJax-SVG-579-Title">X=52</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>2/16</td>
<td>1/16</td>
<td>1/16</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let us now consider the case in which we sample two people from the same dataset as above but without replacement. As before, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-580-Title">
<title id="MathJax-SVG-580-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the age of the first person and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-581-Title">
<title id="MathJax-SVG-581-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the age of the second, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.373ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4896.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-582-Title">
<title id="MathJax-SVG-582-Title">Z = X - Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3132" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4133" y="0"></use>
</g>
</svg></span>. However, now <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-583-Title">
<title id="MathJax-SVG-583-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-584-Title">
<title id="MathJax-SVG-584-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are not independent; for example, if we know <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-585-Title">
<title id="MathJax-SVG-585-Title">X = 51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span>, then <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 3098.6 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-586-Title">
<title id="MathJax-SVG-586-Title">Y \neq 51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2260" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span>. We find the joint distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-587-Title">
<title id="MathJax-SVG-587-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-588-Title">
<title id="MathJax-SVG-588-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as follows:</p>
<table>
<tbody><tr>
<th></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-589-Title">
<title id="MathJax-SVG-589-Title">Y=50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-590-Title">
<title id="MathJax-SVG-590-Title">Y=51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.197ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3098.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-591-Title">
<title id="MathJax-SVG-591-Title">Y=52</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1041" y="0"></use>
<g transform="translate(2097,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span></th>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-592-Title">
<title id="MathJax-SVG-592-Title">X=50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>2/12</td>
<td>2/12</td>
<td>2/12</td>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-593-Title">
<title id="MathJax-SVG-593-Title">X=51</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>2/12</td>
<td>0</td>
<td>1/12</td>
</tr>
<tr>
<td><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.403ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3187.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-594-Title">
<title id="MathJax-SVG-594-Title">X=52</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
<g transform="translate(2186,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</svg></span></td>
<td>2/12</td>
<td>1/12</td>
<td>0</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also find the marginal distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-595-Title">
<title id="MathJax-SVG-595-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> from the table:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="77.848ex" height="24.509ex" style="vertical-align: -11.671ex;" viewBox="0 -5527.4 33517.9 10552.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-596-Title">
<title id="MathJax-SVG-596-Title">
\begin{aligned}
P(Y = 50) &amp;= P(Y = 50, X = 50) + P(Y = 50, X = 51) + P(Y = 50, X = 52) \\
&amp;= \frac{2}{12} + \frac{2}{12} + \frac{2}{12} \\
&amp;= \frac{1}{2} \\
P(Y = 51) &amp;= \frac{2}{12} + 0 + \frac{1}{12} = \frac{1}{4} \\
P(Y = 52) &amp;= \frac{2}{12} + \frac{1}{12} + 0 = \frac{1}{4}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,4648)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2182" y="0"></use>
<g transform="translate(3238,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4239" y="0"></use>
</g>
<g transform="translate(0,-1909)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2182" y="0"></use>
<g transform="translate(3238,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4239" y="0"></use>
</g>
<g transform="translate(0,-4250)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2182" y="0"></use>
<g transform="translate(3238,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4239" y="0"></use>
</g>
</g>
<g transform="translate(4618,0)">
<g transform="translate(0,4648)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2085" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="2475" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3516" y="0"></use>
<g transform="translate(4572,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="5573" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6018" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7149" y="0"></use>
<g transform="translate(8205,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9206" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9818" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="10818" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="11570" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="11959" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="13001" y="0"></use>
<g transform="translate(14057,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="15058" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="15503" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="16633" y="0"></use>
<g transform="translate(17690,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="18691" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="19302" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="20303" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="21055" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="21444" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="22485" y="0"></use>
<g transform="translate(23542,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="24543" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="24988" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="26118" y="0"></use>
<g transform="translate(27174,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="28175" y="0"></use>
</g>
<g transform="translate(0,2753)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="2917" y="0"></use>
<g transform="translate(3695,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="5501" y="0"></use>
<g transform="translate(6279,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,422)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-32" x="60" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-1909)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="2917" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3918" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4640" y="0"></use>
<g transform="translate(5419,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="7280" y="0"></use>
<g transform="translate(8058,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
</g>
<g transform="translate(0,-4250)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="2917" y="0"></use>
<g transform="translate(3695,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="5501" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="6501" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7280" y="0"></use>
<g transform="translate(8058,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Even though we are sampling without replacement, note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-597-Title">
<title id="MathJax-SVG-597-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-598-Title">
<title id="MathJax-SVG-598-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> still have the same distribution!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this section, we learn that random variables are variables with multiple possible outcomes. These outcomes must be defined completely and precisely—each outcome must have a well-defined probability of occurrence.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/12'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">stats</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Expectation-and-Variance">Expectation and Variance<a class="anchor-link" href="#Expectation-and-Variance">¶</a></h2><p>Although a random variable is completely described by its probability mass function (PMF), we often use <strong>expectation</strong> and <strong>variance</strong> to describe the variable's long-run average and spread. These two values have unique mathematical properties that hold particular importance for data science—for example, we can show that an estimation is accurate in the long term by showing that its expected value is equal to the population parameter. We proceed by defining expectation and variance, introducing their most useful mathematical properties, and conclude with a brief application to estimation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Expectation">Expectation<a class="anchor-link" href="#Expectation">¶</a></h3><p>We are often interested in the long-run average of a random variable because it gives us a sense of the center of the variable's distribution. We call this long-run average the <strong>expected value</strong>, or <strong>expectation</strong> of a random variable. The expected value of a random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-599-Title">
<title id="MathJax-SVG-599-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> is defined as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.636ex" height="5.676ex" style="vertical-align: -3.171ex;" viewBox="0 -1078.4 10607.2 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-600-Title">
<title id="MathJax-SVG-600-Title">\mathbb{E}[X] = \sum_{x\in \mathbb{X}} x \cdot P(X = x)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
<g transform="translate(3411,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(28,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-58" x="1240" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-78" x="5022" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="5816" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6317" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7069" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="7458" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8588" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="9645" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10217" y="0"></use>
</g>
</svg></span><p>For example, if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-601-Title">
<title id="MathJax-SVG-601-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represents the roll of a single fair six-sided die,</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="57.83ex" height="11.509ex" style="vertical-align: -5.171ex;" viewBox="0 -2728.8 24898.9 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-602-Title">
<title id="MathJax-SVG-602-Title">
\begin{aligned}
\mathbb{E}[X]
&amp;= 1 \cdot P(X = 1) + 2 \cdot P(X = 2) + \ldots + 6 \cdot P(X = 6) \\
&amp;= 1 \cdot \frac{1}{6} + 2 \cdot \frac{1}{6} + \ldots + 6 \cdot \frac{1}{6} \\
&amp;= 3.5
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1801)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</g>
<g transform="translate(2066,0)">
<g transform="translate(0,1801)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2056" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="2557" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3309" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="3698" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4828" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5885" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6385" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="6997" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="7998" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="8720" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="9221" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9972" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="10362" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11492" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="12549" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13049" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13661" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="14661" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="16056" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="17057" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="17780" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="18280" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="19032" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="19421" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="20552" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="21608" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="22108" y="0"></use>
</g>
<g transform="translate(0,-93)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2056" y="0"></use>
<g transform="translate(2335,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="3640" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4640" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="5363" y="0"></use>
<g transform="translate(5642,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="6947" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="7947" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9342" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="10343" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="11066" y="0"></use>
<g transform="translate(11344,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-36" x="60" y="-687"></use>
</g>
</g>
</g>
<g transform="translate(0,-1902)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Notice that the expected value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-603-Title">
<title id="MathJax-SVG-603-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> does not have to be a possible value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-604-Title">
<title id="MathJax-SVG-604-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>; although in this case  <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.894ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4690.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-605-Title">
<title id="MathJax-SVG-605-Title"> \mathbb{E}[X] = 3.5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
<g transform="translate(3411,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-606-Title">
<title id="MathJax-SVG-606-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> never takes on the value <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.972ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-607-Title">
<title id="MathJax-SVG-607-Title"> 3.5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Example:</strong> Recall our dataset from the previous section:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">"Name"</span><span class="p">:[</span><span class="s2">"Carol"</span><span class="p">,</span><span class="s2">"Bob"</span><span class="p">,</span><span class="s2">"John"</span><span class="p">,</span><span class="s2">"Dave"</span><span class="p">],</span> <span class="s1">'Age'</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">52</span><span class="p">,</span><span class="mi">51</span><span class="p">,</span><span class="mi">50</span><span class="p">]}</span>
<span class="n">people</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">people</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Age</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>50</td>
<td>Carol</td>
</tr>
<tr>
<th>1</th>
<td>52</td>
<td>Bob</td>
</tr>
<tr>
<th>2</th>
<td>51</td>
<td>John</td>
</tr>
<tr>
<th>3</th>
<td>50</td>
<td>Dave</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We pick one person from this dataset uniformly at random. Let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-608-Title">
<title id="MathJax-SVG-608-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> be a random variable representing the age of this person. Then:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.414ex" height="11.509ex" style="vertical-align: -5.171ex;" viewBox="0 -2728.8 25150.5 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-609-Title">
<title id="MathJax-SVG-609-Title">
\begin{aligned}
\mathbb{E}[Y]
&amp;= 50 \cdot P(Y = 50) + 51 \cdot P(Y = 51) + 52 \cdot P(Y = 52) \\
&amp;= 50 \cdot \frac{2}{4} + 51 \cdot \frac{1}{4} + 52 \cdot \frac{1}{4} \\
&amp;= 50.75
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1796)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1709" y="0"></use>
</g>
</g>
<g transform="translate(1977,0)">
<g transform="translate(0,1796)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2557" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3058" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3809" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4199" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5240" y="0"></use>
<g transform="translate(6296,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7297" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7909" y="0"></use>
<g transform="translate(8910,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="10133" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="10633" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="11385" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="11774" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="12816" y="0"></use>
<g transform="translate(13872,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14873" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15485" y="0"></use>
<g transform="translate(16485,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="17709" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="18209" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="18961" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="19350" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="20392" y="0"></use>
<g transform="translate(21448,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="22449" y="0"></use>
</g>
<g transform="translate(0,-99)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2557" y="0"></use>
<g transform="translate(2835,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="4140" y="0"></use>
<g transform="translate(5141,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="6364" y="0"></use>
<g transform="translate(6643,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="7948" y="0"></use>
<g transform="translate(8948,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="10172" y="0"></use>
<g transform="translate(10450,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="620" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="60" y="676"></use>
 <use xlink:href="#MJMAIN-34" x="60" y="-698"></use>
</g>
</g>
</g>
<g transform="translate(0,-1897)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Example:</strong> Suppose we sample two people from the dataset with replacement. If the random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-610-Title">
<title id="MathJax-SVG-610-Title"> Z </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span> represents the difference between the ages of the first and second persons in the sample, what is  <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.524ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1948 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-611-Title">
<title id="MathJax-SVG-611-Title"> \mathbb{E}[Z] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
</g>
</svg></span>?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As in the previous section, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-612-Title">
<title id="MathJax-SVG-612-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the age of the first person and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-613-Title">
<title id="MathJax-SVG-613-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the age of the second such that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.373ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4896.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-614-Title">
<title id="MathJax-SVG-614-Title">Z = X - Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3132" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4133" y="0"></use>
</g>
</svg></span>. From the joint distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-615-Title">
<title id="MathJax-SVG-615-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-616-Title">
<title id="MathJax-SVG-616-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> given in the previous section, we can find the PMF for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.68ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 723.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-617-Title">
<title id="MathJax-SVG-617-Title"> Z </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
</g>
</svg></span>. For example, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="59.391ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 25571 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-618-Title">
<title id="MathJax-SVG-618-Title"> P(Z = 1) = P(X = 51, Y = 50) + P(X = 52, Y = 51) = \frac{3}{16} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2142" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3198" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3699" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4366" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5422" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6174" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6563" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7693" y="0"></use>
<g transform="translate(8750,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="9751" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="10196" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11237" y="0"></use>
<g transform="translate(12293,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="13294" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13906" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="14907" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="15658" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="16048" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="17178" y="0"></use>
<g transform="translate(18234,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="19235" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="19681" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="20722" y="0"></use>
<g transform="translate(21778,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="22779" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="23446" y="0"></use>
<g transform="translate(24225,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="335" y="651"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>. Thus,</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.292ex" height="11.509ex" style="vertical-align: -5.171ex;" viewBox="0 -2728.8 29833.9 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-619-Title">
<title id="MathJax-SVG-619-Title">
\begin{aligned}
\mathbb{E}[Z]
&amp;= (-2) \cdot P(Z = -2) + (-1) \cdot P(Z = -1) + \ldots + (2) \cdot P(Z = 2) \\
&amp;= (-2) \cdot \frac{2}{16} + (-1) \cdot \frac{3}{16}+ \ldots + (2) \cdot \frac{2}{16} \\
&amp;= 0
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1801)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
</g>
</g>
<g transform="translate(1937,0)">
<g transform="translate(0,1801)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3002" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="3614" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4115" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4866" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="5256" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6257" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7313" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8092" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8592" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9204" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10205" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10594" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="11373" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11873" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="12485" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="12985" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13737" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="14126" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="15128" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="16184" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="16963" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17463" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18075" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="19075" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="20470" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="21471" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="21860" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="22361" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="22973" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="23473" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="24225" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="24614" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="25616" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="26672" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="27172" y="0"></use>
</g>
<g transform="translate(0,-93)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3002" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="3614" y="0"></use>
<g transform="translate(3892,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="5698" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6698" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7088" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="7866" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8367" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="8979" y="0"></use>
<g transform="translate(9257,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="11063" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="12063" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13458" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14459" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="14848" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15349" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="15961" y="0"></use>
<g transform="translate(16239,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1902)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.785ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3782.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-620-Title">
<title id="MathJax-SVG-620-Title"> \mathbb{E}[Z] = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2225" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3282" y="0"></use>
</g>
</svg></span>, we expect that in the long run the difference between the ages of the people in a sample of size 2 will be 0.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Linearity-of-Expectation">Linearity of Expectation<a class="anchor-link" href="#Linearity-of-Expectation">¶</a></h4><p>When working with linear combinations of random variables as we did above, we can often make good use of the <strong>linearity of expectation</strong> instead of tediously calculating each joint probability individually.</p>
<p>The linearity of expectation states that:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.569ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11009 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-621-Title">
<title id="MathJax-SVG-621-Title">
\begin{aligned}
\mathbb{E}[X + Y] &amp;= \mathbb{E}[X] + \mathbb{E}[Y] \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2020" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3021" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3784" y="0"></use>
</g>
</g>
<g transform="translate(4052,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3132" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3633" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4634" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5301" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="5580" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6343" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>From this statement we may also derive:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.512ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6678.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-622-Title">
<title id="MathJax-SVG-622-Title">
\begin{aligned}
\mathbb{E}[cX] &amp;= c\mathbb{E}[X] \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-63" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1379" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2232" y="0"></use>
</g>
</g>
<g transform="translate(2500,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-63" x="1334" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1767" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2435" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2713" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3566" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-623-Title">
<title id="MathJax-SVG-623-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-624-Title">
<title id="MathJax-SVG-624-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are random variables, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.007ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 433.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-625-Title">
<title id="MathJax-SVG-625-Title">c</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-63" x="0" y="0"></use>
</g>
</svg></span> is a constant.</p>
<p>In words, the expectation of a sum of any two random variables is equal to the sum of the expectations of the variables.</p>
<p>In the previous example, we saw that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.373ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4896.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-626-Title">
<title id="MathJax-SVG-626-Title"> Z = X - Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3132" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4133" y="0"></use>
</g>
</svg></span>. Thus,  <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.441ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13967.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-627-Title">
<title id="MathJax-SVG-627-Title"> \mathbb{E}[Z] = \mathbb{E}[X - Y] = \mathbb{E}[X] - \mathbb{E}[Y] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2225" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3282" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="3949" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4228" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5302" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="6303" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7067" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7623" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8679" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9347" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9625" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="10478" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10978" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11979" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12647" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="12925" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="13689" y="0"></use>
</g>
</svg></span>.</p>
<p>Now we can calculate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-628-Title">
<title id="MathJax-SVG-628-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span> and  <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.617ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1988 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-629-Title">
<title id="MathJax-SVG-629-Title"> \mathbb{E}[Y] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1709" y="0"></use>
</g>
</svg></span> separately from each other. Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.935ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9013.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-630-Title">
<title id="MathJax-SVG-630-Title"> \mathbb{E}[X] = \mathbb{E}[Y] = 50.75 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3411" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4078" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4357" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5676" y="0"></use>
<g transform="translate(6733,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.318ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10900.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-631-Title">
<title id="MathJax-SVG-631-Title"> \mathbb{E}[Z] = 50.75 - 50.75 = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2225" y="0"></use>
<g transform="translate(3282,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5784" y="0"></use>
<g transform="translate(6785,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="9343" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="10400" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The linearity of expectation holds even if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-632-Title">
<title id="MathJax-SVG-632-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-633-Title">
<title id="MathJax-SVG-633-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are dependent on each other! As an example, let us again consider the case in which we sample two people from the dataset in the previous section but without replacement. As before, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-634-Title">
<title id="MathJax-SVG-634-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the age of the first person and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-635-Title">
<title id="MathJax-SVG-635-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> as the age of the second, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.373ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4896.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-636-Title">
<title id="MathJax-SVG-636-Title">Z = X - Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-5A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1001" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3132" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4133" y="0"></use>
</g>
</svg></span> where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-637-Title">
<title id="MathJax-SVG-637-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-638-Title">
<title id="MathJax-SVG-638-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are not independent.</p>
<p>From the joint distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-639-Title">
<title id="MathJax-SVG-639-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-640-Title">
<title id="MathJax-SVG-640-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> given in the previous section, we can find <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.524ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1948 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-641-Title">
<title id="MathJax-SVG-641-Title">\mathbb{E}[Z]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.292ex" height="11.509ex" style="vertical-align: -5.171ex;" viewBox="0 -2728.8 29833.9 4955.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-642-Title">
<title id="MathJax-SVG-642-Title">
\begin{aligned}
\mathbb{E}[Z]
&amp;= (-2) \cdot P(Z = -2) + (-1) \cdot P(Z = -1) + \ldots + (2) \cdot P(Z = 2) \\
&amp;= (-2) \cdot \frac{2}{12} + (-1) \cdot \frac{3}{12}+ \ldots + (2) \cdot \frac{2}{12} \\
&amp;= 0
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1790)">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
</g>
</g>
<g transform="translate(1937,0)">
<g transform="translate(0,1790)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3002" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="3614" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="4115" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4866" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="5256" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6257" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7313" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8092" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8592" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9204" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10205" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10594" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="11373" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11873" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="12485" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="12985" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13737" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="14126" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="15128" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="16184" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="16963" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17463" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18075" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="19075" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="20470" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="21471" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="21860" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="22361" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="22973" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="23473" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="24225" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="24614" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="25616" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="26672" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="27172" y="0"></use>
</g>
<g transform="translate(0,-104)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3002" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="3614" y="0"></use>
<g transform="translate(3892,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="5698" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6698" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7088" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="7866" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8367" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="8979" y="0"></use>
<g transform="translate(9257,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="11063" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="12063" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="13458" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14459" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="14848" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15349" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="15961" y="0"></use>
<g transform="translate(16239,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1891)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>A simpler way to compute this expectation is to use the linearity of expectation. Even though <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-643-Title">
<title id="MathJax-SVG-643-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-644-Title">
<title id="MathJax-SVG-644-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> dependent, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.441ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13967.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-645-Title">
<title id="MathJax-SVG-645-Title">\mathbb{E}[Z] = \mathbb{E}[X - Y] = \mathbb{E}[X] - \mathbb{E}[Y]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2225" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3282" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="3949" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4228" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5302" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="6303" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7067" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7623" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8679" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9347" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9625" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="10478" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10978" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11979" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12647" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="12925" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="13689" y="0"></use>
</g>
</svg></span>. Recall from the previous section that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-646-Title">
<title id="MathJax-SVG-646-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-647-Title">
<title id="MathJax-SVG-647-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> have the same PMF even though we are sampling without replacement, which means that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.935ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9013.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-648-Title">
<title id="MathJax-SVG-648-Title">\mathbb{E}[X] = \mathbb{E}[Y] = 50.75</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3411" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4078" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4357" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5676" y="0"></use>
<g transform="translate(6733,0)">
 <use xlink:href="#MJMAIN-35"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
</g>
</svg></span>. Hence as in the first scenario, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.785ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3782.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-649-Title">
<title id="MathJax-SVG-649-Title">\mathbb{E}[Z] = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-5A" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1669" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2225" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3282" y="0"></use>
</g>
</svg></span>.</p>
<p>Note that the linearity of expectation only holds for linear combinations of random variables. For example, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.137ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8239.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-650-Title">
<title id="MathJax-SVG-650-Title"> \mathbb{E}[XY] = \mathbb{E}[X]\mathbb{E}[Y] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2562" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3118" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4174" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4842" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5973" y="0"></use>
 <use xlink:href="#MJAMS-45" x="6251" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6919" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="7197" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7961" y="0"></use>
</g>
</svg></span> is not a linear combination of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-651-Title">
<title id="MathJax-SVG-651-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-652-Title">
<title id="MathJax-SVG-652-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>. In this case, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.137ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8239.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-653-Title">
<title id="MathJax-SVG-653-Title"> \mathbb{E}[XY] = \mathbb{E}[X]\mathbb{E}[Y] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2562" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3118" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4174" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4842" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5973" y="0"></use>
 <use xlink:href="#MJAMS-45" x="6251" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6919" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="7197" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7961" y="0"></use>
</g>
</svg></span> is true in general only for independent random variables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Variance">Variance<a class="anchor-link" href="#Variance">¶</a></h3><p>The variance of a random variable is a numerical description of the spread of a random variable. For a random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-654-Title">
<title id="MathJax-SVG-654-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.057ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 11649.5 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-655-Title">
<title id="MathJax-SVG-655-Title">
\begin{aligned}
Var(X) &amp;= \mathbb{E}[(X - \mathbb{E}[X])^2] \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</g>
<g transform="translate(3371,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7665" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>The above formula states that the variance of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-656-Title">
<title id="MathJax-SVG-656-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> is the average squared distance from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-657-Title">
<title id="MathJax-SVG-657-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>'s expected value.</p>
<p>With some algebraic manipulation that we omit for brevity, we may also equivalently write:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.319ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 11331.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-658-Title">
<title id="MathJax-SVG-658-Title">
\begin{aligned}
Var(X) &amp;= \mathbb{E}[X^2] - \mathbb{E}[X]^2 \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</g>
<g transform="translate(3371,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1215" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3593" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4094" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5095" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5762" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6041" y="0"></use>
<g transform="translate(6893,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Consider the following two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-659-Title">
<title id="MathJax-SVG-659-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-660-Title">
<title id="MathJax-SVG-660-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> with the following probability distributions:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">xk</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">pk</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">pk</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="s1">'ro'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$P(X = x)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{4}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{2}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{3}{4}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$1$'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'PMF of $X$'</span><span class="p">)</span>

<span class="n">xk</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pk</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">rv_discrete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">pk</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="s1">'ro'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">mec</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">xk</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xk</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'$P(Y = y)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">),</span>
           <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{4}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{1}{2}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$\frac</span><span class="si">{3}{4}</span><span class="s1">$'</span><span class="p">,</span> <span class="sa">r</span><span class="s1">'$1$'</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'PMF of $Y$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/prob_exp_var_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-661-Title">
<title id="MathJax-SVG-661-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> takes on values -1 and 1 with probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.658ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 713.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-662-Title">
<title id="MathJax-SVG-662-Title"> \frac{1}{2} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="84" y="-589"></use>
</g>
</g>
</svg></span> each. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-663-Title">
<title id="MathJax-SVG-663-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> takes on values -2, -1, 1, and 2 with probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.658ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 713.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-664-Title">
<title id="MathJax-SVG-664-Title"> \frac{1}{4} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="473" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="84" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="84" y="-600"></use>
</g>
</g>
</svg></span> each. We find that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.801ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7233.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-665-Title">
<title id="MathJax-SVG-665-Title"> \mathbb{E}[X] = \mathbb{E}[Y] = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3411" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4078" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4357" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5676" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="6733" y="0"></use>
</g>
</svg></span>. Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-666-Title">
<title id="MathJax-SVG-666-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span>'s distribution has a higher spread than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-667-Title">
<title id="MathJax-SVG-667-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>'s, we expect that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.648ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3293 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-668-Title">
<title id="MathJax-SVG-668-Title"> Var(Y) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2903" y="0"></use>
</g>
</svg></span> is larger than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.855ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3382 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-669-Title">
<title id="MathJax-SVG-669-Title"> Var(X) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="81.918ex" height="41.509ex" style="vertical-align: -20.171ex;" viewBox="0 -9187.2 35270.3 17872" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-670-Title">
<title id="MathJax-SVG-670-Title">
\begin{aligned}
Var(X)
&amp;= \mathbb{E}[X^2] - \mathbb{E}[X]^2 \\
&amp;= \mathbb{E}[X^2] - 0^2 \\
&amp;= \mathbb{E}[X^2] \\
&amp;= (-1)^2 P(X = -1) + (1)^2 P(X = 1) \\
&amp;= 1 \cdot 0.5 + 1 \cdot 0.5 \\
&amp;= 1 \\\\
Var(Y)
&amp;= \mathbb{E}[Y^2] - \mathbb{E}[Y]^2 \\
&amp;= \mathbb{E}[Y^2] - 0^2 \\
&amp;= \mathbb{E}[Y^2] \\
&amp;= (-2)^2 P(Y = -2) + (-1)^2 P(Y = -1) + (1)^2 P(Y = 1) + (2)^2 P(Y = 2) \\
&amp;= 4 \cdot 0.25 + 1 \cdot 0.25 + 1 \cdot 0.25 + 4 \cdot 0.25\\
&amp;= 2.5
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,8207)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
<g transform="translate(89,-1435)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2903" y="0"></use>
</g>
</g>
<g transform="translate(3371,0)">
<g transform="translate(0,8207)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1215" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3593" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4094" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5095" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5762" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6041" y="0"></use>
<g transform="translate(6893,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
</g>
<g transform="translate(0,6772)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1215" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3593" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4094" y="0"></use>
<g transform="translate(5095,0)">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
</g>
<g transform="translate(0,5336)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1215" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3593" y="0"></use>
</g>
<g transform="translate(0,3900)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2502" y="0"></use>
<g transform="translate(3002,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="3845" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4597" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4986" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6117" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7173" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="7952" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8452" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9064" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10064" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="10454" y="0"></use>
<g transform="translate(10954,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="11798" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12549" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="12939" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14069" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="15125" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15626" y="0"></use>
</g>
<g transform="translate(0,2549)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2056" y="0"></use>
<g transform="translate(2557,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4059" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5059" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="5782" y="0"></use>
<g transform="translate(6283,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
<g transform="translate(0,1249)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1334" y="0"></use>
</g>
<g transform="translate(0,-1435)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1157" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3552" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4052" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5053" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5721" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="5999" y="0"></use>
<g transform="translate(6763,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
</g>
<g transform="translate(0,-2871)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1157" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3552" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4052" y="0"></use>
<g transform="translate(5053,0)">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
</g>
<g transform="translate(0,-4306)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
<g transform="translate(2280,0)">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1157" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3552" y="0"></use>
</g>
<g transform="translate(0,-5742)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2502" y="0"></use>
<g transform="translate(3002,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="3845" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4597" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4986" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6028" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7084" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="7863" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8363" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8975" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9975" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10365" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="11143" y="0"></use>
<g transform="translate(11644,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="12487" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13239" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="13628" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14670" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="15726" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="16504" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17005" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="17617" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="18617" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="19007" y="0"></use>
<g transform="translate(19507,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="20351" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="21102" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="21492" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="22533" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="23589" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="24090" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="24702" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="25702" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="26092" y="0"></use>
<g transform="translate(26592,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="27436" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="28187" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="28577" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="29618" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="30674" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="31175" y="0"></use>
</g>
<g transform="translate(0,-7093)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2056" y="0"></use>
<g transform="translate(2557,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4559" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5560" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="6283" y="0"></use>
<g transform="translate(6783,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8786" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="9786" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="10509" y="0"></use>
<g transform="translate(11010,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="13012" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="14013" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="14735" y="0"></use>
<g transform="translate(15236,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(0,-8393)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, the variance of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-671-Title">
<title id="MathJax-SVG-671-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> is greater than the variance of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-672-Title">
<title id="MathJax-SVG-672-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>The variance has a useful property to simplify some calculations. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-673-Title">
<title id="MathJax-SVG-673-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> is a random variable:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.912ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 11587 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-674-Title">
<title id="MathJax-SVG-674-Title">
\begin{aligned}
Var(aX + b) &amp;= a^2 Var(X)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="2140" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3744" y="0"></use>
 <use xlink:href="#MJMATHI-62" x="4744" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5174" y="0"></use>
</g>
</g>
<g transform="translate(5553,0)">
<g transform="translate(0,-67)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="583"></use>
</g>
 <use xlink:href="#MJMATHI-56" x="2317" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="3086" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="3616" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4067" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4457" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5309" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>If two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-675-Title">
<title id="MathJax-SVG-675-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-676-Title">
<title id="MathJax-SVG-676-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.662ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14924 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-677-Title">
<title id="MathJax-SVG-677-Title">
\begin{aligned}
Var(X + Y) = Var(X) + Var(Y)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3214" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4215" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4978" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5646" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="6702" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="7471" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="8001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8453" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="8842" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9695" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10306" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="11307" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="12076" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="12606" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13057" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="13447" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14210" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Note that the linearity of expectation holds for any <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-678-Title">
<title id="MathJax-SVG-678-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-679-Title">
<title id="MathJax-SVG-679-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> even if they are dependent; <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.911ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14600.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-680-Title">
<title id="MathJax-SVG-680-Title"> Var(X + Y) = Var(X) + Var(Y) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3214" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="4215" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4978" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5646" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="6702" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="7471" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="8001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8453" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="8842" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9695" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10306" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="11307" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="12076" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="12606" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13057" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="13447" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14210" y="0"></use>
</g>
</svg></span> holds only when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-681-Title">
<title id="MathJax-SVG-681-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-682-Title">
<title id="MathJax-SVG-682-Title"> Y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Covariance">Covariance<a class="anchor-link" href="#Covariance">¶</a></h4><p>The covariance of two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-683-Title">
<title id="MathJax-SVG-683-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-684-Title">
<title id="MathJax-SVG-684-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> is defined as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.806ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 17138.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-685-Title">
<title id="MathJax-SVG-685-Title">
\begin{aligned}
Cov(X, Y) &amp;= \mathbb{E}[(X - \mathbb{E}[X])(Y - \mathbb{E}[Y])]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="760" y="0"></use>
 <use xlink:href="#MJMATHI-76" x="1246" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1731" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2121" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2973" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3418" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4182" y="0"></use>
</g>
</g>
<g transform="translate(4561,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6822" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7211" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="7601" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8586" y="0"></use>
 <use xlink:href="#MJAMS-45" x="9587" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="10254" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="10533" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="11296" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11575" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="11964" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Again, we can perform some algebraic manipulation to obtain:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.347ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 14357.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-686-Title">
<title id="MathJax-SVG-686-Title">
\begin{aligned}
Cov(X, Y) = \mathbb{E}[XY] - \mathbb{E}[X]\mathbb{E}[Y]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="760" y="0"></use>
 <use xlink:href="#MJMATHI-76" x="1246" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1731" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2121" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2973" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3418" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4182" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4849" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5905" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6573" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6851" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="7704" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="8467" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8968" y="0"></use>
 <use xlink:href="#MJAMS-45" x="9969" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="10636" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="10915" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="11767" y="0"></use>
 <use xlink:href="#MJAMS-45" x="12046" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12713" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="12992" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="13755" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Note that although the variance of a single random variable must be non-negative, the covariance of two random variables can be negative. In fact, the covariance helps measure the correlation between two random variables; the sign of the covariance helps us determine whether two random variables are positively or negatively correlated. If two random variables <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-687-Title">
<title id="MathJax-SVG-687-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.773ex" height="2.009ex" style="vertical-align: -0.171ex;" viewBox="0 -791.3 763.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-688-Title">
<title id="MathJax-SVG-688-Title">Y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-59" x="0" y="0"></use>
</g>
</svg></span> are independent, then <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.879ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6406.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-689-Title">
<title id="MathJax-SVG-689-Title">Cov(X, Y) = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-6F" x="760" y="0"></use>
 <use xlink:href="#MJMATHI-76" x="1246" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1731" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2121" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2973" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="3418" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4182" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4849" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="5905" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.137ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8239.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-690-Title">
<title id="MathJax-SVG-690-Title">\mathbb{E}[XY] = \mathbb{E}[X]\mathbb{E}[Y]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2562" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3118" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4174" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4842" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5120" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="5973" y="0"></use>
 <use xlink:href="#MJAMS-45" x="6251" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6919" y="0"></use>
 <use xlink:href="#MJMATHI-59" x="7197" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7961" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bernoulli-Random-Variables">Bernoulli Random Variables<a class="anchor-link" href="#Bernoulli-Random-Variables">¶</a></h3><p>Suppose we want to use a random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-691-Title">
<title id="MathJax-SVG-691-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> to a simulate a biased coin with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.506ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6245.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-692-Title">
<title id="MathJax-SVG-692-Title">P(Heads) = p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="2029" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="2496" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="3549" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4018" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4685" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="5742" y="0"></use>
</g>
</svg></span>. We can say that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-693-Title">
<title id="MathJax-SVG-693-Title">X = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2186" y="0"></use>
</g>
</svg></span> if the coin flip is heads, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.241ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2687.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-694-Title">
<title id="MathJax-SVG-694-Title">X = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1130" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2186" y="0"></use>
</g>
</svg></span> if the coin flip is tails. Therefore, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.064ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6055.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-695-Title">
<title id="MathJax-SVG-695-Title">P(X = 1) = p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3828" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4495" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="5551" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.066ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7778.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-696-Title">
<title id="MathJax-SVG-696-Title">P(X = 0) = 1 - p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3828" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4495" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5551" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6274" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="7275" y="0"></use>
</g>
</svg></span>. This type of binary random variable is called a Bernoulli random variable; we can calculate its expected value and variance as follows:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.187ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 13427.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-697-Title">
<title id="MathJax-SVG-697-Title">\mathbb{E}[X] = 1 \times p + 0 \times (1 - p) = p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3411" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="4133" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="5134" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5860" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="6860" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="7583" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8584" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8973" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="9696" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="10697" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11200" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11868" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="12924" y="0"></use>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="75.417ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 32471 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-698-Title">
<title id="MathJax-SVG-698-Title">Var(X) = \mathbb{E}[X^2] - \mathbb{E}[X]^2 = 1^2 \times p + 0^2 \times (1 - p) - p^2 = p - p^2 = p(1 - p)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3659" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4716" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5383" y="0"></use>
<g transform="translate(5662,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1215" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="6975" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7476" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8477" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9144" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9423" y="0"></use>
<g transform="translate(10275,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="11285" y="0"></use>
<g transform="translate(12342,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-D7" x="13518" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="14519" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15245" y="0"></use>
<g transform="translate(16245,0)">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-D7" x="17422" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="18423" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="18812" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="19535" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="20536" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21039" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="21651" y="0"></use>
<g transform="translate(22652,0)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="712" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="23887" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="24943" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="25669" y="0"></use>
<g transform="translate(26670,0)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="712" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="27905" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="28961" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="29465" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="29854" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="30577" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="31577" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="32081" y="0"></use>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sample-Means">Sample Means<a class="anchor-link" href="#Sample-Means">¶</a></h3><p>Suppose we flip a coin with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.506ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6245.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-699-Title">
<title id="MathJax-SVG-699-Title">P(Heads) = p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="2029" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="2496" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="3549" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4018" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4685" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="5742" y="0"></use>
</g>
</svg></span> a total of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-700-Title">
<title id="MathJax-SVG-700-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> times and find the proportion of heads. Let us call this proportion <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-701-Title">
<title id="MathJax-SVG-701-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span>. If we wanted to estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.238ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4408 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-702-Title">
<title id="MathJax-SVG-702-Title">P(Heads)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="1141" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="2029" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="2496" y="0"></use>
 <use xlink:href="#MJMATHI-64" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="3549" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4018" y="0"></use>
</g>
</svg></span>, we might intuitively believe that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-703-Title">
<title id="MathJax-SVG-703-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span> is a good guess. Now, we can use our newly gained knowledge of random variables, expectation, and variance to confirm this intuition.</p>
<p>Note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-704-Title">
<title id="MathJax-SVG-704-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span> itself is a random variable; thus, it must have some underlying distribution. If we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-705-Title">
<title id="MathJax-SVG-705-Title">X_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span> be a Bernoulli random variable for the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.575ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1108.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-706-Title">
<title id="MathJax-SVG-706-Title">i^{th}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
<g transform="translate(345,362)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-68" x="361" y="0"></use>
</g>
</g>
</svg></span> coin flip (note that the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-707-Title">
<title id="MathJax-SVG-707-Title">X_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span>'s are independent since they represent independent coin flips), then we can mathematically determine that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.222ex" height="3.343ex" style="vertical-align: -1.005ex; margin-left: -0.089ex;" viewBox="-38.5 -1006.6 6553.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-708-Title">
<title id="MathJax-SVG-708-Title">\hat{p} = \frac{1}{n} \sum_{i=1}^{n} X_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
 <use xlink:href="#MJMAIN-3D" x="863" y="0"></use>
<g transform="translate(1641,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
<g transform="translate(2870,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
</g>
<g transform="translate(5342,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</g>
</svg></span>. We can then calculate the expected value, variance, and standard deviation of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-709-Title">
<title id="MathJax-SVG-709-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span> as follows:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.956ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 18064.4 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-710-Title">
<title id="MathJax-SVG-710-Title">\mathbb{E}[\frac{1}{n} \sum_{i=1}^{n} X_i] = \frac{1}{n} \sum_{i=1}^{n}\mathbb{E}[X_i] = \frac{1}{n} \times np = p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
<g transform="translate(946,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2073,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(3684,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="4857" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5413" y="0"></use>
<g transform="translate(6191,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(7596,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJAMS-45" x="9208" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9875" y="0"></use>
<g transform="translate(10154,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="11326" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="11883" y="0"></use>
<g transform="translate(12661,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-D7" x="14122" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="15122" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="15723" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="16504" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="17560" y="0"></use>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.926ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 27954.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-711-Title">
<title id="MathJax-SVG-711-Title">Var(\frac{1}{n} \sum_{i=1}^{n} X_i) = \frac{1}{n^2} \sum_{i=1}^{n}Var(X_i) = \frac{1}{n^2} \times np(1-p) = \frac{p(1-p)}{n}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
<g transform="translate(2140,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3267,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(4878,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6051" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6718" y="0"></use>
<g transform="translate(7496,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1174" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="336" y="676"></use>
<g transform="translate(60,-780)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="849" y="408"></use>
</g>
</g>
</g>
<g transform="translate(9355,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMATHI-56" x="10966" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="11736" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="12265" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12717" y="0"></use>
<g transform="translate(13106,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14279" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="14947" y="0"></use>
<g transform="translate(15725,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1174" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="336" y="676"></use>
<g transform="translate(60,-780)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="849" y="408"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-D7" x="17639" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="18640" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="19241" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="19744" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="20134" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="20856" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="21857" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="22361" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="23028" y="0"></use>
<g transform="translate(23806,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="3629" height="60" x="0" y="220"></rect>
<g transform="translate(60,770)">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="503" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="893" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1615" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3119" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-6E" x="1514" y="-686"></use>
</g>
</g>
</g>
</svg></span><p>The expected value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-712-Title">
<title id="MathJax-SVG-712-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span>, the sample proportion, is the same as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-713-Title">
<title id="MathJax-SVG-713-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>, the true proportion! Furthermore, the variance of the sample proportion gives us a measure of how much error we should expect if we use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-714-Title">
<title id="MathJax-SVG-714-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span> to estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-715-Title">
<title id="MathJax-SVG-715-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>. As we increase the sample size <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-716-Title">
<title id="MathJax-SVG-716-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span>, the variance of our estimator decreases by a factor of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.822ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 784.6 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-717-Title">
<title id="MathJax-SVG-717-Title">\frac{1}{n}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.449ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -791.3 623.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-718-Title">
<title id="MathJax-SVG-718-Title">\hat{p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="84" y="21"></use>
</g>
</svg></span> converges to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-719-Title">
<title id="MathJax-SVG-719-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>. This fact is known as the law of large numbers.</p>
<p>Since this sample proportion converges to the true proportion as the sample size becomes large, the sample proportion is considered an <em>unbiased estimator</em> for the true proportion. Some estimators are biased—the sample maximum, for example, meaning that the expected value for these estimators is not the true value.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">��</a></h2><p>Expectation and variance are simple descriptions of a random variable's center and spread. We use the versatility of random variables to describe data generation and modeling.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/12'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Expected-Loss">Expected Loss<a class="anchor-link" href="#Expected-Loss">¶</a></h2><p>Let us return to our discussion of the constant model with the example of tip percentages from the previous chapters. Suppose we only have data from a simple random sample of tips for all waiters at a particular restaurant in a 3-month period, and we want to predict a single tip percentage for all tips from this restaurant. To generalize a model on our 3-month sample to a model on the entire tip history of the restaurant, we must assume that tipping at this restaurant is the same year-round. Since we only have access to data from the sample, we can find the model that empirically minimizes the loss for the sample data with the mean absolute, mean squared, and Huber loss functions. However, if we want to generalize our model, we would need another loss function that does not specifically depend on which data points appear in our sample. The <em>expected loss</em> is an example of such a loss function that allows us to analyze the relationship between our sample and the population.</p>
<h2 id="Definition">Definition<a class="anchor-link" href="#Definition">¶</a></h2><p>We define the population as all tip percentages that have ever been observed at a restaurant, and we define the random variable <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-720-Title">
<title id="MathJax-SVG-720-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as the percentage tipped for a table in the population. As before, we use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-721-Title">
<title id="MathJax-SVG-721-Title"> \theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> to represent our model for the universal tip percentage in the population. Using the quadratic loss as an example, we obtain the following loss function for the expected squared loss:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.895ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 8135.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-722-Title">
<title id="MathJax-SVG-722-Title"> f(\theta) =  \mathbb{E}[(X - \theta)^2] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="550" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="940" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1409" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2076" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3133" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="3800" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4079" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4468" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5543" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="6544" y="0"></use>
<g transform="translate(7013,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7856" y="0"></use>
</g>
</svg></span><h2 id="Minimizing-the-Expected-Squared-Loss">Minimizing the Expected Squared Loss<a class="anchor-link" href="#Minimizing-the-Expected-Squared-Loss">¶</a></h2><p>Note that the expected squared loss is a function of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-723-Title">
<title id="MathJax-SVG-723-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-724-Title">
<title id="MathJax-SVG-724-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is a model parameter that we get to choose. We can rewrite <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.911ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 2544.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-725-Title">
<title id="MathJax-SVG-725-Title">X - \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1074" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2075" y="0"></use>
</g>
</svg></span> as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.24ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9144.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-726-Title">
<title id="MathJax-SVG-726-Title">X - \mathbb{E}[X] + \mathbb{E}[X] - \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1074" y="0"></use>
 <use xlink:href="#MJAMS-45" x="2075" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2742" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="3021" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3873" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4374" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5375" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6042" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6321" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7173" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7674" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="8675" y="0"></use>
</g>
</svg></span> and simplify using the linearity of expectation to find the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-727-Title">
<title id="MathJax-SVG-727-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes the expected squared loss.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="69.548ex" height="31.509ex" style="vertical-align: -15.171ex;" viewBox="0 -7034.4 29944.1 13566.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-728-Title">
<title id="MathJax-SVG-728-Title"> \begin{aligned}
f(\theta) &amp;=  \mathbb{E}[(X - \theta)^2] \\\\
&amp;= \mathbb{E}[(X - \mathbb{E}[X] + \mathbb{E}[X] - \theta)^2] \\\\
&amp;= \mathbb{E}[(X - \mathbb{E}[X])^2 + 2(X - \mathbb{E}[X])(\mathbb{E}[X] - \theta) + (\mathbb{E}[X]- \theta)^2] \\\\
&amp;= \mathbb{E}[(X - \mathbb{E}[X])^2] + \mathbb{E}[2(X - \mathbb{E}[X])(\mathbb{E}[X] - \theta)] + \mathbb{E}[(\mathbb{E}[X]- \theta)^2] \\\\
&amp;= \mathbb{E}[(X - \mathbb{E}[X])^2] + 2(\mathbb{E}[X] - \theta)\mathbb{E}[X - \mathbb{E}[X]] + (\mathbb{E}[X]- \theta)^2 \\\\
\end{aligned} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,6054)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="550" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="940" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1409" y="0"></use>
</g>
</g>
<g transform="translate(1788,0)">
<g transform="translate(0,6054)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="4745" y="0"></use>
<g transform="translate(5214,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="6057" y="0"></use>
</g>
<g transform="translate(0,3318)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7044" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8044" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8712" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="8990" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="9843" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10344" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="11344" y="0"></use>
<g transform="translate(11814,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12657" y="0"></use>
</g>
<g transform="translate(0,583)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="7887" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8888" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9388" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9778" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10853" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11853" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12521" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="12799" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="13652" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13930" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="14320" y="0"></use>
 <use xlink:href="#MJAMS-45" x="14709" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="15377" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="15655" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="16508" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="17009" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="18009" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18479" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="19090" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="20091" y="0"></use>
 <use xlink:href="#MJAMS-45" x="20481" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="21148" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="21427" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="22279" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="22780" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="23781" y="0"></use>
<g transform="translate(24250,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="25094" y="0"></use>
</g>
<g transform="translate(0,-2153)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7665" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8166" y="0"></use>
 <use xlink:href="#MJAMS-45" x="9166" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9834" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="10112" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10613" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="11002" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="12077" y="0"></use>
 <use xlink:href="#MJAMS-45" x="13078" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="13745" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="14024" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="14876" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15155" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="15544" y="0"></use>
 <use xlink:href="#MJAMS-45" x="15934" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="16601" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="16880" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="17732" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="18233" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="19234" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="19703" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="20093" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="20593" y="0"></use>
 <use xlink:href="#MJAMS-45" x="21594" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="22262" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="22540" y="0"></use>
 <use xlink:href="#MJAMS-45" x="22930" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="23597" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="23876" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="24728" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="25229" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="26230" y="0"></use>
<g transform="translate(26699,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="27543" y="0"></use>
</g>
<g transform="translate(0,-4888)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2280" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2669" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3744" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4745" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5412" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="5691" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6543" y="0"></use>
<g transform="translate(6822,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7665" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8166" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="9166" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9667" y="0"></use>
 <use xlink:href="#MJAMS-45" x="10056" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="10724" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="11002" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="11855" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="12356" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="13356" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13826" y="0"></use>
 <use xlink:href="#MJAMS-45" x="14215" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="14883" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="15161" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="16236" y="0"></use>
 <use xlink:href="#MJAMS-45" x="17237" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="17904" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="18183" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="19035" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="19314" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="19814" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="20815" y="0"></use>
 <use xlink:href="#MJAMS-45" x="21205" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="21872" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="22151" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="23003" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="23504" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="24505" y="0"></use>
<g transform="translate(24974,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>The second term in this expression simplifies to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.024ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11204.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-729-Title">
<title id="MathJax-SVG-729-Title"> 2(\mathbb{E}[X] - \theta)(\mathbb{E}[X] - \mathbb{E}[X]) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="500" y="0"></use>
 <use xlink:href="#MJAMS-45" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1557" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1836" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2688" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3189" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="4189" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4659" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5048" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5438" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6105" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6384" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7236" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7737" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8738" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9405" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9684" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="10536" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10815" y="0"></use>
</g>
</svg></span>, which is simply <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-730-Title">
<title id="MathJax-SVG-730-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>. Thus, we are left with:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.088ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 15968.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-731-Title">
<title id="MathJax-SVG-731-Title"> f(\theta) = \mathbb{E}[(X - \mathbb{E}[X])^2] + (\mathbb{E}[X]- \theta)^2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="550" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="940" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1409" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2076" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3133" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="3800" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4079" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="4468" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5543" y="0"></use>
 <use xlink:href="#MJAMS-45" x="6544" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="7211" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="7490" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="8342" y="0"></use>
<g transform="translate(8621,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="9464" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9965" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10965" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11355" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12022" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="12301" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="13153" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="13654" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="14655" y="0"></use>
<g transform="translate(15124,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</svg></span><p>Note that the first term of the expression does not depend on <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-732-Title">
<title id="MathJax-SVG-732-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>, so we only need to find the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-733-Title">
<title id="MathJax-SVG-733-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes the second term to minimize the entire expression. Since the second term is a quadratic, we know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.278ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 3994.9 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-734-Title">
<title id="MathJax-SVG-734-Title"> \hat{\theta} = \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1917" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2585" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2863" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3716" y="0"></use>
</g>
</svg></span> minimizes the term and hence the entire expression. If we plug in this value back into the original loss function, we get:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.362ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 11350.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-735-Title">
<title id="MathJax-SVG-735-Title"> f(\mathbb{E}[X]) = \mathbb{E}[(X - \mathbb{E}[X])^2] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="550" y="0"></use>
 <use xlink:href="#MJAMS-45" x="940" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1607" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1886" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="2738" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3017" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3684" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4740" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5408" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5686" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="6076" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7150" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8151" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8819" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="9097" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="9950" y="0"></use>
<g transform="translate(10228,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="11071" y="0"></use>
</g>
</svg></span><p>Notice that this is simply the definition of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.855ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3382 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-736-Title">
<title id="MathJax-SVG-736-Title"> Var(X) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</svg></span>, which means that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.855ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3382 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-737-Title">
<title id="MathJax-SVG-737-Title"> Var(X) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</svg></span> is the minimized error of the expected squared loss. Consequently,
if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.116ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5216.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-738-Title">
<title id="MathJax-SVG-738-Title"> Var(X) = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3659" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="4716" y="0"></use>
</g>
</svg></span>, there is no spread in the population, so <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.278ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 3994.9 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-739-Title">
<title id="MathJax-SVG-739-Title"> \hat{\theta} = \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1917" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2585" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2863" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3716" y="0"></use>
</g>
</svg></span> perfectly predicts every point in the population with no error. On the other hand, if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.855ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3382 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-740-Title">
<title id="MathJax-SVG-740-Title"> Var(X) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="769" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="1299" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1750" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2992" y="0"></use>
</g>
</svg></span> is high, many data points in the population will be far away from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-741-Title">
<title id="MathJax-SVG-741-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span>, resulting in a large error.</p>
<h2 id="Comparison-with-MSE">Comparison with MSE<a class="anchor-link" href="#Comparison-with-MSE">¶</a></h2><p>Ideally, we would like to set <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.278ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 3994.9 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-742-Title">
<title id="MathJax-SVG-742-Title"> \hat{\theta} = \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1917" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2585" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2863" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3716" y="0"></use>
</g>
</svg></span>, but we must be able to calculate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-743-Title">
<title id="MathJax-SVG-743-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span> to do this. If we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-744-Title">
<title id="MathJax-SVG-744-Title"> \mathbb{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-58" x="0" y="0"></use>
</g>
</svg></span> be the set of all possible tip percentages in the population, then we can use the definition of the expected value to expand <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-745-Title">
<title id="MathJax-SVG-745-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.636ex" height="5.676ex" style="vertical-align: -3.171ex;" viewBox="0 -1078.4 10607.2 2443.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-746-Title">
<title id="MathJax-SVG-746-Title"> \mathbb{E}[X] = \sum_{x \in \mathbb{X}} x \cdot P(X = x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2354" y="0"></use>
<g transform="translate(3411,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(28,-1102)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="572" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJAMS-58" x="1240" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-78" x="5022" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="5816" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6317" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7069" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="7458" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8588" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="9645" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10217" y="0"></use>
</g>
</svg></span><p>Unfortunately, we cannot find <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.963ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4289.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-747-Title">
<title id="MathJax-SVG-747-Title"> P(X = x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2271" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3327" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3900" y="0"></use>
</g>
</svg></span>, the probability that a specific tip percentage appears in the population, because we do not have access to data from the population. Since the empirical distribution of a simple random sample from the population will resemble the distribution of the population, we can pretend that our sample is the population. This allows us to estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-748-Title">
<title id="MathJax-SVG-748-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span> with the mean of our sample since each point appears in our sample with probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.822ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 784.6 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-749-Title">
<title id="MathJax-SVG-749-Title"> \frac{1}{n} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
</svg></span> if our sample has size <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-750-Title">
<title id="MathJax-SVG-750-Title"> n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.412ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 7066.2 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-751-Title">
<title id="MathJax-SVG-751-Title">
\mathbb{E}[X] \approx \frac{1}{n} \sum_{i=1}^n x_i
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
 <use xlink:href="#MJMAIN-2248" x="2354" y="0"></use>
<g transform="translate(3133,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(4538,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(6149,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</svg></span><p>If we have data from a sample, we can always minimize the mean squared loss of a constant model on the sample by setting <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-752-Title">
<title id="MathJax-SVG-752-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> equal to the mean of the dataset. However, if we want to generalize our model to new points in the population, our sample must be a large random sample from the population so that the mean of the sample is a good estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.824ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2077 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-753-Title">
<title id="MathJax-SVG-753-Title"> \mathbb{E}[X] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1798" y="0"></use>
</g>
</svg></span> for the population. Thus, a model that minimizes the squared loss on a large random sample will also have an error that is close to the minimal squared loss of the population.</p>
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this section, we introduced the expected loss as an example of a loss function that helps us generalize from a sample to the population. Often, we only have access to data from a large random sample, so using loss functions such as the MSE gives us a good approximation of the expected loss for the population.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Linear-Models">Linear Models<a class="anchor-link" href="#Linear-Models">¶</a></h1><p>Now that we have a general method for fitting a model to a cost function, we
turn our attention to improvements on our model. For the sake of simplicity, we
previously restricted ourselves to a constant model: our model only ever
predicts a single number.</p>
<p>However, giving our waiter such a model would hardly satisfy him. He would
likely point out that he collected much more information about his tables than
simply the tip percents. Why didn't we use his other data—e.g. size of the
table or total bill—in order to make our model more useful?</p>
<p>In this chapter we will introduce linear models which will allow us to make use
of our entire dataset to make predictions. Linear models are not only widely
used in practice but also have rich theoretical underpinnings that will allow
us to understand future tools for modeling. We introduce a simple linear regression model that uses one explanatory variable, explain how gradient descent is used to fit the model, and finally extend the model to incorporate multiple explanatory variables.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predicting-Tip-Amounts">Predicting Tip Amounts<a class="anchor-link" href="#Predicting-Tip-Amounts">¶</a></h2><p>Previously, we worked with a dataset that contained one row for each table that a waiter served in a week. Our waiter collected this data in order to predict the tip amount he could expect to receive from a future table.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
<span class="n">tips</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>total_bill</th>
<th>tip</th>
<th>sex</th>
<th>smoker</th>
<th>day</th>
<th>time</th>
<th>size</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>16.99</td>
<td>1.01</td>
<td>Female</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>2</td>
</tr>
<tr>
<th>1</th>
<td>10.34</td>
<td>1.66</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
</tr>
<tr>
<th>2</th>
<td>21.01</td>
<td>3.50</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>23.68</td>
<td>3.31</td>
<td>Male</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>2</td>
</tr>
<tr>
<th>4</th>
<td>24.59</td>
<td>3.61</td>
<td>Female</td>
<td>No</td>
<td>Sun</td>
<td>Dinner</td>
<td>4</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_tips_4_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we have covered previously, if we choose a constant model and the mean squared error cost, our model will predict the mean of the tip amount:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s1">'tip'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>2.9982786885245902</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This means that if a new party orders a meal and the waiter asks us how much tip he will likely receive, we will say "around <span>$</span>3", no matter how large the table is or how much their total bill was.</p>
<p>However, looking at other variables in the dataset, we see that we might be able to make more accurate predictions if we incorporate them into our model. For example, the following plot of the tip amount against the total bill shows a positive association.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'total_bill'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'tip'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Tip amount vs. Total Bill'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Total Bill'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Tip Amount'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_tips_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the average tip amount is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1001 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-754-Title">
<title id="MathJax-SVG-754-Title">\$3</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</svg></span>, if a table orders <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1501.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-755-Title">
<title id="MathJax-SVG-755-Title">\$40</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span> worth of food we would certainly expect that the waiter receives more than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.325ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1001 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-756-Title">
<title id="MathJax-SVG-756-Title">\$3</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</svg></span> of tip. Thus, we would like to alter our model so that it makes predictions based on the variables in our dataset instead of blindly predicting the mean tip amount. To do this, we use a linear model instead of constant one.</p>
<p>Let's briefly review our current toolbox for modeling and estimation and define some new notation so that we can better represent the additional complexity that linear models have.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Defining-a-Simple-Linear-Model">Defining a Simple Linear Model<a class="anchor-link" href="#Defining-a-Simple-Linear-Model">¶</a></h2><p>We are interested in predicting the tip amount based on the total bill of a table. Let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-757-Title">
<title id="MathJax-SVG-757-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> represent the tip amount, the variable we are trying to predict. Let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-758-Title">
<title id="MathJax-SVG-758-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> represent the total bill, the variable we are incorporating for prediction.</p>
<p>We define a linear model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.375ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1022.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-759-Title">
<title id="MathJax-SVG-759-Title"> f_\boldsymbol\theta^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="804" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-471"></use>
</g>
</svg></span> that depends on <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-760-Title">
<title id="MathJax-SVG-760-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.072ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 7350.3 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-761-Title">
<title id="MathJax-SVG-761-Title">
f_\boldsymbol\theta^* (x) = \theta_1^* x + \theta_0^*
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="804" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-471"></use>
 <use xlink:href="#MJMAIN-28" x="1022" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1411" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1984" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2651" y="0"></use>
<g transform="translate(3708,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-435"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="4631" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5426" y="0"></use>
<g transform="translate(6426,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-435"></use>
</g>
</g>
</svg></span><p>We treat <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.514ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 2374 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-762-Title">
<title id="MathJax-SVG-762-Title"> f_\boldsymbol\theta^* (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="804" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-471"></use>
 <use xlink:href="#MJMAIN-28" x="1022" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1411" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1984" y="0"></use>
</g>
</svg></span> as the underlying function that generated the data.</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.514ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 2374 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-763-Title">
<title id="MathJax-SVG-763-Title"> f_\boldsymbol\theta^* (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="804" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-471"></use>
 <use xlink:href="#MJMAIN-28" x="1022" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1411" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1984" y="0"></use>
</g>
</svg></span> assumes that in truth, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-764-Title">
<title id="MathJax-SVG-764-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> has a perfectly linear relationship with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-765-Title">
<title id="MathJax-SVG-765-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span>. However, our observed data do not follow a perfectly straight line because of some random noise <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.944ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 406.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-766-Title">
<title id="MathJax-SVG-766-Title"> \epsilon </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
</g>
</svg></span>. Mathematically, we account for this by adding a noise term:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.552ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 5835 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-767-Title">
<title id="MathJax-SVG-767-Title">
y = f_\boldsymbol\theta^* (x) + \epsilon
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
<g transform="translate(1831,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="804" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-471"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2854" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3243" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3816" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4427" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="5428" y="0"></use>
</g>
</svg></span><p>If the assumption that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-768-Title">
<title id="MathJax-SVG-768-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> has a perfectly linear relationship with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-769-Title">
<title id="MathJax-SVG-769-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> holds, and we are able to somehow find the exact values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-770-Title">
<title id="MathJax-SVG-770-Title"> \theta_1^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-435"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-771-Title">
<title id="MathJax-SVG-771-Title"> \theta_0^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-435"></use>
</g>
</svg></span>, and we magically have no random noise, we will be able to perfectly predict the amount of tip the waiter will get for all tables, forever. Of course, we cannot completely fulfill any of these criteria in practice. Instead, we will estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-772-Title">
<title id="MathJax-SVG-772-Title"> \theta_1^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-435"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-773-Title">
<title id="MathJax-SVG-773-Title"> \theta_0^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-435"></use>
</g>
</svg></span> using our dataset to make our predictions as accurate as possible.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Estimating-the-Linear-Model">Estimating the Linear Model<a class="anchor-link" href="#Estimating-the-Linear-Model">¶</a></h3><p>Since we cannot find <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-774-Title">
<title id="MathJax-SVG-774-Title"> \theta_1^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-435"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 923.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-775-Title">
<title id="MathJax-SVG-775-Title"> \theta_0^* </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-435"></use>
</g>
</svg></span> exactly, we will assume that our dataset approximates our population and use our dataset to estimate these parameters. We denote our estimations with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-776-Title">
<title id="MathJax-SVG-776-Title">\theta_1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-777-Title">
<title id="MathJax-SVG-777-Title">\theta_0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span>, our fitted estimations with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-778-Title">
<title id="MathJax-SVG-778-Title"> \hat{\theta_1} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-779-Title">
<title id="MathJax-SVG-779-Title"> \hat{\theta_0} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span>, and our model as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.992ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7316.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-780-Title">
<title id="MathJax-SVG-780-Title">
f_\boldsymbol\theta (x) = \theta_1 x + \theta_0
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1950" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2617" y="0"></use>
<g transform="translate(3673,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="4597" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5391" y="0"></use>
<g transform="translate(6392,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</g>
</svg></span><p>Sometimes you will see <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.478ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1928 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-781-Title">
<title id="MathJax-SVG-781-Title"> h(x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-68" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="576" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="966" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1538" y="0"></use>
</g>
</svg></span> written instead of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.606ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2413.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-782-Title">
<title id="MathJax-SVG-782-Title"> f_\hat{\boldsymbol\theta} (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2024" y="0"></use>
</g>
</svg></span>; the "<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.339ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 576.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-783-Title">
<title id="MathJax-SVG-783-Title"> h </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-68" x="0" y="0"></use>
</g>
</svg></span>" stands for hypothesis, as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.606ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2413.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-784-Title">
<title id="MathJax-SVG-784-Title"> f_\hat{\boldsymbol\theta} (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2024" y="0"></use>
</g>
</svg></span> is our hypothesis of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.266ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2697.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-785-Title">
<title id="MathJax-SVG-785-Title"> f_{\boldsymbol\theta^*} (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-199)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-2217" x="692" y="479"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1346" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1735" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2308" y="0"></use>
</g>
</svg></span>.</p>
<p>In order to determine <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-786-Title">
<title id="MathJax-SVG-786-Title"> \hat{\theta_1} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-787-Title">
<title id="MathJax-SVG-787-Title"> \hat{\theta_0} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span>, we choose a cost function and minimize it using gradient descent.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s1">'tips'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">,</span>
             <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Uses gradient descent to minimize loss_fn. Returns the minimizing value of</span>
<span class="sd">    theta once the loss changes less than 0.0001 between iterations.</span>
<span class="sd">    '''</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">progress</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'theta: </span><span class="si">{theta}</span><span class="s1"> | loss: </span><span class="si">{loss}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">gradient</span> <span class="o">=</span> <span class="n">grad_loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
        <span class="n">new_theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">gradient</span>
        <span class="n">new_loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">new_theta</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_loss</span> <span class="o">-</span> <span class="n">loss</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">new_theta</span>
        
        <span class="n">theta</span> <span class="o">=</span> <span class="n">new_theta</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">new_loss</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-a-Linear-Model-Using-Gradient-Descent">Fitting a Linear Model Using Gradient Descent<a class="anchor-link" href="#Fitting-a-Linear-Model-Using-Gradient-Descent">¶</a></h2><p>We want to fit a linear model that predicts the tip amount based on the total bill of the table:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.992ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7316.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-788-Title">
<title id="MathJax-SVG-788-Title">
f_\boldsymbol\theta (x) = \theta_1 x + \theta_0
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1950" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2617" y="0"></use>
<g transform="translate(3673,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="4597" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5391" y="0"></use>
<g transform="translate(6392,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</g>
</svg></span><p>In order to optimize <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-789-Title">
<title id="MathJax-SVG-789-Title"> \theta_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-790-Title">
<title id="MathJax-SVG-790-Title"> \theta_0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span>, we need to first choose a loss function. We will choose the mean squared error loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.288ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 14332.3 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-791-Title">
<title id="MathJax-SVG-791-Title">
\begin{aligned}
L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&amp;= \frac{1}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
</g>
</g>
<g transform="translate(4117,0)">
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7341" y="0"></use>
<g transform="translate(7730,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8647" y="0"></use>
<g transform="translate(9037,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Note that we have modified our loss function to reflect the addition of an explanatory variable in our new model. Now, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-792-Title">
<title id="MathJax-SVG-792-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> is a vector containing the individual total bills, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-793-Title">
<title id="MathJax-SVG-793-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> is a vector containing the individual tip amounts, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-794-Title">
<title id="MathJax-SVG-794-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> is a vector: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.022ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4745.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-795-Title">
<title id="MathJax-SVG-795-Title"> \boldsymbol\theta = [ \theta_1, \theta_0 ] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="840" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1896" y="0"></use>
<g transform="translate(2175,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3098" y="0"></use>
<g transform="translate(3543,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="4467" y="0"></use>
</g>
</svg></span>.</p>
<p>Using a linear model with the squared error also goes by the name of least-squares linear regression. We can use gradient descent to find the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-796-Title">
<title id="MathJax-SVG-796-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> that minimizes the loss.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>An Aside on Using Correlation</strong></p>
<p>If you have seen least-squares linear regression before, you may recognize that we can compute the correlation coefficient and use it to determine <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-797-Title">
<title id="MathJax-SVG-797-Title"> \theta_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-798-Title">
<title id="MathJax-SVG-798-Title"> \theta_0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span>. This is simpler and faster to compute than using gradient descent for this specific problem, similar to how computing the mean was simpler than using gradient descent to fit a constant model. We will use gradient descent anyway because it is a general-purpose method of loss minimization that still works when we later introduce models that do not have analytic solutions. In fact, in many real-world scenarios, we will use gradient descent even when an analytic solution exists because computing the analytic solution can take longer than gradient descent, especially on large datasets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Derivative-of-the-MSE-Loss">Derivative of the MSE Loss<a class="anchor-link" href="#Derivative-of-the-MSE-Loss">¶</a></h2><p>In order to use gradient descent, we have to compute the derivative of the MSE loss with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-799-Title">
<title id="MathJax-SVG-799-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span>. Now that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-800-Title">
<title id="MathJax-SVG-800-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> is a vector of length 2 instead of a scalar, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.68ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5459.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-801-Title">
<title id="MathJax-SVG-801-Title"> \nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{x}, \textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4017" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4462" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5070" y="0"></use>
</g>
</svg></span> will also be a vector of length 2.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.819ex" height="21.843ex" style="vertical-align: -10.338ex;" viewBox="0 -4953.4 21449.6 9404.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-802-Title">
<title id="MathJax-SVG-802-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&amp;= \nabla_{\boldsymbol\theta} \left[ \frac{1}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2 \right] \\
&amp;= \frac{1}{n} \sum_{i = 1}^{n}2 (y_i - f_\boldsymbol\theta (x_i))(- \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
&amp;= -\frac{2}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3062)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4017" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4462" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5070" y="0"></use>
</g>
</g>
<g transform="translate(5449,0)">
<g transform="translate(0,3062)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(2831,0)">
 <use xlink:href="#MJSZ4-5B"></use>
<g transform="translate(583,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(1710,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3155" y="0"></use>
<g transform="translate(3544,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4601" y="0"></use>
<g transform="translate(5602,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6590" y="0"></use>
<g transform="translate(6980,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7896" y="0"></use>
<g transform="translate(8286,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJSZ4-5D" x="9129" y="-1"></use>
</g>
</g>
<g transform="translate(0,-53)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-32" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4572" y="0"></use>
<g transform="translate(4962,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6019" y="0"></use>
<g transform="translate(7020,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8008" y="0"></use>
<g transform="translate(8397,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9314" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9704" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10093" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10483" y="0"></use>
<g transform="translate(11261,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(12592,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="13581" y="0"></use>
<g transform="translate(13970,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14887" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15276" y="0"></use>
</g>
<g transform="translate(0,-3116)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
<g transform="translate(7131,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8119" y="0"></use>
<g transform="translate(8509,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9426" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9815" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10205" y="0"></use>
<g transform="translate(10594,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(11925,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12914" y="0"></use>
<g transform="translate(13303,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14220" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14609" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.992ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7316.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-803-Title">
<title id="MathJax-SVG-803-Title">
f_\boldsymbol\theta (x) = \theta_1 x + \theta_0
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1950" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2617" y="0"></use>
<g transform="translate(3673,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="4597" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5391" y="0"></use>
<g transform="translate(6392,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</g>
</svg></span><p>We now need to compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.326ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4015.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-804-Title">
<title id="MathJax-SVG-804-Title"> \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2319" y="0"></use>
<g transform="translate(2708,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3625" y="0"></use>
</g>
</svg></span> which is a length 2 vector.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.952ex" height="23.843ex" style="vertical-align: -11.338ex;" viewBox="0 -5383.9 13326.3 10265.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-805-Title">
<title id="MathJax-SVG-805-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i)
&amp;= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} f_\boldsymbol\theta (x_i)\\
     \frac{\partial}{\partial \theta_1} f_\boldsymbol\theta (x_i)
   \end{bmatrix} \\
&amp;= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} [\theta_1 x_i + \theta_0]\\
     \frac{\partial}{\partial \theta_1} [\theta_1 x_i + \theta_0]
   \end{bmatrix} \\
&amp;= \begin{bmatrix}
     1 \\
     x_i
   \end{bmatrix} \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3264)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2319" y="0"></use>
<g transform="translate(2708,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3625" y="0"></use>
</g>
</g>
<g transform="translate(4004,0)">
<g transform="translate(0,3264)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,2014)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-2884"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1047)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-30" x="578" y="-243"></use>
</g>
</g>
</g>
<g transform="translate(1451,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2439" y="0"></use>
<g transform="translate(2829,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3745" y="0"></use>
</g>
<g transform="translate(0,-924)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-31" x="578" y="-243"></use>
</g>
</g>
</g>
<g transform="translate(1451,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2439" y="0"></use>
<g transform="translate(2829,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3745" y="0"></use>
</g>
</g>
</g>
<g transform="translate(5126,2014)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-2884"></use>
</g>
</g>
</g>
<g transform="translate(0,-564)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,2014)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-2884"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1047)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-30" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5B" x="1451" y="0"></use>
<g transform="translate(1729,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(2653,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3792" y="0"></use>
<g transform="translate(4792,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="5716" y="0"></use>
</g>
<g transform="translate(0,-924)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-31" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5B" x="1451" y="0"></use>
<g transform="translate(1729,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(2653,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3792" y="0"></use>
<g transform="translate(4792,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="5716" y="0"></use>
</g>
</g>
</g>
<g transform="translate(6985,2014)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-2884"></use>
</g>
</g>
</g>
<g transform="translate(0,-3829)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="208" y="650"></use>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1768" y="-1"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we plug back into our formula above to get</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.053ex" height="21.176ex" style="vertical-align: -9.741ex; margin-bottom: -0.263ex;" viewBox="0 -4809.9 20689.5 9117.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-806-Title">
<title id="MathJax-SVG-806-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\theta, \textbf{x}, \textbf{y})
&amp;= -\frac{2}{n} \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (x_i))\\
&amp;= -\frac{2}{n} \sum_{i = 1}^{n} (y_i - f_\boldsymbol\theta (x_i)) \begin{bmatrix} 1 \\ x_i \end{bmatrix} \\
&amp;= -\frac{2}{n} \sum_{i = 1}^{n} \begin{bmatrix}
    (y_i - f_\boldsymbol\theta (x_i)) \\
    (y_i - f_\boldsymbol\theta (x_i)) x_i
    \end{bmatrix} \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2871" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3316" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3924" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4369" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4977" y="0"></use>
</g>
</g>
<g transform="translate(5356,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
<g transform="translate(7131,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8119" y="0"></use>
<g transform="translate(8509,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9426" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9815" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10205" y="0"></use>
<g transform="translate(10594,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(11925,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12914" y="0"></use>
<g transform="translate(13303,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14220" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14609" y="0"></use>
</g>
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
<g transform="translate(7131,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8119" y="0"></use>
<g transform="translate(8509,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9426" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9815" y="0"></use>
<g transform="translate(10371,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="208" y="650"></use>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1768" y="-1"></use>
</g>
</g>
<g transform="translate(0,-2997)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(4850,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(458,701)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3435" y="0"></use>
<g transform="translate(3824,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4741" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5131" y="0"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3435" y="0"></use>
<g transform="translate(3824,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4741" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5131" y="0"></use>
<g transform="translate(5520,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="7289" y="-1"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>This is a length 2 vector since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.823ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5520.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-807-Title">
<title id="MathJax-SVG-807-Title"> (y_i - f_\boldsymbol\theta (x_i)) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3435" y="0"></use>
<g transform="translate(3824,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4741" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5131" y="0"></use>
</g>
</svg></span> is scalar.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Running-Gradient-Descent">Running Gradient Descent<a class="anchor-link" href="#Running-Gradient-Descent">¶</a></h2><p>Now, let's fit a linear model on the tips dataset to predict the tip amount from the total table bill.</p>
<p>First, we define a Python function to compute the loss:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">simple_linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">):</span>
    <span class="sd">'''Returns predictions by a linear model on x_vals.'''</span>
    <span class="k">return</span> <span class="n">thetas</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">thetas</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">x_vals</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">simple_linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we define a function to compute the gradient of the loss:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">grad_mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_vals</span><span class="p">)</span>
    <span class="n">grad_0</span> <span class="o">=</span> <span class="n">y_vals</span> <span class="o">-</span> <span class="n">simple_linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">)</span>
    <span class="n">grad_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">y_vals</span> <span class="o">-</span> <span class="n">simple_linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">))</span> <span class="o">*</span> <span class="n">x_vals</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grad_0</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">grad_1</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">y_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">grad_mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">),</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the previously defined <code>minimize</code> function that runs gradient descent, accounting for our new explanatory variable. It has the function signature (body omitted):</p>
<div class="highlight"><pre><span></span><span class="n">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">,</span> <span class="n">y_vals</span><span class="p">)</span>
</pre></div>
<p>Finally, we run gradient descent!</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

thetas = minimize(mse_loss, grad_mse_loss, tips['total_bill'], tips['tip'])
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: [0. 0.] | cost: 10.896283606557377
theta: [0.   0.07] | cost: 3.8937622006094705
theta: [0.  0.1] | cost: 1.9359443267168215
theta: [0.01 0.12] | cost: 1.388538448286097
theta: [0.01 0.13] | cost: 1.235459416905535
theta: [0.01 0.14] | cost: 1.1926273731479433
theta: [0.01 0.14] | cost: 1.1806184944517062
theta: [0.01 0.14] | cost: 1.177227251696266
theta: [0.01 0.14] | cost: 1.1762453624313751
theta: [0.01 0.14] | cost: 1.1759370980989148
theta: [0.01 0.14] | cost: 1.175817178966766
CPU times: user 272 ms, sys: 67.3 ms, total: 339 ms
Wall time: 792 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that gradient descent converges to the theta values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.643ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4151.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-808-Title">
<title id="MathJax-SVG-808-Title">\hat\theta_0 = 0.01</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="825" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1315" y="0"></use>
<g transform="translate(2371,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.643ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4151.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-809-Title">
<title id="MathJax-SVG-809-Title">\hat\theta_1 = 0.14</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="825" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1315" y="0"></use>
<g transform="translate(2371,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1279" y="0"></use>
</g>
</g>
</svg></span>. Our linear model is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.692ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 7187 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-810-Title">
<title id="MathJax-SVG-810-Title">y = 0.14x + 0.01</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
<g transform="translate(1831,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="3611" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4406" y="0"></use>
<g transform="translate(5407,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
</g>
</svg></span><p>We can use our estimated thetas to make and plot our predictions alongside the original data points.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">x_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">55</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'total_bill'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'tip'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_vals</span><span class="p">,</span> <span class="n">simple_linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">x_vals</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">'goldenrod'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Tip amount vs. Total Bill'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Total Bill'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Tip Amount'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_grad_17_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that if a table's bill is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1501.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-811-Title">
<title id="MathJax-SVG-811-Title">\$10</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span>, our model will predict that the waiter gets around <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.297ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2280.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-812-Title">
<title id="MathJax-SVG-812-Title">\$1.50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span> in tip. Similarly, if a table's bill is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.487ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1501.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-813-Title">
<title id="MathJax-SVG-813-Title">\$40</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</svg></span>, our model will predict a tip of around <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.297ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2280.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-814-Title">
<title id="MathJax-SVG-814-Title">\$6.00</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-24" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMAIN-36"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">minimize</span> <span class="k">as</span> <span class="n">sci_min</span>
<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">,</span> <span class="n">grad_loss_fn</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Uses scipy.minimize to minimize loss_fn using a form of gradient descent.</span>
<span class="sd">    '''</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">iters</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">grad_loss_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">iters</span>
        <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">iters</span> <span class="o">%</span> <span class="n">progress</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'theta: </span><span class="si">{theta}</span><span class="s1"> | loss: {loss_fn(theta, X, y):.2f}'</span><span class="p">)</span>
        <span class="n">iters</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="n">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sci_min</span><span class="p">(</span>
        <span class="n">objective</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_theta</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span>
    <span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multiple-Linear-Regression">Multiple Linear Regression<a class="anchor-link" href="#Multiple-Linear-Regression">¶</a></h2><p>Our simple linear model has a key advantage over the constant model: it uses the data when making predictions. However, it is still rather limited since simple linear models only use one variable in our dataset. Many datasets have many potentially useful variables, and multiple linear regression can take advantage of that. For example, consider the following dataset on car models and their milage per gallon (MPG):</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mpg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'mpg.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpg</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>mpg</th>
<th>cylinders</th>
<th>displacement</th>
<th>...</th>
<th>model year</th>
<th>origin</th>
<th>car name</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>18.0</td>
<td>8</td>
<td>307.0</td>
<td>...</td>
<td>70</td>
<td>1</td>
<td>chevrolet chevelle malibu</td>
</tr>
<tr>
<th>1</th>
<td>15.0</td>
<td>8</td>
<td>350.0</td>
<td>...</td>
<td>70</td>
<td>1</td>
<td>buick skylark 320</td>
</tr>
<tr>
<th>2</th>
<td>18.0</td>
<td>8</td>
<td>318.0</td>
<td>...</td>
<td>70</td>
<td>1</td>
<td>plymouth satellite</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>389</th>
<td>32.0</td>
<td>4</td>
<td>135.0</td>
<td>...</td>
<td>82</td>
<td>1</td>
<td>dodge rampage</td>
</tr>
<tr>
<th>390</th>
<td>28.0</td>
<td>4</td>
<td>120.0</td>
<td>...</td>
<td>82</td>
<td>1</td>
<td>ford ranger</td>
</tr>
<tr>
<th>391</th>
<td>31.0</td>
<td>4</td>
<td>119.0</td>
<td>...</td>
<td>82</td>
<td>1</td>
<td>chevy s-10</td>
</tr>
</tbody>
</table>
<p>392 rows × 9 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems likely that multiple attributes of a car model will affect its MPG. For example, the MPG seems to decrease as horsepower increases:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'horsepower'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'mpg'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mpg</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, cars released later generally have better MPG than older cars:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'model year'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'mpg'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">mpg</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems possible that we can get a more accurate model if we could take both horsepower and model year into account when making predictions about the MPG. In fact, perhaps the best model takes into account all the numerical variables in our dataset. We can extend our univariate linear regression to allow prediction based on any number of attributes.</p>
<p>We state the following model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.07ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 13377.4 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-815-Title">
<title id="MathJax-SVG-815-Title">
f_\boldsymbol\theta (\textbf{x}) = \theta_0 + \theta_1 x_1 + \ldots + \theta_p x_p
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2652" y="0"></use>
<g transform="translate(3708,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4854" y="0"></use>
<g transform="translate(5855,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(6778,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8027" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="9027" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10422" y="0"></use>
<g transform="translate(11423,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
</g>
<g transform="translate(12348,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
</svg></span><p>Where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-816-Title">
<title id="MathJax-SVG-816-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> now represents a vector containing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-817-Title">
<title id="MathJax-SVG-817-Title"> p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span> attributes of a single car. The model above says, "Take multiple attributes of a car, multiply them by some weights, and add them together to make a prediction for MPG."</p>
<p>For example, if we're making a prediction on the first car in our dataset using the horsepower, weight, and model year columns, the vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-818-Title">
<title id="MathJax-SVG-818-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> looks like:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mpg</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">'horsepower'</span><span class="p">,</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>horsepower</th>
<th>weight</th>
<th>model year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>130.0</td>
<td>3504.0</td>
<td>70</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In there examples, we've kept the column names for clarity but keep in mind that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-819-Title">
<title id="MathJax-SVG-819-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> only contains the numerical values of the table above: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.952ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9451.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-820-Title">
<title id="MathJax-SVG-820-Title"> \textbf{x} = [130.0, 3504.0, 70] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1941" y="0"></use>
<g transform="translate(2220,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4500" y="0"></use>
<g transform="translate(4945,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2280" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="7726" y="0"></use>
<g transform="translate(8171,0)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="9172" y="0"></use>
</g>
</svg></span>.</p>
<p>Now, we will perform a notational trick that will greatly simplify later formulas. We will prepend the value <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-821-Title">
<title id="MathJax-SVG-821-Title"> 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span> to the vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-822-Title">
<title id="MathJax-SVG-822-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>, so that we have the following vector for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-823-Title">
<title id="MathJax-SVG-823-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mpg_mat</span> <span class="o">=</span> <span class="n">mpg</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mpg_mat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'horsepower'</span><span class="p">,</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>horsepower</th>
<th>weight</th>
<th>model year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>130.0</td>
<td>3504.0</td>
<td>70</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, observe what happens to the formula for our model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.793ex" height="12.509ex" style="vertical-align: -5.671ex;" viewBox="0 -2944.1 14980.5 5385.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-824-Title">
<title id="MathJax-SVG-824-Title">
\begin{aligned}
f_\boldsymbol\theta (\textbf{x})
&amp;= \theta_0 + \theta_1 x_1 + \ldots + \theta_p x_p \\
&amp;= \theta_0 (1) + \theta_1 x_1 + \ldots + \theta_p x_p \\
&amp;= \theta_0 x_0 + \theta_1 x_1 + \ldots + \theta_p x_p \\
f_\boldsymbol\theta (\textbf{x}) &amp;= \boldsymbol\theta \cdot \textbf{x}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2057)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
<g transform="translate(0,-2107)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
</g>
<g transform="translate(2364,0)">
<g transform="translate(0,2057)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2479" y="0"></use>
<g transform="translate(3480,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(4403,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5652" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="6653" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8047" y="0"></use>
<g transform="translate(9048,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
</g>
<g transform="translate(9974,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,669)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2257" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2646" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3147" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="3759" y="0"></use>
<g transform="translate(4759,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(5683,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="6931" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="7932" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9327" y="0"></use>
<g transform="translate(10328,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
</g>
<g transform="translate(11253,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,-719)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(2257,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3506" y="0"></use>
<g transform="translate(4506,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(5430,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="6678" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="7679" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9074" y="0"></use>
<g transform="translate(10075,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
</g>
<g transform="translate(11000,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,-2107)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2118" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2619" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.397ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1892.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-825-Title">
<title id="MathJax-SVG-825-Title"> \boldsymbol\theta \cdot \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="784" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1285" y="0"></use>
</g>
</svg></span> is the vector dot product of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-826-Title">
<title id="MathJax-SVG-826-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-827-Title">
<title id="MathJax-SVG-827-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>. Vector and matrix notation were designed to succinctly write linear combinations and is thus well-suited for our linear models. However, you will have to remember from now on that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.397ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1892.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-828-Title">
<title id="MathJax-SVG-828-Title"> \boldsymbol\theta \cdot \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="784" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1285" y="0"></use>
</g>
</svg></span> is a vector-vector dot product. When in doubt, you can always expand the dot product into simple multiplications and additions.</p>
<p>Now, we define the matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-829-Title">
<title id="MathJax-SVG-829-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> as the matrix containing every car model as a row and a first column of biases. For example, here are the first five rows of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-830-Title">
<title id="MathJax-SVG-830-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mpg_mat</span> <span class="o">=</span> <span class="n">mpg</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">mpg_mat</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">4</span><span class="p">,</span> <span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'horsepower'</span><span class="p">,</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>horsepower</th>
<th>weight</th>
<th>model year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>130.0</td>
<td>3504.0</td>
<td>70</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>165.0</td>
<td>3693.0</td>
<td>70</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>150.0</td>
<td>3436.0</td>
<td>70</td>
</tr>
<tr>
<th>3</th>
<td>1</td>
<td>150.0</td>
<td>3433.0</td>
<td>70</td>
</tr>
<tr>
<th>4</th>
<td>1</td>
<td>140.0</td>
<td>3449.0</td>
<td>70</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, keep in mind that the actual matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-831-Title">
<title id="MathJax-SVG-831-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> only contains the numerical values of the table above.</p>
<p>Notice that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-832-Title">
<title id="MathJax-SVG-832-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> is composed of multiple <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-833-Title">
<title id="MathJax-SVG-833-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> vectors stacked on top of each other. To keep the notation clear, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.819ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1213.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-834-Title">
<title id="MathJax-SVG-834-Title"> \textbf{X}_{i} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</svg></span> to refer to the row vector with index <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-835-Title">
<title id="MathJax-SVG-835-Title"> i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span> of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-836-Title">
<title id="MathJax-SVG-836-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. We define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.859ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1661.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-837-Title">
<title id="MathJax-SVG-837-Title"> X_{i,j} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
<g transform="translate(828,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use>
</g>
</g>
</svg></span> to refer to the element with index <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.985ex" height="2.509ex" style="vertical-align: -0.671ex; margin-left: -0.027ex;" viewBox="-11.5 -791.3 424 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-838-Title">
<title id="MathJax-SVG-838-Title"> j </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6A" x="0" y="0"></use>
</g>
</svg></span> of the row with index <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-839-Title">
<title id="MathJax-SVG-839-Title"> i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span> of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-840-Title">
<title id="MathJax-SVG-840-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. Thus, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.819ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1213.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-841-Title">
<title id="MathJax-SVG-841-Title"> \textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</svg></span> is a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-842-Title">
<title id="MathJax-SVG-842-Title"> p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>-dimensional vector and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.859ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 1661.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-843-Title">
<title id="MathJax-SVG-843-Title"> X_{i,j} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
<g transform="translate(828,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="624" y="0"></use>
</g>
</g>
</svg></span> is a scalar. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-844-Title">
<title id="MathJax-SVG-844-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> is an <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-845-Title">
<title id="MathJax-SVG-845-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> matrix, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-846-Title">
<title id="MathJax-SVG-846-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> is the number of car examples we have and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-847-Title">
<title id="MathJax-SVG-847-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span> is the number of attributes we have for a single car.</p>
<p>For example, from the table above we have <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.192ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 9555 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-848-Title">
<title id="MathJax-SVG-848-Title"> \textbf{X}_4 = [1, 140, 3449, 70] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="1229" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1601" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2657" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2935" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3436" y="0"></use>
<g transform="translate(3881,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="5383" y="0"></use>
<g transform="translate(5828,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1501" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="7830" y="0"></use>
<g transform="translate(8275,0)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="9276" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.844ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 4668.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-849-Title">
<title id="MathJax-SVG-849-Title"> X_{4,1} = 140 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
<g transform="translate(828,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2C" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2111" y="0"></use>
<g transform="translate(3167,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
</g>
</svg></span>. This notation becomes important when we define the loss function since we will need both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-850-Title">
<title id="MathJax-SVG-850-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, the matrix of input values, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-851-Title">
<title id="MathJax-SVG-851-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span>, the vector of MPGs.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="MSE-Loss-and-its-Gradient">MSE Loss and its Gradient<a class="anchor-link" href="#MSE-Loss-and-its-Gradient">¶</a></h2><p>The mean squared error loss function takes in a vector of weights <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-852-Title">
<title id="MathJax-SVG-852-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span>, a matrix of inputs <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-853-Title">
<title id="MathJax-SVG-853-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, and a vector of observed MPGs <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-854-Title">
<title id="MathJax-SVG-854-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.586ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14891.3 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-855-Title">
<title id="MathJax-SVG-855-Title">
\begin{aligned}
L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
</g>
</g>
<g transform="translate(4379,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7341" y="0"></use>
<g transform="translate(7730,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8944" y="0"></use>
<g transform="translate(9334,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've previously derived the gradient of the MSE loss with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-856-Title">
<title id="MathJax-SVG-856-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.257ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 21638.5 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-857-Title">
<title id="MathJax-SVG-857-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&amp;= -\frac{2}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{X}_i))\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</g>
<g transform="translate(5711,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
<g transform="translate(7131,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8119" y="0"></use>
<g transform="translate(8509,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9723" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10112" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10502" y="0"></use>
<g transform="translate(10891,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(12222,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="13211" y="0"></use>
<g transform="translate(13600,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14814" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15203" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know that:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.762ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5925.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-858-Title">
<title id="MathJax-SVG-858-Title">
\begin{aligned}
f_\boldsymbol\theta (\textbf{x}) &amp;= \boldsymbol\theta \cdot \textbf{x} \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
</g>
<g transform="translate(2364,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2118" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2619" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Let's now compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.608ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3706 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-859-Title">
<title id="MathJax-SVG-859-Title"> \nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2319" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2708" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3316" y="0"></use>
</g>
</svg></span>. The result is surprisingly simple because <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.966ex" height="2.843ex" style="vertical-align: -1.005ex;" viewBox="0 -791.3 10749.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-860-Title">
<title id="MathJax-SVG-860-Title"> \boldsymbol\theta \cdot \textbf{x} = \theta_0 x_0 + \ldots + \theta_p x_p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="784" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1285" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2170" y="0"></use>
<g transform="translate(3227,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(4150,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5399" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="6399" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7794" y="0"></use>
<g transform="translate(8795,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
</g>
<g transform="translate(9720,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
</svg></span> and thus <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.059ex" height="4.176ex" style="vertical-align: -1.671ex;" viewBox="0 -1078.4 6483.7 1798" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-861-Title">
<title id="MathJax-SVG-861-Title"> \frac{\partial}{\partial \theta_0}(\boldsymbol\theta \cdot \textbf{x}) = x_0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-30" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1451" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1840" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2625" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3126" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3733" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4401" y="0"></use>
<g transform="translate(5457,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="809" y="-213"></use>
</g>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.059ex" height="4.176ex" style="vertical-align: -1.671ex;" viewBox="0 -1078.4 6483.7 1798" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-862-Title">
<title id="MathJax-SVG-862-Title"> \frac{\partial}{\partial \theta_1}(\boldsymbol\theta \cdot \textbf{x}) = x_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-31" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1451" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1840" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2625" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3126" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3733" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4401" y="0"></use>
<g transform="translate(5457,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
</g>
</svg></span>, and so on.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.89ex" height="38.176ex" style="vertical-align: -18.505ex;" viewBox="0 -8469.6 11147.1 16436.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-863-Title">
<title id="MathJax-SVG-863-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x})
&amp;= \nabla_{\boldsymbol\theta} [ \boldsymbol\theta \cdot \textbf{x} ] \\
&amp;= \begin{bmatrix}
     \frac{\partial}{\partial \theta_0} (\boldsymbol\theta \cdot \textbf{x}) \\
     \frac{\partial}{\partial \theta_1} (\boldsymbol\theta \cdot \textbf{x}) \\
     \vdots \\
     \frac{\partial}{\partial \theta_p} (\boldsymbol\theta \cdot \textbf{x}) \\
   \end{bmatrix} \\
&amp;= \begin{bmatrix}
     x_0 \\
     x_1 \\
     \vdots \\
     x_p
   \end{bmatrix} \\
\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{x}) &amp;= \textbf{x}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,7578)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2319" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2708" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3316" y="0"></use>
</g>
<g transform="translate(0,-7628)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2319" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2708" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3316" y="0"></use>
</g>
</g>
<g transform="translate(3695,0)">
<g transform="translate(0,7578)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-5B" x="2665" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2943" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="3728" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="4229" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="4836" y="0"></use>
</g>
<g transform="translate(0,3044)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,3982)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-5707.731694047177) scale(1,6.561744102897475)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-6821"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3015)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-30" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1451" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1840" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2625" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3126" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3733" y="0"></use>
</g>
<g transform="translate(0,1045)">
<g transform="translate(120,0)">
<rect stroke="none" width="1211" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="572" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-31" x="578" y="-243"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1451" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1840" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2625" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3126" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3733" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="1923" y="-1247"></use>
<g transform="translate(0,-2814)">
<g transform="translate(120,0)">
<rect stroke="none" width="1213" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="573" y="651"></use>
<g transform="translate(60,-451)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2202" x="0" y="0"></use>
<g transform="translate(401,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHI-70" x="578" y="-185"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1453" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1842" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2627" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3127" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3735" y="0"></use>
</g>
</g>
</g>
<g transform="translate(5116,3982)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-5707.731694047177) scale(1,6.561744102897475)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-6821"></use>
</g>
</g>
</g>
<g transform="translate(0,-3883)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,3144)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-4034.099587526192) scale(1,3.786234805184398)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5144"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(1,2344)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="809" y="-213"></use>
</g>
<g transform="translate(1,944)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="375" y="-957"></use>
<g transform="translate(0,-2357)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2019,3144)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-4034.099587526192) scale(1,3.786234805184398)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5144"></use>
</g>
</g>
</g>
<g transform="translate(0,-7628)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we plug this result back into our gradient calculations:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.257ex" height="12.843ex" style="vertical-align: -5.838ex;" viewBox="0 -3015.9 21638.5 5529.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-864-Title">
<title id="MathJax-SVG-864-Title">
\begin{aligned}
\nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y})
&amp;= -\frac{2}{n} \sum_{i}(y_i - f_\boldsymbol\theta (\textbf{X}_i))(\nabla_{\boldsymbol\theta} f_\boldsymbol\theta (\textbf{X}_i))\\
&amp;= -\frac{2}{n} \sum_{i}(y_i - \boldsymbol\theta \cdot \textbf{X}_i)(\textbf{X}_i)\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1594)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</g>
<g transform="translate(5711,0)">
<g transform="translate(0,1594)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
<g transform="translate(7131,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8119" y="0"></use>
<g transform="translate(8509,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9723" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10112" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10502" y="0"></use>
<g transform="translate(10891,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(12222,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="13211" y="0"></use>
<g transform="translate(13600,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14814" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15203" y="0"></use>
</g>
<g transform="translate(0,-1244)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-32" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4684" y="0"></use>
<g transform="translate(5073,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6130" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="7131" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="7916" y="0"></use>
<g transform="translate(8416,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="9630" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="10020" y="0"></use>
<g transform="translate(10409,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11623" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Remember that since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.584ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4557 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-865-Title">
<title id="MathJax-SVG-865-Title"> y_i - \boldsymbol\theta \cdot \textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1057" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2842" y="0"></use>
<g transform="translate(3343,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</svg></span> is a scalar and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.819ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1213.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-866-Title">
<title id="MathJax-SVG-866-Title"> \textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</svg></span> is a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-867-Title">
<title id="MathJax-SVG-867-Title"> p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>-dimensional vector, the gradient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.289ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5721.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-868-Title">
<title id="MathJax-SVG-868-Title"> \nabla_{\boldsymbol\theta} L(\boldsymbol\theta, \textbf{X}, \textbf{y}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</svg></span> is a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-869-Title">
<title id="MathJax-SVG-869-Title"> p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>-dimensional vector.</p>
<p>We saw this same type of result when we computed the gradient for univariate linear regression and found that it was 2-dimensional since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-870-Title">
<title id="MathJax-SVG-870-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> was 2-dimensional.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-the-Model-With-Gradient-Descent">Fitting the Model With Gradient Descent<a class="anchor-link" href="#Fitting-the-Model-With-Gradient-Descent">¶</a></h2><p>We can now plug in our loss and its derivative into gradient descent. As usual, we will define the model, loss, and gradient loss in Python.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="sd">'''Returns predictions by a linear model on x_vals.'''</span>
    <span class="k">return</span>  \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">@</span> <span class="n">thetas</span>

<span class="k">def</span> <span class="nf">mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> \<span class="n">textbf</span><span class="p">{</span><span class="n">y</span><span class="p">}</span>  <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span>  \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">@</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">thetas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
 \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">9</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">),</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">grad_mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">[</span> <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">3.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">grad_mse_loss</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span>  \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="p">[</span> <span class="mf">25.</span><span class="p">,</span>  <span class="mf">25.</span><span class="p">,</span>  <span class="mf">25.</span><span class="p">,</span>  <span class="mf">35.</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can simply plug in our functions into our gradient descent minimizer:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
 \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">=</span> <span class="p">(</span><span class="n">mpg_mat</span>
     <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'horsepower'</span><span class="p">,</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">]]</span>
     <span class="o">.</span><span class="n">as_matrix</span><span class="p">())</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">mpg_mat</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span> 

thetas = minimize(mse_loss, grad_mse_loss, X, y)
print(f'theta: {thetas} | loss: {mse_loss(thetas, X, y):.2f}')
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: [ 0.  0.  0.  0.] | cost: 610.47
theta: [ 0.    0.    0.01  0.  ] | cost: 178.95
theta: [ 0.01 -0.11 -0.    0.55] | cost: 15.78
theta: [ 0.01 -0.01 -0.01  0.58] | cost: 11.97
theta: [-4.   -0.01 -0.01  0.63] | cost: 11.81
theta: [-13.72  -0.    -0.01   0.75] | cost: 11.65
theta: [-13.72  -0.    -0.01   0.75] | cost: 11.65
CPU times: user 8.81 ms, sys: 3.11 ms, total: 11.9 ms
Wall time: 9.22 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>According to gradient descent, our linear model is:</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.076ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 12949.3 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-871-Title">
<title id="MathJax-SVG-871-Title">y = -13.72 - 0.01x_2 + 0.75x_3</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1831" y="0"></use>
<g transform="translate(2610,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5112" y="0"></use>
<g transform="translate(6113,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
<g transform="translate(7893,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9142" y="0"></use>
<g transform="translate(10142,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
<g transform="translate(11922,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
</g>
</svg></span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Visualizing-our-Predictions">Visualizing our Predictions<a class="anchor-link" href="#Visualizing-our-Predictions">¶</a></h2><p>How does our model do? We can see that the loss decreased dramatically (from 610 to 11.6). We can show the predictions of our model alongside the original values:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">reordered</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'predicted_mpg'</span><span class="p">,</span> <span class="s1">'mpg'</span><span class="p">,</span> <span class="s1">'horsepower'</span><span class="p">,</span> <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">]</span>
<span class="n">with_predictions</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">mpg</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">predicted_mpg</span><span class="o">=</span><span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">reordered</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">with_predictions</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>predicted_mpg</th>
<th>mpg</th>
<th>horsepower</th>
<th>weight</th>
<th>model year</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>15.447125</td>
<td>18.0</td>
<td>130.0</td>
<td>3504.0</td>
<td>70</td>
</tr>
<tr>
<th>1</th>
<td>14.053509</td>
<td>15.0</td>
<td>165.0</td>
<td>3693.0</td>
<td>70</td>
</tr>
<tr>
<th>2</th>
<td>15.785576</td>
<td>18.0</td>
<td>150.0</td>
<td>3436.0</td>
<td>70</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>389</th>
<td>32.456900</td>
<td>32.0</td>
<td>84.0</td>
<td>2295.0</td>
<td>82</td>
</tr>
<tr>
<th>390</th>
<td>30.354143</td>
<td>28.0</td>
<td>79.0</td>
<td>2625.0</td>
<td>82</td>
</tr>
<tr>
<th>391</th>
<td>29.726608</td>
<td>31.0</td>
<td>82.0</td>
<td>2720.0</td>
<td>82</td>
</tr>
</tbody>
</table>
<p>392 rows × 5 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we found <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-872-Title">
<title id="MathJax-SVG-872-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> from gradient descent, we can verify for the first row of our data that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.059ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2608.9 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-873-Title">
<title id="MathJax-SVG-873-Title"> \boldsymbol\theta \cdot \textbf{X}_0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="784" y="0"></use>
<g transform="translate(1285,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="1229" y="-213"></use>
</g>
</g>
</svg></span> matches our prediction above:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Prediction for first row: '</span>
      <span class="n">f</span><span class="s1">'{thetas[0] + thetas[1] * 130 + thetas[2] * 3504 + thetas[3] * 70:.2f}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Prediction for first row: 15.45
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've included a widget below to pan through the predictions and the data used to make the prediction:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">with_predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(392 rows, 5 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also plot the residuals of our predictions (actual values - predicted values):</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resid</span> <span class="o">=</span> \<span class="n">textbf</span><span class="p">{</span><span class="n">y</span><span class="p">}</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid</span><span class="p">)),</span> <span class="n">resid</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residuals (actual MPG - predicted MPG)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'MPG'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_35_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like our model makes reasonable predictions for many car models, although there are some predictions that were off by over 10 MPG (some cars had under 10 MPG!). Perhaps we are more interested in the percent error between the predicted MPG values and the actual MPG values:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resid_prop</span> <span class="o">=</span> <span class="n">resid</span> <span class="o">/</span> <span class="n">with_predictions</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid_prop</span><span class="p">)),</span> <span class="n">resid_prop</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residual proportions (resid / actual MPG)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error proportion'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_37_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It looks like our model's predictions are usually within 20% away from the actual MPG values.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-All-the-Data">Using All the Data<a class="anchor-link" href="#Using-All-the-Data">¶</a></h2><p>Notice that in our example thus far, our <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-874-Title">
<title id="MathJax-SVG-874-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> matrix has four columns: one column of all ones, the horsepower, the weight, and the model year. However, model allows us to handle an arbitrary number of columns:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.762ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5925.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-875-Title">
<title id="MathJax-SVG-875-Title">
\begin{aligned}
f_\boldsymbol\theta (\textbf{x}) &amp;= \boldsymbol\theta \cdot \textbf{x}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
</g>
<g transform="translate(2364,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="2118" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2619" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>As we include more columns into our data matrix, we extend <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-876-Title">
<title id="MathJax-SVG-876-Title"> \boldsymbol\theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> so that it has one parameter for each column in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-877-Title">
<title id="MathJax-SVG-877-Title">  \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. Instead of only selecting three numerical columns for prediction, why not use all seven of them?</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'cylinders'</span><span class="p">,</span> <span class="s1">'displacement'</span><span class="p">,</span> <span class="s1">'horsepower'</span><span class="p">,</span>
        <span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'acceleration'</span><span class="p">,</span> <span class="s1">'model year'</span><span class="p">,</span> <span class="s1">'origin'</span><span class="p">]</span>
 \<span class="n">textbf</span><span class="p">{</span><span class="n">X</span><span class="p">}</span> <span class="o">=</span> <span class="n">mpg_mat</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">mpg_mat</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>cylinders</th>
<th>displacement</th>
<th>...</th>
<th>acceleration</th>
<th>model year</th>
<th>origin</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>8</td>
<td>307.0</td>
<td>...</td>
<td>12.0</td>
<td>70</td>
<td>1</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>8</td>
<td>350.0</td>
<td>...</td>
<td>11.5</td>
<td>70</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>1</td>
<td>8</td>
<td>318.0</td>
<td>...</td>
<td>11.0</td>
<td>70</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>389</th>
<td>1</td>
<td>4</td>
<td>135.0</td>
<td>...</td>
<td>11.6</td>
<td>82</td>
<td>1</td>
</tr>
<tr>
<th>390</th>
<td>1</td>
<td>4</td>
<td>120.0</td>
<td>...</td>
<td>18.6</td>
<td>82</td>
<td>1</td>
</tr>
<tr>
<th>391</th>
<td>1</td>
<td>4</td>
<td>119.0</td>
<td>...</td>
<td>19.4</td>
<td>82</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>392 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span> 

thetas_all = minimize(mse_loss, grad_mse_loss, X, y, progress=10)
print(f'theta: {thetas_all} | loss: {mse_loss(thetas_all, X, y):.2f}')
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: [ 0.  0.  0.  0.  0.  0.  0.  0.] | cost: 610.47
theta: [-0.5  -0.81  0.02 -0.04 -0.01 -0.07  0.59  1.3 ] | cost: 11.22
theta: [-17.23  -0.49   0.02  -0.02  -0.01   0.08   0.75   1.43] | cost: 10.85
theta: [-17.22  -0.49   0.02  -0.02  -0.01   0.08   0.75   1.43] | cost: 10.85
CPU times: user 10.9 ms, sys: 3.51 ms, total: 14.4 ms
Wall time: 11.7 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>According to gradient descent, our linear model is:</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.868ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 33096 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-878-Title">
<title id="MathJax-SVG-878-Title">y = -17.22 - 0.49x_1 + 0.02x_2 - 0.02x_3 - 0.01x_4 + 0.08x_5 + 0.75x_6 + 1.43x_7</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1831" y="0"></use>
<g transform="translate(2610,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5112" y="0"></use>
<g transform="translate(6113,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
<g transform="translate(7893,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9142" y="0"></use>
<g transform="translate(10142,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
<g transform="translate(11922,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="13171" y="0"></use>
<g transform="translate(14172,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
<g transform="translate(15952,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="17200" y="0"></use>
<g transform="translate(18201,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
<g transform="translate(19981,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="21230" y="0"></use>
<g transform="translate(22230,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1279" y="0"></use>
</g>
<g transform="translate(24010,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="25259" y="0"></use>
<g transform="translate(26260,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
<g transform="translate(28040,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="29288" y="0"></use>
<g transform="translate(30289,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
<g transform="translate(32069,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="809" y="-213"></use>
</g>
</g>
</svg></span></p>
<p>We see that our loss has decreased from 11.6 with three columns of our dataset to 10.85 when using all seven numerical columns of our dataset. We display the proportion error plots for both old and new predictions below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">resid_prop_all</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas_all</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">/</span> <span class="n">with_predictions</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid_prop</span><span class="p">)),</span> <span class="n">resid_prop</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residual proportions using 3 columns'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error proportion'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid_prop_all</span><span class="p">)),</span> <span class="n">resid_prop_all</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residual proportions using 7 columns'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error proportion'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_43_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although the difference is slight, you can see that the errors are a bit lower when using seven columns compared to using three. Both models are much better than using a constant model, as the below plot shows:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">constant_resid_prop</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">with_predictions</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span> <span class="o">/</span> <span class="n">with_predictions</span><span class="p">[</span><span class="s1">'mpg'</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">constant_resid_prop</span><span class="p">)),</span> <span class="n">constant_resid_prop</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residual proportions using constant model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error proportion'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_multiple_45_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using a constant model results in over 75% error for many car MPGs!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have introduced the linear model for regression. Unlike the constant model, the linear regression model takes in features of our data into account when making predictions, making it much more useful whenever we have correlations between variables of our data.</p>
<p>The procedure of fitting a model to data should now be quite familiar:</p>
<ol>
<li>Select a model.</li>
<li>Select a loss function.</li>
<li>Minimize the loss function using gradient descent.</li>
</ol>
<p>It is useful to know that we can usually tweak one of the components without changing the others. In this section, we introduced the linear model without changing our loss function or using a different minimization algorithm. Although modeling can get complicated, it is usually easier to learn by focusing on one component at a time, then combining different parts together as needed in practice.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1>Least Squares — A Geometric Perspective</h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that we found the optimal coefficients for linear models by optimizing their loss functions with gradient descent. We also mentioned that least squares linear regression can be solved analytically. While gradient descent is practical, this geometric perspective will provide a deeper understanding of linear regression.</p>
<p>A Vector Space Review is included in the Appendix. We will assume familiarity with vector arithmetic, the 1-vector, span of a collection of vectors, and projections.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Case-Study">Case Study<a class="anchor-link" href="#Case-Study">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've been tasked with finding a good linear model for the data:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>x</th>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>-1</td>
<td>-2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span>
        <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="p">],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_projection_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Assume that the best model is one with the least error, and that the least squares error is an acceptable measure.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Least-Squares:-Constant-Model">Least Squares: Constant Model<a class="anchor-link" href="#Least-Squares:-Constant-Model">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like we did with the tips dataset, let's start with the constant model: the model that only ever predicts a single number.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.955ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2564.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-879-Title">
<title id="MathJax-SVG-879-Title"> \theta = C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="747" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="1803" y="0"></use>
</g>
</svg></span><p>Thus, we are working with just the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-880-Title">
<title id="MathJax-SVG-880-Title">y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span>-values.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th>y</th>
</tr>
</thead>
<tbody>
<tr>
<td>2</td>
</tr>
<tr>
<td>1</td>
</tr>
<tr>
<td>-2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our goal is to find the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-881-Title">
<title id="MathJax-SVG-881-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> that results in the line that minimizes the squared loss:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100ex" height="7.843ex" style="vertical-align: -4.005ex; max-width: 60000px;" viewBox="0 -1652.5 43055.4 3376.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-882-Title">
<title id="MathJax-SVG-882-Title"> L(\theta, \textbf{y}) = \sum_{i = 1}^{n}(y_i - \theta)^2\\ </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(16767,0)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3260" y="0"></use>
<g transform="translate(4316,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="5761" y="0"></use>
<g transform="translate(6150,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="7207" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="8208" y="0"></use>
<g transform="translate(8677,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</svg></span><p>Recall that for the constant model, the minimizing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-883-Title">
<title id="MathJax-SVG-883-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> for MSE is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.343ex" style="vertical-align: -0.671ex;" viewBox="0 -719.6 607.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-884-Title">
<title id="MathJax-SVG-884-Title">\bar{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-AF" x="53" y="9"></use>
</g>
</svg></span>, the average of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-885-Title">
<title id="MathJax-SVG-885-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> values. The calculus derivation can be found in the Loss Functions lesson in the Modeling and Estimations chapter. For the linear algebra derivation, please refer to the Vector Space Review in the Appendix.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that our loss function is a sum of squares. The <em>L2</em>-norm for a vector is also a sum of squares, but with a square root:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.112ex" height="4.843ex" style="vertical-align: -1.838ex;" viewBox="0 -1293.7 11673.3 2085" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-886-Title">
<title id="MathJax-SVG-886-Title">\Vert \textbf{v} \Vert = \sqrt{v_1^2 + v_2^2 + \dots + v_n^2}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-76" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="1108" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1886" y="0"></use>
<g transform="translate(2942,0)">
 <use xlink:href="#MJSZ2-221A" x="0" y="-20"></use>
<rect stroke="none" width="7730" height="60" x="1000" y="1071"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-435"></use>
 <use xlink:href="#MJMAIN-2B" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3323" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="4324" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5719" y="0"></use>
<g transform="translate(6720,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="686" y="-212"></use>
</g>
</g>
</g>
</g>
</svg></span><p></p>
<p>If we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.896ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 4691.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-887-Title">
<title id="MathJax-SVG-887-Title">y_i - \theta = v_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1057" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2805" y="0"></use>
<g transform="translate(3861,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="686" y="-213"></use>
</g>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.732ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 12370.5 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-888-Title">
<title id="MathJax-SVG-888-Title">
\begin{aligned}
L(\theta, \textbf{y}) 
&amp;= v_1^2 + v_2^2 + \dots + v_n^2 \\
&amp;= \Vert \textbf{v} \Vert^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,713)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(2972,0)">
<g transform="translate(0,713)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2495" y="0"></use>
<g transform="translate(3496,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4658" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="5658" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7053" y="0"></use>
<g transform="translate(8054,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="686" y="-212"></use>
</g>
</g>
<g transform="translate(0,-780)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="1334" y="0"></use>
 <use xlink:href="#MJMAINB-76" x="1834" y="0"></use>
<g transform="translate(2442,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>This means our loss can be expressed as the <em>L2</em>-norm of some vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-889-Title">
<title id="MathJax-SVG-889-Title">\textbf{v}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-76" x="0" y="0"></use>
</g>
</svg></span>, squared. We can express <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.927ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 829.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-890-Title">
<title id="MathJax-SVG-890-Title">v_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="686" y="-213"></use>
</g>
</svg></span> as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.013ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 7755.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-891-Title">
<title id="MathJax-SVG-891-Title">y_i - \theta \quad \forall i \in [1,n]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1057" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2057" y="0"></use>
 <use xlink:href="#MJMAIN-2200" x="3527" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="4083" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="4707" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5652" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5930" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6431" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="6876" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7476" y="0"></use>
</g>
</svg></span> so that in Cartesian notation,</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.094ex" height="41.843ex" style="vertical-align: -20.338ex;" viewBox="0 -9258.9 12956.9 18015.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-892-Title">
<title id="MathJax-SVG-892-Title">
\begin{aligned}
\textbf{v} \quad &amp;= \quad \begin{bmatrix} y_1 - \theta \\ y_2 - \theta \\ \vdots \\ y_n - \theta \end{bmatrix} \\
&amp;= \quad \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\begin{bmatrix} \theta \\ \theta \\ \vdots \\ \theta \end{bmatrix} \\
&amp;= \quad \begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,6019)">
 <use xlink:href="#MJMAINB-76" x="0" y="0"></use>
</g>
</g>
<g transform="translate(1597,0)">
<g transform="translate(0,6019)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
<g transform="translate(0,3109)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5074"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2309)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1166" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2167" y="0"></use>
</g>
<g transform="translate(35,903)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1166" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2167" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="1214" y="-1004"></use>
<g transform="translate(0,-2404)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1237" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="2238" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3698,3109)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5074"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
<g transform="translate(0,3109)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5074"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2309)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
<g transform="translate(35,903)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="368" y="-1004"></use>
<g transform="translate(0,-2404)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2006,3109)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5074"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6229" y="0"></use>
<g transform="translate(8230,0)">
<g transform="translate(0,3100)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5056"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="2300"></use>
 <use xlink:href="#MJMATHI-3B8" x="0" y="900"></use>
 <use xlink:href="#MJMAIN-22EE" x="95" y="-1001"></use>
 <use xlink:href="#MJMATHI-3B8" x="0" y="-2401"></use>
</g>
</g>
<g transform="translate(1460,3100)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5056"></use>
</g>
</g>
<g transform="translate(0,-6019)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
<g transform="translate(0,3109)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5074"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2309)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
<g transform="translate(35,903)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="368" y="-1004"></use>
<g transform="translate(0,-2404)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2006,3109)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5074"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6229" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="8230" y="0"></use>
<g transform="translate(8866,0)">
<g transform="translate(0,3100)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5056"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="2300"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="900"></use>
 <use xlink:href="#MJMAIN-22EE" x="111" y="-1001"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-2401"></use>
</g>
</g>
<g transform="translate(1491,3100)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5056"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>So our loss function can be written as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.28ex" height="17.843ex" style="vertical-align: -8.338ex;" viewBox="0 -4092.3 20787 7682.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-893-Title">
<title id="MathJax-SVG-893-Title"> 
\begin{aligned}
L(\theta, \textbf{y})
\quad &amp;= \quad \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ \vdots \\ y_n  \end{bmatrix} \quad - \quad 
\theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}
\qquad \right \Vert ^2 \\
\quad &amp;= \quad \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\hat{\textbf{y}}
\qquad \right \Vert ^2 \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1540" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2593" y="0"></use>
</g>
</g>
<g transform="translate(3972,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
<g transform="translate(0,3109)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-3811.3463073852295) scale(1,3.8073852295409183)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-5468"></use>
</g>
<g transform="translate(2500,0)">
<g transform="translate(0,3109)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5074"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,2309)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
<g transform="translate(35,903)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22EE" x="368" y="-1004"></use>
<g transform="translate(0,-2404)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2006,3109)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3964.3294701986756) scale(1,3.6705298013245033)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5074"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6396" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="8397" y="0"></use>
<g transform="translate(9033,0)">
<g transform="translate(0,3100)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5056"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="2300"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="900"></use>
 <use xlink:href="#MJMAIN-22EE" x="111" y="-1001"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-2401"></use>
</g>
</g>
<g transform="translate(1491,3100)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5056"></use>
</g>
</g>
<g transform="translate(13192,3109)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-3811.3463073852295) scale(1,3.8073852295409183)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-5468"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="19364" y="4011"></use>
</g>
</g>
<g transform="translate(0,-3209)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4330" y="0"></use>
<g transform="translate(6330,0)">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="8938" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="13348" y="675"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The expression <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.492ex" height="13.843ex" style="vertical-align: -6.338ex;" viewBox="0 -3231.2 2795.2 5960" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-894-Title">
<title id="MathJax-SVG-894-Title">\theta \begin{bmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(636,0)">
<g transform="translate(0,3100)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-5056"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="2300"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="900"></use>
 <use xlink:href="#MJMAIN-22EE" x="111" y="-1001"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-2401"></use>
</g>
</g>
<g transform="translate(1491,3100)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-3946.359271523179) scale(1,3.640728476821192)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-5056"></use>
</g>
</g>
</g>
</svg></span>  is a scalar multiple of the columns of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-895-Title">
<title id="MathJax-SVG-895-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> vector, and is the result of our predictions, denoted <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-896-Title">
<title id="MathJax-SVG-896-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span>.</p>
<p>This gives us a new perspective on what it means to minimize the least squares error.</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-897-Title">
<title id="MathJax-SVG-897-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-898-Title">
<title id="MathJax-SVG-898-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> are fixed, but <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-899-Title">
<title id="MathJax-SVG-899-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> can take on any value, so <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-900-Title">
<title id="MathJax-SVG-900-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> can be any scalar multiple of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-901-Title">
<title id="MathJax-SVG-901-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span>. We want to find <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-902-Title">
<title id="MathJax-SVG-902-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> so that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.427ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1045 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-903-Title">
<title id="MathJax-SVG-903-Title"> \theta \textbf{1} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="469" y="0"></use>
</g>
</svg></span> is as close to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-904-Title">
<title id="MathJax-SVG-904-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> as possible. We use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-905-Title">
<title id="MathJax-SVG-905-Title">\hat{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> to denote this best-fit <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-906-Title">
<title id="MathJax-SVG-906-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p><img src="../../notebooks-images/linear_projection__1dprojection.png" width="300"></p>
<p>The projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-907-Title">
<title id="MathJax-SVG-907-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-908-Title">
<title id="MathJax-SVG-908-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> is guaranteed to be the closest vector (see "Vector Space Review" in the Appendix).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Least-Squares:-Simple-Linear-Model">Least Squares: Simple Linear Model<a class="anchor-link" href="#Least-Squares:-Simple-Linear-Model">¶</a></h3><p>Now, let's look at the simple linear regression model. This is strongly parallel to the constant model derivation, but be mindful of the differences and think about how you might generalize to multiple linear regression.</p>
<p>The simple linear model is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.343ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 8328.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-909-Title">
<title id="MathJax-SVG-909-Title">
\begin{aligned}
f_\boldsymbol\theta (x_i) 
&amp;= \theta_0 + \theta_1 x_i \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
<g transform="translate(1377,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2294" y="0"></use>
</g>
</g>
<g transform="translate(2673,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2479" y="0"></use>
<g transform="translate(3480,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(4403,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Our goal is to find the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-910-Title">
<title id="MathJax-SVG-910-Title">\boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> that results in the line with the least squared error:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.834ex" height="21.176ex" style="vertical-align: -9.741ex; margin-bottom: -0.263ex;" viewBox="0 -4809.9 16289.6 9117.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-911-Title">
<title id="MathJax-SVG-911-Title">
\begin{aligned}
L(\boldsymbol\theta, \textbf{x}, \textbf{y})
&amp;= \sum_{i = 1}^{n}(y_i - f_\boldsymbol\theta (x_i))^2\\
&amp;= \sum_{i = 1}^{n}(y_i - \theta_0 - \theta_1 x_i)^2\\
&amp;= \sum_{i = 1}^{n}(y_i - \begin{bmatrix} 1 &amp; x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} ) ^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
</g>
</g>
<g transform="translate(4117,0)">
<g transform="translate(0,3129)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2778" y="0"></use>
<g transform="translate(3168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4225" y="0"></use>
<g transform="translate(5225,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6214" y="0"></use>
<g transform="translate(6603,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7520" y="0"></use>
<g transform="translate(7909,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
<g transform="translate(0,66)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2778" y="0"></use>
<g transform="translate(3168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4225" y="0"></use>
<g transform="translate(5225,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6371" y="0"></use>
<g transform="translate(7372,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(8295,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
<g transform="translate(9212,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
<g transform="translate(0,-2997)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2778" y="0"></use>
<g transform="translate(3168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4225" y="0"></use>
<g transform="translate(5225,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3019" y="0"></use>
</g>
<g transform="translate(8690,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(10994,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To help us visualize the translation of our loss summation into matrix form, let's expand out the loss with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.656ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2435.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-912-Title">
<title id="MathJax-SVG-912-Title">n = 3</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="878" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1934" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.988ex" height="18.509ex" style="vertical-align: -8.671ex;" viewBox="0 -4235.8 15064.3 7969.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-913-Title">
<title id="MathJax-SVG-913-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y})
&amp;=
(y_1 - \begin{bmatrix} 1 &amp; x_1 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2  \\
&amp;+
(y_2 - \begin{bmatrix} 1 &amp; x_2 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2 \\
&amp;+
(y_3 - \begin{bmatrix} 1 &amp; x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix})^2 \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2701)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
</g>
</g>
<g transform="translate(4117,0)">
<g transform="translate(0,2701)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2890" y="0"></use>
<g transform="translate(3890,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3128" y="0"></use>
</g>
<g transform="translate(7465,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(9768,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="222" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1222" y="0"></use>
<g transform="translate(1612,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2779" y="0"></use>
<g transform="translate(3779,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3128" y="0"></use>
</g>
<g transform="translate(7353,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(9657,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
<g transform="translate(0,-2701)">
 <use xlink:href="#MJMAIN-2B" x="222" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1222" y="0"></use>
<g transform="translate(1612,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2779" y="0"></use>
<g transform="translate(3779,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3128" y="0"></use>
</g>
<g transform="translate(7353,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(9657,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, our loss function is a sum of squares and the <em>L2</em>-norm for a vector is the square root of a sum of squares:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.112ex" height="4.843ex" style="vertical-align: -1.838ex;" viewBox="0 -1293.7 11673.3 2085" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-914-Title">
<title id="MathJax-SVG-914-Title">\Vert \textbf{v} \Vert = \sqrt{v_1^2 + v_2^2 + \dots + v_n^2}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-76" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="1108" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1886" y="0"></use>
<g transform="translate(2942,0)">
 <use xlink:href="#MJSZ2-221A" x="0" y="-20"></use>
<rect stroke="none" width="7730" height="60" x="1000" y="1071"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-435"></use>
 <use xlink:href="#MJMAIN-2B" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3323" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="4324" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5719" y="0"></use>
<g transform="translate(6720,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="686" y="-212"></use>
</g>
</g>
</g>
</g>
</svg></span><p></p>
<p>If we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.203ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 9990.1 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-915-Title">
<title id="MathJax-SVG-915-Title">y_i - \begin{bmatrix} 1 &amp; x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} = v_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-2212" x="1057" y="0"></use>
<g transform="translate(2057,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3019" y="0"></use>
</g>
<g transform="translate(5522,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="8104" y="0"></use>
<g transform="translate(9160,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="686" y="-213"></use>
</g>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.393ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 13516.2 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-916-Title">
<title id="MathJax-SVG-916-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y}) 
&amp;= v_1^2 + v_2^2 + \dots + v_n^2 \\
&amp;= \Vert \textbf{v} \Vert^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,713)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
</g>
</g>
<g transform="translate(4117,0)">
<g transform="translate(0,713)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2495" y="0"></use>
<g transform="translate(3496,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4658" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="5658" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7053" y="0"></use>
<g transform="translate(8054,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="686" y="-212"></use>
</g>
</g>
<g transform="translate(0,-780)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="1334" y="0"></use>
 <use xlink:href="#MJMAINB-76" x="1834" y="0"></use>
<g transform="translate(2442,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="707" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>As before, our loss can be expressed as the <em>L2</em>-norm of some vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-917-Title">
<title id="MathJax-SVG-917-Title">\textbf{v}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-76" x="0" y="0"></use>
</g>
</svg></span>, squared. With each component <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.501ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 15285 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-918-Title">
<title id="MathJax-SVG-918-Title">v_i = y_i - \begin{bmatrix} 1 &amp; x_i \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix} \quad \forall i \in [1,3]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="686" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1107" y="0"></use>
<g transform="translate(2163,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3220" y="0"></use>
<g transform="translate(4221,0)">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAIN-31" x="-11" y="-50"></use>
<g transform="translate(1490,0)">
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-5D" x="3019" y="0"></use>
</g>
<g transform="translate(7686,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-2200" x="11156" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="11713" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="12336" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="13281" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="13560" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="14060" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="14505" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="15006" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.098ex" height="23.509ex" style="vertical-align: -11.171ex;" viewBox="0 -5312.2 23722.8 10122" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-919-Title">
<title id="MathJax-SVG-919-Title"> 
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{x}, \textbf{y})
&amp;= \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ y_3  \end{bmatrix} \quad - \quad 
\begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ 1 &amp; x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix}
\qquad \right \Vert ^2 \\
&amp;= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\textbf{X}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix}
\qquad \right \Vert ^2 \\
&amp;= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
f_\boldsymbol\theta(\textbf{x})
\qquad \right \Vert ^2 \\
&amp;= \left \Vert  \qquad  
\textbf{y} 
\quad - \quad 
\hat{\textbf{y}}
\qquad \right \Vert ^2 \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2851)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
</g>
</g>
<g transform="translate(4117,0)">
<g transform="translate(0,2851)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,2159)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-2386.5449101796407) scale(1,1.910179640718563)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-3567"></use>
</g>
<g transform="translate(2500,0)">
<g transform="translate(0,2159)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2066.4768211920527) scale(1,0.5231788079470199)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3173"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1359)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
<g transform="translate(0,-1453)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(1935,2159)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2066.4768211920527) scale(1,0.5231788079470199)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3173"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6325" y="0"></use>
<g transform="translate(8326,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
<g transform="translate(1490,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(3517,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
<g transform="translate(12678,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(16982,2159)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-2386.5449101796407) scale(1,1.910179640718563)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-3567"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="24724" y="2667"></use>
</g>
</g>
<g transform="translate(0,-757)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,1450)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-1324.501996007984) scale(1,0.49600798403193613)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-2150"></use>
</g>
 <use xlink:href="#MJMAINB-79" x="2500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4330" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="6330" y="0"></use>
<g transform="translate(7367,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
<g transform="translate(11671,1450)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-1324.501996007984) scale(1,0.49600798403193613)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-2150"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="17213" y="1665"></use>
</g>
</g>
<g transform="translate(0,-2958)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4330" y="0"></use>
<g transform="translate(6330,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7319" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="7708" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8316" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="10705" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="15847" y="675"></use>
</g>
</g>
<g transform="translate(0,-4458)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="2500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4330" y="0"></use>
<g transform="translate(6330,0)">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="8938" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="13348" y="675"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The matrix multiplication <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.459ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 6656.1 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-920-Title">
<title id="MathJax-SVG-920-Title">\begin{bmatrix} 1 &amp; x_1 \\ 1 &amp; x_2 \\ 1 &amp; x_3 \end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1
\end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
<g transform="translate(1490,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(3517,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
<g transform="translate(4352,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1775" y="-1"></use>
</g>
</g>
</svg></span> is a linear combination of the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-921-Title">
<title id="MathJax-SVG-921-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>: each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.89ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 813.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-922-Title">
<title id="MathJax-SVG-922-Title">\theta_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="663" y="-213"></use>
</g>
</svg></span> only ever multiplies with one column of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-923-Title">
<title id="MathJax-SVG-923-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>—this perspective shows us that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.295ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 988.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-924-Title">
<title id="MathJax-SVG-924-Title">f_\boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
</svg></span> is a linear combination of the features of our data.</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-925-Title">
<title id="MathJax-SVG-925-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-926-Title">
<title id="MathJax-SVG-926-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> are fixed, but <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-927-Title">
<title id="MathJax-SVG-927-Title">\theta_0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-928-Title">
<title id="MathJax-SVG-928-Title">\theta_1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</svg></span> can take on any value, so <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-929-Title">
<title id="MathJax-SVG-929-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> can take on any of the infinite linear combinations of the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-930-Title">
<title id="MathJax-SVG-930-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. To have the smallest loss, we want to choose <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-931-Title">
<title id="MathJax-SVG-931-Title">\boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> such that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-932-Title">
<title id="MathJax-SVG-932-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> is as close to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-933-Title">
<title id="MathJax-SVG-933-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> as possibled, denoted as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-934-Title">
<title id="MathJax-SVG-934-Title">\hat{\boldsymbol\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Geometric-Intuition">Geometric Intuition<a class="anchor-link" href="#Geometric-Intuition">¶</a></h2><p>Now, let's develop an intuition for why it matters that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-935-Title">
<title id="MathJax-SVG-935-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> is restricted to the linear combinations of the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-936-Title">
<title id="MathJax-SVG-936-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. Although the span of any set of vectors includes an infinite number of linear combinations, infinite does not mean any—the linear combinations are restricted by the basis vectors.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a reminder, here is our loss function and scatter plot:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.579ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 16179.7 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-937-Title">
<title id="MathJax-SVG-937-Title">L(\boldsymbol{\theta}, \textbf{x}, \textbf{y}) \quad = \quad \left \Vert  \quad  
\textbf{y} 
\quad - \quad 
\textbf{X} \boldsymbol\theta
\quad \right \Vert ^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5406" y="0"></use>
<g transform="translate(7462,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="1500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3330" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="5330" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="6200" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="7762" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="11686" y="675"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'x'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_projection_21_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By inspecting our scatter plot, we see that no line can perfectly fit our points, so we cannot achieve 0 loss. Thus, we know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-938-Title">
<title id="MathJax-SVG-938-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> is not in the plane spanned by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-939-Title">
<title id="MathJax-SVG-939-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-940-Title">
<title id="MathJax-SVG-940-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span>, represented as a parallelogram below.</p>
<p><img src="../../notebooks-images/linear_projection1.png" width="500"></p>
<p>Since our loss is distance-based, we can see that to minimize <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.643ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 10179.7 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-941-Title">
<title id="MathJax-SVG-941-Title"> L(\boldsymbol\theta, \textbf{x}, \textbf{y}) = \left \Vert  \textbf{y} - \textbf{X} \boldsymbol\theta \right \Vert ^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2686" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3131" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3738" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4406" y="0"></use>
<g transform="translate(5462,0)">
 <use xlink:href="#MJMAIN-2225" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1330" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2330" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="3200" y="0"></use>
 <use xlink:href="#MJMAIN-2225" x="3762" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="6029" y="675"></use>
</g>
</g>
</svg></span>, we want <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.326ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1432 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-942-Title">
<title id="MathJax-SVG-942-Title">\textbf{X} \boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="869" y="0"></use>
</g>
</svg></span> to be as close to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-943-Title">
<title id="MathJax-SVG-943-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> as possible.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Mathematically, we are looking for the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-944-Title">
<title id="MathJax-SVG-944-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto the vector space spanned by the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-945-Title">
<title id="MathJax-SVG-945-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, as the projection of any vector is the closest point in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.122ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3927.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-946-Title">
<title id="MathJax-SVG-946-Title">Span(\textbf{X})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="645" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1149" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="1678" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2279" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2668" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3538" y="0"></use>
</g>
</svg></span> to that vector. Thus, choosing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-947-Title">
<title id="MathJax-SVG-947-Title">\boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> such that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.289ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 4429.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-948-Title">
<title id="MathJax-SVG-948-Title">\hat{\textbf{y}} = \textbf{X} \boldsymbol\theta= </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="1941" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2811" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3651" y="0"></use>
</g>
</svg></span> proj<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.682ex" height="2.176ex" style="vertical-align: -1.171ex;" viewBox="0 -432.6 2877.2 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-949-Title">
<title id="MathJax-SVG-949-Title">_{Span(\textbf{X})} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,-187)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="645" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1149" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="2279" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAINB-58" x="2668" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="3538" y="0"></use>
</g>
</g>
</svg></span> <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-950-Title">
<title id="MathJax-SVG-950-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> is the best solution.
<img src="../../notebooks-images/linear_projection2.png" width="500"></p>
<p>To see why, consider other points on the vector space, in purple.
<img src="../../notebooks-images/linear_projection3.png" width="500"></p>
<p>By the Pythagorean Theorem, any other point on the plane is farther from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-951-Title">
<title id="MathJax-SVG-951-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-952-Title">
<title id="MathJax-SVG-952-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> is. The length of the perpendicular corresponding to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-953-Title">
<title id="MathJax-SVG-953-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> represents the least squared error.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Algebra">Linear Algebra<a class="anchor-link" href="#Linear-Algebra">¶</a></h2><p>Since we've snuck in a lot of linear algebra concepts already, all that's left is solving for the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-954-Title">
<title id="MathJax-SVG-954-Title">\hat{\boldsymbol\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span> that yields our desired <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-955-Title">
<title id="MathJax-SVG-955-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span>.</p>
<p>A couple things to note:</p>
<p><img src="../../notebooks-images/linear_projection5.png" width="500"></p>
<ul>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.986ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 4299.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-956-Title">
<title id="MathJax-SVG-956-Title">\hat{\textbf{y}} + \textbf{e} = \textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
 <use xlink:href="#MJMAIN-2B" x="829" y="0"></use>
 <use xlink:href="#MJMAINB-65" x="1830" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2635" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3692" y="0"></use>
</g>
</svg></span></li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.225ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 527.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-957-Title">
<title id="MathJax-SVG-957-Title">\textbf{e}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-65" x="0" y="0"></use>
</g>
</svg></span> is perpendicular to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-958-Title">
<title id="MathJax-SVG-958-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-959-Title">
<title id="MathJax-SVG-959-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span></li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.986ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 3438.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-960-Title">
<title id="MathJax-SVG-960-Title">\hat{\textbf{y}} = \textbf{X} \hat{\boldsymbol\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="1941" y="0"></use>
<g transform="translate(2811,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</g>
</svg></span> is the vector closest to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-961-Title">
<title id="MathJax-SVG-961-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> in the vector space spanned by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-962-Title">
<title id="MathJax-SVG-962-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-963-Title">
<title id="MathJax-SVG-963-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span></li>
</ul>
<p>Thus, we arrive at the equation:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.051ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 5188.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-964-Title">
<title id="MathJax-SVG-964-Title">\textbf{X}  \hat{\boldsymbol\theta} + \textbf{e} = \textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
<g transform="translate(869,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="1719" y="0"></use>
 <use xlink:href="#MJMAINB-65" x="2719" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3525" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4581" y="0"></use>
</g>
</svg></span><p>Left-multiplying both sides by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.409ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1467.7 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-965-Title">
<title id="MathJax-SVG-965-Title">\textbf{X}^T</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.278ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 9591.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-966-Title">
<title id="MathJax-SVG-966-Title">\textbf{X}^T \textbf{X}  \hat{\boldsymbol\theta} + \textbf{X}^T \textbf{e} = \textbf{X}^T \textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
 <use xlink:href="#MJMAINB-58" x="1467" y="0"></use>
<g transform="translate(2337,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3186" y="0"></use>
<g transform="translate(4187,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-65" x="5655" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6460" y="0"></use>
<g transform="translate(7516,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-79" x="8984" y="0"></use>
</g>
</svg></span><p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.225ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 527.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-967-Title">
<title id="MathJax-SVG-967-Title">\textbf{e}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-65" x="0" y="0"></use>
</g>
</svg></span> is perpendicular to the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-968-Title">
<title id="MathJax-SVG-968-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.634ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1995.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-969-Title">
<title id="MathJax-SVG-969-Title">\textbf{X}^T \textbf{e}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
 <use xlink:href="#MJMAINB-65" x="1467" y="0"></use>
</g>
</svg></span> is a column vector of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-970-Title">
<title id="MathJax-SVG-970-Title">0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>'s. Thus, we arrive at the Normal Equation:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.803ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 6373.7 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-971-Title">
<title id="MathJax-SVG-971-Title">\textbf{X}^T \textbf{X}  \hat{\boldsymbol\theta} = \textbf{X}^T \textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
 <use xlink:href="#MJMAINB-58" x="1467" y="0"></use>
<g transform="translate(2337,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="3242" y="0"></use>
<g transform="translate(4298,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-79" x="5766" y="0"></use>
</g>
</svg></span><p>From here, we can easily solve for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-972-Title">
<title id="MathJax-SVG-972-Title">\hat{\boldsymbol\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span> by left-multiplying both sides by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.57ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 4120.5 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-973-Title">
<title id="MathJax-SVG-973-Title">(\textbf{X}^T \textbf{X})^{-1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-58" x="1857" y="0"></use>
<g transform="translate(2726,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
<g transform="translate(389,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.945ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 8157.1 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-974-Title">
<title id="MathJax-SVG-974-Title">\hat{\boldsymbol\theta} = (\textbf{X}^T \textbf{X})^{-1} \textbf{X}^T \textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-3D" x="905" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1961" y="0"></use>
<g transform="translate(2350,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-58" x="3818" y="0"></use>
<g transform="translate(4688,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
<g transform="translate(389,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(6081,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-54" x="1229" y="585"></use>
</g>
 <use xlink:href="#MJMAINB-79" x="7549" y="0"></use>
</g>
</svg></span><p>Note: we can get this same solution by minimizing with vector calculus, but in the case of least squares loss, vector calculus isn't necessary. For other loss functions, we will need to use vector calculus to get the analytic solution.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Finishing-up-the-Case-Study">Finishing up the Case Study<a class="anchor-link" href="#Finishing-up-the-Case-Study">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's return to our case study, apply what we've learned, and explain why our solution is sound.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.79ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 13687.4 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-975-Title">
<title id="MathJax-SVG-975-Title">
\textbf{y} = \begin{bmatrix} 2 \\ 1 \\ -2  \end{bmatrix} \qquad \textbf{X} = \begin{bmatrix} 1 &amp; 3 \\ 1 &amp; 0 \\ 1 &amp; -1 \end{bmatrix}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
<g transform="translate(1941,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-32" x="389" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="-50"></use>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="778" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2270,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
 <use xlink:href="#MJMAINB-58" x="7045" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8193" y="0"></use>
<g transform="translate(9249,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#MJMAIN-33" x="389" y="1350"></use>
 <use xlink:href="#MJMAIN-30" x="389" y="-50"></use>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3770,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="56.293ex" height="37.009ex" style="vertical-align: -18.005ex;" viewBox="0 -8182.5 24237 15934.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-976-Title">
<title id="MathJax-SVG-976-Title">
\begin{align}
\hat{\boldsymbol\theta} 
&amp;= 
\left(
\begin{bmatrix} 1 &amp; 1 &amp; 1 \\ 3 &amp; 0 &amp; -1 \end{bmatrix}
\begin{bmatrix} 1 &amp; 3 \\ 1 &amp; 0 \\ 1 &amp; -1 \end{bmatrix}
\right)^{-1}
\begin{bmatrix} 1 &amp; 1 &amp; 1 \\ 3 &amp; 0 &amp; -1 \end{bmatrix}
\begin{bmatrix} 2 \\ 1 \\ -2  \end{bmatrix} \\
&amp;= 
\left(
\begin{bmatrix} 3 &amp; 2\\ 2 &amp; 10 \end{bmatrix}
\right)^{-1}
\begin{bmatrix} 1 \\ 8 \end{bmatrix} \\
&amp;=
\frac{1}{30-4}
\begin{bmatrix} 10 &amp; -2\\ -2 &amp; 3 \end{bmatrix}
\begin{bmatrix} 1 \\ 8 \end{bmatrix} \\
&amp;=
\frac{1}{26}
\begin{bmatrix} -6 \\ 22 \end{bmatrix}\\
&amp;=
\begin{bmatrix} - \frac{3}{13} \\ \frac{11}{13} \end{bmatrix}
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,5758)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</g>
<g transform="translate(616,0)">
<g transform="translate(0,5758)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-239B" x="0" y="-1156"></use>
<g transform="translate(0,-2033.6645264847511) scale(1,0.4446227929373997)">
 <use xlink:href="#MJSZ4-239C"></use>
</g>
 <use xlink:href="#MJSZ4-239D" x="0" y="-3155"></use>
</g>
<g transform="translate(875,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-33" x="0" y="-750"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-30" x="0" y="-750"></use>
</g>
<g transform="translate(2990,0)">
 <use xlink:href="#MJMAIN-31" x="389" y="650"></use>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="5132" y="-1"></use>
</g>
<g transform="translate(6702,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#MJMAIN-33" x="389" y="1350"></use>
 <use xlink:href="#MJMAIN-30" x="389" y="-50"></use>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
<g transform="translate(3770,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
<g transform="translate(11140,2150)">
 <use xlink:href="#MJSZ4-239E" x="0" y="-1155"></use>
<g transform="translate(0,-2033.645264847512) scale(1,0.4462279293739968)">
 <use xlink:href="#MJSZ4-239F"></use>
</g>
 <use xlink:href="#MJSZ4-23A0" x="0" y="-3155"></use>
</g>
<g transform="translate(12016,1876)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(14521,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-33" x="0" y="-750"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-30" x="0" y="-750"></use>
</g>
<g transform="translate(2990,0)">
 <use xlink:href="#MJMAIN-31" x="389" y="650"></use>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="5132" y="-1"></use>
</g>
<g transform="translate(20348,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-32" x="389" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="-50"></use>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="778" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2270,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
</g>
<g transform="translate(0,2159)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ3-28"></use>
<g transform="translate(736,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-33" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-32" x="0" y="-750"></use>
</g>
<g transform="translate(1490,0)">
 <use xlink:href="#MJMAIN-32" x="250" y="650"></use>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="3353" y="-1"></use>
</g>
 <use xlink:href="#MJSZ3-29" x="4618" y="-1"></use>
<g transform="translate(5355,1177)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
<g transform="translate(7860,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-38" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
</g>
<g transform="translate(0,-542)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="2844" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="1171" y="676"></use>
<g transform="translate(60,-698)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1223" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="2223" y="0"></use>
</g>
</g>
</g>
<g transform="translate(4418,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(139,650)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
<g transform="translate(0,-750)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="778" y="0"></use>
</g>
</g>
<g transform="translate(2268,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="778" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-33" x="389" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="4410" y="-1"></use>
</g>
<g transform="translate(9523,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-38" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
</g>
<g transform="translate(0,-3243)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-36" x="500" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2695,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="778" y="0"></use>
</g>
<g transform="translate(139,-750)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="2131" y="-1"></use>
</g>
</g>
<g transform="translate(0,-6301)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ4-5B"></use>
<g transform="translate(750,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,875)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="335" y="651"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(389,-875)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
<g transform="translate(60,445)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-5D" x="2753" y="-1"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have analytically found that best model for least squares regression is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.07ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 9072 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-977-Title">
<title id="MathJax-SVG-977-Title">f_\boldsymbol{\boldsymbol\theta}(x_i) = - \frac{3}{13} + \frac{11}{13} x_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
<g transform="translate(1377,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2294" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2961" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4018" y="0"></use>
<g transform="translate(4796,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="335" y="651"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="6086" y="0"></use>
<g transform="translate(6865,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
<g transform="translate(60,445)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
<g transform="translate(8155,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</g>
</svg></span>. We know that our choice of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-978-Title">
<title id="MathJax-SVG-978-Title">\boldsymbol\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> is sound by the mathematical property that the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-979-Title">
<title id="MathJax-SVG-979-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto the span of the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-980-Title">
<title id="MathJax-SVG-980-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> yields the closest point in the vector space to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-981-Title">
<title id="MathJax-SVG-981-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span>. Under linear constraints using the least squares loss, solving for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-982-Title">
<title id="MathJax-SVG-982-Title">\hat{\boldsymbol\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span> by taking the projection guarantees us the optimal solution.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="When-Variables-are-Linearly-Dependent">When Variables are Linearly Dependent<a class="anchor-link" href="#When-Variables-are-Linearly-Dependent">¶</a></h2><p>For every additional variable, we add one column to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-983-Title">
<title id="MathJax-SVG-983-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>. The span of the columns of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-984-Title">
<title id="MathJax-SVG-984-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> is the linear combinations of the column vectors, so adding columns only changes the span if it is linearly independent from all existing columns.</p>
<p>When the added column is linearly dependent, it can be expressed as a linear combination of some other columns, and thus will not introduce new any vectors to the subspace.</p>
<p>Recall that the span of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-985-Title">
<title id="MathJax-SVG-985-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> is important because it is the subspace we want to project <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-986-Title">
<title id="MathJax-SVG-986-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto. If the subspace does not change, then the projection will not change.</p>
<p>For example, when we introduced <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-987-Title">
<title id="MathJax-SVG-987-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> to the constant model to get the simple linear model, we introduced a independent variable. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.332ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 4879.1 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-988-Title">
<title id="MathJax-SVG-988-Title">\textbf{x} = \begin{bmatrix} 3 \\ 0 \\ -1 \end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
<g transform="translate(1941,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-33" x="389" y="1350"></use>
 <use xlink:href="#MJMAIN-30" x="389" y="-50"></use>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="778" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2270,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
</g>
</svg></span> cannot be expressed as a scalar of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.015ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 2159 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-989-Title">
<title id="MathJax-SVG-989-Title">\begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
</g>
<g transform="translate(1491,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
</svg></span>. Thus, we moved from finding the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-990-Title">
<title id="MathJax-SVG-990-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto a line:</p>
<p><img src="../../notebooks-images/linear_projection__1dprojection.png" width="250"></p>
<p>to finding the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-991-Title">
<title id="MathJax-SVG-991-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto a plane:</p>
<p><img src="../../notebooks-images/linear_projection1.png" width="500"></p>
<p>Now, lets introduce another variable, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-992-Title">
<title id="MathJax-SVG-992-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span>, and explicitly write out the bias column:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th><strong>z</strong></th>
<th><strong>1</strong></th>
<th><strong>x</strong></th>
<th><strong>y</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>4</td>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>0</td>
<td>1</td>
<td>-1</td>
<td>-2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.874ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4251.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-993-Title">
<title id="MathJax-SVG-993-Title">\textbf{z} = \textbf{1} + \textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="789" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="1845" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2643" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3644" y="0"></use>
</g>
</svg></span>. Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-994-Title">
<title id="MathJax-SVG-994-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span> is a linear combination of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-995-Title">
<title id="MathJax-SVG-995-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-996-Title">
<title id="MathJax-SVG-996-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>, it lies in the original <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.122ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3927.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-997-Title">
<title id="MathJax-SVG-997-Title">Span(\textbf{X})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="645" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1149" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="1678" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2279" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2668" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3538" y="0"></use>
</g>
</svg></span>. Formally, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-998-Title">
<title id="MathJax-SVG-998-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span> is linearly dependent to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.499ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1076 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-999-Title">
<title id="MathJax-SVG-999-Title">\{\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="500" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.573ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1108 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1000-Title">
<title id="MathJax-SVG-1000-Title">\textbf{x}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="607" y="0"></use>
</g>
</svg></span> and does not change <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.122ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3927.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1001-Title">
<title id="MathJax-SVG-1001-Title">Span(\textbf{X})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="645" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1149" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="1678" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2279" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2668" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3538" y="0"></use>
</g>
</svg></span>. Thus, the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1002-Title">
<title id="MathJax-SVG-1002-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto the subspace spanned by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1003-Title">
<title id="MathJax-SVG-1003-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1004-Title">
<title id="MathJax-SVG-1004-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1005-Title">
<title id="MathJax-SVG-1005-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span> would be the same as the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1006-Title">
<title id="MathJax-SVG-1006-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto the subspace spanned by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1007-Title">
<title id="MathJax-SVG-1007-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1008-Title">
<title id="MathJax-SVG-1008-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="../../notebooks-images/linear_projection__dependent_variablesz.png" width="500"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also observe this from minimizing the loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="60.276ex" height="9.843ex" style="vertical-align: -4.338ex;" viewBox="0 -2370 25952.2 4237.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1009-Title">
<title id="MathJax-SVG-1009-Title"> 
\begin{aligned}
L(\boldsymbol\theta, \textbf{d}, \textbf{y})
&amp;= \left \Vert  \qquad   
\begin{bmatrix} y_1 \\ y_2 \\ y_3  \end{bmatrix} \quad - \quad 
\begin{bmatrix} 1 &amp; x_1 &amp; z_1 \\ 1 &amp; x_2 &amp; z_2\\ 1 &amp; x_3 &amp; z_3\end{bmatrix}
\begin{bmatrix} 
     \theta_0 \\
     \theta_1 \\
     \theta_2
\end{bmatrix}
\qquad \right \Vert ^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-100)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-64" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2718" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3163" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3770" y="0"></use>
</g>
</g>
<g transform="translate(4149,0)">
<g transform="translate(0,-100)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
<g transform="translate(0,2159)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-2386.5449101796407) scale(1,1.910179640718563)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-3567"></use>
</g>
<g transform="translate(2500,0)">
<g transform="translate(0,2159)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2066.4768211920527) scale(1,0.5231788079470199)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3173"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1359)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
<g transform="translate(0,-1453)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="693" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(1935,2159)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2066.4768211920527) scale(1,0.5231788079470199)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3173"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6325" y="0"></use>
<g transform="translate(8326,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1350"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-50"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1450"></use>
</g>
<g transform="translate(1490,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(3516,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="658" y="-213"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="658" y="-213"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="658" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(5437,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
<g transform="translate(14597,0)">
<g transform="translate(0,2150)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3155"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1350)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
<g transform="translate(0,-50)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
<g transform="translate(0,-1450)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(1914,2150)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2048.5066225165565) scale(1,0.49337748344370863)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3155"></use>
</g>
</g>
<g transform="translate(19179,2159)">
 <use xlink:href="#MJMAIN-2225" x="0" y="-751"></use>
<g transform="translate(0,-2386.5449101796407) scale(1,1.910179640718563)">
 <use xlink:href="#MJMAIN-2225"></use>
</g>
 <use xlink:href="#MJMAIN-2225" x="0" y="-3567"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="27832" y="2667"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Our possible solutions follow the form <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.051ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 6910.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1010-Title">
<title id="MathJax-SVG-1010-Title">\theta_0 \textbf{1} + \theta_1 \textbf{x} + \theta_2 \textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAINB-31" x="923" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1721" y="0"></use>
<g transform="translate(2721,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAINB-78" x="3645" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4474" y="0"></use>
<g transform="translate(5475,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAINB-7A" x="6399" y="0"></use>
</g>
</svg></span>.</p>
<p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.874ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4251.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1011-Title">
<title id="MathJax-SVG-1011-Title">\textbf{z} = \textbf{1} + \textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="789" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="1845" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2643" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3644" y="0"></use>
</g>
</svg></span>, regardless of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1012-Title">
<title id="MathJax-SVG-1012-Title">\theta_0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1013-Title">
<title id="MathJax-SVG-1013-Title">\theta_1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1014-Title">
<title id="MathJax-SVG-1014-Title">\theta_2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
</svg></span>, the possible values can be rewritten as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.576ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 21345.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1015-Title">
<title id="MathJax-SVG-1015-Title">
\begin{aligned}
\theta_0 \textbf{1} + \theta_1 \textbf{x} + \theta_2 (\textbf{1} + \textbf{x})
&amp;= 
(\theta_0 + \theta_2) \textbf{1} + (\theta_1 + \theta_2) \textbf{x} \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAINB-31" x="923" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1721" y="0"></use>
<g transform="translate(2721,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAINB-78" x="3645" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4474" y="0"></use>
<g transform="translate(5475,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6399" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="6788" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="7586" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="8587" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9194" y="0"></use>
</g>
</g>
<g transform="translate(9573,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2869" y="0"></use>
<g transform="translate(3869,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4793" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="5182" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5980" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6981" y="0"></use>
<g transform="translate(7370,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8516" y="0"></use>
<g transform="translate(9517,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="10440" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="10830" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>So adding <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1016-Title">
<title id="MathJax-SVG-1016-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span> does not change the problem at all. The only difference is, we can express this projection in multiple ways. Recall that we found the projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1017-Title">
<title id="MathJax-SVG-1017-Title">\textbf{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> onto the plane spanned by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.337ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 575.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1018-Title">
<title id="MathJax-SVG-1018-Title">\textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1019-Title">
<title id="MathJax-SVG-1019-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> to be:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.069ex" height="7.843ex" style="vertical-align: -3.338ex;" viewBox="0 -1939.5 13807.6 3376.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1020-Title">
<title id="MathJax-SVG-1020-Title"> \begin{bmatrix} \textbf{1} &amp; \textbf{x} \end{bmatrix}  \begin{bmatrix} - \frac{3}{13} \\ \frac{11}{13} \end{bmatrix} = - \frac{3}{13} \textbf{1} + \frac{11}{13} \textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
<g transform="translate(445,0)">
 <use xlink:href="#MJMAINB-31" x="-11" y="-50"></use>
 <use xlink:href="#MJMAINB-78" x="1565" y="-50"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="2785" y="0"></use>
<g transform="translate(3230,0)">
 <use xlink:href="#MJSZ4-5B"></use>
<g transform="translate(750,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,875)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="335" y="651"></use>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
</g>
<g transform="translate(389,-875)">
<g transform="translate(120,0)">
<rect stroke="none" width="827" height="60" x="0" y="220"></rect>
<g transform="translate(60,445)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-5D" x="2753" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="6844" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7901" y="0"></use>
<g transform="translate(8679,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-31" x="10040" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10838" y="0"></use>
<g transform="translate(11616,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-78" x="13200" y="0"></use>
</g>
</svg></span><p>However, with the introduction of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.188ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 511.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1021-Title">
<title id="MathJax-SVG-1021-Title">\textbf{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-7A" x="0" y="0"></use>
</g>
</svg></span>, we have more ways to express this same projection vector.</p>
<p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.874ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4251.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1022-Title">
<title id="MathJax-SVG-1022-Title">\textbf{1} = \textbf{z} - \textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="853" y="0"></use>
 <use xlink:href="#MJMAINB-7A" x="1909" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="2643" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3644" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1023-Title">
<title id="MathJax-SVG-1023-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> can also be expressed as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="36.298ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 15628.4 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1024-Title">
<title id="MathJax-SVG-1024-Title"> - \frac{3}{13} (\textbf{z} - \textbf{x}) + \frac{11}{13} \textbf{x} = - \frac{3}{13} \textbf{z} + \frac{14}{13} \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2139" y="0"></use>
 <use xlink:href="#MJMAINB-7A" x="2529" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3262" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="4263" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4870" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5482" y="0"></use>
<g transform="translate(6261,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-78" x="7844" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8729" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="9785" y="0"></use>
<g transform="translate(10564,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-7A" x="11925" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="12659" y="0"></use>
<g transform="translate(13437,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-78" x="15020" y="0"></use>
</g>
</svg></span><p>Since <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.874ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4251.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1025-Title">
<title id="MathJax-SVG-1025-Title">\textbf{x} = \textbf{z} + \textbf{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="885" y="0"></use>
 <use xlink:href="#MJMAINB-7A" x="1941" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2675" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="3676" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 607.5 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1026-Title">
<title id="MathJax-SVG-1026-Title">\hat{\textbf{y}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="53" y="22"></use>
</g>
</svg></span> can also be expressed as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.267ex" height="5.176ex" style="vertical-align: -1.838ex;" viewBox="0 -1437.2 14753.9 2228.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1027-Title">
<title id="MathJax-SVG-1027-Title"> - \frac{3}{13} \textbf{1} + \frac{11}{13} (\textbf{z} + \textbf{1}) = \frac{8}{13} \textbf{1} + \frac{11}{13} \textbf{z} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-33" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-31" x="2139" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2937" y="0"></use>
<g transform="translate(3715,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="5298" y="0"></use>
 <use xlink:href="#MJMAINB-7A" x="5688" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="6422" y="0"></use>
 <use xlink:href="#MJMAINB-31" x="7422" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7998" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8665" y="0"></use>
<g transform="translate(9444,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-38" x="310" y="676"></use>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-31" x="11082" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="11880" y="0"></use>
<g transform="translate(12659,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAINB-7A" x="14242" y="0"></use>
</g>
</svg></span><p>But all three expressions represent the same projection.</p>
<p>In conclusion, adding a linearly dependent column to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1028-Title">
<title id="MathJax-SVG-1028-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> does not change <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.122ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3927.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1029-Title">
<title id="MathJax-SVG-1029-Title">Span(\textbf{X})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="645" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="1149" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="1678" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2279" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2668" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3538" y="0"></use>
</g>
</svg></span>, and thus will not change the projection and solution to the least squares problem.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Two-Schools-of-Thought">Two Schools of Thought<a class="anchor-link" href="#Two-Schools-of-Thought">¶</a></h2><p>We included the scatter plots twice in this lesson. The first reminded us that like before, we are finding the best-fit line for the data. The second showed that there was no line that could fit all points. Apart from these two occurences, we tried not to disrupt our vector space drawings with scatter plots. This is because scatter plots correspond with the row-space perspective of the least squares problem: looking at each data point and trying to minimize the distance between our predictions and each datum. In this lesson, we looked at the column-space perspective: each feature was a vector, constructing a space of possible solutions (projections).</p>
<p>Both perspectives are valid and helpful to understand, and we hope you had fun seeing both sides of the least squares problem!</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/13'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">minimize</span> <span class="k">as</span> <span class="n">sci_min</span>

<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">cost_fn</span><span class="p">,</span> <span class="n">grad_cost_fn</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Uses scipy.minimize to minimize cost_fn using a form of gradient descent.</span>
<span class="sd">    '''</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">iters</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">grad_cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">iters</span>
        <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">iters</span> <span class="o">%</span> <span class="n">progress</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'theta: </span><span class="si">{theta}</span><span class="s1"> | cost: {cost_fn(theta, X, y):.2f}'</span><span class="p">)</span>
        <span class="n">iters</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="n">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sci_min</span><span class="p">(</span>
        <span class="n">objective</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_theta</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span>
    <span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Linear-Regression-Case-Study">Linear Regression Case Study<a class="anchor-link" href="#Linear-Regression-Case-Study">¶</a></h2><p>In this section, we perform an end-to-end case study of applying the linear regression model to a dataset. The dataset we will be working with has various attributes, such as length and girth, of donkeys.</p>
<p>Our task is to predict a donkey's weight using linear regression.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Preliminary-Data-Overview">Preliminary Data Overview<a class="anchor-link" href="#Preliminary-Data-Overview">¶</a></h2><p>We will begin by reading in the dataset and taking a quick peek at its contents.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">"donkeys.csv"</span><span class="p">)</span>
<span class="n">donkeys</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>BCS</th>
<th>Age</th>
<th>Sex</th>
<th>...</th>
<th>Height</th>
<th>Weight</th>
<th>WeightAlt</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3.0</td>
<td>&lt;2</td>
<td>stallion</td>
<td>...</td>
<td>90</td>
<td>77</td>
<td>NaN</td>
</tr>
<tr>
<th>1</th>
<td>2.5</td>
<td>&lt;2</td>
<td>stallion</td>
<td>...</td>
<td>94</td>
<td>100</td>
<td>NaN</td>
</tr>
<tr>
<th>2</th>
<td>1.5</td>
<td>&lt;2</td>
<td>stallion</td>
<td>...</td>
<td>95</td>
<td>74</td>
<td>NaN</td>
</tr>
<tr>
<th>3</th>
<td>3.0</td>
<td>&lt;2</td>
<td>female</td>
<td>...</td>
<td>96</td>
<td>116</td>
<td>NaN</td>
</tr>
<tr>
<th>4</th>
<td>2.5</td>
<td>&lt;2</td>
<td>female</td>
<td>...</td>
<td>91</td>
<td>91</td>
<td>NaN</td>
</tr>
</tbody>
</table>
<p>5 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's always a good idea to look at <em>how much</em> data we have by looking at the dimensions of the dataset. If we have a large number of observations, printing out the entire dataframe may crash our notebook.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(544, 8)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is relatively small, with only 544 rows of observations and 8 columns. Let's look at what columns are available to us.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array(['BCS', 'Age', 'Sex', 'Length', 'Girth', 'Height', 'Weight',
       'WeightAlt'], dtype=object)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A good understanding of our data can guide our analysis, so we should understand what each of these columns represent. A few of these columns are self-explanatory, but others require a little more explanation:</p>
<ul>
<li><code>BCS</code>: Body Condition Score (a physical health rating)</li>
<li><code>Girth</code>: the measurement around the middle of the donkey</li>
<li><code>WeightAlt</code>: the second weighing (31 donkeys in our data were weighed twice in order to check the accuracy of the scale)</li>
</ul>
<p>It is also a good idea to determine which variables are quantitative and which are categorical.</p>
<p>Quantitative: <code>Length</code>, <code>Girth</code>, <code>Height</code>, <code>Weight</code>, <code>WeightAlt</code></p>
<p>Categorical: <code>BCS</code>, <code>Age</code>, <code>Sex</code></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Data-Cleaning">Data Cleaning<a class="anchor-link" href="#Data-Cleaning">¶</a></h2><p>In this section, we will check the data for any abnormalities that we have to deal with.</p>
<p>By examining <code>WeightAlt</code> more closely, we can make sure that the scale is accurate by taking the difference between the two different weighings and plotting them.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">difference</span> <span class="o">=</span> <span class="n">donkeys</span><span class="p">[</span><span class="s1">'WeightAlt'</span><span class="p">]</span> <span class="o">-</span> <span class="n">donkeys</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">difference</span><span class="o">.</span><span class="n">dropna</span><span class="p">());</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The measurements are all within 1 kg of each other, which seems reasonable.</p>
<p>Next, we can look for unusual values that might indicate errors or other problems. We can use the quantile function in order to detect anomalous values.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="o">.</span><span class="n">quantile</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.995</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>BCS</th>
<th>Length</th>
<th>Girth</th>
<th>Height</th>
<th>Weight</th>
<th>WeightAlt</th>
</tr>
</thead>
<tbody>
<tr>
<th>0.005</th>
<td>1.5</td>
<td>71.145</td>
<td>90.000</td>
<td>89.0</td>
<td>71.715</td>
<td>98.75</td>
</tr>
<tr>
<th>0.995</th>
<td>4.0</td>
<td>111.000</td>
<td>131.285</td>
<td>112.0</td>
<td>214.000</td>
<td>192.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For each of these numerical columns, we can look at which rows fall outside of these quantiles and what values they take on. Consider that we want our model to apply to only healthy and mature donkeys.</p>
<p>First, let's look at the <code>BCS</code> column.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">)][</span><span class="s1">'BCS'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>291    4.5
445    1.0
Name: BCS, dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Also looking at the barplot of <code>BCS</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">],</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'BCS'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Considering that <code>BCS</code> is an indication of the health of a donkey, a <code>BCS</code> of 1 represents an extremely emaciated donkey and a <code>BCS</code> of 4.5 an overweight donkey. Also looking at the barplot, there only appear to be two donkeys with such outlying <code>BCS</code> values. Thus, we remove these two donkeys.</p>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, let's look at <code>Length</code>, <code>Girth</code>, and <code>Height</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">71.145</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Length'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">111</span><span class="p">)][</span><span class="s1">'Length'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>8       46
22      68
26      69
216    112
Name: Length, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Girth'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">90</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Girth'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">131.285</span><span class="p">)][</span><span class="s1">'Girth'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>8       66
239    132
283    134
523    134
Name: Girth, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Height'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">89</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Height'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">112</span><span class="p">)][</span><span class="s1">'Height'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>8       71
22      86
244    113
523    116
Name: Height, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For these three columns, the donkey in row 8 seems to have a much smaller value than the cut-off while the other anomalous donkeys are close to the cut-off and likely do not need to be removed.</p>
<hr>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, let's take a look at <code>Weight</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">71.715</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">214</span><span class="p">)][</span><span class="s1">'Weight'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>8       27
26      65
50      71
291    227
523    230
Name: Weight, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first 2 and last 2 donkeys in the list are far off from the cut-off and most likely should be removed. The middle donkey can be included.</p>
<hr>
<p>Since <code>WeightAlt</code> closely corresponds to <code>Weight</code>, we skip checking this column for anomalies. Summarizing what we have learned, here is how we want to filter our donkeys:</p>
<ul>
<li>Keep donkeys with <code>BCS</code> in the range 1.5 and 4</li>
<li>Keep donkeys with <code>Weight</code> between 71 and 214  </li>
</ul>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">donkeys_c</span> <span class="o">=</span> <span class="n">donkeys</span><span class="p">[(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">1.5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&amp;</span>
                         <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">71</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">donkeys</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">214</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-Test-Split">Train-Test Split<a class="anchor-link" href="#Train-Test-Split">¶</a></h2><p>Before we proceed with our data analysis, we divide our data into an 80/20 split, using 80% of our data to train our model and setting aside the other 20% for evaluation of the model.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">donkeys_c</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Weight'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                                                    <span class="n">donkeys_c</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">],</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                                                   <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>((431, 7), (108, 7))</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's also create a function that evaluates our predictions on the test set. Let's use mean squared error.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Exploratory-Data-Analysis-and-Visualization">Exploratory Data Analysis and Visualization<a class="anchor-link" href="#Exploratory-Data-Analysis-and-Visualization">¶</a></h2><p>As usual, we will explore our data before attempting to fit a model to it.</p>
<p>First, we will examine the categorical variables with boxplots.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_34_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems like median weight increases with BCS, but not linearly.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s1">'Sex'</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span>
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'female'</span><span class="p">,</span> <span class="s1">'stallion'</span><span class="p">,</span> <span class="s1">'gelding'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_36_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It seems like the sex of the donkey doesn't appear to cause much of a difference in weight.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">X_train</span><span class="p">[</span><span class="s1">'Age'</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">y_train</span><span class="p">,</span> 
            <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'&lt;2'</span><span class="p">,</span> <span class="s1">'2-5'</span><span class="p">,</span> <span class="s1">'5-10'</span><span class="p">,</span> <span class="s1">'10-15'</span><span class="p">,</span> <span class="s1">'15-20'</span><span class="p">,</span> <span class="s1">'&gt;20'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_38_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For donkeys over 5, the weight distribution is not too different.</p>
<p>Now, let's look at the quantitative variables. We can plot each of them against the target variable.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_40_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Girth'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_41_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_42_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>All three of our quantitative features have a linear relationship with our target variable of <code>Weight</code>, so we will not have to perform any transformations on our input data.</p>
<p>It is also a good idea to see if our features are linear with each other. We plot two below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_44_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Girth'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_45_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From these plots, we can see that our predictor variables also have strong linear relationships with each other. This makes our model harder to interpret, so we should keep this in mind after we create our model.</p>
<h2 id="Simpler-Linear-Models">Simpler Linear Models<a class="anchor-link" href="#Simpler-Linear-Models">¶</a></h2><p>Rather than using all of our data at once, let's try to fit linear models to one or two variables first.</p>
<p>Below are three simple linear regression models using just one quantitative variable. Which model appears to be the best?</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Length'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_47_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">'Length'</span><span class="p">]],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[[</span><span class="s1">'Length'</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MSE:"</span><span class="p">,</span> <span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE: 26052.58007702549
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Girth'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_49_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">'Girth'</span><span class="p">]],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[[</span><span class="s1">'Girth'</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MSE:"</span><span class="p">,</span> <span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE: 13248.814105932383
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">regplot</span><span class="p">(</span><span class="s1">'Height'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_51_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">'Height'</span><span class="p">]],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[[</span><span class="s1">'Height'</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MSE:"</span><span class="p">,</span> <span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE: 36343.308584306134
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the scatterplots and the mean squared errors, it seems like <code>Girth</code> is the best sole predictor of <code>Weight</code> as it has the strongest linear relationship with <code>Weight</code> and the smallest mean squared error.</p>
<p>Can we do better with two variables? Let's try fitting a linear model using both <code>Girth</code> and <code>Length</code>. Although it is not as easy to visualize this model, we can still look at the MSE of this model.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[[</span><span class="s1">'Girth'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">]],</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">[[</span><span class="s1">'Girth'</span><span class="p">,</span> <span class="s1">'Length'</span><span class="p">]])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MSE:"</span><span class="p">,</span> <span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE: 9680.902423377258
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wow! Looks like our MSE went down from around 13000 with just <code>Girth</code> alone to 10000 with <code>Girth</code> and <code>Length</code>. Using including the second variable improved our model.</p>
<p>We can also use categorical variables in our model. Let's now look at a linear model using the categorical variable of <code>Age</code>. This is the plot of <code>Age</code> versus <code>Weight</code>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">stripplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'Age'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'Weight'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s1">'&lt;2'</span><span class="p">,</span> <span class="s1">'2-5'</span><span class="p">,</span> <span class="s1">'5-10'</span><span class="p">,</span> <span class="s1">'10-15'</span><span class="p">,</span> <span class="s1">'15-20'</span><span class="p">,</span> <span class="s1">'&gt;20'</span><span class="p">]);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_56_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Seeing how <code>Age</code> is a categorical variable, we need to introduce dummy variables in order to produce a linear regression model.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">just_age_and_weight</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[[</span><span class="s1">'Age'</span><span class="p">,</span> <span class="s1">'Weight'</span><span class="p">]]</span>
<span class="n">with_age_dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">just_age_and_weight</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Age'</span><span class="p">])</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">with_age_dummies</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Weight'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">with_age_dummies</span><span class="p">[</span><span class="s1">'Weight'</span><span class="p">])</span>

<span class="n">just_age_and_weight_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[[</span><span class="s1">'Age'</span><span class="p">]]</span>
<span class="n">with_age_dummies_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">just_age_and_weight_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'Age'</span><span class="p">])</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">with_age_dummies_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"MSE:"</span><span class="p">,</span> <span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE: 41398.515625
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A MSE of around 40000 is worse than what we could get using any single one of the quantitative variables, but this variable could still prove to be useful in our linear model.</p>
<p>Let's try to interpret this linear model. Note that every donkey that falls into an age category, say 2-5 years of age, will receive the same prediction because they share the input values: a 1 in the column corresponding to 2-5 years of age, and 0 in all other columns. Thus, we can interpret categorical variables as simply changing the constant in the model because the categorical variable separates the donkeys into groups and gives one prediction for all donkeys within that group.</p>
<p>Our next step is to create a final model using both our categorical variables and multiple quantitative variables.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transforming-Variables">Transforming Variables<a class="anchor-link" href="#Transforming-Variables">¶</a></h2><p>Recall from our boxplots that <code>Sex</code> was not a useful variable, so we will drop it. We will also remove the <code>WeightAlt</code> column because we only have its value for 31 donkeys. Finally, using <code>get_dummies</code>, we transform the categorical variables <code>BCS</code> and <code>Age</code> into dummy variables so that we can include them in the model.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'Weight'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'max_columns'</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'WeightAlt'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">,</span> <span class="s1">'Age'</span><span class="p">])</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Length</th>
<th>Girth</th>
<th>Height</th>
<th>BCS_1.5</th>
<th>BCS_2.0</th>
<th>BCS_2.5</th>
<th>BCS_3.0</th>
<th>BCS_3.5</th>
<th>BCS_4.0</th>
<th>Age_10-15</th>
<th>Age_15-20</th>
<th>Age_2-5</th>
<th>Age_5-10</th>
<th>Age_&lt;2</th>
<th>Age_&gt;20</th>
</tr>
</thead>
<tbody>
<tr>
<th>465</th>
<td>98</td>
<td>113</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>233</th>
<td>101</td>
<td>119</td>
<td>101</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>450</th>
<td>106</td>
<td>125</td>
<td>103</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>453</th>
<td>93</td>
<td>120</td>
<td>100</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>452</th>
<td>98</td>
<td>120</td>
<td>108</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that we noticed that the weight distribution of donkeys over the age of 5 is not very different. Thus, let's combine the columns <code>Age_10-15</code>, <code>Age_15-20</code>, and <code>Age_&gt;20</code> into one column.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">age_over_10</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Age_10-15'</span><span class="p">]</span> <span class="o">|</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Age_15-20'</span><span class="p">]</span> <span class="o">|</span> <span class="n">X_train</span><span class="p">[</span><span class="s1">'Age_&gt;20'</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">[</span><span class="s1">'Age_&gt;10'</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_over_10</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Age_10-15'</span><span class="p">,</span> <span class="s1">'Age_15-20'</span><span class="p">,</span> <span class="s1">'Age_&gt;20'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since we do not want our matrix to be over-parameterized, we should drop one category from the <code>BCS</code> and <code>Age</code> dummies.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'BCS_3.0'</span><span class="p">,</span> <span class="s1">'Age_5-10'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Length</th>
<th>Girth</th>
<th>Height</th>
<th>BCS_1.5</th>
<th>BCS_2.0</th>
<th>BCS_2.5</th>
<th>BCS_3.5</th>
<th>BCS_4.0</th>
<th>Age_2-5</th>
<th>Age_&lt;2</th>
<th>Age_&gt;10</th>
</tr>
</thead>
<tbody>
<tr>
<th>465</th>
<td>98</td>
<td>113</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>233</th>
<td>101</td>
<td>119</td>
<td>101</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>450</th>
<td>106</td>
<td>125</td>
<td>103</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>453</th>
<td>93</td>
<td>120</td>
<td>100</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>452</th>
<td>98</td>
<td>120</td>
<td>108</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We should also add a column of biases in order to have a constant term in our model.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'bias'</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>Length</th>
<th>Girth</th>
<th>Height</th>
<th>BCS_1.5</th>
<th>BCS_2.0</th>
<th>BCS_2.5</th>
<th>BCS_3.5</th>
<th>BCS_4.0</th>
<th>Age_2-5</th>
<th>Age_&lt;2</th>
<th>Age_&gt;10</th>
</tr>
</thead>
<tbody>
<tr>
<th>465</th>
<td>1</td>
<td>98</td>
<td>113</td>
<td>99</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>233</th>
<td>1</td>
<td>101</td>
<td>119</td>
<td>101</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>450</th>
<td>1</td>
<td>106</td>
<td>125</td>
<td>103</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>453</th>
<td>1</td>
<td>93</td>
<td>120</td>
<td>100</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>452</th>
<td>1</td>
<td>98</td>
<td>120</td>
<td>108</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multiple-Linear-Regression-Model">Multiple Linear Regression Model<a class="anchor-link" href="#Multiple-Linear-Regression-Model">¶</a></h2><p>We are finally ready to fit our model to all of the variables we have deemed important and transformed into the proper form.</p>
<p>Our model looks like this:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="70.718ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 30447.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1030-Title">
<title id="MathJax-SVG-1030-Title">
f_\theta (\textbf{x}) = \theta_0 + \theta_1 (Length) + \theta_2 (Girth) + \theta_3 (Height) + ... + \theta_{11} (Age_&gt;10)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1919" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2586" y="0"></use>
<g transform="translate(3643,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4788" y="0"></use>
<g transform="translate(5789,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6712" y="0"></use>
 <use xlink:href="#MJMATHI-4C" x="7102" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="7783" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="8250" y="0"></use>
 <use xlink:href="#MJMATHI-67" x="8850" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="9331" y="0"></use>
 <use xlink:href="#MJMATHI-68" x="9692" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10269" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10881" y="0"></use>
<g transform="translate(11881,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12805" y="0"></use>
 <use xlink:href="#MJMATHI-47" x="13194" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="13981" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="14326" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="14778" y="0"></use>
 <use xlink:href="#MJMATHI-68" x="15139" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15716" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="16327" y="0"></use>
<g transform="translate(17328,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="663" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="18252" y="0"></use>
 <use xlink:href="#MJMATHI-48" x="18641" y="0"></use>
 <use xlink:href="#MJMATHI-65" x="19530" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="19996" y="0"></use>
 <use xlink:href="#MJMATHI-67" x="20342" y="0"></use>
 <use xlink:href="#MJMATHI-68" x="20822" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="21399" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21760" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="22150" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="22928" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="23373" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="23818" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="24264" y="0"></use>
<g transform="translate(25042,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
<g transform="translate(469,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="26319" y="0"></use>
 <use xlink:href="#MJMATHI-41" x="26709" y="0"></use>
 <use xlink:href="#MJMATHI-67" x="27459" y="0"></use>
<g transform="translate(27940,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3E" x="659" y="-213"></use>
</g>
<g transform="translate(29057,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="30058" y="0"></use>
</g>
</svg></span><p>Here are the functions we defined in the multiple linear regression lesson, which we will use again:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
    <span class="sd">'''Returns predictions by a linear model on x_vals.'''</span>
    <span class="k">return</span> <span class="n">X</span> <span class="o">@</span> <span class="n">thetas</span>

<span class="k">def</span> <span class="nf">mse_cost</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">linear_model</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">grad_mse_cost</span><span class="p">(</span><span class="n">thetas</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">2</span> <span class="o">/</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">y</span>  <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span> <span class="o">@</span> <span class="n">thetas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to use the above functions, we need <code>X</code>, and <code>y</code>. These can both be obtained from our data frames. Remember that <code>X</code> and <code>y</code> have to be numpy matrices in order to be able to multiply them with <code>@</code> notation.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we just need to call the <code>minimize</code> function defined in a previous section.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">thetas</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">mse_cost</span><span class="p">,</span> <span class="n">grad_mse_cost</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>theta: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.] | cost: 23979.72
theta: [0.01 0.53 0.65 0.56 0.   0.   0.   0.   0.   0.   0.   0.  ] | cost: 1214.03
theta: [-0.07  1.84  2.55 -2.87 -0.02 -0.13 -0.34  0.19  0.07 -0.22 -0.3   0.43] | cost: 1002.46
theta: [-0.25 -0.76  4.81 -3.06 -0.08 -0.38 -1.11  0.61  0.24 -0.66 -0.93  1.27] | cost: 815.50
theta: [-0.44 -0.33  4.08 -2.7  -0.14 -0.61 -1.89  1.02  0.4  -1.06 -1.57  2.09] | cost: 491.91
theta: [-1.52  0.85  2.   -1.58 -0.52 -2.22 -5.63  3.29  1.42 -2.59 -5.14  5.54] | cost: 140.86
theta: [-2.25  0.9   1.72 -1.3  -0.82 -3.52 -7.25  4.64  2.16 -2.95 -7.32  6.61] | cost: 130.33
theta: [ -4.16   0.84   1.32  -0.78  -1.65  -7.09 -10.4    7.82   4.18  -3.44
 -12.61   8.24] | cost: 116.92
theta: [ -5.89   0.75   1.17  -0.5   -2.45 -10.36 -11.81  10.04   6.08  -3.6
 -16.65   8.45] | cost: 110.37
theta: [ -7.75   0.67   1.13  -0.35  -3.38 -13.76 -11.84  11.55   8.2   -3.8
 -20.     7.55] | cost: 105.74
theta: [ -9.41   0.64   1.15  -0.31  -4.26 -16.36 -10.81  11.97  10.12  -4.33
 -21.88   6.15] | cost: 102.82
theta: [-11.08   0.66   1.17  -0.32  -5.18 -18.28  -9.43  11.61  11.99  -5.37
 -22.77   4.69] | cost: 100.70
theta: [-12.59   0.69   1.16  -0.32  -6.02 -19.17  -8.53  10.86  13.54  -6.65
 -22.89   3.73] | cost: 99.34
theta: [-14.2    0.72   1.14  -0.3   -6.89 -19.35  -8.29  10.03  14.98  -7.99
 -22.74   3.14] | cost: 98.30
theta: [-16.14   0.73   1.11  -0.26  -7.94 -19.03  -8.65   9.3   16.47  -9.18
 -22.59   2.76] | cost: 97.35
theta: [-18.68   0.73   1.1   -0.21  -9.27 -18.29  -9.42   8.76  18.14 -10.04
 -22.55   2.39] | cost: 96.38
theta: [-21.93   0.72   1.1   -0.17 -10.94 -17.19 -10.25   8.5   19.92 -10.36
 -22.66   1.99] | cost: 95.35
theta: [-26.08   0.7    1.13  -0.14 -13.03 -15.78 -10.79   8.54  21.78 -10.05
 -22.83   1.59] | cost: 94.18
theta: [-31.35   0.69   1.17  -0.13 -15.59 -14.12 -10.69   8.9   23.61  -9.19
 -22.93   1.32] | cost: 92.84
theta: [-37.51   0.7    1.21  -0.13 -18.44 -12.47  -9.79   9.52  25.14  -8.06
 -22.78   1.38] | cost: 91.40
theta: [-43.57   0.72   1.23  -0.12 -21.06 -11.3   -8.4   10.2   25.98  -7.16
 -22.24   1.87] | cost: 90.06
theta: [-48.96   0.74   1.23  -0.1  -23.13 -10.82  -7.13  10.76  26.06  -6.79
 -21.34   2.6 ] | cost: 88.89
theta: [-54.87   0.76   1.22  -0.05 -25.11 -10.88  -6.25  11.22  25.55  -6.8
 -20.04   3.41] | cost: 87.62
theta: [-63.83   0.78   1.21   0.02 -27.82 -11.42  -5.83  11.68  24.36  -6.96
 -17.97   4.26] | cost: 85.79
theta: [-77.9    0.8    1.22   0.13 -31.81 -12.47  -6.17  12.03  22.29  -6.98
 -14.93   4.9 ] | cost: 83.19
theta: [-94.94   0.81   1.26   0.23 -36.3  -13.73  -7.37  11.98  19.65  -6.47
 -11.73   4.88] | cost: 80.40
theta: [-108.1     0.81    1.34    0.28  -39.34  -14.55   -8.72   11.32   17.48
   -5.47   -9.92    4.21] | cost: 78.34
theta: [-115.07    0.81    1.4     0.29  -40.38  -14.75   -9.46   10.3    16.16
   -4.47   -9.7     3.5 ] | cost: 77.07
theta: [-119.8     0.81    1.44    0.28  -40.43  -14.6    -9.61    9.02   15.09
   -3.67  -10.25    3.05] | cost: 76.03
theta: [-125.16    0.82    1.47    0.3   -40.01  -14.23   -9.3     7.48   13.79
   -3.14  -11.09    2.94] | cost: 74.96
theta: [-131.24    0.83    1.48    0.33  -39.39  -13.76   -8.71    6.21   12.41
   -3.16  -11.79    3.17] | cost: 74.03
theta: [-137.42    0.84    1.48    0.39  -38.62  -13.25   -8.11    5.57   11.18
   -3.67  -12.11    3.47] | cost: 73.23
theta: [-144.82    0.85    1.47    0.46  -37.36  -12.53   -7.56    5.47    9.93
   -4.57  -12.23    3.56] | cost: 72.28
theta: [-155.48    0.86    1.48    0.54  -34.88  -11.3    -6.98    5.95    8.38
   -5.92  -12.27    3.13] | cost: 70.91
theta: [-167.86    0.88    1.52    0.62  -31.01   -9.63   -6.53    7.03    6.9
   -7.3   -12.29    1.91] | cost: 69.33
theta: [-176.09    0.89    1.57    0.64  -27.32   -8.32   -6.41    8.07    6.31
   -7.84  -12.29    0.44] | cost: 68.19
theta: [-178.63    0.9     1.6     0.62  -25.15   -7.88   -6.5     8.52    6.6
   -7.51  -12.19   -0.39] | cost: 67.59
theta: [-179.83    0.91    1.63    0.6   -23.4    -7.84   -6.6     8.61    7.27
   -6.83  -11.89   -0.72] | cost: 67.08
theta: [-182.79    0.91    1.66    0.58  -20.55   -8.01   -6.68    8.49    8.44
   -5.7   -11.11   -0.69] | cost: 66.27
theta: [-190.23    0.93    1.68    0.6   -15.62   -8.38   -6.68    8.1    10.26
   -4.1    -9.46    0.01] | cost: 65.11
theta: [-199.13    0.93    1.69    0.67  -11.37   -8.7    -6.55    7.67   11.53
   -3.17   -7.81    1.13] | cost: 64.28
theta: [-203.85    0.93    1.68    0.72  -10.03   -8.78   -6.42    7.5    11.68
   -3.25   -7.13    1.86] | cost: 64.01
theta: [-204.24    0.93    1.67    0.74  -10.33   -8.74   -6.39    7.52   11.46
   -3.52   -7.17    1.97] | cost: 63.98
theta: [-204.06    0.93    1.67    0.74  -10.48   -8.72   -6.39    7.54   11.39
   -3.59   -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
theta: [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95] | cost: 63.98
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our linear model is:</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.296ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 19502.6 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1031-Title">
<title id="MathJax-SVG-1031-Title">y = -204.03 + 0.93x_1 + ... -7.22x_{9} + 1.95x_{11}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1831" y="0"></use>
<g transform="translate(2610,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="2280" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5613" y="0"></use>
<g transform="translate(6614,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1279" y="0"></use>
</g>
<g transform="translate(8394,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9420" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="10198" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="10644" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="11089" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="11534" y="0"></use>
<g transform="translate(12312,0)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
<g transform="translate(14092,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="15341" y="0"></use>
<g transform="translate(16342,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
<g transform="translate(18122,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
</g>
</svg></span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compare this equation that we obtained to the one we would get if we had used <code>sklearn</code>'s LinearRegression model instead.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># We already accounted for it with the bias column</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">14</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Coefficients"</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Coefficients [-204.03    0.93    1.67    0.74  -10.5    -8.72   -6.39    7.54   11.39
   -3.6    -7.22    1.95]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The coefficients look exactly the same! Our homemade functions create the same model as an established Python package!</p>
<p>We successfully fit a linear model to our donkey data! Nice!</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluating-our-Model">Evaluating our Model<a class="anchor-link" href="#Evaluating-our-Model">¶</a></h2><p>Our next step is to evaluate our model's performance on the test set. We need to perform the same data pre-processing steps on the test set as we did on the training set before we can pass it into our model.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Sex'</span><span class="p">,</span> <span class="s1">'WeightAlt'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'BCS'</span><span class="p">,</span> <span class="s1">'Age'</span><span class="p">])</span>
<span class="n">age_over_10</span> <span class="o">=</span> <span class="n">X_test</span><span class="p">[</span><span class="s1">'Age_10-15'</span><span class="p">]</span> <span class="o">|</span> <span class="n">X_test</span><span class="p">[</span><span class="s1">'Age_15-20'</span><span class="p">]</span> <span class="o">|</span> <span class="n">X_test</span><span class="p">[</span><span class="s1">'Age_&gt;20'</span><span class="p">]</span>
<span class="n">X_test</span><span class="p">[</span><span class="s1">'Age_&gt;10'</span><span class="p">]</span> <span class="o">=</span> <span class="n">age_over_10</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'Age_10-15'</span><span class="p">,</span> <span class="s1">'Age_15-20'</span><span class="p">,</span> <span class="s1">'Age_&gt;20'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">'BCS_3.0'</span><span class="p">,</span> <span class="s1">'Age_5-10'</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'bias'</span><span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>Length</th>
<th>Girth</th>
<th>Height</th>
<th>BCS_1.5</th>
<th>BCS_2.0</th>
<th>BCS_2.5</th>
<th>BCS_3.5</th>
<th>BCS_4.0</th>
<th>Age_2-5</th>
<th>Age_&lt;2</th>
<th>Age_&gt;10</th>
</tr>
</thead>
<tbody>
<tr>
<th>490</th>
<td>1</td>
<td>98</td>
<td>119</td>
<td>103</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>75</th>
<td>1</td>
<td>86</td>
<td>114</td>
<td>105</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>352</th>
<td>1</td>
<td>94</td>
<td>114</td>
<td>101</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>182</th>
<td>1</td>
<td>94</td>
<td>114</td>
<td>102</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>334</th>
<td>1</td>
<td>104</td>
<td>113</td>
<td>105</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>543</th>
<td>1</td>
<td>104</td>
<td>124</td>
<td>110</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>108 rows × 12 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We pass <code>X_test</code> into <code>predict</code> of our <code>LinearRegression</code> model:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">values</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's look at the mean squared error:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mse_test_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>7261.974205350604</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With these predictions, we can also make a residual plot:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">values</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">predictions</span>
<span class="n">resid_prop</span> <span class="o">=</span> <span class="n">resid</span> <span class="o">/</span> <span class="n">y_test</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resid_prop</span><span class="p">)),</span> <span class="n">resid_prop</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Residual proportions (resid / actual Weight)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Index of row in data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Error proportion'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/linear_case_study_92_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looks like our model does pretty well! The residual proportions indicate that our predictions are mostly within 15% of the correct value.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/14'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Feature-Engineering">Feature Engineering<a class="anchor-link" href="#Feature-Engineering">¶</a></h1><p>Feature engineering refers to the practice of creating and adding new features
to the dataset itself in order to add complexity to our models.</p>
<p>So far we have only conducted linear regression using numerical features
as the input—we used the (numeric) total bill in order to predict the tip
amount. However, the tip dataset also contained categorical data, such as the
day of week and the meal type. Feature engineering allows us to convert
categorical variables into numerical features for linear regression.</p>
<p>Feature engineering also allows us to use our linear regression model to
conduct polynomial regression by creating new variables in our dataset.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/14'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">display</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Walmart-dataset">The Walmart dataset<a class="anchor-link" href="#The-Walmart-dataset">¶</a></h2><p>In 2014, Walmart released some of its sales data as part of a competition to predict the weekly sales of its stores. We've taken a subset of their data and loaded it below.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">walmart</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'walmart.csv'</span><span class="p">)</span>
<span class="n">walmart</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Date</th>
<th>Weekly_Sales</th>
<th>IsHoliday</th>
<th>Temperature</th>
<th>Fuel_Price</th>
<th>Unemployment</th>
<th>MarkDown</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2010-02-05</td>
<td>24924.50</td>
<td>No</td>
<td>42.31</td>
<td>2.572</td>
<td>8.106</td>
<td>No Markdown</td>
</tr>
<tr>
<th>1</th>
<td>2010-02-12</td>
<td>46039.49</td>
<td>Yes</td>
<td>38.51</td>
<td>2.548</td>
<td>8.106</td>
<td>No Markdown</td>
</tr>
<tr>
<th>2</th>
<td>2010-02-19</td>
<td>41595.55</td>
<td>No</td>
<td>39.93</td>
<td>2.514</td>
<td>8.106</td>
<td>No Markdown</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>140</th>
<td>2012-10-12</td>
<td>22764.01</td>
<td>No</td>
<td>62.99</td>
<td>3.601</td>
<td>6.573</td>
<td>MarkDown2</td>
</tr>
<tr>
<th>141</th>
<td>2012-10-19</td>
<td>24185.27</td>
<td>No</td>
<td>67.97</td>
<td>3.594</td>
<td>6.573</td>
<td>MarkDown2</td>
</tr>
<tr>
<th>142</th>
<td>2012-10-26</td>
<td>27390.81</td>
<td>No</td>
<td>69.16</td>
<td>3.506</td>
<td>6.573</td>
<td>MarkDown1</td>
</tr>
</tbody>
</table>
<p>143 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The data contains several interesting features, including whether a week contained a holiday (<code>IsHoliday</code>), the unemployment rate that week (<code>Unemployment</code>), and which special deals the store offered that week (<code>MarkDown</code>).</p>
<p>Our goal is to create a model that predicts the <code>Weekly_Sales</code> variable using the other variables in our data. Using a linear regression model we directly can use the <code>Temperature</code>, <code>Fuel_Price</code>, and <code>Unemployment</code> columns because they contain numerical data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-a-Model-Using-Scikit-Learn">Fitting a Model Using Scikit-Learn<a class="anchor-link" href="#Fitting-a-Model-Using-Scikit-Learn">¶</a></h2><p>In previous sections we have seen how to take the gradient of the cost function and use gradient descent to fit a model. To do this, we had to define Python functions for our model, the cost function, the gradient of the cost function, and the gradient descent algorithm. While this was important to demonstrate how the concepts work, in this section we will instead use a machine learning library called <a href="http://scikit-learn.org/"><code>scikit-learn</code></a> which allows us to fit a model with less code.</p>
<p>For example, to fit a multiple linear regression model using the numerical columns in the Walmart dataset, we first create a two-dimensional NumPy array containing the variables used for prediction and a one-dimensional array containing the values we want to predict:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">numerical_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Temperature'</span><span class="p">,</span> <span class="s1">'Fuel_Price'</span><span class="p">,</span> <span class="s1">'Unemployment'</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">walmart</span><span class="p">[</span><span class="n">numerical_columns</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([[ 42.31,   2.57,   8.11],
       [ 38.51,   2.55,   8.11],
       [ 39.93,   2.51,   8.11],
       ..., 
       [ 62.99,   3.6 ,   6.57],
       [ 67.97,   3.59,   6.57],
       [ 69.16,   3.51,   6.57]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">walmart</span><span class="p">[</span><span class="s1">'Weekly_Sales'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([ 24924.5 ,  46039.49,  41595.55, ...,  22764.01,  24185.27,
        27390.81])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we import the <code>LinearRegression</code> class from <code>scikit-learn</code> (<a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression">docs</a>), instantiate it, and call the <code>fit</code> method using <code>X</code> to predict <code>y</code>.</p>
<p>Note that previously we had to manually add a column of all <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1032-Title">
<title id="MathJax-SVG-1032-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>'s to the <code>X</code> matrix in order to conduct linear regression with an intercept. This time, <code>scikit-learn</code> will take care of the intercept column behind the scenes, saving us some work.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="n">simple_classifier</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">simple_classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are done! When we called <code>.fit</code>, <code>scikit-learn</code> found the linear regression parameters that minimized the least squares cost function. We can see the parameters below:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_classifier</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">simple_classifier</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(array([ -332.22,  1626.63,  1356.87]), 29642.700510138635)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To calculate the mean squared cost, we can ask the classifier to make predictions for the input data <code>X</code> and compare the predictions with the actual values <code>y</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">simple_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">predictions</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>74401210.603607252</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The mean squared error looks quite high. This is likely because our variables (temperature, price of fuel, and unemployment rate) are only weakly correlated with the weekly sales.</p>
<p>There are two more variables in our data that might be more useful for prediction: the <code>IsHoliday</code> column and <code>MarkDown</code> column. The boxplot below shows that holidays may have some relation with the weekly sales.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'IsHoliday'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'Weekly_Sales'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">walmart</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_one_hot_15_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The different markdown categories seem to correlate with different weekly sale amounts well.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">markdowns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'No Markdown'</span><span class="p">,</span> <span class="s1">'MarkDown1'</span><span class="p">,</span> <span class="s1">'MarkDown2'</span><span class="p">,</span> <span class="s1">'MarkDown3'</span><span class="p">,</span> <span class="s1">'MarkDown4'</span><span class="p">,</span> <span class="s1">'MarkDown5'</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pointplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'Weekly_Sales'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'MarkDown'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">walmart</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">markdowns</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_one_hot_17_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>However, both <code>IsHoliday</code> and <code>MarkDown</code> columns contain categorical data, not numerical, so we cannot use them as-is for regression.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-One-Hot-Encoding">The One-Hot Encoding<a class="anchor-link" href="#The-One-Hot-Encoding">¶</a></h2><p>Fortunately, we can perform a <strong>one-hot encoding</strong> transformation on these categorical variables to convert them into numerical variables. The transformation works as follows: create a new column for every unique value in a categorical variable. The column contains a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1033-Title">
<title id="MathJax-SVG-1033-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span> if the variable originally had the corresponding value, otherwise the column contains a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1034-Title">
<title id="MathJax-SVG-1034-Title">0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>. For example, the <code>MarkDown</code> column below contains the following values:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">walmart</span><span class="p">[[</span><span class="s1">'MarkDown'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>MarkDown</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>No Markdown</td>
</tr>
<tr>
<th>1</th>
<td>No Markdown</td>
</tr>
<tr>
<th>2</th>
<td>No Markdown</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>140</th>
<td>MarkDown2</td>
</tr>
<tr>
<th>141</th>
<td>MarkDown2</td>
</tr>
<tr>
<th>142</th>
<td>MarkDown1</td>
</tr>
</tbody>
</table>
<p>143 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This variable contains six different unique values: 'No Markdown', 'MarkDown1', 'MarkDown2', 'MarkDown3', 'MarkDown4', and 'MarkDown5'. We create one column for each value to get six columns in total. Then, we fill in the columns with zeros and ones according the scheme described above.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="k">import</span> <span class="n">DictVectorizer</span>

<span class="n">items</span> <span class="o">=</span> <span class="n">walmart</span><span class="p">[[</span><span class="s1">'MarkDown'</span><span class="p">]]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">'records'</span><span class="p">)</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">DictVectorizer</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">items</span><span class="p">),</span>
    <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">feature_names_</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>MarkDown=MarkDown1</th>
<th>MarkDown=MarkDown2</th>
<th>MarkDown=MarkDown3</th>
<th>MarkDown=MarkDown4</th>
<th>MarkDown=MarkDown5</th>
<th>MarkDown=No Markdown</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr>
<th>1</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr>
<th>2</th>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>1.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>140</th>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>141</th>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
<tr>
<th>142</th>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
<td>0.0</td>
</tr>
</tbody>
</table>
<p>143 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the first value in the data is "No Markdown", and thus only the last column of the first row in the transformed table is marked with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1035-Title">
<title id="MathJax-SVG-1035-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>. In addition, the last value in the data is "MarkDown1" which results in the first column of row 142 marked as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1036-Title">
<title id="MathJax-SVG-1036-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>Each row of the resulting table will contain a single column containing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1037-Title">
<title id="MathJax-SVG-1037-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>; the rest will contain <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1038-Title">
<title id="MathJax-SVG-1038-Title">0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>. The name "one-hot" reflects the fact that only one column is "hot" (marked with a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1039-Title">
<title id="MathJax-SVG-1039-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="One-Hot-Encoding-in-Scikit-Learn">One-Hot Encoding in Scikit-Learn<a class="anchor-link" href="#One-Hot-Encoding-in-Scikit-Learn">¶</a></h2><p>To perform one-hot encoding we can use <code>scikit-learn</code>'s <a href="http://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.DictVectorizer.html"><code>DictVectorizer</code></a> class. To use the class, we have to convert our dataframe into a list of dictionaries. The DictVectorizer class automatically one-hot encodes the categorical data (which needs to be strings) and leaves numerical data untouched.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="k">import</span> <span class="n">DictVectorizer</span>

<span class="n">all_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Temperature'</span><span class="p">,</span> <span class="s1">'Fuel_Price'</span><span class="p">,</span> <span class="s1">'Unemployment'</span><span class="p">,</span> <span class="s1">'IsHoliday'</span><span class="p">,</span>
               <span class="s1">'MarkDown'</span><span class="p">]</span>

<span class="n">records</span> <span class="o">=</span> <span class="n">walmart</span><span class="p">[</span><span class="n">all_columns</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">'records'</span><span class="p">)</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">DictVectorizer</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">encoded_X</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
<span class="n">encoded_X</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([[  2.57,   1.  ,   0.  , ...,   1.  ,  42.31,   8.11],
       [  2.55,   0.  ,   1.  , ...,   1.  ,  38.51,   8.11],
       [  2.51,   1.  ,   0.  , ...,   1.  ,  39.93,   8.11],
       ..., 
       [  3.6 ,   1.  ,   0.  , ...,   0.  ,  62.99,   6.57],
       [  3.59,   1.  ,   0.  , ...,   0.  ,  67.97,   6.57],
       [  3.51,   1.  ,   0.  , ...,   0.  ,  69.16,   6.57]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To get a better sense of the transformed data, we can display it with the column names:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">encoded_X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">encoder</span><span class="o">.</span><span class="n">feature_names_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Fuel_Price</th>
<th>IsHoliday=No</th>
<th>IsHoliday=Yes</th>
<th>MarkDown=MarkDown1</th>
<th>...</th>
<th>MarkDown=MarkDown5</th>
<th>MarkDown=No Markdown</th>
<th>Temperature</th>
<th>Unemployment</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>2.572</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>42.31</td>
<td>8.106</td>
</tr>
<tr>
<th>1</th>
<td>2.548</td>
<td>0.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>38.51</td>
<td>8.106</td>
</tr>
<tr>
<th>2</th>
<td>2.514</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>1.0</td>
<td>39.93</td>
<td>8.106</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>140</th>
<td>3.601</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>62.99</td>
<td>6.573</td>
</tr>
<tr>
<th>141</th>
<td>3.594</td>
<td>1.0</td>
<td>0.0</td>
<td>0.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>67.97</td>
<td>6.573</td>
</tr>
<tr>
<th>142</th>
<td>3.506</td>
<td>1.0</td>
<td>0.0</td>
<td>1.0</td>
<td>...</td>
<td>0.0</td>
<td>0.0</td>
<td>69.16</td>
<td>6.573</td>
</tr>
</tbody>
</table>
<p>143 rows × 11 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The numerical variables (fuel price, temperature, and unemployment) are left as numbers. The categorical variables (holidays and markdown) are one-hot encoded. When we use the new matrix of data to fit a linear regression model, we will generate one parameter for each column of the data. Since this data matrix contains eleven columns, the model will have twelve parameters since we fit extra parameter for the intercept term.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-a-Model-Using-the-Transformed-Data">Fitting a Model Using the Transformed Data<a class="anchor-link" href="#Fitting-a-Model-Using-the-Transformed-Data">¶</a></h2><p>We can now use the <code>encoded_X</code> variable for linear regression.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">encoded_X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=1, normalize=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As promised, we have eleven parameters for the columns and one intercept parameter.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(array([ 1622.11,    -2.04,     2.04,   962.91,  1805.06, -1748.48,
        -2336.8 ,   215.06,  1102.25,  -330.91,  1205.56]), 29723.135729284979)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compare a few of the predictions from both classifiers to see whether there's a large difference between the two.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">walmart</span><span class="p">[[</span><span class="s1">'Weekly_Sales'</span><span class="p">]]</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span>
    <span class="n">pred_numeric</span><span class="o">=</span><span class="n">simple_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span>
    <span class="n">pred_both</span><span class="o">=</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">encoded_X</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Weekly_Sales</th>
<th>pred_numeric</th>
<th>pred_both</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>24924.50</td>
<td>30768.878035</td>
<td>30766.790214</td>
</tr>
<tr>
<th>1</th>
<td>46039.49</td>
<td>31992.279504</td>
<td>31989.410395</td>
</tr>
<tr>
<th>2</th>
<td>41595.55</td>
<td>31465.220158</td>
<td>31460.280008</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>140</th>
<td>22764.01</td>
<td>23492.262649</td>
<td>24447.348979</td>
</tr>
<tr>
<th>141</th>
<td>24185.27</td>
<td>21826.414794</td>
<td>22788.049554</td>
</tr>
<tr>
<th>142</th>
<td>27390.81</td>
<td>21287.928537</td>
<td>21409.367463</td>
</tr>
</tbody>
</table>
<p>143 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It appears that both models make very similar predictions. A scatter plot of both sets of predictions confirms this.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">simple_classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">),</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">encoded_X</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Predictions using all data vs. numerical features only'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Predictions using numerical features'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Predictions using all features'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_one_hot_36_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Diagnosis">Model Diagnosis<a class="anchor-link" href="#Model-Diagnosis">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Why might this be the case? We can examine the parameters that both models learn. The table below shows the weights learned by the classifier that only used numerical variables without one-hot encoding:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">clf_params</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">clf</span><span class="p">):</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">coef_</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">names</span> <span class="o">+</span> <span class="p">[</span><span class="s1">'Intercept'</span><span class="p">])</span>

<span class="n">clf_params</span><span class="p">(</span><span class="n">numerical_columns</span><span class="p">,</span> <span class="n">simple_classifier</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<th>Temperature</th>
<td>-332.221180</td>
</tr>
<tr>
<th>Fuel_Price</th>
<td>1626.625604</td>
</tr>
<tr>
<th>Unemployment</th>
<td>1356.868319</td>
</tr>
<tr>
<th>Intercept</th>
<td>29642.700510</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The table below shows the weights learned by the classifier with one-hot encoding.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">13</span>
<span class="n">display</span><span class="p">(</span><span class="n">clf_params</span><span class="p">(</span><span class="n">encoder</span><span class="o">.</span><span class="n">feature_names_</span><span class="p">,</span> <span class="n">clf</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>0</th>
</tr>
</thead>
<tbody>
<tr>
<th>Fuel_Price</th>
<td>1622.106239</td>
</tr>
<tr>
<th>IsHoliday=No</th>
<td>-2.041451</td>
</tr>
<tr>
<th>IsHoliday=Yes</th>
<td>2.041451</td>
</tr>
<tr>
<th>MarkDown=MarkDown1</th>
<td>962.908849</td>
</tr>
<tr>
<th>MarkDown=MarkDown2</th>
<td>1805.059613</td>
</tr>
<tr>
<th>MarkDown=MarkDown3</th>
<td>-1748.475046</td>
</tr>
<tr>
<th>MarkDown=MarkDown4</th>
<td>-2336.799791</td>
</tr>
<tr>
<th>MarkDown=MarkDown5</th>
<td>215.060616</td>
</tr>
<tr>
<th>MarkDown=No Markdown</th>
<td>1102.245760</td>
</tr>
<tr>
<th>Temperature</th>
<td>-330.912587</td>
</tr>
<tr>
<th>Unemployment</th>
<td>1205.564331</td>
</tr>
<tr>
<th>Intercept</th>
<td>29723.135729</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that even when we fit a linear regression model using one-hot encoded columns the weights for fuel price, temperature, and unemployment are very similar to the previous values. All the weights are small in comparison to the intercept term, suggesting that most of the variables are still only slightly correlated with the actual sale amounts. In fact, the model weights for the <code>IsHoliday</code> variable are so low that it makes nearly no difference in prediction whether the date was a holiday or not. Although some of the <code>MarkDown</code> weights are rather large, many markdown events only appear a few times in the dataset.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">walmart</span><span class="p">[</span><span class="s1">'MarkDown'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>No Markdown    92
MarkDown1      25
MarkDown2      13
MarkDown5       9
MarkDown4       2
MarkDown3       2
Name: MarkDown, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This suggests that we probably need to collect more data in order for the model to better utilize the effects of markdown events on the sale amounts. (In reality, the dataset shown here is a small subset of a <a href="https://www.kaggle.com/c/walmart-recruiting-store-sales-forecasting">much larger dataset</a> released by Walmart. It will be a useful exercise to train a model using the entire dataset instead of a small subset.)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have learned to use one-hot encoding, a useful technique for conducting linear regression on categorical data. Although in this particular example the transformation didn't affect our model very much, in practice the technique is used widely when working with categorical data. One-hot encoding also illustrates the general principle of feature engineering—it takes an original data matrix and transforms it into a potentially more useful one.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/14'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># To determine which columns to regress</span>
<span class="c1"># ice_orig = pd.read_csv('icecream_orig.csv')</span>
<span class="c1"># cols = ['aerated', 'afterfeel', 'almond', 'buttery', 'color', 'cooling',</span>
<span class="c1">#        'creamy', 'doughy', 'eggy', 'fat', 'fat_level', 'fatty', 'hardness',</span>
<span class="c1">#        'ice_crystals', 'id', 'liking_flavor', 'liking_texture', 'melt_rate',</span>
<span class="c1">#        'melting_rate', 'milky', 'sugar', 'sugar_level', 'sweetness',</span>
<span class="c1">#        'tackiness', 'vanilla']</span>

<span class="c1"># melted = ice_orig.melt(id_vars='overall', value_vars=cols, var_name='type')</span>
<span class="c1"># sns.lmplot(x='value', y='overall', col='type', col_wrap=5, data=melted,</span>
<span class="c1">#            sharex=False, fit_reg=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predicting-Ice-Cream-Ratings">Predicting Ice Cream Ratings<a class="anchor-link" href="#Predicting-Ice-Cream-Ratings">¶</a></h2><p>Suppose we are trying to create new, popular ice cream flavors. We are interested in the following regression problem: given the sweetness of an ice cream flavor, predict its overall taste rating out of 7.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'icecream.csv'</span><span class="p">)</span>
<span class="n">ice</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sweetness</th>
<th>overall</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>4.1</td>
<td>3.9</td>
</tr>
<tr>
<th>1</th>
<td>6.9</td>
<td>5.4</td>
</tr>
<tr>
<th>2</th>
<td>8.3</td>
<td>5.8</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>11.0</td>
<td>5.9</td>
</tr>
<tr>
<th>7</th>
<td>11.7</td>
<td>5.5</td>
</tr>
<tr>
<th>8</th>
<td>11.9</td>
<td>5.4</td>
</tr>
</tbody>
</table>
<p>9 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we expect that an ice cream flavor that is not sweet enough would receive a low rating, we also expect that an ice flavor that is too sweet would also receive a low rating. This is reflected in the scatter plot of overall rating and sweetness:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sweetness'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'overall'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Overall taste rating vs. sweetness'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately, a linear model alone cannot take this increase-then-decrease behavior into account; in a linear model, the overall rating can only increase or decrease monotonically with the sweetness. We can see that using linear regression results in a poor fit.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sweetness'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'overall'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ice</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Overall taste rating vs. sweetness'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One useful approach for this problem is to fit a polynomial curve instead of line. Such a curve would allow us to model the fact that the overall rating increases with sweetness only up to a certain point, then decreases as sweetness increases.</p>
<p>With a feature engineering technique, we can simply add new columns to our data to use our linear model for polynomial regression.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Polynomial-Features">Polynomial Features<a class="anchor-link" href="#Polynomial-Features">¶</a></h2><p>Recall that in linear regression we fit one weight for each column of our data matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1040-Title">
<title id="MathJax-SVG-1040-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>. In this case, our matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1041-Title">
<title id="MathJax-SVG-1041-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> contains two columns: a column of all ones and the sweetness.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">first_X</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">first_X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'sweetness'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>sweetness</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1.0</td>
<td>4.1</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>6.9</td>
</tr>
<tr>
<th>2</th>
<td>1.0</td>
<td>8.3</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>1.0</td>
<td>11.0</td>
</tr>
<tr>
<th>7</th>
<td>1.0</td>
<td>11.7</td>
</tr>
<tr>
<th>8</th>
<td>1.0</td>
<td>11.9</td>
</tr>
</tbody>
</table>
<p>9 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model is thus:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.154ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 11691.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1042-Title">
<title id="MathJax-SVG-1042-Title">
f_\hat{\theta} (x) = \hat{\theta_0} + \hat{\theta_1} \cdot \text{sweetness}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4858" y="0"></use>
<g transform="translate(5859,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="7005" y="0"></use>
<g transform="translate(7505,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can create a new column in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1043-Title">
<title id="MathJax-SVG-1043-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> containing the squared values of the sweetness.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">second_X</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">second_X</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'sweetness'</span><span class="p">,</span> <span class="s1">'sweetness^2'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>sweetness</th>
<th>sweetness^2</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1.0</td>
<td>4.1</td>
<td>16.81</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>6.9</td>
<td>47.61</td>
</tr>
<tr>
<th>2</th>
<td>1.0</td>
<td>8.3</td>
<td>68.89</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>1.0</td>
<td>11.0</td>
<td>121.00</td>
</tr>
<tr>
<th>7</th>
<td>1.0</td>
<td>11.7</td>
<td>136.89</td>
</tr>
<tr>
<th>8</th>
<td>1.0</td>
<td>11.9</td>
<td>141.61</td>
</tr>
</tbody>
</table>
<p>9 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since our model learns one weight for each column of its input matrix, our model will become:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.594ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 19200.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1044-Title">
<title id="MathJax-SVG-1044-Title">
f_\hat{\theta} (x) = \hat{\theta_0}
    + \hat{\theta_1} \cdot \text{sweetness}
    + \hat{\theta_2} \cdot \text{sweetness}^2
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4858" y="0"></use>
<g transform="translate(5859,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="7005" y="0"></use>
<g transform="translate(7505,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="11913" y="0"></use>
<g transform="translate(12914,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="14060" y="0"></use>
<g transform="translate(14560,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="5919" y="583"></use>
</g>
</g>
</svg></span><p>Our model now fits a polynomial with degree two to our data. We can easily fit higher degree polynomials by adding columns for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.775ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 4639.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1045-Title">
<title id="MathJax-SVG-1045-Title"> \text{sweetness}^3 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="5919" y="513"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.775ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 4639.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1046-Title">
<title id="MathJax-SVG-1046-Title"> \text{sweetness}^4 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="5919" y="513"></use>
</g>
</svg></span>, and so on.</p>
<p>Notice that this model is still a linear model because it is <strong>linear in its parameters</strong>—each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.89ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 813.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1047-Title">
<title id="MathJax-SVG-1047-Title"> \hat{\theta_i} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="156" y="283"></use>
</g>
</svg></span> is a scalar value of degree one. However, the model is <strong>polynomial in its features</strong> because its input data contains a column that is a polynomial transformation of another column.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Polynomial-Regression">Polynomial Regression<a class="anchor-link" href="#Polynomial-Regression">¶</a></h2><p>To conduct polynomial regression, we use a linear model with polynomial features. Thus, we import the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html#sklearn.linear_model.LinearRegression"><code>LinearRegression</code></a> model and <a href="http://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html#sklearn.preprocessing.PolynomialFeatures"><code>PolynomialFeatures</code></a> transform from <code>scikit-learn</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our original data matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1048-Title">
<title id="MathJax-SVG-1048-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> contains the following values. Remember that we include the column and row labels for reference purposes only; the actual <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1049-Title">
<title id="MathJax-SVG-1049-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> matrix only contains the numerical data in the table below.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sweetness</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>4.1</td>
</tr>
<tr>
<th>1</th>
<td>6.9</td>
</tr>
<tr>
<th>2</th>
<td>8.3</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>11.0</td>
</tr>
<tr>
<th>7</th>
<td>11.7</td>
</tr>
<tr>
<th>8</th>
<td>11.9</td>
</tr>
</tbody>
</table>
<p>9 rows × 1 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We first use the <code>PolynomialFeatures</code> class to transform the data, adding polynomial features of degree 2.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">transformer</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([[  1.  ,   4.1 ,  16.81],
       [  1.  ,   6.9 ,  47.61],
       [  1.  ,   8.3 ,  68.89],
       ...,
       [  1.  ,  11.  , 121.  ],
       [  1.  ,  11.7 , 136.89],
       [  1.  ,  11.9 , 141.61]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we fit a linear model to this data matrix.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">])</span>
<span class="n">clf</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([-1.3 ,  1.6 , -0.09])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The parameters above show that for this dataset, the best-fit model is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.046ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 21547.4 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1050-Title">
<title id="MathJax-SVG-1050-Title">
f_\hat{\theta} (x) = -1.3 + 1.6 \cdot \text{sweetness} - 0.09 \cdot \text{sweetness}^2
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3713" y="0"></use>
<g transform="translate(4491,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5993" y="0"></use>
<g transform="translate(6994,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="8495" y="0"></use>
<g transform="translate(8996,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="13404" y="0"></use>
<g transform="translate(14405,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="16407" y="0"></use>
<g transform="translate(16908,0)">
 <use xlink:href="#MJMAIN-73"></use>
 <use xlink:href="#MJMAIN-77" x="394" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1117" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1561" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2006" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="2395" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2952" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3396" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3791" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="5919" y="583"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now compare this model's predictions against the original data.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sweetness'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'overall'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 2 polynomial fit'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_27_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This model looks like a much better fit than our linear model. We can also verify that the mean squared cost for the degree 2 polynomial fit is much lower than the cost for the linear fit.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span>
<span class="n">pred_linear</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">first_X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">first_X</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">pred_quad</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">mse_cost</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">pred</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for linear reg:     {mse_cost(pred_linear, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 2 poly reg: {mse_cost(pred_quad, y):.3f}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE cost for linear reg:     0.323
MSE cost for deg 2 poly reg: 0.032
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Increasing-the-Degree">Increasing the Degree<a class="anchor-link" href="#Increasing-the-Degree">¶</a></h2><p>As mentioned earlier, we are free to add higher degree polynomial features to our data. For example, we can easily create polynomial features of degree 5:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">second_X</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">second_X</span><span class="p">,</span>
             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'bias'</span><span class="p">,</span> <span class="s1">'sweetness'</span><span class="p">,</span> <span class="s1">'sweetness^2'</span><span class="p">,</span> <span class="s1">'sweetness^3'</span><span class="p">,</span>
                      <span class="s1">'sweetness^4'</span><span class="p">,</span> <span class="s1">'sweetness^5'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>bias</th>
<th>sweetness</th>
<th>sweetness^2</th>
<th>sweetness^3</th>
<th>sweetness^4</th>
<th>sweetness^5</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1.0</td>
<td>4.1</td>
<td>16.81</td>
<td>68.921</td>
<td>282.5761</td>
<td>1158.56201</td>
</tr>
<tr>
<th>1</th>
<td>1.0</td>
<td>6.9</td>
<td>47.61</td>
<td>328.509</td>
<td>2266.7121</td>
<td>15640.31349</td>
</tr>
<tr>
<th>2</th>
<td>1.0</td>
<td>8.3</td>
<td>68.89</td>
<td>571.787</td>
<td>4745.8321</td>
<td>39390.40643</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>1.0</td>
<td>11.0</td>
<td>121.00</td>
<td>1331.000</td>
<td>14641.0000</td>
<td>161051.00000</td>
</tr>
<tr>
<th>7</th>
<td>1.0</td>
<td>11.7</td>
<td>136.89</td>
<td>1601.613</td>
<td>18738.8721</td>
<td>219244.80357</td>
</tr>
<tr>
<th>8</th>
<td>1.0</td>
<td>11.9</td>
<td>141.61</td>
<td>1685.159</td>
<td>20053.3921</td>
<td>238635.36599</td>
</tr>
</tbody>
</table>
<p>9 rows × 6 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fitting a linear model using these features results in a degree five polynomial regression.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">trans_five</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">X_five</span> <span class="o">=</span> <span class="n">trans_five</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">clf_five</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_five</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sweetness'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'overall'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf_five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trans_five</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 5 polynomial fit'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_33_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plot shows that a degree five polynomial seems to fit the data roughly as well as a degree two polynomial. In fact, the mean squared cost for the degree five polynomial is almost half of the cost for the degree two polynomial.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pred_five</span> <span class="o">=</span> <span class="n">clf_five</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_five</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for linear reg:     {mse_cost(pred_linear, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 2 poly reg: {mse_cost(pred_quad, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 5 poly reg: {mse_cost(pred_five, y):.3f}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE cost for linear reg:     0.323
MSE cost for deg 2 poly reg: 0.032
MSE cost for deg 5 poly reg: 0.017
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This suggests that we might do even better by increasing the degree even more. Why not a degree 10 polynomial?</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">trans_ten</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">X_ten</span> <span class="o">=</span> <span class="n">trans_ten</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">clf_ten</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_ten</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sweetness'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'overall'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf_ten</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trans_ten</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 10 polynomial fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_37_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Here are the mean squared costs for the regression models we've seen thus far:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pred_ten</span> <span class="o">=</span> <span class="n">clf_ten</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_ten</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for linear reg:      {mse_cost(pred_linear, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 2 poly reg:  {mse_cost(pred_quad, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 5 poly reg:  {mse_cost(pred_five, y):.3f}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'MSE cost for deg 10 poly reg: {mse_cost(pred_ten, y):.3f}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>MSE cost for linear reg:      0.323
MSE cost for deg 2 poly reg:  0.032
MSE cost for deg 5 poly reg:  0.017
MSE cost for deg 10 poly reg: 0.000
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The degree 10 polynomial has a cost of zero! This makes sense if we take a closer look at the plot; the degree ten polynomial manages to pass through the precise location of each point in the data.</p>
<p>However, you should feel hesitant to use the degree 10 polynomial to predict ice cream ratings. Intuitively, the degree 10 polynomial seems to fit our specific set of data too closely. If we take another set of data and plot them on the scatter plot above, we can expect that they fall close to our original set of data. When we do this, however, the degree 10 polynomial suddenly seems like a poor fit while the degree 2 polynomial still looks reasonable.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># sns.lmplot(x='sweetness', y='overall', data=ice, fit_reg=False)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ice</span><span class="p">))</span>
<span class="n">y_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ice</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="c1"># Degree 10</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf_ten</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trans_ten</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ice</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_devs</span><span class="p">,</span>
            <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_devs</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 10 poly, second set of data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ice</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_devs</span><span class="p">,</span>
            <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_devs</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 2 poly, second set of data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/feature_polynomial_41_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that in this case, degree two polynomial features work better than both no transformation and degree ten polynomial features.</p>
<p>This raises the natural question: in general, how do we determine which degree polynomial to fit? Although we are tempted to use the cost on the training dataset to pick the best polynomial, we have seen that using this cost can pick a model that is too complex. Instead, we want to evaluate our model on data that is not used to fit parameters.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this section, we introduce another feature engineering technique: adding polynomial features to the data in order to perform polynomial regression. Like one-hot encoding, adding polynomial features allows us to use our linear regression model effectively on more types of data.</p>
<p>We have also encountered a fundamental issue with feature engineering. Adding many features to the data gives the model a lower cost on its original set of data but often results in a less accurate model on new sets of data.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/15'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="The-Bias-Variance-Tradeoff">The Bias-Variance Tradeoff<a class="anchor-link" href="#The-Bias-Variance-Tradeoff">¶</a></h1><p>Sometimes, we choose a model that is too simple to represent the underlying
data generation process. Other times, we choose a model that is too complex—it
fits the noise in the data rather than the data's overall pattern.</p>
<p>To understand why this happens, we analyze our models using the tools of
probability and statistics. These tools allow us to generalize beyond a few
isolated examples to describe fundamental phenomena in modeling. In
particular, we will use the tools of expectation and variance to uncover the bias-variance tradeoff.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/15'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Risk-and-Loss-Minimization">Risk and Loss Minimization<a class="anchor-link" href="#Risk-and-Loss-Minimization">¶</a></h2><p>In order to make predictions using data, we define a model, select a loss function across the entire dataset, and fit the model's parameters by minimizing the loss. For example, to conduct least squares linear regression, we select the model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.741ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 5916.1 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1051-Title">
<title id="MathJax-SVG-1051-Title">
\begin{aligned}
f_\hat{\theta} (x) &amp;= \hat{\theta} \cdot x
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-46)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
</g>
</g>
<g transform="translate(2368,0)">
<g transform="translate(0,-46)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2140" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="2640" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>And the loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.337ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14784.1 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1052-Title">
<title id="MathJax-SVG-1052-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>As before, we use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1053-Title">
<title id="MathJax-SVG-1053-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> as our vector of model parameters, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1054-Title">
<title id="MathJax-SVG-1054-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> as a vector containing a row of a data matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1055-Title">
<title id="MathJax-SVG-1055-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1056-Title">
<title id="MathJax-SVG-1056-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> as our vector of observed values to predict. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1057-Title">
<title id="MathJax-SVG-1057-Title"> X_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span> is the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1058-Title">
<title id="MathJax-SVG-1058-Title">i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span>'th row of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1059-Title">
<title id="MathJax-SVG-1059-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1060-Title">
<title id="MathJax-SVG-1060-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> is the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1061-Title">
<title id="MathJax-SVG-1061-Title">i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span>'th entry of y.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Observe that our lost function across the dataset is the average of the loss function values for each row of our data. If we define the squared loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.296ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 12183.1 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1062-Title">
<title id="MathJax-SVG-1062-Title">
\begin{aligned}
\ell(y_i, f_\hat{\theta} (x))
&amp;= (y_i - f_\hat{\theta} (x))^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1)">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
<g transform="translate(807,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1641" y="0"></use>
<g transform="translate(2086,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="3114" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3504" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4076" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4466" y="0"></use>
</g>
</g>
<g transform="translate(4845,0)">
<g transform="translate(0,1)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1334" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="2780" y="0"></use>
<g transform="translate(3781,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="4809" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="5198" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5771" y="0"></use>
<g transform="translate(6160,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Then we may rewrite our average loss function more simply:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.833ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14136.6 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1063-Title">
<title id="MathJax-SVG-1063-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i} \ell(y_i, f_\hat{\theta} (X_i))
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4489" y="0"></use>
<g transform="translate(4879,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="5714" y="0"></use>
<g transform="translate(6159,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7187" y="0"></use>
<g transform="translate(7576,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8749" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9138" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>The expression above abstracts over the specific loss function; regardless of the loss function we choose, our overall loss is the average loss.</p>
<p>By minimizing the average loss, we select the model parameters that best fit our observed dataset. Thus far, we have refrained from making statements about the population that generated the dataset. In reality, however, we are quite interested in making good predictions on the entire population, not just our data that we have already seen.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Risk">Risk<a class="anchor-link" href="#Risk">¶</a></h2><p>If our observed dataset <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1064-Title">
<title id="MathJax-SVG-1064-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1065-Title">
<title id="MathJax-SVG-1065-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> are drawn at random from a given population, our observed data are random variables. If our observed data are random variables, our model parameters are also random variables—each time we collect a new set of data and fit a model, the parameters of the model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.526ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2379.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1066-Title">
<title id="MathJax-SVG-1066-Title"> f_\hat{\theta} (x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
</g>
</svg></span> will be slightly different.</p>
<p>Suppose we draw one more input-output pair <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.384ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 1457.2 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1067-Title">
<title id="MathJax-SVG-1067-Title">z, \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="468" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="913" y="0"></use>
</g>
</svg></span> from our population at random. The loss that our model produces on this value is:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.111ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 4783.9 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1068-Title">
<title id="MathJax-SVG-1068-Title">
\begin{aligned}
\ell(\gamma, f_\hat{\theta} (z))
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,43)">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="807" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1350" y="0"></use>
<g transform="translate(1795,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2823" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="3212" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3681" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4070" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Notice that this loss is a random variable; the loss changes for different sets of observed data <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1069-Title">
<title id="MathJax-SVG-1069-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1070-Title">
<title id="MathJax-SVG-1070-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> and different points <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.384ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 1457.2 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1071-Title">
<title id="MathJax-SVG-1071-Title">z, \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="468" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="913" y="0"></use>
</g>
</svg></span> from our population.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>risk</strong> for a model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="3.009ex" style="vertical-align: -1.171ex;" viewBox="0 -791.3 1027.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1072-Title">
<title id="MathJax-SVG-1072-Title"> f_\hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
</svg></span> is the expected value of the loss above for all training data <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1073-Title">
<title id="MathJax-SVG-1073-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1074-Title">
<title id="MathJax-SVG-1074-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> and all points <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 468.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1075-Title">
<title id="MathJax-SVG-1075-Title"> z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1076-Title">
<title id="MathJax-SVG-1076-Title"> \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
</g>
</svg></span> in the population:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.153ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 11260.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1077-Title">
<title id="MathJax-SVG-1077-Title">
\begin{aligned}
R(f_\hat{\theta}(x)) = \mathbb{E}[ \ell(\gamma, f_\hat{\theta} (z)) ]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,43)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2176" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="2566" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3138" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3528" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4195" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5251" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5919" y="0"></use>
 <use xlink:href="#MJMAIN-2113" x="6197" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6615" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="7004" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="7548" y="0"></use>
<g transform="translate(7993,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="9021" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="9410" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9879" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10268" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="10658" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that the risk is an expectation of a random variable and is thus <em>not</em> random itself. The expected value of fair six-sided die rolls is 3.5 even though the rolls themselves are random.</p>
<p>The risk above is sometimes called the <strong>true risk</strong> because it tells how a model does on the entire population. If we could compute the true risk for all models, we can simply pick the model with the least risk and know with certainty that the model will perform better in the long run than all other models on our choice of loss function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Empirical-Risk">Empirical Risk<a class="anchor-link" href="#Empirical-Risk">¶</a></h2><p>Reality, however, is not so kind. If we substitute in the definition of expectation into the formula for the true risk, we get:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.593ex" height="9.176ex" style="vertical-align: -3.765ex; margin-bottom: -0.239ex;" viewBox="0 -2226.5 14894.2 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1078-Title">
<title id="MathJax-SVG-1078-Title">
\begin{aligned}
R(f_\hat{\theta})
&amp;= \mathbb{E}[ \ell(\gamma, f_\hat{\theta} (z)) ] \\
&amp;= \sum_\gamma \sum_z \ell(\gamma, f_\hat{\theta} (z)) P(\gamma, z) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1321)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
</g>
</g>
<g transform="translate(2555,0)">
<g transform="translate(0,1321)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-2113" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2697" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="3087" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3630" y="0"></use>
<g transform="translate(4075,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="5103" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="5492" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5961" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6350" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="6740" y="0"></use>
</g>
<g transform="translate(0,-317)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B3" x="749" y="-1487"></use>
</g>
<g transform="translate(2945,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-7A" x="787" y="-1487"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="4556" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4973" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="5363" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5906" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7379" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="7769" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8237" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8627" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="9016" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9768" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="10157" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="10701" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="11146" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11614" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>To further simplify this expression, we need to know <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.939ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2987.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1079-Title">
<title id="MathJax-SVG-1079-Title"> P(\gamma, z)  </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1684" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2129" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2598" y="0"></use>
</g>
</svg></span>, the global probability distribution of observing any point in the population. Unfortunately, this is not so easy. Suppose we are trying to predict the tip amount based on the size of the table. What is the probability that a table of three people gives a tip of $14.50? If we knew the distribution of points exactly, we wouldn't have to collect data or fit a model—we would already know the most likely tip amount for any given table.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we do not know the exact distribution of the population, we can approximate it using the observed dataset <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1080-Title">
<title id="MathJax-SVG-1080-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1081-Title">
<title id="MathJax-SVG-1081-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span>. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1082-Title">
<title id="MathJax-SVG-1082-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1083-Title">
<title id="MathJax-SVG-1083-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> are drawn at random from our population, the distribution of points in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1084-Title">
<title id="MathJax-SVG-1084-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1085-Title">
<title id="MathJax-SVG-1085-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> is similar to the population distribution. Thus, we treat <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1086-Title">
<title id="MathJax-SVG-1086-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1087-Title">
<title id="MathJax-SVG-1087-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> as our population. Then, the probability that any input-output pair <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1088-Title">
<title id="MathJax-SVG-1088-Title"> X_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1089-Title">
<title id="MathJax-SVG-1089-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> appears is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.822ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 784.6 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1090-Title">
<title id="MathJax-SVG-1090-Title"> \frac{1}{n} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
</svg></span> since each pair appears once out of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1091-Title">
<title id="MathJax-SVG-1091-Title"> n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> points total.</p>
<p>This allows us to calculate the <strong>empirical risk</strong>, an approximation for the true risk:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.842ex" height="17.843ex" style="vertical-align: -8.338ex;" viewBox="0 -4092.3 12418.1 7682.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1092-Title">
<title id="MathJax-SVG-1092-Title">
\begin{aligned}
\hat R(f_\hat{\theta})
&amp;= \mathbb{E}[ \ell(y_i, f_\hat{\theta} (X_i)) ] \\
&amp;= \sum_{i=1}^n \ell(y_i, f_\hat{\theta} (X_i)) \frac{1}{n} \\
&amp;= \frac{1}{n} \sum_{i=1}^n \ell(y_i, f_\hat{\theta} (X_i)) 
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,3027)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="212" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
</g>
</g>
<g transform="translate(2555,0)">
<g transform="translate(0,3027)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="2001" y="0"></use>
 <use xlink:href="#MJMAIN-2113" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2697" y="0"></use>
<g transform="translate(3087,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3921" y="0"></use>
<g transform="translate(4367,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="5394" y="0"></use>
<g transform="translate(5784,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6957" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7346" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7736" y="0"></use>
</g>
<g transform="translate(0,776)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="2945" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3362" y="0"></use>
<g transform="translate(3752,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4587" y="0"></use>
<g transform="translate(5032,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="6059" y="0"></use>
<g transform="translate(6449,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7622" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8011" y="0"></use>
<g transform="translate(8401,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
</g>
<g transform="translate(0,-2287)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="4072" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4489" y="0"></use>
<g transform="translate(4879,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="5714" y="0"></use>
<g transform="translate(6159,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7187" y="0"></use>
<g transform="translate(7576,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8749" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9138" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>If our dataset is large and the data are drawn at random from the population, the empirical risk <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.96ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 2566.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1093-Title">
<title id="MathJax-SVG-1093-Title"> \hat R(f_\hat{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="212" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
</g>
</svg></span> is close to the true risk <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.96ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2566.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1094-Title">
<title id="MathJax-SVG-1094-Title"> R(f_\hat{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
</g>
</svg></span>. This allows us to pick the model that minimizes the empirical risk.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that this expression is the average loss function at the start of the section! By minimizing the average loss, we also minimize the empirical risk. This explains why we often use the average loss as our overall loss function instead of the maximum loss, for example.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>The true risk of a prediction model describes the overall long-run loss that the model will produce for the population. Since we typically cannot calculate the true risk directly, we calculate the empirical risk instead and use the empirical risk to find an appropriate model for prediction. Because the empirical risk is the average loss on the observed dataset, we often minimize the average loss when fitting models.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/15'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Model-Bias-and-Variance">Model Bias and Variance<a class="anchor-link" href="#Model-Bias-and-Variance">¶</a></h2><p>We have previously seen that our choice of model has two basic sources of error.</p>
<p>Our model may be too simple—a linear model is not able to properly fit data generated from a quadratic process, for example. This type of error arises from model <strong>bias</strong>.</p>
<p>Our model may also fit the random noise present in the data—even if we fit a quadratic process using a quadratic model, the model may predict different outcomes than the true process produces. This type of error arises from model <strong>variance</strong>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Bias-Variance-Decomposition">The Bias-Variance Decomposition<a class="anchor-link" href="#The-Bias-Variance-Decomposition">¶</a></h2><p>We can make the statements above more precise by decomposing our formula for model risk. Recall that the <strong>risk</strong> for a model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="3.009ex" style="vertical-align: -1.171ex;" viewBox="0 -791.3 1027.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1095-Title">
<title id="MathJax-SVG-1095-Title"> f_\hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
</svg></span> is the expected loss for all possible sets of training data <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1096-Title">
<title id="MathJax-SVG-1096-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1097-Title">
<title id="MathJax-SVG-1097-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> and all input-output points <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 468.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1098-Title">
<title id="MathJax-SVG-1098-Title"> z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1099-Title">
<title id="MathJax-SVG-1099-Title"> \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
</g>
</svg></span> in the population:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="23.014ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 9908.7 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1100-Title">
<title id="MathJax-SVG-1100-Title">
\begin{aligned}
R(f_\hat{\theta}) = \mathbb{E}[ \ell(\gamma, f_\hat{\theta} (z)) ]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,43)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2843" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3900" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4567" y="0"></use>
 <use xlink:href="#MJMAIN-2113" x="4846" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5263" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="5653" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6196" y="0"></use>
<g transform="translate(6641,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7669" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="8059" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8527" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8917" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="9306" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>We denote the process that generates the true population data as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.282ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2274 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1101-Title">
<title id="MathJax-SVG-1101-Title"> f_\theta(x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1884" y="0"></use>
</g>
</svg></span>. The output point <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1102-Title">
<title id="MathJax-SVG-1102-Title"> \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
</g>
</svg></span> is generated by our population process plus some random noise in data collection: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.72ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6337.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1103-Title">
<title id="MathJax-SVG-1103-Title"> \gamma_i = f_\theta(z_i) + \epsilon </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="733" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1140" y="0"></use>
<g transform="translate(2196,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3119" y="0"></use>
<g transform="translate(3508,0)">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="658" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4318" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4930" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="5931" y="0"></use>
</g>
</svg></span>.  The random noise <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.944ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 406.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1104-Title">
<title id="MathJax-SVG-1104-Title"> \epsilon </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
</g>
</svg></span> is a random variable with a mean of zero: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.049ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3465.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1105-Title">
<title id="MathJax-SVG-1105-Title"> \mathbb{E}[\epsilon] = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="946" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1352" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1908" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2965" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we use the squared error as our loss function, the above expression becomes:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.905ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 10722.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1106-Title">
<title id="MathJax-SVG-1106-Title">
\begin{aligned}
R(f_\hat{\theta}) = \mathbb{E}[ (\gamma - f_\hat{\theta} (z))^2 ]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2843" y="0"></use>
 <use xlink:href="#MJAMS-45" x="3900" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4567" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4846" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="5235" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6001" y="0"></use>
<g transform="translate(7002,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="8029" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="8419" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8887" y="0"></use>
<g transform="translate(9277,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="10120" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With some algebraic manipulation, we can show that the above expression is equivalent to:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.845ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 22322 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1107-Title">
<title id="MathJax-SVG-1107-Title">
\begin{aligned}
R(f_\hat{\theta}) = (\mathbb{E}[f_\hat{\theta}(z)] - f_\theta(z))^2 + \text{Var}(f_\hat{\theta}(z)) + \text{Var}(\epsilon)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1)">
 <use xlink:href="#MJMATHI-52" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="759" y="0"></use>
<g transform="translate(1149,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="2176" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2843" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3900" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4289" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4957" y="0"></use>
<g transform="translate(5235,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="6263" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="6652" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7121" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7510" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8011" y="0"></use>
<g transform="translate(9012,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="9934" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="10324" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10792" y="0"></use>
<g transform="translate(11182,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="12248" y="0"></use>
<g transform="translate(13248,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="14892" y="0"></use>
<g transform="translate(15281,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="16309" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="16698" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17167" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17556" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18168" y="0"></use>
<g transform="translate(19169,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="20812" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="21202" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21608" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first term in this expression, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.872ex" height="3.343ex" style="vertical-align: -1.171ex;" viewBox="0 -934.9 8125.5 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1108-Title">
<title id="MathJax-SVG-1108-Title"> (\mathbb{E}[f_\hat{\theta}(z)] - f_\theta(z))^2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJAMS-45" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1057" y="0"></use>
<g transform="translate(1335,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="2363" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2752" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3221" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3610" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4111" y="0"></use>
<g transform="translate(5112,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6034" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="6424" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6892" y="0"></use>
<g transform="translate(7282,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
</g>
</svg></span>, is a mathematical expression for the bias of the model. (Technically, this term represents the bias squared, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.072ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2183.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1109-Title">
<title id="MathJax-SVG-1109-Title">\text{bias}^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-62"></use>
 <use xlink:href="#MJMAIN-69" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="835" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="2446" y="598"></use>
</g>
</svg></span>.) The bias is equal to zero if in the long run our choice of model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.284ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2275.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1110-Title">
<title id="MathJax-SVG-1110-Title"> f_\hat{\theta}(z) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1885" y="0"></use>
</g>
</svg></span> predicts the same outcomes produced by the population process <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.04ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2170 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1111-Title">
<title id="MathJax-SVG-1111-Title"> f_\theta(z) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1780" y="0"></use>
</g>
</svg></span>. The bias is high if our choice of model makes poor predictions of the population process even when we have the entire population as our dataset.</p>
<p>The second term in this expression, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.911ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 4697.7 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1112-Title">
<title id="MathJax-SVG-1112-Title"> \text{Var}(f_\hat{\theta}(z)) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1643" y="0"></use>
<g transform="translate(2033,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="3060" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="3450" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3918" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4308" y="0"></use>
</g>
</svg></span>, represents the model variance. The variance is low when the model's predictions don't change much when the model is trained on different datasets from the population. The variance is high when the model's predictions change greatly when the model is trained on different datasets from the population.</p>
<p>The third and final term in this expression, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.571ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2829 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1113-Title">
<title id="MathJax-SVG-1113-Title"> \text{Var}(\epsilon) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1643" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="2033" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2439" y="0"></use>
</g>
</svg></span>, represents the irreducible error or the noise in the data generation and collection process. This term is small when the data generation and collection process is precise or has low variation. This term is large when the data contain large amounts of noise.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Derivation-of-Bias-Variance-Decomposition">Derivation of Bias-Variance Decomposition<a class="anchor-link" href="#Derivation-of-Bias-Variance-Decomposition">¶</a></h2><p>To begin the decomposition, we start with the mean squared error:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.095ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 6499.1 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1114-Title">
<title id="MathJax-SVG-1114-Title">\mathbb{E}[(\gamma - f_{\hat{\theta}}(z))^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="2101" y="0"></use>
<g transform="translate(3101,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="4129" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="4519" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4987" y="0"></use>
<g transform="translate(5377,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="6220" y="0"></use>
</g>
</svg></span><p>And expand the square and apply linearity of expectation:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.463ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 10532.4 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1115-Title">
<title id="MathJax-SVG-1115-Title"> =\mathbb{E}[\gamma^2 -2\gamma f_{\hat{\theta}} +f_\hat{\theta}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1056" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1723" y="0"></use>
<g transform="translate(2002,0)">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="779" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3229" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4230" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="4730" y="0"></use>
<g transform="translate(5274,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="6524" y="0"></use>
<g transform="translate(7524,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="8552" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="8942" y="0"></use>
<g transform="translate(9410,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="10253" y="0"></use>
</g>
</svg></span><p><br>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.048ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 14228.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1116-Title">
<title id="MathJax-SVG-1116-Title">= \mathbb{E}[\gamma^2] - \mathbb{E}[2\gamma f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1056" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1723" y="0"></use>
<g transform="translate(2002,0)">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="779" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3007" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3507" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4508" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5176" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="5454" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="5955" y="0"></use>
<g transform="translate(6498,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7526" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="7915" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8384" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="8773" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9274" y="0"></use>
 <use xlink:href="#MJAMS-45" x="10275" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="10942" y="0"></use>
<g transform="translate(11221,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="12249" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="12638" y="0"></use>
<g transform="translate(13107,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="13950" y="0"></use>
</g>
</svg></span></p>
<p>Because <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1117-Title">
<title id="MathJax-SVG-1117-Title"> \gamma </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.284ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2275.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1118-Title">
<title id="MathJax-SVG-1118-Title">f_{\hat{\theta}}(z)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1885" y="0"></use>
</g>
</svg></span> are independent (the model outputs and population observations don't depend on each other), we can say that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.049ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 11646 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1119-Title">
<title id="MathJax-SVG-1119-Title">\mathbb{E}[2\gamma f_{\hat{\theta}}(z)] = \mathbb{E}[2\gamma]  \mathbb{E}[f_{\hat{\theta}}(z)] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="946" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="1446" y="0"></use>
<g transform="translate(1990,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="3017" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="3407" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3875" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="4265" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4821" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5877" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="6545" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="6823" y="0"></use>
 <use xlink:href="#MJMATHI-3B3" x="7324" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="7867" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8146" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8813" y="0"></use>
<g transform="translate(9092,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="10119" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="10509" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10977" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="11367" y="0"></use>
</g>
</svg></span>. We then substitute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.825ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3799.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1120-Title">
<title id="MathJax-SVG-1120-Title">f_\theta(z) + \epsilon</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="2392" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="3392" y="0"></use>
</g>
</svg></span> for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.262ex" height="2.176ex" style="vertical-align: -0.838ex;" viewBox="0 -576.1 543.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1121-Title">
<title id="MathJax-SVG-1121-Title">\gamma</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B3" x="0" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.617ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 23515.8 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1122-Title">
<title id="MathJax-SVG-1122-Title"> =\mathbb{E}[(f_\theta(z) + \epsilon)^2] - \mathbb{E}[2(f_\theta(z) + \epsilon)] \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1056" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2002" y="0"></use>
<g transform="translate(2391,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3314" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="3703" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4172" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="4783" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="5784" y="0"></use>
<g transform="translate(6191,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="7034" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7535" y="0"></use>
 <use xlink:href="#MJAMS-45" x="8536" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="9203" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="9482" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9982" y="0"></use>
<g transform="translate(10372,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="11294" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="11684" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12152" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="12764" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="13764" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14171" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="14560" y="0"></use>
 <use xlink:href="#MJAMS-45" x="14839" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="15506" y="0"></use>
<g transform="translate(15785,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="16813" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="17202" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17671" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="18060" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="18561" y="0"></use>
 <use xlink:href="#MJAMS-45" x="19562" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="20229" y="0"></use>
<g transform="translate(20508,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="21535" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="21925" y="0"></use>
<g transform="translate(22393,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="23237" y="0"></use>
</g>
</svg></span>
<pre><code>      

</code></pre>
<p>Simplifiying some more: (Note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.022ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 6898.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1123-Title">
<title id="MathJax-SVG-1123-Title">\mathbb{E}[f_\theta(z)] = f_\theta(z)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
<g transform="translate(946,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1868" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2257" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2726" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="3115" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3672" y="0"></use>
<g transform="translate(4728,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="5651" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="6040" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6509" y="0"></use>
</g>
</svg></span> because <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.04ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2170 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1124-Title">
<title id="MathJax-SVG-1124-Title">f_\theta(z)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
 <use xlink:href="#MJMAIN-28" x="922" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="1311" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1780" y="0"></use>
</g>
</svg></span> is a deterministic function, given a particular query point <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 468.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1125-Title">
<title id="MathJax-SVG-1125-Title"> z </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
</g>
</svg></span>.)</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="65.012ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 27991.1 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1126-Title">
<title id="MathJax-SVG-1126-Title"> =\mathbb{E}[f_\theta(z)^2 + 2f_\theta(z) \epsilon + \epsilon^2] - (2f_\theta(z) + \mathbb{E}[2\epsilon]) \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJAMS-45" x="1056" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1723" y="0"></use>
<g transform="translate(2002,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2924" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="3314" y="0"></use>
<g transform="translate(3782,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4848" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="5849" y="0"></use>
<g transform="translate(6349,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7272" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="7661" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8130" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="8519" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9148" y="0"></use>
<g transform="translate(10149,0)">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="574" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="11009" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="11510" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12510" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="12900" y="0"></use>
<g transform="translate(13400,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="14323" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="14712" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15181" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15793" y="0"></use>
 <use xlink:href="#MJAMS-45" x="16793" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="17461" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="17739" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="18240" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="18646" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18925" y="0"></use>
 <use xlink:href="#MJAMS-45" x="19314" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="19982" y="0"></use>
<g transform="translate(20260,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="21288" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="21678" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="22146" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="22536" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="23036" y="0"></use>
 <use xlink:href="#MJAMS-45" x="24037" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="24704" y="0"></use>
<g transform="translate(24983,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="26011" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="26400" y="0"></use>
<g transform="translate(26869,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="27712" y="0"></use>
</g>
</svg></span><p></p>
<p>Applying linearity of expectation again:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="67.856ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 29215.6 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1127-Title">
<title id="MathJax-SVG-1127-Title">= f_\theta(z)^2 + 2f_\theta(z)\mathbb{E}[\epsilon] + \mathbb{E}[\epsilon^2] - (2f_\theta(z) + 2\mathbb{E}[\epsilon]) \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1978" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2368" y="0"></use>
<g transform="translate(2836,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3902" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4903" y="0"></use>
<g transform="translate(5403,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6326" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="6715" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7184" y="0"></use>
 <use xlink:href="#MJAMS-45" x="7573" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8241" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="8519" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="8926" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9426" y="0"></use>
 <use xlink:href="#MJAMS-45" x="10427" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="11095" y="0"></use>
<g transform="translate(11373,0)">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="574" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="12233" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="12734" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13735" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="14124" y="0"></use>
<g transform="translate(14625,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="15547" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="15937" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="16405" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="17017" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="18018" y="0"></use>
 <use xlink:href="#MJAMS-45" x="18518" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="19186" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="19464" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="19871" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="20149" y="0"></use>
 <use xlink:href="#MJAMS-45" x="20539" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="21206" y="0"></use>
<g transform="translate(21485,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="22513" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="22902" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="23371" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="23760" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="24261" y="0"></use>
 <use xlink:href="#MJAMS-45" x="25261" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="25929" y="0"></use>
<g transform="translate(26207,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="27235" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="27625" y="0"></use>
<g transform="translate(28093,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="28937" y="0"></use>
</g>
</svg></span><p></p>
<p>Noting that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.082ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 13382.3 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1128-Title">
<title id="MathJax-SVG-1128-Title">\big( \mathbb{E}[\epsilon] = 0 \big) =&gt; \big( \mathbb{E}[\epsilon^2] = \text{Var}(\epsilon) \big)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ1-28" x="0" y="-1"></use>
 <use xlink:href="#MJAMS-45" x="458" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1126" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="1404" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1811" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2367" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3423" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="3924" y="-1"></use>
<g transform="translate(4660,0)">
 <use xlink:href="#MJMAIN-3D"></use>
 <use xlink:href="#MJMAIN-3E" x="778" y="0"></use>
</g>
 <use xlink:href="#MJSZ1-28" x="6217" y="-1"></use>
 <use xlink:href="#MJAMS-45" x="6675" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="7343" y="0"></use>
<g transform="translate(7621,0)">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="574" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="8482" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="9038" y="0"></use>
<g transform="translate(10094,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="11738" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="12127" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12534" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="12923" y="-1"></use>
</g>
</svg></span> because <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.194ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 9555.8 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1129-Title">
<title id="MathJax-SVG-1129-Title">\text{Var}(\epsilon) = \mathbb{E}[\epsilon^2]-\mathbb{E}[\epsilon]^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1643" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="2033" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2439" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3106" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4163" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="4830" y="0"></use>
<g transform="translate(5109,0)">
 <use xlink:href="#MJMATHI-3F5" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="574" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="5969" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6470" y="0"></use>
 <use xlink:href="#MJAMS-45" x="7470" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8138" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="8416" y="0"></use>
<g transform="translate(8823,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="513"></use>
</g>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.153ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 20301.8 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1130-Title">
<title id="MathJax-SVG-1130-Title"> = f_\theta(z)^2 + \text{Var}(\epsilon) - 2f_\theta(z) \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1978" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2368" y="0"></use>
<g transform="translate(2836,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3902" y="0"></use>
<g transform="translate(4903,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6546" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="6936" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7342" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7954" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8955" y="0"></use>
<g transform="translate(9455,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="10378" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="10767" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11236" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11625" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12293" y="0"></use>
<g transform="translate(12571,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="13599" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="13988" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14457" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="14846" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15347" y="0"></use>
 <use xlink:href="#MJAMS-45" x="16348" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="17015" y="0"></use>
<g transform="translate(17294,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="18321" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="18711" y="0"></use>
<g transform="translate(19179,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="20023" y="0"></use>
</g>
</svg></span>
<pre><code>       

</code></pre>
<p>We can then rewrite the equation as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="71.199ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 30654.9 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1131-Title">
<title id="MathJax-SVG-1131-Title"> = f_\theta(z)^2 + \text{Var}(\epsilon) - 2f_\theta(z) \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)^2] -  \mathbb{E}[f_{\hat{\theta}}(z)]^2 + \mathbb{E}[f_{\hat{\theta}}(z)]^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1978" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2368" y="0"></use>
<g transform="translate(2836,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3902" y="0"></use>
<g transform="translate(4903,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6546" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="6936" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7342" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7954" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="8955" y="0"></use>
<g transform="translate(9455,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="10378" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="10767" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11236" y="0"></use>
 <use xlink:href="#MJAMS-45" x="11625" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12293" y="0"></use>
<g transform="translate(12571,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="13599" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="13988" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14457" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="14846" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15347" y="0"></use>
 <use xlink:href="#MJAMS-45" x="16348" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="17015" y="0"></use>
<g transform="translate(17294,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="18321" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="18711" y="0"></use>
<g transform="translate(19179,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="20023" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="20524" y="0"></use>
 <use xlink:href="#MJAMS-45" x="21524" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="22192" y="0"></use>
<g transform="translate(22470,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="23498" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="23887" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="24356" y="0"></use>
<g transform="translate(24745,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="25700" y="0"></use>
 <use xlink:href="#MJAMS-45" x="26701" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="27368" y="0"></use>
<g transform="translate(27647,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="28675" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="29064" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="29533" y="0"></use>
<g transform="translate(29922,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
</g>
</svg></span><p>Because <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.463ex" height="3.343ex" style="vertical-align: -1.171ex;" viewBox="0 -934.9 15268.9 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1132-Title">
<title id="MathJax-SVG-1132-Title"> \mathbb{E}[f_{\hat{\theta}}(z)^2] -  \mathbb{E}[f_{\hat{\theta}}(z)]^2 = Var(f_{\hat{\theta}}(z))</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-45" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="667" y="0"></use>
<g transform="translate(946,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="1973" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2363" y="0"></use>
<g transform="translate(2831,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="3675" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4175" y="0"></use>
 <use xlink:href="#MJAMS-45" x="5176" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5844" y="0"></use>
<g transform="translate(6122,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7150" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="7539" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="8008" y="0"></use>
<g transform="translate(8397,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="9407" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="10464" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="11233" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="11763" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12214" y="0"></use>
<g transform="translate(12604,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="13631" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="14021" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14489" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14879" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.153ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 26329.5 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1133-Title">
<title id="MathJax-SVG-1133-Title"> =  f_\theta(z)^2 - 2f_\theta(z) \mathbb{E}[f_{\hat{\theta}}(z)] + \mathbb{E}[f_{\hat{\theta}}(z)]^2 + Var(f_{\hat{\theta}}(z)) + \text{Var}(\epsilon)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1978" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2368" y="0"></use>
<g transform="translate(2836,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3902" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="4903" y="0"></use>
<g transform="translate(5403,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="6326" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="6715" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7184" y="0"></use>
 <use xlink:href="#MJAMS-45" x="7573" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="8241" y="0"></use>
<g transform="translate(8519,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="9547" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="9936" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10405" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="10794" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="11295" y="0"></use>
 <use xlink:href="#MJAMS-45" x="12296" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="12963" y="0"></use>
<g transform="translate(13242,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="14269" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="14659" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15127" y="0"></use>
<g transform="translate(15517,0)">
 <use xlink:href="#MJMAIN-5D" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="393" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="16472" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="17472" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="18242" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="18771" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="19223" y="0"></use>
<g transform="translate(19612,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="20640" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="21030" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21498" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="21888" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="22499" y="0"></use>
<g transform="translate(23500,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="25143" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="25533" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="25939" y="0"></use>
</g>
</svg></span><p></p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.736ex" height="3.509ex" style="vertical-align: -1.171ex;" viewBox="0 -1006.6 19261.4 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1134-Title">
<title id="MathJax-SVG-1134-Title"> = (f_\theta(z) - \mathbb{E}[f_{\hat{\theta}}(z)])^2 + Var(f_{\hat{\theta}}(z)) + \text{Var}(\epsilon) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1056" y="0"></use>
<g transform="translate(1445,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="693" y="-219"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2368" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="2757" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3226" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3837" y="0"></use>
 <use xlink:href="#MJAMS-45" x="4838" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="5506" y="0"></use>
<g transform="translate(5784,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="6812" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="7201" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7670" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="8059" y="0"></use>
<g transform="translate(8338,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="9404" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="10404" y="0"></use>
 <use xlink:href="#MJMATHI-61" x="11174" y="0"></use>
 <use xlink:href="#MJMATHI-72" x="11703" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12155" y="0"></use>
<g transform="translate(12544,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="13572" y="0"></use>
 <use xlink:href="#MJMATHI-7A" x="13961" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14430" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14819" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="15431" y="0"></use>
<g transform="translate(16432,0)">
 <use xlink:href="#MJMAIN-56"></use>
 <use xlink:href="#MJMAIN-61" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1251" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="18075" y="0"></use>
 <use xlink:href="#MJMATHI-3F5" x="18465" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18871" y="0"></use>
</g>
</svg></span>
<pre><code>                
</code></pre>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.376ex" height="2.843ex" style="vertical-align: -0.505ex;" viewBox="0 -1006.6 14370.1 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1135-Title">
<title id="MathJax-SVG-1135-Title">= \text{bias}^2 + \text{model variance} + \text{noise}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
<g transform="translate(1056,0)">
 <use xlink:href="#MJMAIN-62"></use>
 <use xlink:href="#MJMAIN-69" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="835" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="2446" y="598"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3462" y="0"></use>
<g transform="translate(4463,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-6F" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1890" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="2335" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="2863" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="3392" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="3892" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="4285" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="4563" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="5064" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="5620" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="6065" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="11194" y="0"></use>
<g transform="translate(12195,0)">
 <use xlink:href="#MJMAIN-6E"></use>
 <use xlink:href="#MJMAIN-6F" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1057" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1335" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1730" y="0"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To pick a model that performs well, we seek to minimize the risk. To minimize the risk, we attempt to minimize the bias, variance, and noise terms of the bias-variance decomposition. Decreasing the noise term typically requires improvements to the data collection process—purchasing more precise sensors, for example. To decrease bias and variance, however, we must tune the complexity of our models. Models that are too simple have high bias; models that are too complex have high variance. This is the essence of the <em>bias-variance tradeoff</em>, a fundamental issue that we face in choosing models for prediction.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Linear-Regression-and-Sine-Waves">Example: Linear Regression and Sine Waves<a class="anchor-link" href="#Example:-Linear-Regression-and-Sine-Waves">¶</a></h2><p>Suppose we are modeling data generated from the oscillating function shown below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">Line</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Line'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'x_start'</span><span class="p">,</span> <span class="s1">'x_end'</span><span class="p">,</span> <span class="s1">'y_start'</span><span class="p">,</span> <span class="s1">'y_end'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">noise</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">points</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">points</span><span class="p">)</span> <span class="o">+</span> <span class="n">noise</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fit_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Line</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_start</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_end</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>

<span class="n">population_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">population_y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">population_x</span><span class="p">)</span>

<span class="n">avg_line</span> <span class="o">=</span> <span class="n">fit_line</span><span class="p">(</span><span class="n">population_x</span><span class="p">,</span> <span class="n">population_y</span><span class="p">)</span>

<span class="n">datasets</span> <span class="o">=</span> <span class="p">[</span><span class="n">draw</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="n">random_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">fit_line</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">population_x</span><span class="p">,</span> <span class="n">population_y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'True underlying data generation process'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we randomly draw a dataset from the population, we may end up with the following:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'One set of observed data'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Suppose we draw many sets of data from the population and fit a simple linear model to each one. Below, we plot the population data generation scheme in blue and the model predictions in green.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">population_x</span><span class="p">,</span> <span class="n">population_y</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span> <span class="ow">in</span> <span class="n">random_lines</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">],</span> <span class="p">[</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Population vs. linear model predictions'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The plot above clearly shows that a linear model will make prediction errors for this population. We may decompose the prediction errors into bias, variance, and irreducible noise. We illustrate bias of our model by showing that the long-run average linear model will predict different outcomes than the population process:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">population_x</span><span class="p">,</span> <span class="n">population_y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Population'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">avg_line</span><span class="o">.</span><span class="n">x_start</span><span class="p">,</span> <span class="n">avg_line</span><span class="o">.</span><span class="n">x_end</span><span class="p">],</span>
         <span class="p">[</span><span class="n">avg_line</span><span class="o">.</span><span class="n">y_start</span><span class="p">,</span> <span class="n">avg_line</span><span class="o">.</span><span class="n">y_end</span><span class="p">],</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span>
         <span class="n">label</span><span class="o">=</span><span class="s1">'Long-run average linear model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Bias of linear model'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The variance of our model is the variation of the model predictions around the long-run average model:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="k">for</span> <span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span> <span class="ow">in</span> <span class="n">random_lines</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">],</span> <span class="p">[</span><span class="n">y_start</span><span class="p">,</span> <span class="n">y_end</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">avg_line</span><span class="o">.</span><span class="n">x_start</span><span class="p">,</span> <span class="n">avg_line</span><span class="o">.</span><span class="n">x_end</span><span class="p">],</span>
         <span class="p">[</span><span class="n">avg_line</span><span class="o">.</span><span class="n">y_start</span><span class="p">,</span> <span class="n">avg_line</span><span class="o">.</span><span class="n">y_end</span><span class="p">],</span>
         <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Variance of linear model'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_20_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we illustrate the irreducible error by showing the deviations of the observed points from the underlying population process.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">population_x</span><span class="p">,</span> <span class="n">population_y</span><span class="p">)</span>


<span class="n">xs</span><span class="p">,</span> <span class="n">ys</span> <span class="o">=</span> <span class="n">draw</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Irreducible error'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_modeling_22_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bias-Variance-In-Practice">Bias-Variance In Practice<a class="anchor-link" href="#Bias-Variance-In-Practice">¶</a></h2><p>In an ideal world, we would minimize the expected prediction error for our model over all input-output points in the population.  However, in practice, we do not know the population data generation process and thus are unable to precisely determine a model's bias, variance, or irreducible error. Instead, we use our observed dataset as an approximation to the population.</p>
<p>As we have seen, however, achieving a low training error does not necessarily mean that our model will have a low test error as well. It is easy to obtain a model with extremely low bias and therefore low training error by fitting a curve that passes through every training observation. However, this model will have high variance which typically leads to high test error. Conversely, a model that predicts a constant has low variance but high bias. Fundamentally, this occurs because training error reflects the bias of our model but not the variance; the test error reflects both. In order to minimize test error, our model needs to simultaneously achieve low bias and low variance. To account for this, we need a way to simulate test error without using the test set. This is generally done using cross validation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Takeaways">Takeaways<a class="anchor-link" href="#Takeaways">¶</a></h2><p>The bias-variance tradeoff allows us to more precisely describe the modeling phenomena that we have seen thus far.</p>
<p>Underfitting is typically caused by too much bias; overfitting is typically caused by too much model variance.</p>
<p>Collecting more data reduces variance. For example, the model variance of linear regression goes down by a factor of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.72ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1601.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1136-Title">
<title id="MathJax-SVG-1136-Title"> 1
/n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2F" x="500" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="1001" y="0"></use>
</g>
</svg></span>, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1137-Title">
<title id="MathJax-SVG-1137-Title"> n </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> is the number of data points. Thus, doubling the dataset size halves the model variance, and collecting many data points will cause the variance to approach 0. One recent trend is to select a model with low bias and high intrinsic variance (e.g. a neural network) and collect many data points so that the model variance is low enough to make accurate predictions. While effective in practice, collecting enough data for these models tends to require large amounts of time and money.</p>
<p>Collecting more data reduces bias if the model can fit the population process exactly. If the model is inherently incapable of modeling the population (as in the example above), even infinite data cannot get rid of model bias.</p>
<p>Adding a useful feature to the data, such as a quadratic feature when the underlying process is quadratic, reduces bias. Adding a useless feature rarely increases bias.</p>
<p>Adding a feature, whether useful or not, typically increases model variance since each new feature adds a parameter to the model. Generally speaking, models with many parameters have many possible combinations of parameters and therefore have higher variance than models with few parameters. In order to increase a model's prediction accuracy, a new feature should decrease bias more than it increases variance.</p>
<p>Removing features will typically increase bias and can cause underfitting. For example, a simple linear model has higher model bias than the same model with a quadratic feature added to it. If the data were generated from a quadratic phenomenon, the simple linear model underfits the data.</p>
<p>In the plot below, the X-axis measures model complexity and the Y-axis measures magnitude. Notice  how as model complexity increases, model bias strictly decreases and model variance strictly increases. As we choose more complex models, the test error first decreases then increases as the increased model variance outweighs the decreased model bias.</p>
<p><img alt="bias_modeling_bias_var_plot.png" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/bias_modeling_bias_var_plot.png"></p>
<p>As the plot shows, a model with high complexity can achieve low training error but can fail to generalize to the test set because of its high model variance. On the other hand, a model with low complexity will have low model variance but can also fail to generalize because of its high model bias. To select a useful model, we must strike a balance between model bias and variance.</p>
<p>As we add more data, we shift the curves on our plot to the right and down, reducing bias and variance:</p>
<p><img alt="bias_modeling_bias_var_shiftt.png" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/bias_modeling_bias_var_shift.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>The bias-variance tradeoff reveals a fundamental problem in modeling. In order to minimize model risk, we use a combination of feature engineering, model selection, and cross-validation to balance bias and variance.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/15'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">linear_model</span> <span class="k">as</span> <span class="n">lm</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cross-Validation">Cross-Validation<a class="anchor-link" href="#Cross-Validation">¶</a></h2><p>In the previous section, we observed that we needed a more accurate way of simulating the test error to manage the bias-variance trade off. To reiterate, training error is misleadingly low, because we are fitting our model on the training set. We need to choose a model without using the test set, so we split our training set again, into a validation set. Cross-validation provides a method of estimating our model error using a single observed dataset by separating data used for training from the data used for model selection and final accuracy.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-Validation-Test-Split">Train-Validation-Test Split<a class="anchor-link" href="#Train-Validation-Test-Split">¶</a></h2><p>One way to accomplish this is to split the original dataset into three disjoint subsets:</p>
<ul>
<li>Training set: The data used to fit the model.</li>
<li>Validation set: The data used to select features.</li>
<li>Test set: The data used to report the model's final accuracy.</li>
</ul>
<p>After splitting, we select a set of features and a model based on the following procedure:</p>
<ol>
<li>For each potential set of features, fit a model using the training set. The error of a model on the training set is its <em>training error</em>.</li>
<li>Check the error of each model on the validation set: its <em>validation error</em>. Select the model that achieves the lowest validation error. This is the final choice of features and model.</li>
<li>Calculate the <em>test error</em>, error of the final model on the test set. This is the final reported accuracy of the model. We are forbidden from adjusting the features or model to decrease test error; doing so effectively converts the test set into a validation set. Instead, we must collect a new test set after making further changes to the features or the model.</li>
</ol>
<p>This process allows us to more accurately determine the model to use than using the training error alone. By using cross-validation, we can test our model on data that it wasn't fit on, simulating test error without using the test set. This gives us a sense of how our model performs on unseen data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Size of the train-validation-test split</strong></p>
<p>The train-validation-test split commonly uses 70% of the data as the training set, 15% as the validation set, and the remaining 15% as the test set. Increasing the size of the training set helps model accuracy but causes more variation in the validation and test error. This is because a smaller validation set and test set are less representative of the sample data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training-Error-and-Test-Error">Training Error and Test Error<a class="anchor-link" href="#Training-Error-and-Test-Error">¶</a></h2><p>A model is of little use to us if it fails to generalize to unseen data from the population. The test error provides the most accurate representation of the model's performance on new data since we do not use the test set to train the model or select features.</p>
<p>In general, the training error decreases as we add complexity to our model with additional features or more complex prediction mechanisms. The test error, on the other hand, decreases up to a certain amount of complexity then increases again as the model overfits the training set. This is due the fact that at first, bias decreases more than variance increases. Eventually, the increase in variance surpasses the decrease in bias. 
<img alt="feature_train_test_error.png" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/feature_train_test_error.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="K-Fold-Cross-Validation">K-Fold Cross-Validation<a class="anchor-link" href="#K-Fold-Cross-Validation">¶</a></h2><p>The <strong>train-validation-test split</strong> method is a good method to simulate test error through the validation set. However, making the three splits results in too little data for training. Also, with this method the validation error may be prone to high variance because the evaluation of the error may depend heavily on which points end up in the training and validation sets.</p>
<p>To tackle this problem, we can run the train-validation split multiple times on the same dataset. The dataset is divided into <em>k</em> equally-sized subsets (<em><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1138-Title">
<title id="MathJax-SVG-1138-Title">k</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span> folds</em>), and the train-validation split is repeated <em>k</em> times. Each time, one of the <em>k</em> folds is used as the validation set, and the remaining <em>k-1</em> folds are used as the training set. We report the model's final validation error as the average of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1139-Title">
<title id="MathJax-SVG-1139-Title"> k </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span> validation errors from each trial. This method is called <strong>k-fold cross-validation</strong>.</p>
<p>The diagram below illustrates the technique when using five folds:</p>
<p><img alt="feature_5_fold_cv.jpg" src="https://github.com/DS-100/textbook/blob/master/assets/feature_5_fold_cv.jpg?raw=true"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The biggest advantage of this method is that every data point is used for validation exactly once and for training <em>k-1</em> times. Typically, a <em>k</em> between 5 to 10 is used, but <em>k</em> remains an unfixed parameter. When <em>k</em> is small, the error estimate has a lower variance (many validation points) but has a higher bias (fewer training points). Vice versa, with large <em>k</em> the error estimate has lower bias but has higher variance.</p>
<p><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1140-Title">
<title id="MathJax-SVG-1140-Title">k</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span>-fold cross-validation takes more computation time than the train-validation split since we typically have to refit each model from scratch for each fold. However, it computes a more accurate validation error by averaging multiple errors together for each model.</p>
<p>The <code>scikit-learn</code> library provides a convenient <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html"><code>sklearn.model_selection.KFold</code></a> class to implement <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1141-Title">
<title id="MathJax-SVG-1141-Title">k</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span>-fold cross-validation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bias-Variance-Tradeoff">Bias-Variance Tradeoff<a class="anchor-link" href="#Bias-Variance-Tradeoff">¶</a></h2><p>Cross-validation helps us manage the bias-variance tradeoff more accurately. Intuitively, the validation error estimates test error by checking the model's performance on a dataset not used for training; this allows us to estimate both model bias and model variance. K-fold cross-validation also incorporates the fact that the noise in the test set only affects the noise term in the bias-variance decomposition whereas the noise in the training set affects both bias and model variance. To choose the final model to use, we select the one that has the lowest validation error.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example:-Model-Selection-for-Ice-Cream-Ratings">Example: Model Selection for Ice Cream Ratings<a class="anchor-link" href="#Example:-Model-Selection-for-Ice-Cream-Ratings">¶</a></h2><p>We will use the complete model selection process, including cross-validation, to select a model that predicts ice cream ratings from ice cream sweetness. The complete ice cream dataset and a scatter plot of the overall rating versus ice cream sweetness are shown below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">ice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'icecream.csv'</span><span class="p">)</span>
<span class="n">transformer</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">ice</span><span class="p">[[</span><span class="s1">'overall'</span><span class="p">]])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rating_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>

<span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'sweetness'</span><span class="p">])</span>
<span class="n">temp</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">=</span> <span class="n">rating_pred</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">x_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
<span class="n">y_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
<span class="n">temp</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_devs</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">temp</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">temp</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_devs</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">ice</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">temp</span><span class="p">,</span> <span class="n">ice</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ice</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sweetness</th>
<th>overall</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>3.60</td>
<td>3.09</td>
</tr>
<tr>
<th>1</th>
<td>3.50</td>
<td>3.17</td>
</tr>
<tr>
<th>2</th>
<td>3.69</td>
<td>3.46</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>6</th>
<td>11.00</td>
<td>5.90</td>
</tr>
<tr>
<th>7</th>
<td>11.70</td>
<td>5.50</td>
</tr>
<tr>
<th>8</th>
<td>11.90</td>
<td>5.40</td>
</tr>
</tbody>
</table>
<p>309 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ice</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">],</span> <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Ice Cream Rating vs. Sweetness'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Sweetness'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Rating'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_cv_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using degree 10 polynomial features on 9 random points from the dataset result in a perfectly accurate model for those data points. Unfortunately, this model fails to generalize to previously unseen data from the population.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>

<span class="n">ice2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'icecream.csv'</span><span class="p">)</span>
<span class="n">trans_ten</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">X_ten</span> <span class="o">=</span> <span class="n">trans_ten</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">ice2</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ice2</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span>

<span class="n">clf_ten</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_ten</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">x_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ice2</span><span class="p">))</span>
<span class="n">y_devs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">ice2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ice2</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">],</span> <span class="n">ice2</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">])</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf_ten</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trans_ten</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 10 polynomial fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">clf_ten</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">trans_ten</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">xs</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ice2</span><span class="p">[</span><span class="s1">'sweetness'</span><span class="p">]</span> <span class="o">+</span> <span class="n">x_devs</span><span class="p">,</span>
            <span class="n">ice2</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">]</span> <span class="o">+</span> <span class="n">y_devs</span><span class="p">,</span>
            <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Degree 10 poly, second set of data'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_cv_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Instead of the above method, we first partition our data into training, validation, and test datasets using <code>scikit-learn</code>'s <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code>sklearn.model_selection.train_test_split</code></a> method to perform a 70/30% train-test split.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>

<span class="n">test_size</span> <span class="o">=</span> <span class="mi">92</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">ice</span><span class="p">[[</span><span class="s1">'sweetness'</span><span class="p">]],</span> <span class="n">ice</span><span class="p">[</span><span class="s1">'overall'</span><span class="p">],</span> <span class="n">test_size</span><span class="o">=</span><span class="n">test_size</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'  Training set size: {len(X_train)}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'      Test set size: {len(X_test)}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>  Training set size: 217
      Test set size: 92
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We now fit polynomial regression models using the training set, one for each polynomial degree from 1 to 10.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="c1"># First, we add polynomial features to X_train</span>
<span class="n">transformers</span> <span class="o">=</span> <span class="p">[</span><span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)]</span>
<span class="n">X_train_polys</span> <span class="o">=</span> <span class="p">[</span><span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
                 <span class="k">for</span> <span class="n">transformer</span> <span class="ow">in</span> <span class="n">transformers</span><span class="p">]</span>

<span class="c1"># Display the X_train with degree 5 polynomial features</span>
<span class="n">X_train_polys</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([[     1.  ,      8.8 ,     77.44,    681.47,   5996.95,  52773.19],
       [     1.  ,     10.74,    115.35,   1238.83,  13305.07, 142896.44],
       [     1.  ,      9.98,     99.6 ,    994.01,   9920.24,  99003.99],
       ...,
       [     1.  ,      6.79,     46.1 ,    313.05,   2125.59,  14432.74],
       [     1.  ,      5.13,     26.32,    135.01,    692.58,   3552.93],
       [     1.  ,      8.66,     75.  ,    649.46,   5624.34,  48706.78]])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will then perform 5-fold cross-validation on the 10 featurized datasets. To do so, we will define a function that:</p>
<ol>
<li>Uses the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html"><code>KFold.split</code></a> function to get 5 splits on the training data. Note that <code>split</code> returns the indices of the data for that split.</li>
<li>For each split, select out the rows and columns based on the split indices and features.</li>
<li>Fit a linear model on the training split.</li>
<li>Compute the mean squared error on the validation split.</li>
<li>Return the average error across all cross validation splits.</li>
</ol>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">KFold</span>

<span class="k">def</span> <span class="nf">mse_cost</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">y_actual</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_actual</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">compute_CV_error</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">):</span>
    <span class="n">kf</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">validation_errors</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">train_idx</span><span class="p">,</span> <span class="n">valid_idx</span> <span class="ow">in</span> <span class="n">kf</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X_train</span><span class="p">):</span>
        <span class="c1"># split the data</span>
        <span class="n">split_X_train</span><span class="p">,</span> <span class="n">split_X_valid</span> <span class="o">=</span> <span class="n">X_train</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">X_train</span><span class="p">[</span><span class="n">valid_idx</span><span class="p">]</span>
        <span class="n">split_Y_train</span><span class="p">,</span> <span class="n">split_Y_valid</span> <span class="o">=</span> <span class="n">Y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_idx</span><span class="p">],</span> <span class="n">Y_train</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">valid_idx</span><span class="p">]</span>

        <span class="c1"># Fit the model on the training split</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">split_X_train</span><span class="p">,</span><span class="n">split_Y_train</span><span class="p">)</span>
        
        <span class="c1"># Compute the RMSE on the validation split</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">mse_cost</span><span class="p">(</span><span class="n">split_Y_valid</span><span class="p">,</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">split_X_valid</span><span class="p">))</span>
        
        <span class="n">validation_errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    
    <span class="c1">#average validation errors</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">validation_errors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We train a linear regression classifier for each featurized dataset and perform cross-validation</span>
<span class="c1"># We set fit_intercept=False for our linear regression classifier since </span>
<span class="c1"># the PolynomialFeatures transformer adds the bias column for us.</span>

<span class="n">cross_validation_errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">compute_CV_error</span><span class="p">(</span><span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> <span class="n">X_train_poly</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
                     <span class="k">for</span> <span class="n">X_train_poly</span> <span class="ow">in</span> <span class="n">X_train_polys</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">cv_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'Validation Error'</span><span class="p">:</span> <span class="n">cross_validation_errors</span><span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span>
<span class="n">cv_df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Degree'</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">display</span><span class="p">(</span><span class="n">cv_df</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Validation Error</th>
</tr>
<tr>
<th>Degree</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>1</th>
<td>0.324820</td>
</tr>
<tr>
<th>2</th>
<td>0.045060</td>
</tr>
<tr>
<th>3</th>
<td>0.045418</td>
</tr>
<tr>
<th>4</th>
<td>0.045282</td>
</tr>
<tr>
<th>5</th>
<td>0.046272</td>
</tr>
<tr>
<th>6</th>
<td>0.046715</td>
</tr>
<tr>
<th>7</th>
<td>0.047140</td>
</tr>
<tr>
<th>8</th>
<td>0.047540</td>
</tr>
<tr>
<th>9</th>
<td>0.048055</td>
</tr>
<tr>
<th>10</th>
<td>0.047805</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that as we use higher degree polynomial features, the validation error decreases and increases again.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cv_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">cv_df</span><span class="p">[</span><span class="s1">'Validation Error'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cv_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">cv_df</span><span class="p">[</span><span class="s1">'Validation Error'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Validation Error vs. Polynomial Degree'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Polynomial Degree'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Validation Error'</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cv_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">cv_df</span><span class="p">[</span><span class="s1">'Validation Error'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cv_df</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">cv_df</span><span class="p">[</span><span class="s1">'Validation Error'</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.044925</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Zoomed In'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Polynomial Degree'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Validation Error'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/bias_cv_26_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Examining the validation errors reveals that the most accurate model only used degree 2 polynomial features. Thus, we select the degree 2 polynomial model as our final model and fit it on the all of the training data at once. Then, we compute its error on the test set.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">best_trans</span> <span class="o">=</span> <span class="n">transformers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">best_model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_polys</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">training_error</span> <span class="o">=</span> <span class="n">mse_cost</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train_polys</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">validation_error</span> <span class="o">=</span> <span class="n">cross_validation_errors</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">test_error</span> <span class="o">=</span> <span class="n">mse_cost</span><span class="p">(</span><span class="n">best_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">best_trans</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)),</span> <span class="n">y_test</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Degree 2 polynomial'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'  Training error: </span><span class="si">{training_error:0.5f}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Validation error: </span><span class="si">{validation_error:0.5f}</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'      Test error: </span><span class="si">{test_error:0.5f}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Degree 2 polynomial
  Training error: 0.04409
Validation error: 0.04506
      Test error: 0.04698
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For future reference, <code>scikit-learn</code> has a <a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_predict.html"><code>cross_val_predict</code></a> method to automatically perform cross-validation, so we don't have to break the data into training and validation sets ourselves.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Also, note that the test error is higher than the validation error which is higher than the training error. The training error should be the lowest because the model is fit on the training data. Fitting the model minimizes the mean squared error for that dataset. The validation error and the test error are usually higher than the training error because the error is computed on an unknown dataset that the model hasn't seen.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We use the widely useful cross-validation technique to manage the bias-variance tradeoff. After computing a train-validation-test split on the original dataset, we use the following procedure to train and choose a model.</p>
<ol>
<li>For each potential set of features, fit a model using the training set. The error of a model on the training set is its <em>training error</em>.</li>
<li>Check the error of each model on the validation set using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1142-Title">
<title id="MathJax-SVG-1142-Title">k</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span>-fold cross-validation: its <em>validation error</em>. Select the model that achieves the lowest validation error. This is the final choice of features and model.</li>
<li>Calculate the <em>test error</em>, error of the final model on the test set. This is the final reported accuracy of the model. We are forbidden from adjusting the model to increase test error; doing so effectively converts the test set into a validation set. Instead, we must collect a new test set after making further changes to the model.</li>
</ol>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/16'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Regularization">Regularization<a class="anchor-link" href="#Regularization">¶</a></h1><p>Feature engineering can incorporate important information about the data
generation process into our model. However, adding features to the data also
typically increases the variance of our model and can thus result in worse
performance overall. Rather than throwing out features entirely, we can turn to
a technique called regularization to reduce the variance of our model while
still incorporating as much information about the data as possible.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/16'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'water_large.csv'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="n">Curve</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Curve'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'xs'</span><span class="p">,</span> <span class="s1">'ys'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">subseq</span> <span class="ow">in</span> <span class="n">seq</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subseq</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Curve</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                             <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">deg</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">curves</span><span class="p">,</span> <span class="n">degrees</span><span class="p">):</span>
        <span class="n">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Training data'</span><span class="p">)</span>
        <span class="n">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">f</span><span class="s1">'Deg </span><span class="si">{deg}</span><span class="s1"> poly'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
    <span class="c1"># add a big axes, hide frame</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># hide tick and tick label of the big axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span>
                    <span class="n">left</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">'off'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Polynomial Regression'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Water Level Change (m)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Water Flow (Liters)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">print_coef</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">'reg'</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">clfs</span><span class="p">]</span>

<span class="n">ridge_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">ridge_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">ridge_clfs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regularization-Intuition">Regularization Intuition<a class="anchor-link" href="#Regularization-Intuition">¶</a></h2><p>We begin our discussion of regularization with an example that illustrates the importance of regularization.</p>
<h2 id="Dam-Data">Dam Data<a class="anchor-link" href="#Dam-Data">¶</a></h2><p>The following dataset records the amount of water that flows out of a large dam on a particular day in liters and the amount the water level changed on that day in meters.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>water_level_change</th>
<th>water_flow</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-15.936758</td>
<td>6.042233e+10</td>
</tr>
<tr>
<th>1</th>
<td>-29.152979</td>
<td>3.321490e+10</td>
</tr>
<tr>
<th>2</th>
<td>36.189549</td>
<td>9.727064e+11</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>20</th>
<td>7.085480</td>
<td>2.363520e+11</td>
</tr>
<tr>
<th>21</th>
<td>46.282369</td>
<td>1.494256e+12</td>
</tr>
<tr>
<th>22</th>
<td>14.612289</td>
<td>3.781463e+11</td>
</tr>
</tbody>
</table>
<p>23 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Plotting this data shows an upward trend in water flow as the water level becomes more positive.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_intuition_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To model this pattern, we may use a least squares linear regression model. We show the data and the model's predictions on the plot below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">);</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_intuition_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The visualization shows that this model does not capture the pattern in the data—the model has high bias. As we have previously done, we can attempt to address this issue by adding polynomial features to the data. We add polynomial features of degrees 2, 8, and 12; the chart below shows the training data with each model's predictions.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_intuition_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, the degree 12 polynomial matches the training data well but also seems to fit spurious patterns in the data caused by noise. This provides yet another illustration of the bias-variance tradeoff: the linear model has high bias and low variance while the degree 12 polynomial has low bias but high variance.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Examining-Coefficients">Examining Coefficients<a class="anchor-link" href="#Examining-Coefficients">¶</a></h2><p>Examining the coefficients of the degree 12 polynomial model reveals that this model makes predictions according to the following formula:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100ex" height="6.009ex" style="vertical-align: -3.671ex; max-width: 60000px;" viewBox="0 -1006.6 43055.4 2587.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1143-Title">
<title id="MathJax-SVG-1143-Title">
207097470825 + 1.8x + 482.6x^2 + 601.5x^3 + 872.8x^4 + 150486.6x^5 \\
    + 2156.7x^6 - 307.2x^7 - 4.6x^8 + 0.2x^9 + 0.003x^{10} - 0.00005x^{11} + 0x^{12}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(7176,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="3503" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="4004" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="4504" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="5005" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="5505" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="6228" y="0"></use>
<g transform="translate(7228,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="8508" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="9303" y="0"></use>
<g transform="translate(10303,0)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-38" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1780" y="0"></use>
</g>
<g transform="translate(12584,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="13833" y="0"></use>
<g transform="translate(14833,0)">
 <use xlink:href="#MJMAIN-36"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1780" y="0"></use>
</g>
<g transform="translate(17114,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="18362" y="0"></use>
<g transform="translate(19363,0)">
 <use xlink:href="#MJMAIN-38"></use>
 <use xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1780" y="0"></use>
</g>
<g transform="translate(21644,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="22892" y="0"></use>
<g transform="translate(23893,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="2502" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="3003" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="3281" y="0"></use>
</g>
<g transform="translate(27675,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="809" y="583"></use>
</g>
</g>
<g transform="translate(6393,-1406)">
 <use xlink:href="#MJMAIN-2B" x="0" y="0"></use>
<g transform="translate(1000,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-31" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="2280" y="0"></use>
</g>
<g transform="translate(3781,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5030" y="0"></use>
<g transform="translate(6031,0)">
 <use xlink:href="#MJMAIN-33"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="1501" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1780" y="0"></use>
</g>
<g transform="translate(8311,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="9560" y="0"></use>
<g transform="translate(10560,0)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="779" y="0"></use>
</g>
<g transform="translate(11840,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="13089" y="0"></use>
<g transform="translate(14089,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
</g>
<g transform="translate(15369,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39" x="809" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="16617" y="0"></use>
<g transform="translate(17618,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-33" x="1780" y="0"></use>
</g>
<g transform="translate(19899,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="21501" y="0"></use>
<g transform="translate(22502,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="2781" y="0"></use>
</g>
<g transform="translate(25783,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="27386" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="28387" y="0"></use>
<g transform="translate(28887,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1144-Title">
<title id="MathJax-SVG-1144-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is the water level change on that day.</p>
<p>The coefficients for the model are quite large, especially for the higher degree terms which contribute significantly to the model's variance (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1026.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1145-Title">
<title id="MathJax-SVG-1145-Title"> x^5 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="809" y="513"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1026.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1146-Title">
<title id="MathJax-SVG-1146-Title"> x^6 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="809" y="513"></use>
</g>
</svg></span>, for example).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Penalizing-Parameters">Penalizing Parameters<a class="anchor-link" href="#Penalizing-Parameters">¶</a></h2><p>Recall that our linear model makes predictions according to the following, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1147-Title">
<title id="MathJax-SVG-1147-Title"> \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is the model weights and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1148-Title">
<title id="MathJax-SVG-1148-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is the vector of features:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.989ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 5592.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1149-Title">
<title id="MathJax-SVG-1149-Title">
f_\hat{\theta}(x) = \hat{\theta} \cdot x
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="4519" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="5020" y="0"></use>
</g>
</svg></span><p>To fit our model, we minimize the mean squared error cost function, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1150-Title">
<title id="MathJax-SVG-1150-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> is used to represent the data matrix and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1151-Title">
<title id="MathJax-SVG-1151-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> the observed outcomes:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.337ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14784.1 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1152-Title">
<title id="MathJax-SVG-1152-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>To minimize the cost above, we adjust <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1153-Title">
<title id="MathJax-SVG-1153-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> until we find the best combination of weights regardless of how large the weights are themselves. However, we have found that larger weights for more complex features result in high model variance. If we could instead alter the cost function to penalize large weight values, the resulting model will have lower variance. We use regularization to add this penalty.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/16'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">RidgeCV</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.float_format'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'water_large.csv'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="n">Curve</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Curve'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'xs'</span><span class="p">,</span> <span class="s1">'ys'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">subseq</span> <span class="ow">in</span> <span class="n">seq</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subseq</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Curve</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">'Deg </span><span class="si">{deg}</span><span class="s1"> poly'</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                             <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">curves</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Training data'</span><span class="p">)</span>
        <span class="n">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
    <span class="c1"># add a big axes, hide frame</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># hide tick and tick label of the big axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span>
                    <span class="n">left</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">'off'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Polynomial Regression'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Water Level Change (m)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Water Flow (Liters)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">'reg'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">coef_table</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="n">vals</span><span class="p">})</span>
            <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">'degree'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">clfs</span><span class="p">]</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="n">ridge_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">ridge_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">ridge_clfs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L2-Regularization:-Ridge-Regression">L2 Regularization: Ridge Regression<a class="anchor-link" href="#L2-Regularization:-Ridge-Regression">¶</a></h2><p>In this section we introduce <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1154-Title">
<title id="MathJax-SVG-1154-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization, a method of penalizing large weights in our cost function to lower model variance. We briefly review linear regression, then introduce regularization as a modification to the cost function.</p>
<p>To perform least squares linear regression, we use the model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.989ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 5592.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1155-Title">
<title id="MathJax-SVG-1155-Title">
f_\hat{\theta}(x) = \hat{\theta} \cdot x
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="4519" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="5020" y="0"></use>
</g>
</svg></span><p>We fit the model by minimizing the mean squared error cost function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.337ex" height="6.843ex" style="vertical-align: -2.624ex; margin-bottom: -0.214ex;" viewBox="0 -1724.2 14784.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1156-Title">
<title id="MathJax-SVG-1156-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}^n(y_i - f_\hat{\theta} (X_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,64)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,64)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In the above definitions, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1157-Title">
<title id="MathJax-SVG-1157-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represents the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1158-Title">
<title id="MathJax-SVG-1158-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> data matrix, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1159-Title">
<title id="MathJax-SVG-1159-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> represents a row of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1160-Title">
<title id="MathJax-SVG-1160-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1161-Title">
<title id="MathJax-SVG-1161-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> represents the observed outcomes, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1162-Title">
<title id="MathJax-SVG-1162-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> represents the model weights.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L2-Regularization-Definition">L2 Regularization Definition<a class="anchor-link" href="#L2-Regularization-Definition">¶</a></h2><p>To add <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1163-Title">
<title id="MathJax-SVG-1163-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization to the model, we modify the cost function above:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.717ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 19683.4 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1164-Title">
<title id="MathJax-SVG-1164-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2
    + \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="10398" y="0"></use>
 <use xlink:href="#MJMATHI-3BB" x="11398" y="0"></use>
<g transform="translate(12149,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(124,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="769" y="1697"></use>
</g>
<g transform="translate(13760,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1217" y="997"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Notice that the cost function above is the same as before with the addition of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1165-Title">
<title id="MathJax-SVG-1165-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.648ex" height="4.343ex" style="vertical-align: -1.338ex;" viewBox="0 -1293.7 4584.5 1869.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1166-Title">
<title id="MathJax-SVG-1166-Title"> \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
<g transform="translate(750,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="1494" y="682"></use>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
</g>
<g transform="translate(3269,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1217" y="997"></use>
</g>
</g>
</svg></span> term. The summation in this term sums the square of each model weight <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.651ex" height="3.509ex" style="vertical-align: -1.005ex;" viewBox="0 -1078.4 5447 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1167-Title">
<title id="MathJax-SVG-1167-Title"> \hat{\theta_1}, \hat{\theta_2}, \ldots, \hat{\theta_p} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
 <use xlink:href="#MJMAIN-2C" x="923" y="0"></use>
<g transform="translate(1368,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2291" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2737" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4076" y="0"></use>
<g transform="translate(4521,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="212" y="283"></use>
</g>
</g>
</svg></span>. The term also introduces a new scalar model parameter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1168-Title">
<title id="MathJax-SVG-1168-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> that adjusts the regularization penalty.</p>
<p>The regularization term causes the cost to increase if the values in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1169-Title">
<title id="MathJax-SVG-1169-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> are further away from 0. With the addition of regularization, the optimal model weights minimize the combination of loss and regularization penalty rather than the loss alone. Since the resulting model weights tend to be smaller in absolute value, the model has lower variance and higher bias.</p>
<p>Using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1170-Title">
<title id="MathJax-SVG-1170-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization with a linear model and the mean squared error cost function is also known more commonly as <strong>ridge regression</strong>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Regularization-Parameter">The Regularization Parameter<a class="anchor-link" href="#The-Regularization-Parameter">¶</a></h3><p>The regularization parameter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1171-Title">
<title id="MathJax-SVG-1171-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> controls the regularization penalty. A small <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1172-Title">
<title id="MathJax-SVG-1172-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> results in a small penalty—if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2418.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1173-Title">
<title id="MathJax-SVG-1173-Title"> \lambda = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1917" y="0"></use>
</g>
</svg></span> the regularization term is also <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1174-Title">
<title id="MathJax-SVG-1174-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span> and the cost is not regularized at all.</p>
<p>A large <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1175-Title">
<title id="MathJax-SVG-1175-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> terms results in a large penalty and therefore a simpler model. Increasing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1176-Title">
<title id="MathJax-SVG-1176-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> decreases the variance and increases the bias of the model. We use cross-validation to select the value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1177-Title">
<title id="MathJax-SVG-1177-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> that minimizes the validation error.</p>
<p><strong>Note about regularization in <code>scikit-learn</code>:</strong></p>
<p><code>scikit-learn</code> provides regression models that have regularization built-in. For example, to conduct ridge regression you may use the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Ridge.html"><code>sklearn.linear_model.Ridge</code></a> regression model. Note that <code>scikit-learn</code> models call the regularization parameter <code>alpha</code> instead of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1178-Title">
<title id="MathJax-SVG-1178-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p><code>scikit-learn</code> conveniently provides regularized models that perform cross-validation to select a good value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1179-Title">
<title id="MathJax-SVG-1179-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span>. For example, the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.RidgeCV.html#sklearn.linear_model.RidgeCV"><code>sklearn.linear_model.RidgeCV</code></a> allows users to input regularization parameter values and will automatically use cross-validation to select the parameter value with the least validation error.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bias-Term-Exclusion">Bias Term Exclusion<a class="anchor-link" href="#Bias-Term-Exclusion">¶</a></h3><p>Note that the bias term <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 923.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1180-Title">
<title id="MathJax-SVG-1180-Title"> \theta_0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
</g>
</svg></span> is not included in the summation of the regularization term. We do not penalize the bias term because increasing the bias term does not increase the variance of our model—the bias term simply shifts all predictions by a constant value.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Data-Normalization">Data Normalization<a class="anchor-link" href="#Data-Normalization">¶</a></h3><p>Notice that the regularization term <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.648ex" height="4.343ex" style="vertical-align: -1.338ex;" viewBox="0 -1293.7 4584.5 1869.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1181-Title">
<title id="MathJax-SVG-1181-Title"> \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
<g transform="translate(750,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="1494" y="682"></use>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
</g>
<g transform="translate(3269,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1217" y="997"></use>
</g>
</g>
</svg></span> penalizes each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2ex" height="3.509ex" style="vertical-align: -1.005ex;" viewBox="0 -1078.4 861.2 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1182-Title">
<title id="MathJax-SVG-1182-Title"> \hat{\theta_j} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
</g>
</svg></span> equally. However, the effect of each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2ex" height="3.509ex" style="vertical-align: -1.005ex;" viewBox="0 -1078.4 861.2 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1183-Title">
<title id="MathJax-SVG-1183-Title"> \hat{\theta_j} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
</g>
</svg></span> differs depending on the data itself. Consider this section of the water flow dataset after adding degree 8 polynomial features:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">'poly'</span><span class="p">]</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">]),</span>
             <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">f</span><span class="s1">'deg_</span><span class="si">{n}</span><span class="s1">_feat'</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>deg_0_feat</th>
<th>deg_1_feat</th>
<th>...</th>
<th>deg_6_feat</th>
<th>deg_7_feat</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-15.94</td>
<td>253.98</td>
<td>...</td>
<td>-261095791.08</td>
<td>4161020472.12</td>
</tr>
<tr>
<th>1</th>
<td>-29.15</td>
<td>849.90</td>
<td>...</td>
<td>-17897014961.65</td>
<td>521751305227.70</td>
</tr>
<tr>
<th>2</th>
<td>36.19</td>
<td>1309.68</td>
<td>...</td>
<td>81298431147.09</td>
<td>2942153527269.12</td>
</tr>
<tr>
<th>3</th>
<td>37.49</td>
<td>1405.66</td>
<td>...</td>
<td>104132296999.30</td>
<td>3904147586408.71</td>
</tr>
<tr>
<th>4</th>
<td>-48.06</td>
<td>2309.65</td>
<td>...</td>
<td>-592123531634.12</td>
<td>28456763821657.78</td>
</tr>
</tbody>
</table>
<p>5 rows × 8 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the degree 7 polynomial features have much larger values than the degree 1 features. This means that a large model weight for the degree 7 features affects the predictions much more than a large model weight for the degree 1 features. If we apply regularization to this data directly, the regularization penalty will disproportionately lower the model weight for the lower degree features. In practice, this often results in high model variance even after applying regularization since the features with large effect on prediction will not be affected.</p>
<p>To combat this, we <em>normalize</em> each data column by subtracting the mean and scaling the values in each column to be between -1 and 1. In <code>scikit-learn</code>, most regression models allow initializing with <code>normalize=True</code> to normalize the data before fitting.</p>
<p>Another analogous technique is <em>standardizing</em> the data columns by subtracting the mean and dividing by the standard deviation for each data column.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-Ridge-Regression">Using Ridge Regression<a class="anchor-link" href="#Using-Ridge-Regression">¶</a></h2><p>We have previously used polynomial features to fit polynomials of degree 2, 8, and 12 to water flow data. The original data and resulting model predictions are repeated below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>water_level_change</th>
<th>water_flow</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-15.94</td>
<td>60422330445.52</td>
</tr>
<tr>
<th>1</th>
<td>-29.15</td>
<td>33214896575.60</td>
</tr>
<tr>
<th>2</th>
<td>36.19</td>
<td>972706380901.06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>20</th>
<td>7.09</td>
<td>236352046523.78</td>
</tr>
<tr>
<th>21</th>
<td>46.28</td>
<td>1494256381086.73</td>
</tr>
<tr>
<th>22</th>
<td>14.61</td>
<td>378146284247.97</td>
</tr>
</tbody>
</table>
<p>23 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To conduct ridge regression, we first extract the data matrix and the vector of outcomes from the data:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'X: '</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'y: '</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>X: 
[[-15.94]
 [-29.15]
 [ 36.19]
 ...
 [  7.09]
 [ 46.28]
 [ 14.61]]

y: 
[6.04e+10 3.32e+10 9.73e+11 ... 2.36e+11 1.49e+12 3.78e+11]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we apply a degree 12 polynomial transform to <code>X</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>

<span class="c1"># We need to specify include_bias=False since sklearn's classifiers</span>
<span class="c1"># automatically add the intercept term.</span>
<span class="n">X_poly_8</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'First two rows of transformed X:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_poly_8</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>First two rows of transformed X:
[[-1.59e+01  2.54e+02 -4.05e+03  6.45e+04 -1.03e+06  1.64e+07 -2.61e+08
   4.16e+09]
 [-2.92e+01  8.50e+02 -2.48e+04  7.22e+05 -2.11e+07  6.14e+08 -1.79e+10
   5.22e+11]]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We specify <code>alpha</code> values that <code>scikit-learn</code> will select from using cross-validation, then use the <code>RidgeCV</code> classifier to fit the transformed data.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">RidgeCV</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="c1"># Remember to set normalize=True to normalize data</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_poly_8</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># Display the chosen alpha value:</span>
<span class="n">clf</span><span class="o">.</span><span class="n">alpha_</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.1</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we plot the model predictions for the base degree 8 polynomial classifier next to the regularized degree 8 classifier:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Base degree 8 polynomial'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">ridge_curves</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Regularized degree 8 polynomial'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_24_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the regularized polynomial is smoother than the base degree 8 polynomial and still captures the major trend in the data.</p>
<p>Comparing the coefficients of the non-regularized and regularized models shows that ridge regression favors placing model weights on the lower degree polynomial terms:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">base</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="s1">'Base'</span><span class="p">})</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">ridge_clfs</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="s1">'Regularized'</span><span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">display</span><span class="p">(</span><span class="n">base</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ridge</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Base</th>
<th>Regularized</th>
</tr>
<tr>
<th>degree</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>225782472111.94</td>
<td>221063525725.23</td>
</tr>
<tr>
<th>1</th>
<td>13115217770.78</td>
<td>6846139065.96</td>
</tr>
<tr>
<th>2</th>
<td>-144725749.98</td>
<td>146158037.96</td>
</tr>
<tr>
<th>3</th>
<td>-10355082.91</td>
<td>1930090.04</td>
</tr>
<tr>
<th>4</th>
<td>567935.23</td>
<td>38240.62</td>
</tr>
<tr>
<th>5</th>
<td>9805.14</td>
<td>564.21</td>
</tr>
<tr>
<th>6</th>
<td>-249.64</td>
<td>7.25</td>
</tr>
<tr>
<th>7</th>
<td>-2.09</td>
<td>0.18</td>
</tr>
<tr>
<th>8</th>
<td>0.03</td>
<td>0.00</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Repeating the process for degree 12 polynomial features results in a similar result:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Base degree 12 polynomial'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">ridge_curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Regularized degree 12 polynomial'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_28_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Increasing the regularization parameter results in progressively simpler models. The plot below demonstrates the effects of increasing the regularization amount from 0.001 to 100.0.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">]</span>

<span class="n">alpha_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
    <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))]</span>
<span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">]</span>

<span class="n">alpha_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">alpha_clfs</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">'$</span><span class="se">\\</span><span class="s1">lambda = </span><span class="si">{alpha}</span><span class="s1">$'</span> <span class="k">for</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="n">alphas</span><span class="p">]</span>

<span class="n">plot_curves</span><span class="p">(</span><span class="n">alpha_curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_ridge_30_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, increasing the regularization parameter increases the bias of our model. If our parameter is too large, the model becomes a constant model because any non-zero model weight is heavily penalized.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1184-Title">
<title id="MathJax-SVG-1184-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization allows us to tune model bias and variance by penalizing large model weights. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1185-Title">
<title id="MathJax-SVG-1185-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization for least squares linear regression is also known by the more common name ridge regression. Using regularization adds an additional model parameter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1186-Title">
<title id="MathJax-SVG-1186-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> that we adjust using cross-validation.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/16'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="k">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="k">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="p">(</span>
    <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">Ridge</span><span class="p">,</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">,</span> <span class="n">LassoCV</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.exceptions</span> <span class="k">import</span> <span class="n">ConvergenceWarning</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">"ignore"</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">ConvergenceWarning</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'default'</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">ConvergenceWarning</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.float_format'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'water_large.csv'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="n">Curve</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Curve'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'xs'</span><span class="p">,</span> <span class="s1">'ys'</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">subseq</span> <span class="ow">in</span> <span class="n">seq</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">subseq</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x_start</span><span class="o">=-</span><span class="mi">50</span><span class="p">,</span> <span class="n">x_end</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x_start</span><span class="p">,</span> <span class="n">x_end</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Curve</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_data</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">curve</span><span class="o">.</span><span class="n">xs</span><span class="p">,</span> <span class="n">curve</span><span class="o">.</span><span class="n">ys</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    
<span class="k">def</span> <span class="nf">plot_curves</span><span class="p">(</span><span class="n">curves</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="s1">'Deg </span><span class="si">{deg}</span><span class="s1"> poly'</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">curves</span><span class="p">)</span> <span class="o">/</span> <span class="n">cols</span><span class="p">))</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
                             <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">curve</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">curves</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
        <span class="n">plot_data</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Training data'</span><span class="p">)</span>
        <span class="n">plot_curve</span><span class="p">(</span><span class="n">curve</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        
    <span class="c1"># add a big axes, hide frame</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># hide tick and tick label of the big axes</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span>
                    <span class="n">left</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">'off'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Polynomial Regression'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Water Level Change (m)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Water Flow (Liters)'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s1">'reg'</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">reg</span><span class="o">.</span><span class="n">intercept_</span><span class="p">,</span> <span class="n">reg</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">coef_table</span><span class="p">(</span><span class="n">clf</span><span class="p">):</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="n">vals</span><span class="p">})</span>
            <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">'degree'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">]</span>
<span class="n">clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                  <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">LinearRegression</span><span class="p">())])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">clfs</span><span class="p">]</span>

<span class="n">alphas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">]</span>

<span class="n">ridge_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">RidgeCV</span><span class="p">(</span><span class="n">alphas</span><span class="o">=</span><span class="n">alphas</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">))])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>

<span class="n">ridge_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">ridge_clfs</span><span class="p">]</span>

<span class="n">lasso_clfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Pipeline</span><span class="p">([(</span><span class="s1">'poly'</span><span class="p">,</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="n">deg</span><span class="p">,</span> <span class="n">include_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
                        <span class="p">(</span><span class="s1">'reg'</span><span class="p">,</span> <span class="n">LassoCV</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">precompute</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">))])</span>
        <span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">degrees</span><span class="p">]</span>
<span class="n">lasso_curves</span> <span class="o">=</span> <span class="p">[</span><span class="n">make_curve</span><span class="p">(</span><span class="n">clf</span><span class="p">)</span> <span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="n">lasso_clfs</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L1-Regularization:-Lasso-Regression">L1 Regularization: Lasso Regression<a class="anchor-link" href="#L1-Regularization:-Lasso-Regression">¶</a></h2><p>In this section we introduce <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1187-Title">
<title id="MathJax-SVG-1187-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization, another regularization technique that is useful for feature selection.</p>
<p>We start with a brief review of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1188-Title">
<title id="MathJax-SVG-1188-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization for linear regression. We use the model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.989ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 5592.5 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1189-Title">
<title id="MathJax-SVG-1189-Title">
f_\hat{\theta}(x) = \hat{\theta} \cdot x
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="4519" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="5020" y="0"></use>
</g>
</svg></span><p>We fit the model by minimizing the mean squared error cost function with an additional regularization term:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.717ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 19683.4 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1190-Title">
<title id="MathJax-SVG-1190-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2
    + \lambda \sum_{j = 1}^{p} \hat{\theta_j}^2
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="10398" y="0"></use>
 <use xlink:href="#MJMATHI-3BB" x="11398" y="0"></use>
<g transform="translate(12149,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(124,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="769" y="1697"></use>
</g>
<g transform="translate(13760,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1217" y="997"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In the above definitions, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1191-Title">
<title id="MathJax-SVG-1191-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> represents the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1192-Title">
<title id="MathJax-SVG-1192-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> data matrix, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1193-Title">
<title id="MathJax-SVG-1193-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> represents a row of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1194-Title">
<title id="MathJax-SVG-1194-Title"> X </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1195-Title">
<title id="MathJax-SVG-1195-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> represents the observed outcomes, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1196-Title">
<title id="MathJax-SVG-1196-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> represents the model weights, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.355ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 583.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1197-Title">
<title id="MathJax-SVG-1197-Title"> \lambda </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BB" x="0" y="0"></use>
</g>
</svg></span> represents the regularization parameter.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="L1-Regularization-Definition">L1 Regularization Definition<a class="anchor-link" href="#L1-Regularization-Definition">¶</a></h2><p>To add <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1198-Title">
<title id="MathJax-SVG-1198-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization to the model, we modify the cost function above:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.956ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 19786.5 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1199-Title">
<title id="MathJax-SVG-1199-Title">
\begin{aligned}
L(\hat{\theta}, X, y)
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\hat{\theta} (X_i))^2
    + \lambda \sum_{j = 1}^{p} |\hat{\theta_j}|
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
<g transform="translate(1071,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1654" y="0"></use>
 <use xlink:href="#MJMATHI-58" x="2099" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2952" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="3397" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="3895" y="0"></use>
</g>
</g>
<g transform="translate(4274,0)">
<g transform="translate(0,110)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="7380" y="0"></use>
<g transform="translate(7770,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8942" y="0"></use>
<g transform="translate(9332,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="10398" y="0"></use>
 <use xlink:href="#MJMATHI-3BB" x="11398" y="0"></use>
<g transform="translate(12149,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(124,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="769" y="1697"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="13760" y="0"></use>
<g transform="translate(14038,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="180" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="14899" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Observe that the two cost functions only differ in their regularization term. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1200-Title">
<title id="MathJax-SVG-1200-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization penalizes the sum of the absolute weight values instead of the sum of squared values.</p>
<p>Using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1201-Title">
<title id="MathJax-SVG-1201-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization with a linear model and the mean squared error cost function is also known more commonly as <strong>lasso regression</strong>. (Lasso stands for Least Absolute Shrinkage and Selection Operator.)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-Lasso-and-Ridge-Regression">Comparing Lasso and Ridge Regression<a class="anchor-link" href="#Comparing-Lasso-and-Ridge-Regression">¶</a></h2><p>To conduct lasso regression, we make use of <code>scikit-learn</code>'s convenient <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LassoCV.html"><code>LassoCV</code></a> classifier, a version of the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.Lasso.html"><code>Lasso</code></a> classifier that performs cross-validation to select the regularization parameter. Below, we display our dataset of water level change and water flow out of a dam.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>water_level_change</th>
<th>water_flow</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>-15.94</td>
<td>60422330445.52</td>
</tr>
<tr>
<th>1</th>
<td>-29.15</td>
<td>33214896575.60</td>
</tr>
<tr>
<th>2</th>
<td>36.19</td>
<td>972706380901.06</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>20</th>
<td>7.09</td>
<td>236352046523.78</td>
</tr>
<tr>
<th>21</th>
<td>46.28</td>
<td>1494256381086.73</td>
</tr>
<tr>
<th>22</th>
<td>14.61</td>
<td>378146284247.97</td>
</tr>
</tbody>
</table>
<p>23 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the procedure is almost identical to using the <code>RidgeCV</code> classifier from the previous section, we omit the code and instead display the base degree 12 polynomial, ridge regression, and lasso regression model predictions below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Base'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">ridge_curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Ridge Regression'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plot_data</span><span class="p">()</span>
<span class="n">plot_curve</span><span class="p">(</span><span class="n">lasso_curves</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Lasso Regression'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">5e10</span><span class="p">,</span> <span class="mf">170e10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/reg_lasso_12_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that both regularized models have less variance than the base degree 12 polynomial. At a glance, it appears that using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1202-Title">
<title id="MathJax-SVG-1202-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1203-Title">
<title id="MathJax-SVG-1203-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization produces nearly identical models. Comparing the coefficients of ridge and lasso regression, however, reveals the most significant difference between the two types of regularization: the lasso regression model sets a number of model weights to zero.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">ridge</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">ridge_clfs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="s1">'Ridge'</span><span class="p">})</span>
<span class="n">lasso</span> <span class="o">=</span> <span class="n">coef_table</span><span class="p">(</span><span class="n">lasso_clfs</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'Coefficient Value'</span><span class="p">:</span> <span class="s1">'Lasso'</span><span class="p">})</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.float_format'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:.10f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">ridge</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lasso</span><span class="p">))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'display.float_format'</span><span class="p">,</span> <span class="s1">'</span><span class="si">{:.2f}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea ">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Ridge</th>
<th>Lasso</th>
</tr>
<tr>
<th>degree</th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>221303288116.2275085449</td>
<td>198212062407.2835693359</td>
</tr>
<tr>
<th>1</th>
<td>6953405307.7653837204</td>
<td>9655088668.0876655579</td>
</tr>
<tr>
<th>2</th>
<td>142621063.9297277331</td>
<td>198852674.1646585464</td>
</tr>
<tr>
<th>3</th>
<td>1893283.0567885502</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>4</th>
<td>38202.1520293704</td>
<td>34434.3458919188</td>
</tr>
<tr>
<th>5</th>
<td>484.4262914111</td>
<td>975.6965959434</td>
</tr>
<tr>
<th>6</th>
<td>8.1525126516</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>7</th>
<td>0.1197232472</td>
<td>0.0887942172</td>
</tr>
<tr>
<th>8</th>
<td>0.0012506185</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>9</th>
<td>0.0000289599</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>10</th>
<td>-0.0000000004</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>11</th>
<td>0.0000000069</td>
<td>0.0000000000</td>
</tr>
<tr>
<th>12</th>
<td>-0.0000000001</td>
<td>-0.0000000000</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you will forgive the verbose output above, you will notice that ridge regression results in non-zero weights for the all polynomial features. Lasso regression, on the other hand, produces weights of zero for seven features.</p>
<p>In other words, the lasso regression model completely tosses out a majority of the features when making predictions. Nonetheless, the plots above show that the lasso regression model will make nearly identical predictions compared to the ridge regression model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Feature-Selection-with-Lasso-Regression">Feature Selection with Lasso Regression<a class="anchor-link" href="#Feature-Selection-with-Lasso-Regression">¶</a></h2><p>Lasso regression performs <strong>feature selection</strong>—it discards a subset of the original features when fitting model parameters. This is particularly useful when working with high-dimensional data with many features. A model that only uses a few features to make a prediction will run much faster than a model that requires many calculations. Since unneeded features tend to increase model variance without decreasing bias, we can sometimes increase the accuracy of other models by using lasso regression to select a subset of features to use.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Lasso-vs.-Ridge-In-Practice">Lasso vs. Ridge In Practice<a class="anchor-link" href="#Lasso-vs.-Ridge-In-Practice">¶</a></h2><p>If our goal is merely to achieve the highest prediction accuracy, we can try both types of regularization and use cross-validation to select between the two types.</p>
<p>Sometimes we prefer one type of regularization over the other because it maps more closely to the domain we are working with. For example, if know that the phenomenon we are trying to model results from many small factors, we might prefer ridge regression because it won't discard these factors. On the other hand, some outcomes result from a few highly influential features. We prefer lasso regression in these situations because it will discard unneeded features.</p>
<p>Lasso regression models tend to take more computation to fit than ridge regression models which may also be a concern depending on your data and your available computational resources.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Using <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1204-Title">
<title id="MathJax-SVG-1204-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization, like <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1205-Title">
<title id="MathJax-SVG-1205-Title"> L_2 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="963" y="-213"></use>
</g>
</svg></span> regularization, allows us to tune model bias and variance by penalizing large model weights. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.637ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1135.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1206-Title">
<title id="MathJax-SVG-1206-Title"> L_1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="963" y="-213"></use>
</g>
</svg></span> regularization for least squares linear regression is also known by the more common name lasso regression. Lasso regression may also be used to perform feature selection since it discards insignificant features.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Classification">Classification<a class="anchor-link" href="#Classification">¶</a></h1><p>Thus far we have studied models for regression, the process of making
continuous, numerical estimations based on data. We now turn our attention to
<strong>classification</strong>, the process of making categorical predictions based on
data. For example, weather stations are interested in predicting whether
tomorrow will be rainy or not using the weather conditions today.</p>
<p>Together, regression and classification compose the primary approaches for
<em>supervised learning</em>, the general task of learning a model based on observed
input-output pairs.</p>
<p>We may reconstruct classification as a type of regression problem. Instead of
creating a model to predict an arbitrary number, we create a model to predict a
probability that a data point belongs to a category. This allows us to reuse
the machinery of linear regression for a regression on probabilities: logistic
regression.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="k">import</span> <span class="n">DictVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">jitter_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x_col</span><span class="p">,</span> <span class="n">y_col</span><span class="p">):</span>
    <span class="n">x_jittered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">x_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="n">y_jittered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">y_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">x_col</span><span class="p">:</span> <span class="n">x_jittered</span><span class="p">,</span> <span class="n">y_col</span><span class="p">:</span> <span class="n">y_jittered</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Regression-on-Probabilities">Regression on Probabilities<a class="anchor-link" href="#Regression-on-Probabilities">¶</a></h2><p>In basketball, players score by shooting a ball through a hoop. One such player, LeBron James, is widely considered one of the best basketball players ever for his incredible ability to score.</p>
<p><img alt="LeBron James (31944491583).jpg" height="480" src="https://upload.wikimedia.org/wikipedia/commons/4/4e/LeBron_James_%2831944491583%29.jpg" width="308"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>LeBron plays in the National Basketball Association (NBA), the United States's premier basketball league. We've collected a dataset of all of LeBron's attempts in the 2017 NBA Playoff Games using the NBA statistics website (<a href="https://stats.nba.com/">https://stats.nba.com/</a>).</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lebron</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'lebron.csv'</span><span class="p">)</span>
<span class="n">lebron</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>game_date</th>
<th>minute</th>
<th>opponent</th>
<th>action_type</th>
<th>shot_type</th>
<th>shot_distance</th>
<th>shot_made</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>20170415</td>
<td>10</td>
<td>IND</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>20170415</td>
<td>11</td>
<td>IND</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>20170415</td>
<td>14</td>
<td>IND</td>
<td>Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>381</th>
<td>20170612</td>
<td>46</td>
<td>GSW</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>382</th>
<td>20170612</td>
<td>47</td>
<td>GSW</td>
<td>Turnaround Fadeaway shot</td>
<td>2PT Field Goal</td>
<td>14</td>
<td>0</td>
</tr>
<tr>
<th>383</th>
<td>20170612</td>
<td>48</td>
<td>GSW</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>384 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each row of this dataset contains the following attributes of a shot LeBron attempted:</p>
<ul>
<li><code>game_date</code>: The date of the game.</li>
<li><code>minute</code>: The minute that the shot was attempted (each NBA game is 48 minutes long).</li>
<li><code>opponent</code>: The team abbreviation of LeBron's opponent.</li>
<li><code>action_type</code>: The type of action leading up to the shot.</li>
<li><code>shot_type'</code>: The type of shot (either a 2 point shot or 3 point shot).</li>
<li><code>shot_distance</code>: LeBron's distance from the basket when the shot was attempted (ft).</li>
<li><code>shot_made</code>: <code>0</code> if the shot missed, <code>1</code> if the shot went in.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We would like to use this dataset to predict whether LeBron will make future shots. This is a <em>classification problem</em>; we predict a category, not a continuous number as we do in regression.</p>
<p>We may reframe this classification problem as a type of regression problem by predicting the <em>probability</em> that a shot will go in. For example, we expect that the probability that LeBron makes a shot is lower when he is farther away from the basket.</p>
<p>We plot the shot attempts below, showing the distance from the basket on the x-axis and whether he made the shot on the y-axis. Jittering the points slightly on the y-axis mitigates overplotting.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">jitter_df</span><span class="p">(</span><span class="n">lebron</span><span class="p">,</span> <span class="s1">'shot_distance'</span><span class="p">,</span> <span class="s1">'shot_made'</span><span class="p">),</span>
           <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'LeBron Shot Make vs. Shot Distance'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_prob_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that LeBron tends to make most shots when he is within five feet of the basket. A simple least squares linear regression model fit on this data produces the following predictions:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">jitter_df</span><span class="p">(</span><span class="n">lebron</span><span class="p">,</span> <span class="s1">'shot_distance'</span><span class="p">,</span> <span class="s1">'shot_made'</span><span class="p">),</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Simple Linear Regression'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_prob_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Linear regression predicts a continuous value. To perform classification, however, we need to convert this value into a category: a shot make or miss. We can accomplish this by setting a cutoff, or <strong>classification threshold</strong>. If the regression predicts a value greater than 0.5, we predict that the shot will make. Otherwise, we predict that the shot will miss.</p>
<p>We draw the cutoff below as a green dashed line. According to this cutoff, our model predicts that LeBron will make a shot if he is within 15 feet of the basket.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">jitter_df</span><span class="p">(</span><span class="n">lebron</span><span class="p">,</span> <span class="s1">'shot_distance'</span><span class="p">,</span> <span class="s1">'shot_made'</span><span class="p">),</span>
           <span class="n">ci</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.4</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'g'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Cutoff for Classification'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_prob_13_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the steps above, we attempt to perform a regression to predict the probability that a shot will go in. If our regression produces a probability, setting a cutoff of 0.5 means that we predict that a shot will go in when our model thinks the shot going in is more likely than the shot missing. We will revisit the topic of classification thresholds later in the chapter.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Issues-with-Linear-Regression-for-Probabilities">Issues with Linear Regression for Probabilities<a class="anchor-link" href="#Issues-with-Linear-Regression-for-Probabilities">¶</a></h2><p>Unfortunately, our linear model's predictions cannot be interpreted as probabilities. Valid probabilities must lie between zero and one, but our linear model violates this condition. For example, the probability that LeBron makes a shot when he is 100 feet away from the basket should be close to zero. In this case, however, our model will predict a negative value.</p>
<p>If we alter our regression model so that its predictions may be interpreted as probabilities, we will have no qualms about using its predictions for classification. We accomplish this with a new prediction function and a new loss function. The resulting model is called a <strong>logistic model</strong>.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">jitter_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x_col</span><span class="p">,</span> <span class="n">y_col</span><span class="p">):</span>
    <span class="n">x_jittered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">x_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="n">y_jittered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">y_col</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">x_col</span><span class="p">:</span> <span class="n">x_jittered</span><span class="p">,</span> <span class="n">y_col</span><span class="p">:</span> <span class="n">y_jittered</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">lebron</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'lebron.csv'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Logistic-Model">The Logistic Model<a class="anchor-link" href="#The-Logistic-Model">¶</a></h2><p>In this section, we introduce the <strong>logistic model</strong>, a regression model that we use to predict probabilities.</p>
<p>Recall that fitting a model requires three components: a model that makes predictions, a loss function, and an optimization method. For the by-now familiar least squares linear regression, we select the model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.084ex" height="3.509ex" style="vertical-align: -0.998ex; margin-bottom: -0.174ex;" viewBox="0 -1006.6 6064 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1207-Title">
<title id="MathJax-SVG-1207-Title">
\begin{aligned}
f_\hat{\boldsymbol{\theta}} (\textbf{x}) &amp;= \hat{\boldsymbol{\theta}} \cdot \textbf{x}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
</g>
</g>
<g transform="translate(2438,0)">
<g transform="translate(0,-47)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="2183" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="2684" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>And the loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.586ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 14891.3 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1208-Title">
<title id="MathJax-SVG-1208-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{X}, \textbf{y})
&amp;= \frac{1}{n} \sum_{i}(y_i - f_\boldsymbol{\theta} (\textbf{X}_i))^2\\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
</g>
</g>
<g transform="translate(4379,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3905" y="0"></use>
<g transform="translate(4295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="5352" y="0"></use>
<g transform="translate(6352,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7341" y="0"></use>
<g transform="translate(7730,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8944" y="0"></use>
<g transform="translate(9334,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="583"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>We use gradient descent as our optimization method. In the definitions above, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1209-Title">
<title id="MathJax-SVG-1209-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> represents the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1210-Title">
<title id="MathJax-SVG-1210-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> data matrix (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1211-Title">
<title id="MathJax-SVG-1211-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> is the number of data points and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1212-Title">
<title id="MathJax-SVG-1212-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span> is the number of attributes), <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1213-Title">
<title id="MathJax-SVG-1213-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> represents a row of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1214-Title">
<title id="MathJax-SVG-1214-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1215-Title">
<title id="MathJax-SVG-1215-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> is the vector of observed outcomes. The vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.559ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 671.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1216-Title">
<title id="MathJax-SVG-1216-Title"> \boldsymbol{\hat{\theta}} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="6" y="0"></use>
 <use xlink:href="#MJMAINB-5E" x="95" y="291"></use>
</g>
</svg></span> contains the optimal model weights whereas <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1217-Title">
<title id="MathJax-SVG-1217-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> contains intermediate weight values generated during optimization.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Real-Numbers-to-Probabilities">Real Numbers to Probabilities<a class="anchor-link" href="#Real-Numbers-to-Probabilities">¶</a></h2><p>Observe that the model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.333ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 5740.4 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1218-Title">
<title id="MathJax-SVG-1218-Title"> f_\hat{\boldsymbol{\theta}} (\textbf{x}) = \hat{\boldsymbol{\theta}} \cdot \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2726" y="0"></use>
<g transform="translate(3782,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="4632" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="5132" y="0"></use>
</g>
</svg></span> can output any real number <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1219-Title">
<title id="MathJax-SVG-1219-Title"> \mathbb{R} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
</g>
</svg></span> since it produces a linear combination of the values in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1220-Title">
<title id="MathJax-SVG-1220-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>, which itself can contain any value from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1221-Title">
<title id="MathJax-SVG-1221-Title"> \mathbb{R} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>We can easily visualize this when <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1222-Title">
<title id="MathJax-SVG-1222-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is a scalar. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.426ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 3197.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1223-Title">
<title id="MathJax-SVG-1223-Title"> \hat \theta = 0.5</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-3D" x="861" y="0"></use>
<g transform="translate(1917,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</svg></span>, our model becomes <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.007ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 5600.3 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1224-Title">
<title id="MathJax-SVG-1224-Title"> f_\hat{\theta} (\textbf{x}) = 0.5 x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2024" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2691" y="0"></use>
<g transform="translate(3748,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-78" x="5027" y="0"></use>
</g>
</svg></span>. Its predictions can take on any value from negative infinity to positive infinity:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$f_\hat{\theta}(x)$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Model Predictions for $ \hat{\theta} = 0.5 $'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_log_model_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For classification tasks, we want to constrain <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.687ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2448.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1225-Title">
<title id="MathJax-SVG-1225-Title"> f_\hat{\boldsymbol{\theta}}(\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
</g>
</svg></span> so that its output can be interpreted as a probability. This means that it may only output values in the range <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.653ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2003.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1226-Title">
<title id="MathJax-SVG-1226-Title"> [0, 1] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1224" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="1724" y="0"></use>
</g>
</svg></span>. In addition, we would like large values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.687ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2448.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1227-Title">
<title id="MathJax-SVG-1227-Title"> f_\hat{\boldsymbol{\theta}}(\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
</g>
</svg></span> to correspond to high probabilities and small values to low probabilities.</p>
<h2 id="The-Logistic-Function">The Logistic Function<a class="anchor-link" href="#The-Logistic-Function">¶</a></h2><p>To accomplish this, we introduce the <strong>logistic function</strong>, often called the <strong>sigmoid function</strong>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.856ex" height="5.509ex" style="vertical-align: -2.171ex;" viewBox="0 -1437.2 6826.7 2372" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1228-Title">
<title id="MathJax-SVG-1228-Title">
\begin{aligned}
\sigma(t) = \frac{1}{1 + e^{-t}}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-5)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="572" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="962" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1323" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1990" y="0"></use>
<g transform="translate(2769,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="3216" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="1357" y="676"></use>
<g transform="translate(60,-752)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,288)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>For ease of reading, we often replace <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.256ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 971.3 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1229-Title">
<title id="MathJax-SVG-1229-Title"> e^x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-78" x="659" y="513"></use>
</g>
</svg></span> with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.691ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2881 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1230-Title">
<title id="MathJax-SVG-1230-Title"> \text{exp}(x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-65"></use>
 <use xlink:href="#MJMAIN-78" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="973" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1529" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1919" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2491" y="0"></use>
</g>
</svg></span> and write:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.677ex" height="5.843ex" style="vertical-align: -2.166ex; margin-bottom: -0.172ex;" viewBox="0 -1508.9 8902.5 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1231-Title">
<title id="MathJax-SVG-1231-Title">
\begin{aligned}
\sigma (t) = \frac{1}{1 + \text{exp}(-t)}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,88)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="572" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="962" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1323" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1990" y="0"></use>
<g transform="translate(2769,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="5291" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="2395" y="676"></use>
<g transform="translate(60,-771)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMAIN-65"></use>
 <use xlink:href="#MJMAIN-78" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="973" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3252" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3642" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="4420" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4782" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We plot the sigmoid function for values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.466ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5367.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1232-Title">
<title id="MathJax-SVG-1232-Title"> t \in [-10, 10] </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2208" x="639" y="0"></use>
 <use xlink:href="#MJMAIN-5B" x="1584" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1863" y="0"></use>
<g transform="translate(2641,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3642" y="0"></use>
<g transform="translate(4087,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-30" x="500" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-5D" x="5088" y="0"></use>
</g>
</svg></span> below.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">expit</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Sigmoid Function'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$ t $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \sigma(t) $'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_log_model_10_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Observe that the sigmoid function <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.979ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 1713 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1233-Title">
<title id="MathJax-SVG-1233-Title"> \sigma(t) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="572" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="962" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1323" y="0"></use>
</g>
</svg></span> takes in any real number <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1234-Title">
<title id="MathJax-SVG-1234-Title"> \mathbb{R} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
</g>
</svg></span> and outputs only numbers between 0 and 1. The function is monotonically increasing on its input <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1235-Title">
<title id="MathJax-SVG-1235-Title"> t </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span>; large values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1236-Title">
<title id="MathJax-SVG-1236-Title"> t </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span> correspond to values closer to 1, as desired. This is not a coincidence—the sigmoid function may be derived from a log ratio of probabilities, although we omit the derivation for brevity.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Logistic-Model-Definition">Logistic Model Definition<a class="anchor-link" href="#Logistic-Model-Definition">¶</a></h2><p>We may now take our linear model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.547ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 1957.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1237-Title">
<title id="MathJax-SVG-1237-Title"> \hat{\boldsymbol{\theta}} \cdot \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-22C5" x="849" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1350" y="0"></use>
</g>
</svg></span> and use it as the input to the sigmoid function to create the <strong>logistic model</strong>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.223ex" height="3.509ex" style="vertical-align: -0.998ex; margin-bottom: -0.174ex;" viewBox="0 -1006.6 7415.5 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1238-Title">
<title id="MathJax-SVG-1238-Title">
\begin{aligned}
f_\hat{\boldsymbol{\theta}} (\textbf{x}) = \sigma(\hat{\boldsymbol{\theta}} \cdot \textbf{x})
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2726" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="3782" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4355" y="0"></use>
<g transform="translate(4744,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="5594" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="6094" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6702" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>In other words, we take the output of linear regression—any number in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.678ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 722.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1239-Title">
<title id="MathJax-SVG-1239-Title"> \mathbb{R} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
</g>
</svg></span>— and use the sigmoid function to restrict the model's final output to be a valid probability between zero and one.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To develop some intuition for how the logistic model behaves, we restrict <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1240-Title">
<title id="MathJax-SVG-1240-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> to be a scalar and plot the logistic model's output for several values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1241-Title">
<title id="MathJax-SVG-1241-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">flatten</span><span class="p">(</span><span class="n">li</span><span class="p">):</span> <span class="k">return</span> <span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sub</span> <span class="ow">in</span> <span class="n">li</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sub</span><span class="p">]</span>

<span class="n">thetas</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">theta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">flatten</span><span class="p">(</span><span class="n">axes</span><span class="p">),</span> <span class="n">thetas</span><span class="p">):</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">theta</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ \hat{\theta} = $'</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">theta</span><span class="p">))</span>

<span class="c1"># add a big axes, hide frame</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># hide tick and tick label of the big axes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span>
                <span class="n">left</span><span class="o">=</span><span class="s1">'off'</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="s1">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'$x$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$ f_\hat{\theta}(x) $'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_log_model_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that changing the magnitude of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1242-Title">
<title id="MathJax-SVG-1242-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> changes the sharpness of the curve; the further away from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1243-Title">
<title id="MathJax-SVG-1243-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>, the sharper the curve. Flipping the sign of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1244-Title">
<title id="MathJax-SVG-1244-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> while keeping magnitude constant is equivalent to reflecting the curve over the y-axis.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We introduce the logistic model, a new prediction function that outputs probabilities. To construct the model, we use the output of linear regression as the input to the nonlinear logistic function.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">lebron</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'lebron.csv'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Loss-Function-for-the-Logistic-Model">A Loss Function for the Logistic Model<a class="anchor-link" href="#A-Loss-Function-for-the-Logistic-Model">¶</a></h2><p>We have defined a regression model for probabilities, the logistic model:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.223ex" height="3.509ex" style="vertical-align: -0.998ex; margin-bottom: -0.174ex;" viewBox="0 -1006.6 7415.5 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1245-Title">
<title id="MathJax-SVG-1245-Title">
\begin{aligned}
f_\hat{\boldsymbol{\theta}} (\textbf{x}) = \sigma(\hat{\boldsymbol{\theta}} \cdot \textbf{x})
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2726" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="3782" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4355" y="0"></use>
<g transform="translate(4744,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="5594" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="6094" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6702" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Like the model for linear regression, this model has parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1246-Title">
<title id="MathJax-SVG-1246-Title"> \hat{\boldsymbol{\theta}} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span>, a vector that contains one parameter for each feature of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1247-Title">
<title id="MathJax-SVG-1247-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>. We now address the problem of defining a loss function for this model that allows us to fit the model's parameters to data.</p>
<p>Intuitively, we want the model's predictions to match the data as closely as possible. Below we recreate a plot of LeBron's shot attempts in the 2017 NBA Playoffs using the distance of each shot from the basket. The points are jittered on the y-axis to mitigate overplotting.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">lebron</span><span class="p">,</span>
           <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">y_jitter</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'LeBron Shot Attempts'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Distance from Basket (ft)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Shot Made'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_cost_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Noticing the large cluster of made shots close to the basket and the smaller cluster of missed shots further from the basket, we expect that a logistic model fitted on this data might look like:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="k">import</span> <span class="n">expit</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">lebron</span><span class="p">,</span>
           <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">y_jitter</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="o">-</span><span class="mf">0.15</span> <span class="o">*</span> <span class="p">(</span><span class="n">xs</span> <span class="o">-</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Logistic model'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Possible logistic model fit'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Distance from Basket (ft)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Shot Made'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_cost_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we can use the mean squared error loss function as we have for linear regression, it is non-convex for a logistic model and thus difficult to optimize.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Cross-Entropy-Loss">Cross-Entropy Loss<a class="anchor-link" href="#Cross-Entropy-Loss">¶</a></h2><p>Instead of the mean squared error, we use the <strong>cross-entropy loss</strong>. Let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1248-Title">
<title id="MathJax-SVG-1248-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> represent the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1249-Title">
<title id="MathJax-SVG-1249-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> input data matrix, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1250-Title">
<title id="MathJax-SVG-1250-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> the vector of observed data values, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.516ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2374.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1251-Title">
<title id="MathJax-SVG-1251-Title"> f_\boldsymbol{\theta}(\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
</svg></span> the logistic model. <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1252-Title">
<title id="MathJax-SVG-1252-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> contains the current parameter values. Using this notation, the average cross-entropy loss is defined as:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.772ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 26596.2 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1253-Title">
<title id="MathJax-SVG-1253-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) = \frac{1}{n} \sum_i \left(- y_i \ln (f_\boldsymbol{\theta}(\textbf{X}_i)) - (1 - y_i) \ln (1 - f_\boldsymbol{\theta}(\textbf{X}_i) \right)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4668" y="0"></use>
<g transform="translate(5446,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(6851,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(8462,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="389" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2169,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3004" y="0"></use>
<g transform="translate(3393,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4382" y="0"></use>
<g transform="translate(4771,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6375" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6986" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7987" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8376" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="9099" y="0"></use>
<g transform="translate(10100,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="10935" y="0"></use>
<g transform="translate(11491,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12326" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="12715" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="13438" y="0"></use>
<g transform="translate(14439,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="15427" y="0"></use>
<g transform="translate(15817,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="17030" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17420" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You may observe that as usual we take the mean loss over each point in our dataset. The inner expression in the above summation represents the loss at one data point <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.601ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3272.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1254-Title">
<title id="MathJax-SVG-1254-Title">(\textbf{X}_i, y_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1603" y="0"></use>
<g transform="translate(2048,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2883" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.222ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 23775.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1255-Title">
<title id="MathJax-SVG-1255-Title">
\begin{aligned}
\ell(\boldsymbol{\theta}, \textbf{X}_i, y_i) = - y_i \ln (f_\boldsymbol{\theta}(\textbf{X}_i)) - (1 - y_i) \ln (1 - f_\boldsymbol{\theta}(\textbf{X}_i) )
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="807" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1369" y="0"></use>
<g transform="translate(1814,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3028" y="0"></use>
<g transform="translate(3473,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4308" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4975" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6031" y="0"></use>
<g transform="translate(6810,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(7811,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="8646" y="0"></use>
<g transform="translate(9036,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="10024" y="0"></use>
<g transform="translate(10414,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11628" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="12017" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="12629" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13629" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="14019" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="14742" y="0"></use>
<g transform="translate(15742,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="16577" y="0"></use>
<g transform="translate(17133,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="17968" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="18358" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="19081" y="0"></use>
<g transform="translate(20081,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="21070" y="0"></use>
<g transform="translate(21459,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="22673" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="23062" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1256-Title">
<title id="MathJax-SVG-1256-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> is either 0 or 1 in our dataset. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.2ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2669.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1257-Title">
<title id="MathJax-SVG-1257-Title"> y_i = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2168" y="0"></use>
</g>
</svg></span>, the first term in the loss is zero. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.2ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2669.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1258-Title">
<title id="MathJax-SVG-1258-Title"> y_i = 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2168" y="0"></use>
</g>
</svg></span>, the second term in the loss is zero. Thus, for each point in our dataset, only one term of the cross-entropy loss contributes to the overall loss.</p>
<p>Suppose <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.2ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2669.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1259-Title">
<title id="MathJax-SVG-1259-Title"> y_i = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2168" y="0"></use>
</g>
</svg></span> and our predicted probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.185ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4815.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1260-Title">
<title id="MathJax-SVG-1260-Title"> f_\boldsymbol{\theta}(\textbf{X}_i) = 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
<g transform="translate(1377,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2591" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3258" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="4315" y="0"></use>
</g>
</svg></span>—our model is completely correct. The loss for this point will be:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="55.222ex" height="12.176ex" style="vertical-align: -5.505ex;" viewBox="0 -2872.4 23775.9 5242.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1261-Title">
<title id="MathJax-SVG-1261-Title">
\begin{aligned}
\ell(\boldsymbol{\theta}, \textbf{X}_i, y_i)
&amp;= - y_i \ln (f_\boldsymbol{\theta}(\textbf{X}_i)) - (1 - y_i) \ln (1 - f_\boldsymbol{\theta}(\textbf{X}_i) ) \\
&amp;= - 0 - (1 - 0) \ln (1 - 0 ) \\
&amp;= - \ln (1) \\
&amp;= 0
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1976)">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="807" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1369" y="0"></use>
<g transform="translate(1814,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3028" y="0"></use>
<g transform="translate(3473,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4308" y="0"></use>
</g>
</g>
<g transform="translate(4687,0)">
<g transform="translate(0,1976)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(3114,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3949" y="0"></use>
<g transform="translate(4338,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="5326" y="0"></use>
<g transform="translate(5716,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6930" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7319" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7931" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8932" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="9321" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10044" y="0"></use>
<g transform="translate(11044,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11879" y="0"></use>
<g transform="translate(12435,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="13270" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="13660" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="14383" y="0"></use>
<g transform="translate(15383,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="16372" y="0"></use>
<g transform="translate(16761,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="17975" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="18364" y="0"></use>
</g>
<g transform="translate(0,625)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2112" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="2835" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3836" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="4225" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4948" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="5948" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6449" y="0"></use>
<g transform="translate(7005,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="7840" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8230" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8952" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="9953" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10454" y="0"></use>
</g>
<g transform="translate(0,-726)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2279,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3114" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3503" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4004" y="0"></use>
</g>
<g transform="translate(0,-2077)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1334" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As expected, the loss for a correct prediction is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1262-Title">
<title id="MathJax-SVG-1262-Title"> 0 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30" x="0" y="0"></use>
</g>
</svg></span>. You may verify that the further the predicted probability is from the true value, the greater the loss.</p>
<p>Minimizing the overall cross-entropy loss requires the model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.516ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2374.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1263-Title">
<title id="MathJax-SVG-1263-Title"> f_\boldsymbol{\theta}(\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
 <use xlink:href="#MJMAIN-28" x="988" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1377" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1985" y="0"></use>
</g>
</svg></span> to make the most accurate predictions it can. Conveniently, this loss function is convex, making gradient descent a useful choice for optimization.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Gradient-of-the-Cross-Entropy-Loss">Gradient of the Cross-Entropy Loss<a class="anchor-link" href="#Gradient-of-the-Cross-Entropy-Loss">¶</a></h2><p>In order to run gradient descent on a model's cross-entropy loss we must calculate the gradient of the loss function. First, we compute the derivative of the sigmoid function since we'll use it in our gradient calculation.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.671ex" height="21.509ex" style="vertical-align: -9.933ex; margin-bottom: -0.238ex;" viewBox="0 -4881.6 14497.2 9260.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1264-Title">
<title id="MathJax-SVG-1264-Title">
\begin{aligned}
\sigma(t) &amp;= \frac{1}{1 + e^{-t}} \\
\sigma'(t) &amp;= \frac{e^{-t}}{(1 + e^{-t})^2} \\
\sigma'(t) &amp;= \frac{1}{1 + e^{-t}} \cdot \left(1 - \frac{1}{1 + e^{-t}} \right) \\
\sigma'(t) &amp;= \sigma(t) (1 - \sigma(t))
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(295,3433)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="572" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="962" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1323" y="0"></use>
</g>
<g transform="translate(0,815)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="810" y="583"></use>
 <use xlink:href="#MJMAIN-28" x="867" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="1257" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1618" y="0"></use>
</g>
<g transform="translate(0,-1966)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="810" y="583"></use>
 <use xlink:href="#MJMAIN-28" x="867" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="1257" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1618" y="0"></use>
</g>
<g transform="translate(0,-4026)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2032" x="810" y="583"></use>
 <use xlink:href="#MJMAIN-28" x="867" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="1257" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1618" y="0"></use>
</g>
</g>
<g transform="translate(1997,0)">
<g transform="translate(0,3433)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="3216" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="1357" y="676"></use>
<g transform="translate(60,-752)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,288)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(0,815)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4448" height="60" x="0" y="220"></rect>
<g transform="translate(1538,676)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
<g transform="translate(60,-780)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1112" y="0"></use>
<g transform="translate(2112,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,288)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
<g transform="translate(3485,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="550" y="408"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1966)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="3216" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="1357" y="676"></use>
<g transform="translate(60,-752)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,288)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="5012" y="0"></use>
<g transform="translate(5513,0)">
 <use xlink:href="#MJSZ3-28"></use>
 <use xlink:href="#MJMAIN-31" x="736" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1459" y="0"></use>
<g transform="translate(2237,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="3216" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="1357" y="676"></use>
<g transform="translate(60,-752)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
<g transform="translate(466,288)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="778" y="0"></use>
</g>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-29" x="5915" y="-1"></use>
</g>
</g>
<g transform="translate(0,-4026)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1906" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="2296" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2657" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3047" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3436" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4159" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="5160" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5732" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="6122" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6483" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6873" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>The derivative of the sigmoid function can be conveniently expressed in terms of the sigmoid function itself.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a shorthand, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.191ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10415.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1265-Title">
<title id="MathJax-SVG-1265-Title"> \sigma_i = f_\boldsymbol{\theta}(\textbf{X}_i) = \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1193" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3238" y="0"></use>
<g transform="translate(3627,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4841" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5508" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="6564" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7137" y="0"></use>
<g transform="translate(7526,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="8962" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="9463" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10026" y="0"></use>
</g>
</svg></span>. We will soon need the gradient of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.127ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 915.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1266-Title">
<title id="MathJax-SVG-1266-Title"> \sigma_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</svg></span> with respect to the vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1267-Title">
<title id="MathJax-SVG-1267-Title"> \boldsymbol{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> so we will derive it now using a straightforward application of the chain rule.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="43.474ex" height="9.176ex" style="vertical-align: -4.005ex;" viewBox="0 -2226.5 18718.1 3950.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1268-Title">
<title id="MathJax-SVG-1268-Title">
\begin{aligned}
\nabla_{\boldsymbol{\theta}} \sigma_i
&amp;= \nabla_{\boldsymbol{\theta}} \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) \\
&amp;= \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) (1 - \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}))  \nabla_{\boldsymbol{\theta}} (\textbf{X}_i \cdot \boldsymbol{\theta}) \\
&amp;= \sigma_i (1 - \sigma_i) \textbf{X}_i 
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1326)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
<g transform="translate(1331,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2236,0)">
<g transform="translate(0,1326)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMATHI-3C3" x="2665" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3237" y="0"></use>
<g transform="translate(3627,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="5063" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="5564" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6126" y="0"></use>
</g>
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1906" y="0"></use>
<g transform="translate(2296,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="3732" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="4232" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4795" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5184" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5574" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6297" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="7297" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7870" y="0"></use>
<g transform="translate(8259,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="9695" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="10196" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10758" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="11148" y="0"></use>
<g transform="translate(11537,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12869" y="0"></use>
<g transform="translate(13258,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="14694" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="15195" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="15757" y="0"></use>
</g>
<g transform="translate(0,-1376)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="2249" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2639" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="3362" y="0"></use>
<g transform="translate(4362,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5278" y="0"></use>
<g transform="translate(5668,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we derive the gradient of the cross-entropy loss with respect to the model parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1269-Title">
<title id="MathJax-SVG-1269-Title"> \boldsymbol{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span>. In the derivation below, we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.191ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10415.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1270-Title">
<title id="MathJax-SVG-1270-Title"> \sigma_i = f_\boldsymbol{\theta}(\textbf{X}_i) = \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1193" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3238" y="0"></use>
<g transform="translate(3627,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4841" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5508" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="6564" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7137" y="0"></use>
<g transform="translate(7526,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="8962" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="9463" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10026" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="64.864ex" height="40.176ex" style="vertical-align: -19.217ex; margin-bottom: -0.288ex;" viewBox="0 -8900.1 27927.4 17297.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1271-Title">
<title id="MathJax-SVG-1271-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{X}, \textbf{y})
&amp;= \frac{1}{n} \sum_i \left(- y_i \ln (f_\boldsymbol{\theta}(\textbf{X}_i)) - (1 - y_i) \ln (1 - f_\boldsymbol{\theta}(\textbf{X}_i) \right) \\
&amp;= \frac{1}{n} \sum_i \left(- y_i \ln \sigma_i - (1 - y_i) \ln (1 - \sigma_i) \right) \\
\nabla_{\boldsymbol{\theta}} L(\boldsymbol{\theta}, \textbf{X}, \textbf{y})
&amp;= \frac{1}{n} \sum_i \left(
    - \frac{y_i}{\sigma_i} \nabla_{\boldsymbol{\theta}} \sigma_i
    + \frac{1 - y_i}{1 - \sigma_i} \nabla_{\boldsymbol{\theta}} \sigma_i \right) \\
&amp;= - \frac{1}{n} \sum_i \left(
    \frac{y_i}{\sigma_i} - \frac{1 - y_i}{1 - \sigma_i}
\right) \nabla_{\boldsymbol{\theta}} \sigma_i \\
&amp;= - \frac{1}{n} \sum_i \left(
    \frac{y_i}{\sigma_i} - \frac{1 - y_i}{1 - \sigma_i}
\right) \sigma_i (1 - \sigma_i) \textbf{X}_i \\
&amp;= - \frac{1}{n} \sum_i \left(
    y_i - \sigma_i
\right) \textbf{X}_i \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(1331,7430)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
</g>
<g transform="translate(0,1647)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</g>
<g transform="translate(5711,0)">
<g transform="translate(0,7430)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4072,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="389" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2169,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3004" y="0"></use>
<g transform="translate(3393,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="4382" y="0"></use>
<g transform="translate(4771,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5985" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6375" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6986" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7987" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8376" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="9099" y="0"></use>
<g transform="translate(10100,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="10935" y="0"></use>
<g transform="translate(11491,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12326" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="12715" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="13438" y="0"></use>
<g transform="translate(14439,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="15427" y="0"></use>
<g transform="translate(15817,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="17030" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="17420" y="0"></use>
</g>
</g>
<g transform="translate(0,4592)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4072,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="389" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2169,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(3171,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4309" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5309" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5699" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6422" y="0"></use>
<g transform="translate(7422,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8257" y="0"></use>
<g transform="translate(8813,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="9648" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="10038" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10761" y="0"></use>
<g transform="translate(11761,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12677" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13067" y="0"></use>
</g>
</g>
<g transform="translate(0,1647)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4072,0)">
 <use xlink:href="#MJSZ3-28"></use>
 <use xlink:href="#MJMAIN-2212" x="736" y="0"></use>
<g transform="translate(1515,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1035" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(59,-686)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2790,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(4122,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5260" y="0"></use>
<g transform="translate(6038,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="2759" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
</g>
<g transform="translate(9260,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(10591,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJSZ3-29" x="11507" y="-1"></use>
</g>
</g>
<g transform="translate(0,-1298)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4850,0)">
 <use xlink:href="#MJSZ3-28"></use>
<g transform="translate(736,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1035" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(59,-686)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="2234" y="0"></use>
<g transform="translate(3013,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="2759" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-29" x="6234" y="-1"></use>
</g>
<g transform="translate(11988,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
<g transform="translate(13319,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
<g transform="translate(0,-4242)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4850,0)">
 <use xlink:href="#MJSZ3-28"></use>
<g transform="translate(736,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1035" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(59,-686)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="2234" y="0"></use>
<g transform="translate(3013,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="2759" height="60" x="0" y="220"></rect>
<g transform="translate(100,725)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(60,-687)">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-29" x="6234" y="-1"></use>
</g>
<g transform="translate(11988,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12904" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="13293" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="14016" y="0"></use>
<g transform="translate(15017,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="15933" y="0"></use>
<g transform="translate(16322,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
<g transform="translate(0,-7080)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4850,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3363" y="0"></use>
</g>
<g transform="translate(8770,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The surprisingly simple gradient expression allows us to fit a logistic model to the cross-entropy loss using gradient descent:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.638ex" height="4.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1078.4 9747 1941.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1272-Title">
<title id="MathJax-SVG-1272-Title"> \hat{\boldsymbol{\theta}} = \displaystyle\arg \min_{\substack{\boldsymbol{\theta}}}  L(\boldsymbol{\theta}, \textbf{X}, \textbf{y})</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-3D" x="905" y="0"></use>
<g transform="translate(1961,0)">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-72" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="893" y="0"></use>
<g transform="translate(1560,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-69" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1112" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="891" y="-947"></use>
</g>
 <use xlink:href="#MJMATHI-4C" x="3395" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4076" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="4466" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="5028" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="5474" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6343" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="6788" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="7396" y="0"></use>
</g>
</g>
</svg></span><p>Section 17.6 delves into deriving update formulas for batch, stochastic, and mini-batch gradient descent.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Since the cross-entropy loss function is convex, we minimize it using gradient descent to fit logistic models to data. We now have the necessary components of logistic regression: the model, loss function, and minimization procedure. In Section 17.5, we take a closer look at why we use average cross-entropy loss for logistic regression.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="k">import</span> <span class="n">minimize</span> <span class="k">as</span> <span class="n">sci_min</span>
<span class="k">def</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">cost_fn</span><span class="p">,</span> <span class="n">grad_cost_fn</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">progress</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Uses scipy.minimize to minimize cost_fn using a form of gradient descent.</span>
<span class="sd">    '''</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">iters</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">gradient</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">grad_cost_fn</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">iters</span>
        <span class="k">if</span> <span class="n">progress</span> <span class="ow">and</span> <span class="n">iters</span> <span class="o">%</span> <span class="n">progress</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'theta: </span><span class="si">{theta}</span><span class="s1"> | cost: {cost_fn(theta, X, y):.2f}'</span><span class="p">)</span>
        <span class="n">iters</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="n">print_theta</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">sci_min</span><span class="p">(</span>
        <span class="n">objective</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">'BFGS'</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="n">gradient</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_theta</span><span class="p">,</span>
        <span class="n">tol</span><span class="o">=</span><span class="mf">1e-7</span>
    <span class="p">)</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-Logistic-Regression">Using Logistic Regression<a class="anchor-link" href="#Using-Logistic-Regression">¶</a></h2><p>We have developed all the components of logistic regression. First, the logistic model used to predict probabilities:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.223ex" height="3.509ex" style="vertical-align: -0.998ex; margin-bottom: -0.174ex;" viewBox="0 -1006.6 7415.5 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1273-Title">
<title id="MathJax-SVG-1273-Title">
\begin{aligned}
f_\hat{\boldsymbol{\theta}} (\textbf{x}) = \sigma(\hat{\boldsymbol{\theta}} \cdot \textbf{x})
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-47)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2726" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="3782" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4355" y="0"></use>
<g transform="translate(4744,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="5594" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="6094" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6702" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>Then, the cross-entropy loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.114ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 23299.1 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1274-Title">
<title id="MathJax-SVG-1274-Title">
\begin{aligned}
L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) = &amp;= \frac{1}{n} \sum_i \left(- y_i \ln \sigma_i - (1 - y_i) \ln (1 - \sigma_i ) \right) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4668" y="0"></use>
</g>
</g>
<g transform="translate(5436,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2461,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4072,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="389" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2169,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(3171,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="4309" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5309" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5699" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="6422" y="0"></use>
<g transform="translate(7422,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8257" y="0"></use>
<g transform="translate(8813,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="9648" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="10038" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10761" y="0"></use>
<g transform="translate(11761,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12677" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="13067" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>Finally, the gradient of the cross-entropy loss for gradient descent:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.229ex" height="6.509ex" style="vertical-align: -2.671ex;" viewBox="0 -1652.5 16029 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1275-Title">
<title id="MathJax-SVG-1275-Title">
\begin{aligned}
\nabla_{\boldsymbol{\theta}} L(\boldsymbol{\theta}, \textbf{X}, \textbf{y})
&amp;= - \frac{1}{n} \sum_i \left(
    y_i - \sigma_i
\right) \textbf{X}_i \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</g>
<g transform="translate(5711,0)">
<g transform="translate(0,175)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
<g transform="translate(2112,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(3239,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(4850,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3363" y="0"></use>
</g>
<g transform="translate(8770,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the expressions above, we let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1276-Title">
<title id="MathJax-SVG-1276-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> represent the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1277-Title">
<title id="MathJax-SVG-1277-Title"> n \times p </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> input data matrix, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1278-Title">
<title id="MathJax-SVG-1278-Title">\textbf{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span> a row of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1279-Title">
<title id="MathJax-SVG-1279-Title"> \textbf{X} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1280-Title">
<title id="MathJax-SVG-1280-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span> the vector of observed data values, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.687ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2448.6 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1281-Title">
<title id="MathJax-SVG-1281-Title"> f_\hat{\boldsymbol{\theta}}(\textbf{x}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1062" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="1451" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="2059" y="0"></use>
</g>
</svg></span> the logistic model with optimal parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1282-Title">
<title id="MathJax-SVG-1282-Title">\hat{\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span> . As a shorthand, we define <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.514ex" height="3.676ex" style="vertical-align: -1.171ex;" viewBox="0 -1078.4 10554.4 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1283-Title">
<title id="MathJax-SVG-1283-Title"> \sigma_i = f_\hat{\boldsymbol{\theta}}(\textbf{X}_i) = \sigma(\textbf{X}_i \cdot \hat{\boldsymbol{\theta}}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1193" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="3311" y="0"></use>
<g transform="translate(3701,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4915" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5582" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="6638" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7211" y="0"></use>
<g transform="translate(7600,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="9036" y="0"></use>
<g transform="translate(9537,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="10164" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Logistic-Regression-on-LeBron's-Shots">Logistic Regression on LeBron's Shots<a class="anchor-link" href="#Logistic-Regression-on-LeBron's-Shots">¶</a></h2><p>Let us now return to the problem we faced at the start of this chapter: predicting which shots LeBron James will make. We start by loading the dataset of shots taken by LeBron in the 2017 NBA Playoffs.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lebron</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'lebron.csv'</span><span class="p">)</span>
<span class="n">lebron</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>game_date</th>
<th>minute</th>
<th>opponent</th>
<th>action_type</th>
<th>shot_type</th>
<th>shot_distance</th>
<th>shot_made</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>20170415</td>
<td>10</td>
<td>IND</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>20170415</td>
<td>11</td>
<td>IND</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>2</th>
<td>20170415</td>
<td>14</td>
<td>IND</td>
<td>Layup Shot</td>
<td>2PT Field Goal</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>381</th>
<td>20170612</td>
<td>46</td>
<td>GSW</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<th>382</th>
<td>20170612</td>
<td>47</td>
<td>GSW</td>
<td>Turnaround Fadeaway shot</td>
<td>2PT Field Goal</td>
<td>14</td>
<td>0</td>
</tr>
<tr>
<th>383</th>
<td>20170612</td>
<td>48</td>
<td>GSW</td>
<td>Driving Layup Shot</td>
<td>2PT Field Goal</td>
<td>2</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>384 rows × 7 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We've included a widget below to allow you to pan through the entire DataFrame.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_interact</span><span class="p">(</span><span class="n">lebron</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_widget_view ">
<button class="js-nbinteract-widget">
      Loading widgets...
    </button>
</div>
</div>
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>(384 rows, 7 columns) total
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We start by using only the shot distance to predict whether or not the shot is made. <code>scikit-learn</code> conveniently provides a logistic regression classifier as the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html"><code>sklearn.linear_model.LogisticRegression</code></a> class. To use the class, we first create our data matrix <code>X</code> and vector of observed outcomes <code>y</code>.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">lebron</span><span class="p">[[</span><span class="s1">'shot_distance'</span><span class="p">]]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lebron</span><span class="p">[</span><span class="s1">'shot_made'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'X:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'y:'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>X:
[[ 0]
 [ 0]
 [ 0]
 ...
 [ 1]
 [14]
 [ 2]]

y:
[0 1 1 ... 1 0 1]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As is customary, we split our data into a training set and a test set.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Training set size: {len(y_train)}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Test set size: {len(y_test)}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size: 344
Test set size: 40
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>scikit-learn</code> makes it simple to initialize the classifier and fit it on <code>X_train</code> and <code>y_train</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="n">simple_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">simple_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,
          penalty='l2', random_state=None, solver='liblinear', tol=0.0001,
          verbose=0, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To visualize the classifier's performance, we plot the original points and the classifier's predicted probabilities.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN </span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'shot_made'</span><span class="p">,</span>
           <span class="n">data</span><span class="o">=</span><span class="n">lebron</span><span class="p">,</span>
           <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">ci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">y_jitter</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
           <span class="n">scatter_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">'alpha'</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">})</span>

<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span> <span class="o">=</span> <span class="n">simple_clf</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">xs</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'LeBron Training Data and Predictions'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Distance from Basket (ft)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Shot Made'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_log_reg_17_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluating-the-Classifier">Evaluating the Classifier<a class="anchor-link" href="#Evaluating-the-Classifier">¶</a></h2><p>One method to evaluate the effectiveness of our classifier is to check its prediction accuracy: what proportion of points does it predict correctly?</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simple_clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.6</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our classifier achieves a rather low accuracy of 0.60 on the test set. If our classifier simply guessed each point at random, we would expect an accuracy of 0.50. In fact, if our classifier simply predicted that every shot LeBron takes will go in, we would also get an accuracy of 0.60:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculates the accuracy if we always predict 1</span>
<span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">y_test</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.6</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For this classifier, we only used one out of several possible features. As in multivariable linear regression, we will likely achieve a more accurate classifier by incorporating more features.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multivariable-Logistic-Regression">Multivariable Logistic Regression<a class="anchor-link" href="#Multivariable-Logistic-Regression">¶</a></h2><p>Incorporating more numerical features in our classifier is as simple as extracting additional columns from the <code>lebron</code> DataFrame into the <code>X</code> matrix. Incorporating categorical features, on the other hand, requires us to apply a one-hot encoding. In the code below, we augment our classifier with the <code>minute</code>, <code>opponent</code>, <code>action_type</code>, and <code>shot_type</code> features, using the <code>DictVectorizer</code> class from <code>scikit-learn</code> to apply a one-hot encoding to the categorical variables.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="k">import</span> <span class="n">DictVectorizer</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'shot_distance'</span><span class="p">,</span> <span class="s1">'minute'</span><span class="p">,</span> <span class="s1">'action_type'</span><span class="p">,</span> <span class="s1">'shot_type'</span><span class="p">,</span> <span class="s1">'opponent'</span><span class="p">]</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">lebron</span><span class="p">[</span><span class="n">columns</span><span class="p">]</span><span class="o">.</span><span class="n">to_dict</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">'row'</span><span class="p">)</span>

<span class="n">onehot</span> <span class="o">=</span> <span class="n">DictVectorizer</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">onehot</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">lebron</span><span class="p">[</span><span class="s1">'shot_made'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(384, 42)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will again split the data into a training set and test set:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Training set size: {len(y_train)}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Test set size: {len(y_test)}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Training set size: 344
Test set size: 40
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, we fit our model once more and check its accuracy:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">()</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'Test set accuracy: {clf.score(X_test, y_test)}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Test set accuracy: 0.725
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This classifier is around 12% more accurate than the classifier that only took the shot distance into account. In Section 17.7, we explore additional metrics used to evaluate classifier performance.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>We have developed the mathematical and computational machinery needed to use logistic regression for classification. Logistic regression is widely used for its simplicity and effectiveness in prediction.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Approximating-the-Empirical-Probability-Distribution">Approximating the Empirical Probability Distribution<a class="anchor-link" href="#Approximating-the-Empirical-Probability-Distribution">¶</a></h2><p>In this section, we introduce <strong>KL divergence</strong> and demonstrate how minimizing average KL divergence in binary classification is equivalent to minimizing average cross-entropy loss.</p>
<p>Since logistic regression outputs probabilities, a logistic model produces a certain type of probability distribution. Specifically, based on optimal parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1284-Title">
<title id="MathJax-SVG-1284-Title"> \hat{\boldsymbol{\theta}} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span>, it estimates the probability that the label <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 497.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1285-Title">
<title id="MathJax-SVG-1285-Title"> y </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
</g>
</svg></span> is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1286-Title">
<title id="MathJax-SVG-1286-Title"> 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span> for an example input <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 607.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1287-Title">
<title id="MathJax-SVG-1287-Title"> \textbf{x} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-78" x="0" y="0"></use>
</g>
</svg></span>.</p>
<p>For example, suppose that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1288-Title">
<title id="MathJax-SVG-1288-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is a scalar recording the forecasted chance of rain for the day and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.416ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2332.1 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1289-Title">
<title id="MathJax-SVG-1289-Title"> y = 1 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="775" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1831" y="0"></use>
</g>
</svg></span> means that Mr. Doe takes his umbrella with him to work. A logistic model with scalar parameter <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1290-Title">
<title id="MathJax-SVG-1290-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> predicts the probability that Mr. Doe takes his umbrella given a forecasted chance of rain: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.698ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 5036.5 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1291-Title">
<title id="MathJax-SVG-1291-Title"> \hat{P_\theta}(y = 1 | x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="908" y="-219"></use>
 <use xlink:href="#MJMAIN-5E" x="286" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1074" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1463" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2239" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3295" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3796" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4074" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4647" y="0"></use>
</g>
</svg></span>.</p>
<p>Collecting data on Mr. Doe's umbrella usage provides us with a method of constructing an empirical probability distribution <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.948ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4713.6 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1292-Title">
<title id="MathJax-SVG-1292-Title"> P(y = 1 | x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1916" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2972" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3473" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3751" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4324" y="0"></use>
</g>
</svg></span>. For example, if there were five days where the chance of rain <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.562ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3686.6 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1293-Title">
<title id="MathJax-SVG-1293-Title"> x = 0.60 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="850" y="0"></use>
<g transform="translate(1906,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span> and Mr. Doe only took his umbrella to work once, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.413ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10941.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1294-Title">
<title id="MathJax-SVG-1294-Title"> P(y = 1 | x = 0.60) = 0.20 </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1916" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2972" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3473" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="3751" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4601" y="0"></use>
<g transform="translate(5658,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7438" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8105" y="0"></use>
<g transform="translate(9161,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1279" y="0"></use>
</g>
</g>
</svg></span>. We can compute a similar probability distribution for each value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1295-Title">
<title id="MathJax-SVG-1295-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> that appears in our data. Naturally, after fitting a logistic model we would like the distribution predicted by the model to be as close as possible to the empirical distribution from the dataset. That is, for all values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1296-Title">
<title id="MathJax-SVG-1296-Title"> x </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> that appear in our data, we want:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.744ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 11084.2 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1297-Title">
<title id="MathJax-SVG-1297-Title"> \hat{P_\theta}(y = 1 | x) \approx P(y = 1 | x) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="908" y="-219"></use>
 <use xlink:href="#MJMAIN-5E" x="286" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1074" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1463" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2239" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3295" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3796" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="4074" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4647" y="0"></use>
 <use xlink:href="#MJMAIN-2248" x="5314" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="6370" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7122" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="7511" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8286" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="9343" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="9843" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="10122" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10694" y="0"></use>
</g>
</svg></span><p>One commonly used metric to determine the "closeness" of two probability distributions is the Kullback–Leibler divergence, or KL divergence, which has its roots in information theory.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Defining-Average-KL-Divergence">Defining Average KL Divergence<a class="anchor-link" href="#Defining-Average-KL-Divergence">¶</a></h2><p>KL divergence quantifies the difference between the probability distribution <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1298-Title">
<title id="MathJax-SVG-1298-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> computed by our logistic model with parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1299-Title">
<title id="MathJax-SVG-1299-Title"> \boldsymbol{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> and the actual distribution <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1300-Title">
<title id="MathJax-SVG-1300-Title"> P </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> based on the dataset. Intuitively, it calculates how imprecisely the logistic model estimates the distribution of labels in data.</p>
<p>The KL divergence for binary classification between two distributions <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1301-Title">
<title id="MathJax-SVG-1301-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1302-Title">
<title id="MathJax-SVG-1302-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> for a single data point <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.41ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2329.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1303-Title">
<title id="MathJax-SVG-1303-Title">(\textbf{x}, y)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="997" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1442" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1939" y="0"></use>
</g>
</svg></span> is given by:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="74.969ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 32278.3 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1304-Title">
<title id="MathJax-SVG-1304-Title">D(P || \hat{P_\boldsymbol{\theta}}) = P(y = 0 | \textbf{x}) \ln \left(\frac{P(y = 0 | \textbf{x})}{\hat{P_\boldsymbol{\theta}}(y = 0 | \textbf{x})}\right) + P(y = 1 | \textbf{x}) \ln \left(\frac{P(y = 1 | \textbf{x})}{\hat{P_\boldsymbol{\theta}}(y = 1 | \textbf{x})}\right)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-44" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="828" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1218" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1969" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2248" y="0"></use>
<g transform="translate(2526,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3666" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4334" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="5390" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6141" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="6531" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="7306" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="8362" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="8863" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="9141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9749" y="0"></use>
<g transform="translate(10305,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(11140,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="5257" height="60" x="0" y="220"></rect>
<g transform="translate(254,770)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1916" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2972" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3473" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3751" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4359" y="0"></use>
</g>
<g transform="translate(60,-977)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1140" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1529" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2305" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3361" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3861" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="4140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4747" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="6289" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="18445" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="19445" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="20197" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="20586" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="21362" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="22418" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="22918" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="23197" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="23804" y="0"></use>
<g transform="translate(24360,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(25195,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="5257" height="60" x="0" y="220"></rect>
<g transform="translate(254,770)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1916" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2972" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3473" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="3751" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4359" y="0"></use>
</g>
<g transform="translate(60,-977)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1140" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="1529" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2305" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3361" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3861" y="0"></use>
 <use xlink:href="#MJMAINB-78" x="4140" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4747" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="6289" y="0"></use>
</g>
</g>
</svg></span><p>KL divergence is not symmetric, i.e., the divergence of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1305-Title">
<title id="MathJax-SVG-1305-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1306-Title">
<title id="MathJax-SVG-1306-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> is not the same as the divergence of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1307-Title">
<title id="MathJax-SVG-1307-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1308-Title">
<title id="MathJax-SVG-1308-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span>: <span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.94ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 9446.6 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1309-Title">
<title id="MathJax-SVG-1309-Title">D(P || \hat{P_\boldsymbol{\theta}}) \neq D(\hat{P_\boldsymbol{\theta}} || P)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-44" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="828" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1218" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1969" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2248" y="0"></use>
<g transform="translate(2526,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3666" y="0"></use>
 <use xlink:href="#MJMAIN-2260" x="4334" y="0"></use>
 <use xlink:href="#MJMATHI-44" x="5390" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6218" y="0"></use>
<g transform="translate(6608,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="7748" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="8027" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="8305" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="9057" y="0"></use>
</g>
</svg></span></p>
<p>Since our goal is to use <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1310-Title">
<title id="MathJax-SVG-1310-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> to approximate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1311-Title">
<title id="MathJax-SVG-1311-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span>, we are concerned with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.421ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 4056.2 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1312-Title">
<title id="MathJax-SVG-1312-Title"> D(P || \hat{P_\boldsymbol{\theta}}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-44" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="828" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="1218" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1969" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2248" y="0"></use>
<g transform="translate(2526,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3666" y="0"></use>
</g>
</svg></span>.</p>
<p>The best <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1313-Title">
<title id="MathJax-SVG-1313-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> values, which we denote as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.457ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 627.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1314-Title">
<title id="MathJax-SVG-1314-Title">\hat{\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
</g>
</svg></span>, minimize the average KL divergence of the entire dataset of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 600.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1315-Title">
<title id="MathJax-SVG-1315-Title">n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
</g>
</svg></span> points:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="108.196ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 46584.3 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1316-Title">
<title id="MathJax-SVG-1316-Title"> \text{Average KL Divergence} = \frac{1}{n} \sum_{i=1}^{n} \left(P(y_i = 0 | \textbf{X}_i) \ln \left(\frac{P(y_i = 0 | \textbf{X}_i)}{\hat{P_\boldsymbol{\theta}}(y_i = 0 | \textbf{X}_i)}\right) + P(y_i = 1 | \textbf{X}_i) \ln \left(\frac{P(y_i = 1 | \textbf{X}_i)}{\hat{P_\boldsymbol{\theta}}(y_i = 1 | \textbf{X}_i)}\right)\right)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-4B" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="4590" y="0"></use>
 <use xlink:href="#MJMAIN-44" x="5465" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="6230" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="6508" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7037" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="7481" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="7874" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="8374" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="8819" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="9375" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="9820" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="10542" y="0"></use>
<g transform="translate(11320,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(12725,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(14336,0)">
 <use xlink:href="#MJSZ4-28"></use>
 <use xlink:href="#MJMATHI-50" x="792" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1544" y="0"></use>
<g transform="translate(1933,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="3046" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="4102" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4602" y="0"></use>
<g transform="translate(4881,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6095" y="0"></use>
<g transform="translate(6651,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(7486,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="6200" height="60" x="0" y="220"></rect>
<g transform="translate(254,770)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3810" y="0"></use>
<g transform="translate(4088,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5302" y="0"></use>
</g>
<g transform="translate(60,-977)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1140" y="0"></use>
<g transform="translate(1529,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2642" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3698" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4199" y="0"></use>
<g transform="translate(4477,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5691" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="7233" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="15734" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="16735" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="17486" y="0"></use>
<g transform="translate(17876,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="18988" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="20045" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="20545" y="0"></use>
<g transform="translate(20824,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="22037" y="0"></use>
<g transform="translate(22594,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(23429,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="6200" height="60" x="0" y="220"></rect>
<g transform="translate(254,770)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3810" y="0"></use>
<g transform="translate(4088,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5302" y="0"></use>
</g>
<g transform="translate(60,-977)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1140" y="0"></use>
<g transform="translate(1529,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2642" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3698" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4199" y="0"></use>
<g transform="translate(4477,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5691" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="7233" y="0"></use>
</g>
 <use xlink:href="#MJSZ4-29" x="31454" y="0"></use>
</g>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.704ex" height="4.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1078.4 16233.5 1941.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1317-Title">
<title id="MathJax-SVG-1317-Title"> \hat{\boldsymbol{\theta}} = \displaystyle\arg \min_{\substack{\boldsymbol{\theta}}} (\text{Average KL Divergence}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-3D" x="905" y="0"></use>
<g transform="translate(1961,0)">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-72" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="893" y="0"></use>
<g transform="translate(1560,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-69" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1112" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="891" y="-947"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3228" y="0"></use>
<g transform="translate(3618,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-4B" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="4590" y="0"></use>
 <use xlink:href="#MJMAIN-44" x="5465" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="6230" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="6508" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7037" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="7481" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="7874" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="8374" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="8819" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="9375" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="9820" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="13882" y="0"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the above equation, the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1114.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1318-Title">
<title id="MathJax-SVG-1318-Title">i^{\text{th}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
<g transform="translate(345,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-74"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-68" x="389" y="0"></use>
</g>
</g>
</svg></span> data point is represented as (<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.819ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1213.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1319-Title">
<title id="MathJax-SVG-1319-Title"> \textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1320-Title">
<title id="MathJax-SVG-1320-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span>) where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.819ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1213.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1321-Title">
<title id="MathJax-SVG-1321-Title"> \textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</svg></span> is the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.588ex" height="2.509ex" style="vertical-align: -0.338ex;" viewBox="0 -934.9 1114.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1322-Title">
<title id="MathJax-SVG-1322-Title">i^{\text{th}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
<g transform="translate(345,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-74"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-68" x="389" y="0"></use>
</g>
</g>
</svg></span> row of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.405ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 2326.9 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1323-Title">
<title id="MathJax-SVG-1323-Title">n \times p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMATHI-70" x="1823" y="0"></use>
</g>
</svg></span> data matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1324-Title">
<title id="MathJax-SVG-1324-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1325-Title">
<title id="MathJax-SVG-1325-Title"> y_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> is the observed outcome.</p>
<p>KL divergence does not penalize mismatch for rare events with respect to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1326-Title">
<title id="MathJax-SVG-1326-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span>. If the model predicts a high probability for an event that is actually rare, then both <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.766ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 2052 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1327-Title">
<title id="MathJax-SVG-1327-Title">P(k)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="1141" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1662" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.302ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 4435.5 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1328-Title">
<title id="MathJax-SVG-1328-Title">\ln \left(\frac{P(k)}{\hat{P_\boldsymbol{\theta}}(k)}\right)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
<g transform="translate(835,0)">
 <use xlink:href="#MJSZ3-28"></use>
<g transform="translate(736,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1887" height="60" x="0" y="220"></rect>
<g transform="translate(218,622)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6B" x="1141" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="1662" y="0"></use>
</g>
<g transform="translate(60,-653)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMATHBI-3B8" x="791" y="-279"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="349" y="306"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="1199" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6B" x="1588" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2110" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ3-29" x="2864" y="-1"></use>
</g>
</g>
</svg></span> are low so the divergence is also low. However, if the model predicts a low probability for an event that is actually common, then the divergence is high. We can deduce that a logistic model that accurately predicts common events has a lower divergence from <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1329-Title">
<title id="MathJax-SVG-1329-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> than does a model that accurately predicts rare events but varies widely on common events.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Deriving-Cross-Entropy-Loss-from-KL-Divergence">Deriving Cross-Entropy Loss from KL Divergence<a class="anchor-link" href="#Deriving-Cross-Entropy-Loss-from-KL-Divergence">¶</a></h2><p>The structure of the above average KL divergence equation contains some surface similarities with cross-entropy loss. We will now show with some algebraic manipulation that minimizing average KL divergence is in fact equivalent to minimizing average cross-entropy loss.</p>
<p>Using properties of logarithms, we can rewrite the weighted log ratio:
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="99.632ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 42896.8 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1330-Title">
<title id="MathJax-SVG-1330-Title">P(y_i = k | \textbf{X}_i) \ln \left(\frac{P(y_i = k | \textbf{X}_i)}{\hat{P_\boldsymbol{\theta}}(y_i = k | \textbf{X}_i)}\right) = P(y_i = k | \textbf{X}_i) \ln P(y_i = k | \textbf{X}_i) - P(y_i = k | \textbf{X}_i) \ln \hat{P_\boldsymbol{\theta}}(y_i = k | \textbf{X}_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3831" y="0"></use>
<g transform="translate(4109,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5323" y="0"></use>
<g transform="translate(5879,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(6714,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="6221" height="60" x="0" y="220"></rect>
<g transform="translate(254,770)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3831" y="0"></use>
<g transform="translate(4109,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5323" y="0"></use>
</g>
<g transform="translate(60,-977)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
 <use xlink:href="#MJMAIN-28" x="1140" y="0"></use>
<g transform="translate(1529,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2642" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="3698" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4220" y="0"></use>
<g transform="translate(4498,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5712" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="7254" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="15039" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="16095" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="16847" y="0"></use>
<g transform="translate(17236,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="18349" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="19405" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="19927" y="0"></use>
<g transform="translate(20205,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="21419" y="0"></use>
<g transform="translate(21975,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-50" x="22977" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="23728" y="0"></use>
<g transform="translate(24118,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="25230" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="26287" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="26808" y="0"></use>
<g transform="translate(27087,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="28300" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="28912" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="29913" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="30664" y="0"></use>
<g transform="translate(31054,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="32166" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="33223" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="33744" y="0"></use>
<g transform="translate(34023,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="35237" y="0"></use>
<g transform="translate(35793,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(36794,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="37935" y="0"></use>
<g transform="translate(38324,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="39437" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="40493" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="41015" y="0"></use>
<g transform="translate(41293,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="42507" y="0"></use>
</g>
</svg></span></p>
<p>Note that since the first term doesn't depend on <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1331-Title">
<title id="MathJax-SVG-1331-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span>, it doesn't affect <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.499ex" height="3.843ex" style="vertical-align: -2.005ex;" viewBox="0 -791.3 3228.7 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1332-Title">
<title id="MathJax-SVG-1332-Title">\displaystyle\arg \min_{\substack{\boldsymbol{\theta}}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-72" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="893" y="0"></use>
<g transform="translate(1560,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-69" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1112" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="891" y="-947"></use>
</g>
</g>
</svg></span> and can be removed from the equation. The resulting expression is the cross-entropy loss of the model <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1333-Title">
<title id="MathJax-SVG-1333-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="102.531ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 44145.1 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1334-Title">
<title id="MathJax-SVG-1334-Title"> \text{Average Cross-Entropy Loss} = \frac{1}{n} \sum_{i=1}^{n} - P(y_i = 0 | \textbf{X}_i) \ln \hat{P_\theta}(y_i = 0 | \textbf{X}_i) - P(y_i = 1 | \textbf{X}_i) \ln \hat{P_\theta}(y_i = 1 | \textbf{X}_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-43" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4534" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4926" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5427" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5821" y="0"></use>
 <use xlink:href="#MJMAIN-2D" x="6216" y="0"></use>
 <use xlink:href="#MJMAIN-45" x="6549" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="7231" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="7787" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="8177" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8569" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="9070" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="9626" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="10405" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="11030" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11531" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11925" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="12597" y="0"></use>
<g transform="translate(13376,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(14781,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="16392" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="17170" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="17922" y="0"></use>
<g transform="translate(18311,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="19424" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="20480" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="20981" y="0"></use>
<g transform="translate(21259,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="22473" y="0"></use>
<g transform="translate(23029,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(24031,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="908" y="-219"></use>
 <use xlink:href="#MJMAIN-5E" x="286" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="25105" y="0"></use>
<g transform="translate(25495,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="26607" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="27664" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="28164" y="0"></use>
<g transform="translate(28443,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="29657" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="30268" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="31269" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="32020" y="0"></use>
<g transform="translate(32410,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="33523" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="34579" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="35079" y="0"></use>
<g transform="translate(35358,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="36572" y="0"></use>
<g transform="translate(37128,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(38129,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="908" y="-219"></use>
 <use xlink:href="#MJMAIN-5E" x="286" y="261"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="39204" y="0"></use>
<g transform="translate(39593,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="40706" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="41762" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="42263" y="0"></use>
<g transform="translate(42541,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="43755" y="0"></use>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.478ex" height="4.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1078.4 18289 1941.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1335-Title">
<title id="MathJax-SVG-1335-Title"> \hat{\boldsymbol{\theta}} = \displaystyle\arg \min_{\substack{\theta}} (\text{Average Cross-Entropy Loss}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-3D" x="905" y="0"></use>
<g transform="translate(1961,0)">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-72" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="893" y="0"></use>
<g transform="translate(1560,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-69" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1112" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="937" y="-948"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3228" y="0"></use>
<g transform="translate(3618,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-43" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4534" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4926" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5427" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5821" y="0"></use>
 <use xlink:href="#MJMAIN-2D" x="6216" y="0"></use>
 <use xlink:href="#MJMAIN-45" x="6549" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="7231" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="7787" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="8177" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8569" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="9070" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="9626" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="10405" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="11030" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11531" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11925" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="15938" y="0"></use>
</g>
</g>
</svg></span><p>Since the label <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1336-Title">
<title id="MathJax-SVG-1336-Title">y_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> is a known value, the probability that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.2ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2669.4 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1337-Title">
<title id="MathJax-SVG-1337-Title">y_i = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1112" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="2168" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.221ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5692.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1338-Title">
<title id="MathJax-SVG-1338-Title">P(y_i = 1 | \textbf{X}_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3810" y="0"></use>
<g transform="translate(4088,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5302" y="0"></use>
</g>
</svg></span>, is equal to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.939ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 834.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1339-Title">
<title id="MathJax-SVG-1339-Title">y_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.221ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 5692.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1340-Title">
<title id="MathJax-SVG-1340-Title">P(y_i = 0 | \textbf{X}_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="751" y="0"></use>
<g transform="translate(1141,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3309" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3810" y="0"></use>
<g transform="translate(4088,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5302" y="0"></use>
</g>
</svg></span> is equal to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.942ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2558.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1341-Title">
<title id="MathJax-SVG-1341-Title">1 - y_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
</g>
</svg></span>. The model's probability distribution <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1342-Title">
<title id="MathJax-SVG-1342-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> is given by the output of the sigmoid function discussed in the previous two sections. After making these substitutions, we arrive at the average cross-entropy loss equation:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="80.102ex" height="6.343ex" style="vertical-align: -3.005ex;" viewBox="0 -1437.2 34488 2730.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1343-Title">
<title id="MathJax-SVG-1343-Title"> \text{Average Cross-Entropy Loss} = \frac{1}{n} \sum_i \left(- y_i \ln (f_\hat{\boldsymbol{\theta}}(\textbf{X}_i)) - (1 - y_i) \ln (1 - f_\hat{\boldsymbol{\theta}}(\textbf{X}_i) \right) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-43" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4534" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4926" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5427" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5821" y="0"></use>
 <use xlink:href="#MJMAIN-2D" x="6216" y="0"></use>
 <use xlink:href="#MJMAIN-45" x="6549" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="7231" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="7787" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="8177" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8569" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="9070" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="9626" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="10405" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="11030" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11531" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11925" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="12597" y="0"></use>
<g transform="translate(13376,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(14781,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="848" y="-1536"></use>
</g>
<g transform="translate(16392,0)">
 <use xlink:href="#MJSZ1-28"></use>
 <use xlink:href="#MJMAIN-2212" x="458" y="0"></use>
<g transform="translate(1237,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2238,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3073" y="0"></use>
<g transform="translate(3462,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="4525" y="0"></use>
<g transform="translate(4914,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6128" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="6517" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7129" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8130" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="8519" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="9242" y="0"></use>
<g transform="translate(10243,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11078" y="0"></use>
<g transform="translate(11634,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="12469" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="12858" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="13581" y="0"></use>
<g transform="translate(14582,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-377)">
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="166" y="325"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="15644" y="0"></use>
<g transform="translate(16033,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="17247" y="0"></use>
 <use xlink:href="#MJSZ1-29" x="17637" y="-1"></use>
</g>
</g>
</svg></span><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.478ex" height="4.509ex" style="vertical-align: -2.005ex;" viewBox="0 -1078.4 18289 1941.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1344-Title">
<title id="MathJax-SVG-1344-Title"> \hat{\boldsymbol{\theta}} = \displaystyle\arg \min_{\substack{\theta}} (\text{Average Cross-Entropy Loss}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="126" y="280"></use>
 <use xlink:href="#MJMAIN-3D" x="905" y="0"></use>
<g transform="translate(1961,0)">
 <use xlink:href="#MJMAIN-61"></use>
 <use xlink:href="#MJMAIN-72" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="893" y="0"></use>
<g transform="translate(1560,0)">
 <use xlink:href="#MJMAIN-6D"></use>
 <use xlink:href="#MJMAIN-69" x="833" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1112" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="937" y="-948"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3228" y="0"></use>
<g transform="translate(3618,0)">
 <use xlink:href="#MJMAIN-41"></use>
 <use xlink:href="#MJMAIN-76" x="750" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1723" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="2116" y="0"></use>
 <use xlink:href="#MJMAIN-67" x="2616" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3117" y="0"></use>
 <use xlink:href="#MJMAIN-43" x="3811" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="4534" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="4926" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5427" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="5821" y="0"></use>
 <use xlink:href="#MJMAIN-2D" x="6216" y="0"></use>
 <use xlink:href="#MJMAIN-45" x="6549" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="7231" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="7787" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="8177" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="8569" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="9070" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="9626" y="0"></use>
 <use xlink:href="#MJMAIN-4C" x="10405" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="11030" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11531" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="11925" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="15938" y="0"></use>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Statistical-justification-for-Cross-Entropy-Loss">Statistical justification for Cross-Entropy Loss<a class="anchor-link" href="#Statistical-justification-for-Cross-Entropy-Loss">¶</a></h2><p>The cross-entropy loss also has fundamental underpinnings in statistics. Since the logistic regression model predicts probabilities, given a particular logistic model we can ask, "What is the probability that this model produced the set of observed outcomes <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.411ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 607.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1345-Title">
<title id="MathJax-SVG-1345-Title"> \textbf{y} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-79" x="0" y="0"></use>
</g>
</svg></span>?" We might naturally adjust the parameters of our model until the probability of drawing our dataset from the model is as high as possible. Although we will not prove it in this section, this procedure is equivalent to minimizing the cross-entropy loss—this is the <em>maximum likelihood</em> statistical justification for the cross-entropy loss.</p>
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Average KL divergence can be interpreted as the average log difference between the two distributions <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1346-Title">
<title id="MathJax-SVG-1346-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.648ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 1140.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1347-Title">
<title id="MathJax-SVG-1347-Title">\hat{P_\boldsymbol{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="908" y="-216"></use>
 <use xlink:href="#MJMAIN-5E" x="319" y="261"></use>
</g>
</svg></span> weighted by <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.745ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 751.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1348-Title">
<title id="MathJax-SVG-1348-Title">P</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
</g>
</svg></span>. Minimizing average KL divergence also minimizes average cross-entropy loss. We can reduce the divergence of logistic regression models by selecting parameters that accurately classify commonly occurring data.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="k">import</span> <span class="n">CountVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span><span class="p">,</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">GridSearchCV</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fitting-a-Logistic-Model">Fitting a Logistic Model<a class="anchor-link" href="#Fitting-a-Logistic-Model">¶</a></h2><p>Previously, we covered batch gradient descent, an algorithm that iteratively updates <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1349-Title">
<title id="MathJax-SVG-1349-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> to find the loss-minimizing parameters <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.559ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 671.3 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1350-Title">
<title id="MathJax-SVG-1350-Title">\boldsymbol{\hat\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="6" y="0"></use>
 <use xlink:href="#MJMAINB-5E" x="95" y="291"></use>
</g>
</svg></span>. We also discussed stochastic gradient descent and mini-batch gradient descent, methods that take advantage of statistical theory and parallelized hardware to decrease the time spent training the gradient descent algorithm. In this section, we will apply these concepts to logistic regression and walk through examples using scikit-learn functions.</p>
<h3 id="Batch-Gradient-Descent">Batch Gradient Descent<a class="anchor-link" href="#Batch-Gradient-Descent">¶</a></h3><p>The general update formula for batch gradient descent is given by:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.424ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 14390.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1351-Title">
<title id="MathJax-SVG-1351-Title">
\boldsymbol{\theta}^{(t+1)} = \boldsymbol{\theta}^{(t)} - \alpha \cdot \nabla_\boldsymbol{\theta} L(\boldsymbol{\theta}^{(t)}, \textbf{X}, \textbf{y})
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2651" y="0"></use>
<g transform="translate(3707,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5398" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6399" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="7262" y="0"></use>
<g transform="translate(7762,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMATHI-4C" x="9093" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9775" y="0"></use>
<g transform="translate(10164,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2C" x="11633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="12079" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="12948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="13393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="14001" y="0"></use>
</g>
</svg></span><p>In logistic regression, we use the cross entropy loss as our loss function:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="62.699ex" height="6.843ex" style="vertical-align: -3.005ex;" viewBox="0 -1652.5 26995.4 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1352-Title">
<title id="MathJax-SVG-1352-Title">
L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) = \frac{1}{n} \sum_{i=1}^{n} \left(-y_i \ln \left(f_{\boldsymbol{\theta}} \left(\textbf{X}_i \right) \right) - \left(1 - y_i \right) \ln \left(1 - f_{\boldsymbol{\theta}} \left(\textbf{X}_i \right) \right) \right)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-4C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="681" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="1071" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1633" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="2078" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2948" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="3393" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="4000" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4668" y="0"></use>
<g transform="translate(5446,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(6851,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(8462,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="389" y="0"></use>
<g transform="translate(1168,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
<g transform="translate(2169,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(3004,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
<g transform="translate(1544,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="1603" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3537" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="7153" y="0"></use>
<g transform="translate(8154,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1112" y="0"></use>
<g transform="translate(2112,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2947" y="0"></use>
</g>
<g transform="translate(11658,0)">
 <use xlink:href="#MJMAIN-6C"></use>
 <use xlink:href="#MJMAIN-6E" x="278" y="0"></use>
</g>
<g transform="translate(12493,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1112" y="0"></use>
<g transform="translate(2112,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
<g transform="translate(3267,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="1603" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5260" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="18143" y="0"></use>
</g>
</g>
</svg></span><p>The gradient of the cross entropy loss is <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.294ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 16057 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1353-Title">
<title id="MathJax-SVG-1353-Title">\nabla_{\boldsymbol{\theta}} L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) = -\frac{1}{n}\sum_{i=1}^n(y_i - \sigma_i)\textbf{X}_i </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5999" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="7055" y="0"></use>
<g transform="translate(7834,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
<g transform="translate(8785,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="11090" y="0"></use>
<g transform="translate(11480,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="12537" y="0"></use>
<g transform="translate(13537,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14453" y="0"></use>
<g transform="translate(14843,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</svg></span>. Plugging this into the update formula allows us to find the gradient descent algorithm specific to logistic regression. Letting <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.191ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10415.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1354-Title">
<title id="MathJax-SVG-1354-Title"> \sigma_i = f_\boldsymbol{\theta}(\textbf{X}_i) = \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1193" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3238" y="0"></use>
<g transform="translate(3627,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4841" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5508" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="6564" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7137" y="0"></use>
<g transform="translate(7526,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="8962" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="9463" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10026" y="0"></use>
</g>
</svg></span>:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="42.553ex" height="15.176ex" style="vertical-align: -7.005ex;" viewBox="0 -3518.2 18321.2 6534.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1355-Title">
<title id="MathJax-SVG-1355-Title">
\begin{align}
\boldsymbol{\theta}^{(t+1)} &amp;= \boldsymbol{\theta}^{(t)} - \alpha \cdot \left(- \frac{1}{n} \sum_{i=1}^{n} \left(y_i - \sigma_i\right) \textbf{X}_i \right) \\
&amp;= \boldsymbol{\theta}^{(t)} + \alpha \cdot \left(\frac{1}{n} \sum_{i=1}^{n} \left(y_i - \sigma_i\right) \textbf{X}_i \right)
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1651)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2362,0)">
<g transform="translate(0,1651)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="4888" y="0"></use>
<g transform="translate(5389,0)">
 <use xlink:href="#MJSZ4-28"></use>
 <use xlink:href="#MJMAIN-2212" x="792" y="0"></use>
<g transform="translate(1571,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(2698,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(4309,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3363" y="0"></use>
</g>
<g transform="translate(8228,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJSZ4-29" x="9442" y="0"></use>
</g>
</g>
<g transform="translate(0,-1651)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="4888" y="0"></use>
<g transform="translate(5389,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="720" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="110" y="676"></use>
 <use xlink:href="#MJMATHI-6E" x="60" y="-686"></use>
</g>
</g>
<g transform="translate(1919,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(147,-1090)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="721" y="1627"></use>
</g>
<g transform="translate(3530,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3363" y="0"></use>
</g>
<g transform="translate(7450,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJSZ4-29" x="8663" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><ul>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.412ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1469 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1356-Title">
<title id="MathJax-SVG-1356-Title">\boldsymbol{\theta}^{(t)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span> is the current estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1357-Title">
<title id="MathJax-SVG-1357-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> at iteration <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.84ex" height="2.009ex" style="vertical-align: -0.338ex;" viewBox="0 -719.6 361.5 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1358-Title">
<title id="MathJax-SVG-1358-Title">t</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-74" x="0" y="0"></use>
</g>
</svg></span></li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1359-Title">
<title id="MathJax-SVG-1359-Title">\alpha</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> is the learning rate</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.681ex" height="3.343ex" style="vertical-align: -1.005ex;" viewBox="0 -1006.6 9334.7 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1360-Title">
<title id="MathJax-SVG-1360-Title">-\frac{1}{n} \sum_{i=1}^{n} \left(y_i - \sigma_i\right) \textbf{X}_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="544" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="134" y="629"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="84" y="-488"></use>
</g>
</g>
<g transform="translate(1729,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1494" y="675"></use>
<g transform="translate(1056,-287)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1124" y="0"></use>
</g>
</g>
<g transform="translate(4201,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1446" y="0"></use>
<g transform="translate(2447,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3363" y="0"></use>
</g>
<g transform="translate(8120,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</svg></span> is the gradient of the cross entropy loss</li>
<li><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.512ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 2373.3 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1361-Title">
<title id="MathJax-SVG-1361-Title">\boldsymbol{\theta}^{(t+1)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</svg></span> is the next estimate of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.306ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 562.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1362-Title">
<title id="MathJax-SVG-1362-Title">\boldsymbol{\theta}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
</g>
</svg></span> computed by subtracting the product of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.488ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 640.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1363-Title">
<title id="MathJax-SVG-1363-Title">\alpha</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B1" x="0" y="0"></use>
</g>
</svg></span> and the cross entropy loss computed at <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.412ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1469 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1364-Title">
<title id="MathJax-SVG-1364-Title">\boldsymbol{\theta}^{(t)}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
</svg></span></li>
</ul>
<h3 id="Stochastic-Gradient-Descent">Stochastic Gradient Descent<a class="anchor-link" href="#Stochastic-Gradient-Descent">¶</a></h3><p>Stochastic gradient descent approximates the gradient of the loss function across all observations using the gradient of the loss of a single data point.The general update formula is below, where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.911ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4697.9 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1365-Title">
<title id="MathJax-SVG-1365-Title">\ell(\boldsymbol{\theta}, \textbf{X}_i, y_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2113" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="417" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="807" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1369" y="0"></use>
<g transform="translate(1814,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3028" y="0"></use>
<g transform="translate(3473,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4308" y="0"></use>
</g>
</svg></span> is the loss function for a single data point:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.354ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 13069 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1366-Title">
<title id="MathJax-SVG-1366-Title">
\boldsymbol{\theta}^{(t+1)} = \boldsymbol{\theta}^{(t)} - \alpha \nabla_\boldsymbol{\theta} \ell(\boldsymbol{\theta}, \textbf{X}_i, y_i)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2651" y="0"></use>
<g transform="translate(3707,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="5398" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="6399" y="0"></use>
<g transform="translate(7039,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="8371" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="8788" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="9178" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="9740" y="0"></use>
<g transform="translate(10185,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="11399" y="0"></use>
<g transform="translate(11844,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12679" y="0"></use>
</g>
</svg></span><p>Returning back to our example in logistic regression, we approximate the gradient of the cross entropy loss across all data points using the gradient of the cross entropy loss of one data point. This is shown below, with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.191ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10415.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1367-Title">
<title id="MathJax-SVG-1367-Title"> \sigma_i = f_{\boldsymbol{\theta}}(\textbf{X}_i) = \sigma(\textbf{X}_i \cdot \boldsymbol{\theta}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
 <use xlink:href="#MJMAIN-3D" x="1193" y="0"></use>
<g transform="translate(2249,0)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="693" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="3238" y="0"></use>
<g transform="translate(3627,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4841" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5508" y="0"></use>
 <use xlink:href="#MJMATHI-3C3" x="6564" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="7137" y="0"></use>
<g transform="translate(7526,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-22C5" x="8962" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="9463" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="10026" y="0"></use>
</g>
</svg></span>.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.142ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 13408.4 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1368-Title">
<title id="MathJax-SVG-1368-Title">
\begin{align}
\nabla_\boldsymbol{\theta} L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) &amp;\approx \nabla_\boldsymbol{\theta} \ell(\boldsymbol{\theta}, \textbf{X}_i, y_i)\\
&amp;= -(y_i - \sigma_i)\textbf{X}_i
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
</g>
</g>
<g transform="translate(5711,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-2248" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="2665" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3082" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="3472" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4034" y="0"></use>
<g transform="translate(4479,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="5693" y="0"></use>
<g transform="translate(6138,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6973" y="0"></use>
</g>
<g transform="translate(0,-700)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="1334" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2112" y="0"></use>
<g transform="translate(2502,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3559" y="0"></use>
<g transform="translate(4559,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="5475" y="0"></use>
<g transform="translate(5865,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>When we plug this approximation into the general formula for stochastic gradient descent, we find the stochastic gradient descent update formula for logistic regression.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.105ex" height="6.843ex" style="vertical-align: -2.838ex;" viewBox="0 -1724.2 13392.5 2946.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1369-Title">
<title id="MathJax-SVG-1369-Title">
\begin{align}
\boldsymbol{\theta}^{(t+1)} &amp;= \boldsymbol{\theta}^{(t)} - \alpha \nabla_\boldsymbol{\theta} \ell(\boldsymbol{\theta}, \textbf{X}_i, y_i) \\
&amp;= \boldsymbol{\theta}^{(t)} + \alpha \cdot (y_i - \sigma_i)\textbf{X}_i
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2362,0)">
<g transform="translate(0,651)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
<g transform="translate(4666,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="5997" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="6415" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="6804" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="7367" y="0"></use>
<g transform="translate(7812,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="9026" y="0"></use>
<g transform="translate(9471,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="10306" y="0"></use>
</g>
<g transform="translate(0,-844)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="4888" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5389" y="0"></use>
<g transform="translate(5778,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="6835" y="0"></use>
<g transform="translate(7836,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8752" y="0"></use>
<g transform="translate(9141,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><h3 id="Mini-batch-Gradient-Descent">Mini-batch Gradient Descent<a class="anchor-link" href="#Mini-batch-Gradient-Descent">¶</a></h3><p>Similarly, we can approximate the gradient of the cross entropy loss for all observations using a random sample of data points, known as a mini-batch.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.193ex" height="6.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1437.2 16444.2 2802.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1370-Title">
<title id="MathJax-SVG-1370-Title">
\nabla_\boldsymbol{\theta} L(\boldsymbol{\theta}, \textbf{X}, \textbf{y}) \approx \frac{1}{|\mathcal{B}|} \sum_{i\in\mathcal{B}}\nabla_{\boldsymbol{\theta}} \ell(\boldsymbol{\theta}, \textbf{X}_i, y_i)
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
 <use xlink:href="#MJMATHI-4C" x="1331" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="2012" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="2402" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2964" y="0"></use>
 <use xlink:href="#MJMAINB-58" x="3409" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4279" y="0"></use>
 <use xlink:href="#MJMAINB-79" x="4724" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="5332" y="0"></use>
 <use xlink:href="#MJMAIN-2248" x="5999" y="0"></use>
<g transform="translate(6777,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1341" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="420" y="676"></use>
<g transform="translate(60,-771)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJCAL-42" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="943" y="0"></use>
</g>
</g>
</g>
<g transform="translate(8803,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(129,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJCAL-42" x="1013" y="0"></use>
</g>
</g>
<g transform="translate(10414,0)">
 <use xlink:href="#MJMAIN-2207" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHBI-3B8" x="1178" y="-216"></use>
</g>
 <use xlink:href="#MJMAIN-2113" x="11746" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="12163" y="0"></use>
 <use xlink:href="#MJMATHBI-3B8" x="12553" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="13115" y="0"></use>
<g transform="translate(13560,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="14774" y="0"></use>
<g transform="translate(15219,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="16054" y="0"></use>
</g>
</svg></span><p>We substitute this approximation for the gradient of the cross entropy loss, yielding a mini-batch gradient descent update formula specific to logistic regression:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.539ex" height="13.176ex" style="vertical-align: -6.005ex;" viewBox="0 -3087.6 17023.8 5673" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1371-Title">
<title id="MathJax-SVG-1371-Title">
\begin{align}
\boldsymbol{\theta}^{(t+1)} &amp;= \boldsymbol{\theta}^{(t)} - \alpha \cdot -\frac{1}{|\mathcal{B}|} \sum_{i\in\mathcal{B}}(y_i - \sigma_i)\textbf{X}_i \\
&amp;= \boldsymbol{\theta}^{(t)} + \alpha \cdot \frac{1}{|\mathcal{B}|} \sum_{i\in\mathcal{B}}(y_i - \sigma_i)\textbf{X}_i
\end{align}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1646)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="751" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2030" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2362,0)">
<g transform="translate(0,1646)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="4888" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="5389" y="0"></use>
<g transform="translate(6167,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1341" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="420" y="676"></use>
<g transform="translate(60,-771)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJCAL-42" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="943" y="0"></use>
</g>
</g>
</g>
<g transform="translate(7916,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(129,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJCAL-42" x="1013" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="9360" y="0"></use>
<g transform="translate(9750,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="10807" y="0"></use>
<g transform="translate(11807,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12723" y="0"></use>
<g transform="translate(13113,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
<g transform="translate(0,-1244)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1334,0)">
 <use xlink:href="#MJMATHBI-3B8" x="0" y="0"></use>
<g transform="translate(562,412)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="389" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="751" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="3025" y="0"></use>
 <use xlink:href="#MJMATHI-3B1" x="4025" y="0"></use>
 <use xlink:href="#MJMAIN-22C5" x="4888" y="0"></use>
<g transform="translate(5167,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="1341" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-31" x="420" y="676"></use>
<g transform="translate(60,-771)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJCAL-42" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="943" y="0"></use>
</g>
</g>
</g>
<g transform="translate(7137,0)">
 <use xlink:href="#MJSZ2-2211" x="0" y="0"></use>
<g transform="translate(129,-1117)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2208" x="345" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJCAL-42" x="1013" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-28" x="8582" y="0"></use>
<g transform="translate(8971,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="10028" y="0"></use>
<g transform="translate(11029,0)">
 <use xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="808" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="11945" y="0"></use>
<g transform="translate(12334,0)">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1229" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementation-in-Scikit-learn">Implementation in Scikit-learn<a class="anchor-link" href="#Implementation-in-Scikit-learn">¶</a></h2><p>Scikit-learn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDClassifier.html"><code>SGDClassifier</code></a> class provides an implementation for stochastic gradient descent, which we can use by specifying <code>loss=log</code>. Since scikit-learn does not have a model that implements batch gradient descent, we will compare <code>SGDClassifier</code>'s performance against <a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html"><code>LogisticRegression</code></a> on the <code>emails</code> dataset. We omit feature extraction for brevity:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">emails</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'emails_sgd.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">emails</span><span class="p">[</span><span class="s1">'email'</span><span class="p">],</span> <span class="n">emails</span><span class="p">[</span><span class="s1">'spam'</span><span class="p">]</span>
<span class="n">X_tr</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_tr</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">y_train</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">y_test</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_reg</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">stochastic_gd</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">0.0001</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'log'</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
log_reg.fit(X_train, y_train)
log_reg_pred = log_reg.predict(X_test)
print('Logistic Regression')
print('  Accuracy:  ', accuracy_score(y_test, log_reg_pred))
print('  Precision: ', precision_score(y_test, log_reg_pred))
print('  Recall:    ', recall_score(y_test, log_reg_pred))
print()
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Logistic Regression
  Accuracy:   0.9913793103448276
  Precision:  0.974169741697417
  Recall:     0.9924812030075187

CPU times: user 3.2 s, sys: 0 ns, total: 3.2 s
Wall time: 3.26 s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>
stochastic_gd.fit(X_train, y_train)
stochastic_gd_pred = stochastic_gd.predict(X_test)
print('Stochastic GD')
print('  Accuracy:  ', accuracy_score(y_test, stochastic_gd_pred))
print('  Precision: ', precision_score(y_test, stochastic_gd_pred))
print('  Recall:    ', recall_score(y_test, stochastic_gd_pred))
print()
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>Stochastic GD
  Accuracy:   0.9808429118773946
  Precision:  0.9392857142857143
  Recall:     0.9887218045112782

CPU times: user 93.8 ms, sys: 31.2 ms, total: 125 ms
Wall time: 119 ms
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The results above indicate that <code>SGDClassifier</code> is able to find a solution in significantly less time than <code>LogisticRegression</code>. Although the evaluation metrics are slightly worse on the <code>SGDClassifier</code>, we can improve the <code>SGDClassifier</code>'s performance by tuning hyperparameters. Furthermore, this discrepancy is a tradeoff that data scientists often encounter in the real world. Depending on the situation, data scientists might place greater value on the lower runtime or on the higher metrics.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Stochastic gradient descent is a method that data scientists use to cut down on computational cost and runtime. We can see the value of stochastic gradient descent in logistic regression, since we would only have to calculate the gradient of the cross entropy loss for one observation at each iteration instead of for every observation in batch gradient descent. From the example using scikit-learn's <code>SGDClassifier</code>, we observe that stochastic gradient descent may achieve slightly worse evaluation metrics, but drastically improves runtime. On larger datasets or for more complex models, the difference in runtime might be much larger and thus more valuable.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_extraction</span> <span class="k">import</span> <span class="n">DictVectorizer</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">confusion_matrix</span>

<span class="n">emails</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'selected_emails.csv'</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="k">def</span> <span class="nf">words_in_texts</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">texts</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Args:</span>
<span class="sd">        words (list-like): words to find</span>
<span class="sd">        texts (Series): strings to search in</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        NumPy array of 0s and 1s with shape (n, p) where n is the</span>
<span class="sd">        number of texts and p is the number of words.</span>
<span class="sd">    '''</span>
    <span class="n">indicator_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">texts</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

    <span class="c1"># YOUR CODE HERE</span>
    <span class="k">return</span> <span class="n">indicator_array</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Evaluating-Logistic-Models">Evaluating Logistic Models<a class="anchor-link" href="#Evaluating-Logistic-Models">¶</a></h2><p>Although we used the classification accuracy to evaluate our logistic model in previous sections, using the accuracy alone has some serious flaws that we explore in this section. To address these issues, we introduce a more useful metric to evaluate classifier performance: the <strong>Area Under Curve (AUC)</strong> metric.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Suppose we have a dataset of 1000 emails that are labeled as spam or ham (not spam) and our goal is to build a classifier that distinguishes future spam emails from ham emails. The data is contained in the <code>emails</code> DataFrame displayed below:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">emails</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>body</th>
<th>spam</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>\n Hi Folks,\n \n I've been trying to set a bu...</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>Hah.  I guess she doesn't want everyone to kno...</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>This article from NYTimes.com \n has been sent...</td>
<td>0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>997</th>
<td>&lt;html&gt;\n &lt;head&gt;\n     &lt;meta http-equiv="Conten...</td>
<td>1</td>
</tr>
<tr>
<th>998</th>
<td>&lt;html&gt;\n &lt;head&gt;\n &lt;/head&gt;\n &lt;body&gt;\n \n &lt;cente...</td>
<td>1</td>
</tr>
<tr>
<th>999</th>
<td>\n &lt;html&gt;\n \n &lt;head&gt;\n &lt;meta http-equiv=3D"Co...</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>1000 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Each row contains the body of an email in the <code>body</code> column and a spam indicator in the <code>spam</code> column, which is <code>0</code> if the email is ham or <code>1</code> if it is spam.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compare the performance of three different classifiers:</p>
<ul>
<li><code>ham_only</code>: labels every email as ham.</li>
<li><code>spam_only</code>: labels every email as spam.</li>
<li><code>words_list_model</code>: predicts 'ham' or 'spam' based on the presence of certain words in the body of an email.</li>
</ul>
<p>Suppose we have a list of words <code>words_list</code> that we believe are common in spam emails: "please", "click", "money", "business", and "remove". We construct <code>words_list_model</code> using the following procedure: transform each email into a feature vector by setting the vector's <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1372-Title">
<title id="MathJax-SVG-1372-Title">i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span>th entry to 1 if the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1373-Title">
<title id="MathJax-SVG-1373-Title">i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span>th word in <code>words_list</code> is contained in the email body and 0 if it isn't. For example, using our five chosen words and the email body "please remove by tomorrow", the feature vector would be <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.242ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 4840.2 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1374-Title">
<title id="MathJax-SVG-1374-Title">[1, 0, 0, 0, 1]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-5B" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1224" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="1724" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="2169" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="2670" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3115" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3616" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="4061" y="0"></use>
 <use xlink:href="#MJMAIN-5D" x="4561" y="0"></use>
</g>
</svg></span>. This procedure generates the <code>1000 X 5</code> feature matrix <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 869.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1375-Title">
<title id="MathJax-SVG-1375-Title">\textbf{X}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAINB-58" x="0" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following code block displays the accuracies of the classifiers. Model creation and training are omitted for brevity.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="n">words_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'please'</span><span class="p">,</span> <span class="s1">'click'</span><span class="p">,</span> <span class="s1">'money'</span><span class="p">,</span> <span class="s1">'business'</span><span class="p">,</span> <span class="s1">'remove'</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">words_in_texts</span><span class="p">(</span><span class="n">words_list</span><span class="p">,</span> <span class="n">emails</span><span class="p">[</span><span class="s1">'body'</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">emails</span><span class="p">[</span><span class="s1">'spam'</span><span class="p">]</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>

<span class="c1"># Train-test split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">41</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span>
<span class="p">)</span>

<span class="c1">#Fit the model</span>
<span class="n">words_list_model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">words_list_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="n">y_prediction_words_list</span> <span class="o">=</span> <span class="n">words_list_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">y_prediction_ham_only</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span>
<span class="n">y_prediction_spam_only</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_test</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>

<span class="c1"># Our selected words</span>
<span class="n">words_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'please'</span><span class="p">,</span> <span class="s1">'click'</span><span class="p">,</span> <span class="s1">'money'</span><span class="p">,</span> <span class="s1">'business'</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'ham_only test set accuracy: {np.round(accuracy_score(y_prediction_ham_only, y_test), 3)}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'spam_only test set accuracy: {np.round(accuracy_score(y_prediction_spam_only, y_test), 3)}'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'words_list_model test set accuracy: {np.round(accuracy_score(y_prediction_words_list, y_test), 3)}'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>ham_only test set accuracy: 0.96
spam_only test set accuracy: 0.04
words_list_model test set accuracy: 0.96
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Using <code>words_list_model</code> classifies 96% of the test set emails correctly. Although this accuracy appears high, <code>ham_only</code> achieves the same accuracy by simply labeling everything as ham. This is cause for concern because the data suggests we can do just as well without a spam filter at all.</p>
<p>As the accuracies above show, model accuracy alone can be a misleading indicator of model performance. We can understand the model's predictions in greater depth using a <strong>confusion matrix</strong>. A confusion matrix for a binary classifier is a two-by-two heatmap that contains the model predictions on one axis and the actual labels on the other.</p>
<p>Each entry in a confusion matrix represents a possible outcome of the classifier. If a spam email is input to the classifier, there are two possible outcomes:</p>
<ul>
<li><strong>True Positive</strong> (top left entry): the model correctly labels it with the positive class (spam).</li>
<li><strong>False Negative</strong> (top right entry): the model mislabels it with the negative class (ham), but it truly belongs in the positive class (spam). In our case, a false negative means that a spam email gets mislabelled as ham and ends up in the inbox.</li>
</ul>
<p>Similarly, if a ham email is input to the classifier, there are two possible outcomes.</p>
<ul>
<li><strong>False Positive</strong> (bottom left entry): the model mislabels it with the positive class (spam), but it truly belongs in the negative class (ham). In our case, a false positive means that a ham email gets flagged as spam and filtered out of the inbox.</li>
<li><strong>True Negative</strong> (bottom right entry): the model correctly labels it with the negative class (ham).</li>
</ul>
<p>The costs of false positives and false negatives depend on the situation. For email classification, false positives result in important emails being filtered out, so they are worse than false negatives, in which a spam email winds up in the inbox. In medical settings, however, false negatives in a diagnostic test can be much more consequential than false positives.</p>
<p>We will use scikit-learn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html#sklearn.metrics.confusion_matrix">confusion matrix function</a> to construct confusion matrices for the three models on the training data set. The <code>ham_only</code> confusion matrix is shown below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span>
                          <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">'Confusion matrix'</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    This function prints and plots the confusion matrix.</span>
<span class="sd">    Normalization can be applied by setting `normalize=True`.</span>
<span class="sd">    """</span>
    <span class="kn">import</span> <span class="nn">itertools</span>
    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float'</span><span class="p">)</span> <span class="o">/</span> <span class="n">cm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
<span class="c1">#         print("Normalized confusion matrix")</span>
<span class="c1">#     else:</span>
<span class="c1">#         print('Confusion matrix, without normalization')</span>

<span class="c1">#     print(cm)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">'nearest'</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span>

    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">'.2f'</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="s1">'d'</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">fmt</span><span class="p">),</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">"center"</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s2">"white"</span> <span class="k">if</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span> <span class="k">else</span> <span class="s2">"black"</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'True label'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Predicted label'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ham_only_y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
<span class="n">spam_only_y_pred</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">))</span>
<span class="n">words_list_model_y_pred</span> <span class="o">=</span> <span class="n">words_list_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">confusion_matrix</span>

<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Spam'</span><span class="p">,</span> <span class="s1">'Ham'</span><span class="p">]</span>

<span class="n">ham_only_cnf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">ham_only_y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">ham_only_cnf_matrix</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">'ham_only Confusion Matrix'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Summing the quantities in a row indicates how many emails in the training dataset belong to the corresponding class:</p>
<ul>
<li>True label = spam (first row): the sum of true positives (0) and false negatives (42) reveals there are 42 spam emails in the training dataset.</li>
<li>True label = ham (second row): the sum of false positives (0) and true negatives (758) reveals there are 758 ham emails in the training dataset.</li>
</ul>
<p>Summing the quantities in a column indicates how many emails the classifier predicted in the corresponding class:</p>
<ul>
<li>Predicted label = spam (first column): the sum of true positives (0) and false positives (0) reveals <code>ham_only</code> predicted there are 0 spam emails in the training dataset.</li>
<li>Predicted label = ham (second column): the sum of false negatives (42) and true negatives (758) reveals <code>ham_only</code> predicted there are 800 ham emails in the training dataset.</li>
</ul>
<p>We can see that <code>ham_only</code> had a high accuracy of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.148ex" height="4.843ex" style="vertical-align: -1.838ex;" viewBox="0 -1293.7 5230.3 2085" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1376-Title">
<title id="MathJax-SVG-1376-Title">\left(\frac{758}{800} \approx .95\right)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ2-28"></use>
<g transform="translate(597,0)">
<g transform="translate(120,0)">
<rect stroke="none" width="1181" height="60" x="0" y="220"></rect>
<g transform="translate(60,460)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
<g transform="translate(60,-417)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="1001" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="2296" y="0"></use>
<g transform="translate(3353,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-39" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#MJSZ2-29" x="4632" y="-1"></use>
</g>
</svg></span> because there are 758 ham emails in the training dataset out of 800 total emails.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam_only_cnf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">spam_only_y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">spam_only_cnf_matrix</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">'spam_only Confusion Matrix'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the other extreme, <code>spam_only</code> predicts the training dataset has no ham emails, which the confusion matrix indicates is far from the truth with 758 false positives.</p>
<p>Our main interest is the confusion matrix for <code>words_list_model</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">words_list_model_cnf_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">words_list_model_y_pred</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">words_list_model_cnf_matrix</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">'words_list_model Confusion Matrix'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_18_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The row totals match those of the <code>ham_only</code> and <code>spam_only</code> confusion matrices as expected since the true labels in the training dataset are unaltered for all models.</p>
<p>Of the 42 spam emails, <code>words_list_model</code> correctly classifies 18 of them, which is a poor performance. Its high accuracy is buoyed by the large number of true negatives, but this is insufficient because it does not serve its purpose of reliably filtering out spam emails.</p>
<p>This emails dataset is an example of a <strong>class-imbalanced dataset</strong>, in which a vast majority of labels belong to one class over the other. In this case, most of our emails are ham. Another common example of class imbalance is disease detection when the frequency of the disease in a population is low. A medical test that always concludes a patient doesn't have the disease will have a high accuracy because most patients truly won't have the disease, but its inability to identify individuals with the disease renders it useless.</p>
<p>We now turn to sensitivity and specificity, two metrics that are better suited for evaluating class-imbalanced datasets.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sensitivity">Sensitivity<a class="anchor-link" href="#Sensitivity">¶</a></h3><p><strong>Sensitivity</strong> (also called <strong>true positive rate</strong>) measures the proportion of data belonging to the positive class that the classifier correctly labels.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.7ex" height="5.343ex" style="vertical-align: -2.005ex;" viewBox="0 -1437.2 10634.5 2300.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1377-Title">
<title id="MathJax-SVG-1377-Title"> \text{Sensitivity} = \frac{TP}{TP + FN} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1952" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2620" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="2898" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3427" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3705" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="4095" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4901" y="0"></use>
<g transform="translate(5679,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4436" height="60" x="0" y="220"></rect>
<g transform="translate(1490,676)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="704" y="0"></use>
</g>
<g transform="translate(60,-704)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1678" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2678" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="3428" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>From our discussion of confusion matrices, you should recognize the expression <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.026ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4316.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1378-Title">
<title id="MathJax-SVG-1378-Title">TP + FN</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1678" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2678" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="3428" y="0"></use>
</g>
</svg></span> as the sum of the entries in the first row, which is equal to the actual number of data points belonging to the positive class in the dataset. Using confusion matrices allows us to easily compare the sensitivities of our models:</p>
<ul>
<li><code>ham_only</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.842ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 3806.8 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1379-Title">
<title id="MathJax-SVG-1379-Title">\frac{0}{0 + 42} = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="1732" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="974" y="651"></use>
<g transform="translate(60,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="500" y="0"></use>
<g transform="translate(904,0)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="2249" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3306" y="0"></use>
</g>
</svg></span></li>
<li><code>spam_only</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.842ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 3806.8 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1380-Title">
<title id="MathJax-SVG-1380-Title">\frac{42}{42 + 0} = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="1732" height="60" x="0" y="220"></rect>
<g transform="translate(512,445)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
<g transform="translate(60,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="1779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="2249" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3306" y="0"></use>
</g>
</svg></span></li>
<li><code>words_list_model</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.635ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 5440.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1381-Title">
<title id="MathJax-SVG-1381-Title">\frac{18}{18 + 24} \approx .429</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="2086" height="60" x="0" y="220"></rect>
<g transform="translate(689,460)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="500" y="0"></use>
</g>
<g transform="translate(60,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="1001" y="0"></use>
<g transform="translate(1258,0)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="2603" y="0"></use>
<g transform="translate(3660,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-34" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
</g>
</svg></span></li>
</ul>
<p>Since <code>ham_only</code> has no true positives, it has the worst possible sensitivity value of 0. On the other hand, <code>spam_only</code> has an abysmally low accuracy but it has the best possible sensitivity value of 1 because it labels all spam emails correctly. The low sensitivity of <code>words_list_model</code> indicates that it frequently fails to mark spam emails as such; nevertheless, it significantly outperforms <code>ham_only</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Specificity">Specificity<a class="anchor-link" href="#Specificity">¶</a></h3><p><strong>Specificity</strong> (also called <strong>true negative rate</strong>) measures the proportion of data belonging to the negative class that the classifier correctly labels.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.428ex" height="5.343ex" style="vertical-align: -2.005ex;" viewBox="0 -1437.2 10517.5 2300.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1382-Title">
<title id="MathJax-SVG-1382-Title"> \text{Specificity} = \frac{TN}{TN + FP} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-70" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1113" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2587" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="2865" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3310" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3588" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="3978" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="4784" y="0"></use>
<g transform="translate(5562,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4436" height="60" x="0" y="220"></rect>
<g transform="translate(1421,676)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
</g>
<g transform="translate(60,-704)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p></p>
<p>The expression <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.026ex" height="2.343ex" style="vertical-align: -0.505ex;" viewBox="0 -791.3 4316.9 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1383-Title">
<title id="MathJax-SVG-1383-Title">TN + FP</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
</g>
</svg></span> is equal to the actual number of data points belonging to the negative class in the dataset. Again the confusion matrices help to compare the specificities of our models:</p>
<ul>
<li><code>ham_only</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.664ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 4160.7 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1384-Title">
<title id="MathJax-SVG-1384-Title">\frac{758}{758 + 0} = 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="2086" height="60" x="0" y="220"></rect>
<g transform="translate(512,460)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
<g transform="translate(59,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="1501" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="2280" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="2603" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="3660" y="0"></use>
</g>
</svg></span></li>
<li><code>spam_only</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.664ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 4160.7 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1385-Title">
<title id="MathJax-SVG-1385-Title">\frac{0}{0 + 758} = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="2086" height="60" x="0" y="220"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="1224" y="651"></use>
<g transform="translate(59,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="500" y="0"></use>
<g transform="translate(904,0)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="2603" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3660" y="0"></use>
</g>
</svg></span></li>
<li><code>words_list_model</code>: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.635ex" height="3.843ex" style="vertical-align: -1.338ex;" viewBox="0 -1078.4 5440.2 1654.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1386-Title">
<title id="MathJax-SVG-1386-Title">\frac{752}{752 + 6} \approx .992</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(120,0)">
<rect stroke="none" width="2086" height="60" x="0" y="220"></rect>
<g transform="translate(512,460)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1001" y="0"></use>
</g>
<g transform="translate(59,-424)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2B" x="1501" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-36" x="2280" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="2603" y="0"></use>
<g transform="translate(3660,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-39" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1279" y="0"></use>
</g>
</g>
</svg></span></li>
</ul>
<p>As with sensitivity, the worst and best specificities are 0 and 1 respectively. Notice that <code>ham_only</code> has the best specificity and worst sensitivity, while <code>spam_only</code> has the worst specificity and best sensitivity. Since these models only predict one label, they will misclassify all instances of the other label, which is reflected in the extreme sensitivity and specificity values. The disparity is much smaller for <code>words_list_model</code>.</p>
<p>Although sensitivity and specificity seem to describe different characteristics of a classifier, we draw an important connection between these two metrics using the classification threshold.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Classification-Threshold">Classification Threshold<a class="anchor-link" href="#Classification-Threshold">¶</a></h3><p>The <strong>classification threshold</strong> is a value that determines what class a data point is assigned to; points that fall on opposite sides of the threshold are labeled with different classes. Recall that logistic regression outputs a probability that the data point belongs to the positive class. If this probability is greater than the threshold, the data point is labeled with the positive class, and if it is below the threshold, the data point is labeled with the negative class. For our case, let <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.387ex" height="3.009ex" style="vertical-align: -1.171ex;" viewBox="0 -791.3 1027.7 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1387-Title">
<title id="MathJax-SVG-1387-Title">f_{\hat{\theta}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
</svg></span> be the logistic model and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1388-Title">
<title id="MathJax-SVG-1388-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> the threshold. If <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.391ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 4473.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1389-Title">
<title id="MathJax-SVG-1389-Title">f_{\hat{\theta}}(x) &gt; C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3E" x="2656" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="3713" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1390-Title">
<title id="MathJax-SVG-1390-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is labeled spam; if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.391ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 4473.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1391-Title">
<title id="MathJax-SVG-1391-Title">f_{\hat{\theta}}(x) &lt; C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3C" x="2656" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="3713" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1392-Title">
<title id="MathJax-SVG-1392-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is labeled ham. Scikit-learn breaks ties by defaulting to the negative class, so if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.391ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 4473.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1393-Title">
<title id="MathJax-SVG-1393-Title">f_{\hat{\theta}}(x) = C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="3713" y="0"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1394-Title">
<title id="MathJax-SVG-1394-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> is labeled ham.</p>
<p>We can assess our model's performance with classification threshold <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1395-Title">
<title id="MathJax-SVG-1395-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> by creating a confusion matrix. The <code>words_list_model</code> confusion matrix displayed earlier in the section uses scikit learn's default threshold <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1396-Title">
<title id="MathJax-SVG-1396-Title">C = .50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-35" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span>.</p>
<p>Raising the threshold to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1397-Title">
<title id="MathJax-SVG-1397-Title">C = .70</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-37" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span>, meaning we label an email <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1398-Title">
<title id="MathJax-SVG-1398-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> as spam if the probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.526ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2379.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1399-Title">
<title id="MathJax-SVG-1399-Title">f_{\hat{\theta}}(x)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
</g>
</svg></span> is greater than .70, results in the following confusion matrix:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="n">words_list_prediction_probabilities</span> <span class="o">=</span> <span class="n">words_list_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>

<span class="n">words_list_predictions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">pred</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">70</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">words_list_prediction_probabilities</span><span class="p">]</span>

<span class="n">high_classification_threshold</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">words_list_predictions</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">high_classification_threshold</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">'words_list_model Confusion Matrix $C = .70$'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_23_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By raising the bar for classifying an email as spam, 13 spam emails that were correctly classified with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1400-Title">
<title id="MathJax-SVG-1400-Title">C = .50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-35" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span> are now mislabeled.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100ex" height="11.009ex" style="vertical-align: -7.671ex; max-width: 60000px;" viewBox="0 -1437.2 43055.4 4740.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1401-Title">
<title id="MathJax-SVG-1401-Title"> \text{Sensitivity } (C = .70) = \frac{5}{42} \approx .119 \\
\text{Specificity } (C = .70) = \frac{757}{758} \approx .999
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(14109,0)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1952" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2620" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="2898" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3427" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3705" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="4095" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4873" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="5263" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6301" y="0"></use>
<g transform="translate(7357,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-37" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8637" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="9304" y="0"></use>
<g transform="translate(10082,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
 <use xlink:href="#MJMAIN-35" x="310" y="676"></use>
<g transform="translate(60,-698)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="11999" y="0"></use>
<g transform="translate(13055,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-31" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(13918,-2483)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-70" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1113" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2587" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="2865" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3310" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3588" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="3978" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4756" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="5146" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6184" y="0"></use>
<g transform="translate(7240,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-37" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8520" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="9187" y="0"></use>
<g transform="translate(9965,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1621" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1001" y="0"></use>
</g>
<g transform="translate(60,-697)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="12382" y="0"></use>
<g transform="translate(13439,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-39" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
</g>
</g>
</g>
</svg></span><p>Compared to the default, a higher threshold of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1402-Title">
<title id="MathJax-SVG-1402-Title">C = .70</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-37" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span> increases specificity but decreases sensitivity.</p>
<p>Lowering the threshold to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1403-Title">
<title id="MathJax-SVG-1403-Title">C = .30</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-33" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span>, meaning we label an email <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1404-Title">
<title id="MathJax-SVG-1404-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> as spam if the probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.526ex" height="3.176ex" style="vertical-align: -1.171ex;" viewBox="0 -863.1 2379.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1405-Title">
<title id="MathJax-SVG-1405-Title">f_{\hat{\theta}}(x)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
</g>
</svg></span> is greater than .30, results in the following confusion matrix:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">words_list_predictions</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">pred</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">30</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">pred</span> <span class="ow">in</span> <span class="n">words_list_prediction_probabilities</span><span class="p">]</span>

<span class="n">low_classification_threshold</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">words_list_predictions</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">low_classification_threshold</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">class_names</span><span class="p">,</span>
                      <span class="n">title</span><span class="o">=</span><span class="s1">'words_list_model Confusion Matrix $C = .30$'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_25_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By lowering the bar for classifying an email as spam, 6 spam emails that were mislabeled with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1406-Title">
<title id="MathJax-SVG-1406-Title">C = .50</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-35" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span> are now correct. However, there are more false positives.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="100ex" height="11.009ex" style="vertical-align: -7.671ex; max-width: 60000px;" viewBox="0 -1437.2 43055.4 4740.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1407-Title">
<title id="MathJax-SVG-1407-Title"> \text{Sensitivity } (C = .30) = \frac{24}{42} \approx .571 \\
\text{Specificity } (C = .30) = \frac{738}{758} \approx .974
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(14109,0)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="1001" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="1952" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="2230" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2620" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="2898" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3427" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3705" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="4095" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4873" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="5263" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6301" y="0"></use>
<g transform="translate(7357,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-33" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8637" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="9304" y="0"></use>
<g transform="translate(10082,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1121" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-34" x="500" y="0"></use>
</g>
<g transform="translate(60,-698)">
 <use xlink:href="#MJMAIN-34"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="11999" y="0"></use>
<g transform="translate(13055,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-35" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(13918,-2483)">
 <use xlink:href="#MJMAIN-53"></use>
 <use xlink:href="#MJMAIN-70" x="556" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1113" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="1557" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2002" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="2280" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="2587" y="0"></use>
 <use xlink:href="#MJMAIN-63" x="2865" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="3310" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="3588" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="3978" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4756" y="0"></use>
 <use xlink:href="#MJMATHI-43" x="5146" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="6184" y="0"></use>
<g transform="translate(7240,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-33" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="8520" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="9187" y="0"></use>
<g transform="translate(9965,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1621" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-33" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
<g transform="translate(60,-697)">
 <use xlink:href="#MJMAIN-37"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2248" x="12382" y="0"></use>
<g transform="translate(13439,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-39" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-34" x="1279" y="0"></use>
</g>
</g>
</g>
</svg></span><p>Compared to the default, a lower threshold of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1408-Title">
<title id="MathJax-SVG-1408-Title">C = .30</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-2E"></use>
 <use xlink:href="#MJMAIN-33" x="278" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span> increases sensitivity but decreases specificity.</p>
<p>We adjust a model's sensitivity and specificity by changing the classification threshold. Although we strive to maximize both sensitivity and specificity, we can see from the confusion matrices created with varying classification thresholds that there is a tradeoff. Increasing sensitivity leads to a decrease in specificity and vice versa.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="ROC-Curves">ROC Curves<a class="anchor-link" href="#ROC-Curves">¶</a></h3><p>We can calculate sensitivity and specificity values for all classification thresholds between 0 and 1 and plot them. Each threshold value <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1409-Title">
<title id="MathJax-SVG-1409-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> is associated with a (sensitivity, specificity) pair. A <strong>ROC (Receiver Operating Characteristic) curve</strong> is a slight modification of this idea; instead of plotting (sensitivity, specificity) it plots (sensitivity, 1 - specificity) pairs, where 1 - specificity is defined as the false positive rate.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="72.374ex" height="5.343ex" style="vertical-align: -2.005ex;" viewBox="0 -1437.2 31160.9 2300.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1410-Title">
<title id="MathJax-SVG-1410-Title"> \text{False Positive Rate } = 1 - \frac{TN}{TN + FP} = \frac{TN + FP - TN}{TN + FP} = \frac{FP}{TN + FP} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-46"></use>
 <use xlink:href="#MJMAIN-61" x="653" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="1154" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1432" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1827" y="0"></use>
 <use xlink:href="#MJMAIN-50" x="2521" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="3203" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="3703" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="4098" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="4376" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="4766" y="0"></use>
 <use xlink:href="#MJMAIN-76" x="5044" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="5573" y="0"></use>
 <use xlink:href="#MJMAIN-52" x="6267" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="7004" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="7504" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="7894" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="8866" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="9922" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="10645" y="0"></use>
<g transform="translate(11423,0)">
<g transform="translate(342,0)">
<rect stroke="none" width="4436" height="60" x="0" y="220"></rect>
<g transform="translate(1421,676)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
</g>
<g transform="translate(60,-704)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="16600" y="0"></use>
<g transform="translate(17379,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="7252" height="60" x="0" y="220"></rect>
<g transform="translate(60,676)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="4539" y="0"></use>
 <use xlink:href="#MJMATHI-54" x="5539" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="6244" y="0"></use>
</g>
<g transform="translate(1467,-704)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="25427" y="0"></use>
<g transform="translate(26206,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="4436" height="60" x="0" y="220"></rect>
<g transform="translate(1467,676)">
 <use xlink:href="#MJMATHI-46" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="749" y="0"></use>
</g>
<g transform="translate(60,-704)">
 <use xlink:href="#MJMATHI-54" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-4E" x="704" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1815" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="2815" y="0"></use>
 <use xlink:href="#MJMATHI-50" x="3565" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>A point on the ROC curve represents the sensitivity and false positive rate associated with a specific threshold value.</p>
<p>The ROC curve for <code>words_list_model</code> is calculated below using scikit-learn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_curve.html">ROC curve function</a>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_curve</span>

<span class="n">words_list_model_probabilities</span> <span class="o">=</span> <span class="n">words_list_model</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[:,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">false_positive_rate_values</span><span class="p">,</span> <span class="n">sensitivity_values</span><span class="p">,</span> <span class="n">thresholds</span> <span class="o">=</span> <span class="n">roc_curve</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">words_list_model_probabilities</span><span class="p">,</span> <span class="n">pos_label</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">false_positive_rate_values</span><span class="p">,</span> <span class="n">sensitivity_values</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="s1">'post'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'False Positive Rate (1 - Specificity)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Sensitivity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'words_list_model ROC Curve'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5,1,'words_list_model ROC Curve')</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_29_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice that as we move from left to right across the curve, sensitivity increases and the specificity decreases. Generally, the best classification threshold corresponds to high sensitivity and specificity (low false positive rate), so points in or around the northwest corner of the plot are preferable.</p>
<p>Let's examine the four corners of the plot:</p>
<ul>
<li>(0, 0): Specificity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1411-Title">
<title id="MathJax-SVG-1411-Title">=1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1056" y="0"></use>
</g>
</svg></span>, which means all data points in the negative class are correctly labeled, but sensitivity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1412-Title">
<title id="MathJax-SVG-1412-Title">= 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1056" y="0"></use>
</g>
</svg></span>, so the model has no true positives. (0,0) maps to the classification threshold <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1413-Title">
<title id="MathJax-SVG-1413-Title">C = 1.0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span>, which has the same effect as <code>ham_only</code> since no email can have a probability greater than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.972ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1414-Title">
<title id="MathJax-SVG-1414-Title">1.0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</svg></span>.</li>
<li>(1, 1): Specificity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1415-Title">
<title id="MathJax-SVG-1415-Title">=0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1056" y="0"></use>
</g>
</svg></span>, which means the model has no true negatives, but sensitivity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1416-Title">
<title id="MathJax-SVG-1416-Title">= 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1056" y="0"></use>
</g>
</svg></span>, so all data points in the positive class are correctly labeled. (1,1) maps to the classification threshold <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.837ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3374.1 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1417-Title">
<title id="MathJax-SVG-1417-Title">C = 0.0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="1038" y="0"></use>
<g transform="translate(2094,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</g>
</svg></span>, which has the same effect as <code>spam_only</code> since no email can have a probability lower than <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.972ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1279.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1418-Title">
<title id="MathJax-SVG-1418-Title">0.0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
</g>
</svg></span>.</li>
<li>(0, 1): Both specificity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1419-Title">
<title id="MathJax-SVG-1419-Title">=1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1056" y="0"></use>
</g>
</svg></span> and sensitivity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1420-Title">
<title id="MathJax-SVG-1420-Title">= 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1056" y="0"></use>
</g>
</svg></span>, which means there are no false positives or false negatives. A model with an ROC curve containing (0, 1) has a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1421-Title">
<title id="MathJax-SVG-1421-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> value at which it is a perfect classifier!</li>
<li>(1, 0): Both specificity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1422-Title">
<title id="MathJax-SVG-1422-Title">=0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1056" y="0"></use>
</g>
</svg></span> and sensitivity <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.616ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 1556.8 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1423-Title">
<title id="MathJax-SVG-1423-Title">= 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-3D" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1056" y="0"></use>
</g>
</svg></span>, which means there are no true positives or true negatives. A model with an ROC curve containing (1, 0) has a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 760.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1424-Title">
<title id="MathJax-SVG-1424-Title">C</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-43" x="0" y="0"></use>
</g>
</svg></span> value at which it predicts the wrong class for every data point!</li>
</ul>
<p>A classifier that randomly predicts classes has a diagonal ROC curve containing all points where sensitivity and the false positive rate are equal:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
         <span class="n">where</span><span class="o">=</span><span class="s1">'post'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'False Positive Rate (1 - Specificity)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Sensitivity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Random Classifier ROC Curve'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5,1,'Random Classifier ROC Curve')</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_31_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Intuitively, a random classifier that predicts probability <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1425-Title">
<title id="MathJax-SVG-1425-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span> for input <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 572.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1426-Title">
<title id="MathJax-SVG-1426-Title">x</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
</g>
</svg></span> will result in either a true positive or false positive with chance <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1427-Title">
<title id="MathJax-SVG-1427-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span>, so sensitivity and the false positive rate are equal.</p>
<p>We want our classifier's ROC curve to be high above the random model diagnoal line, which brings us to the AUC metric.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="AUC">AUC<a class="anchor-link" href="#AUC">¶</a></h3><p>The <strong>Area Under Curve (AUC)</strong> is the area under the ROC curve and serves as a single number performance summary of the classifier. The AUC for <code>words_list_model</code> is shaded below and calculating using scikit-learn's <a href="http://scikit-learn.org/stable/modules/generated/sklearn.metrics.roc_auc_score.html#sklearn.metrics.roc_auc_score">AUC function</a>:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>

<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">false_positive_rate_values</span><span class="p">,</span> <span class="n">sensitivity_values</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="s1">'post'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'False Positive Rate (1 - Specificity)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Sensitivity'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'words_list_model ROC Curve'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>Text(0.5,1,'words_list_model ROC Curve')</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_sensitivity_specificity_34_1.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">roc_auc_score</span>

<span class="n">roc_auc_score</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span> <span class="n">words_list_model_probabilities</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.9057984671441136</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>AUC is interpreted as the probability that the classifier will assign a higher probability to a randomly chosen data point truly belonging to the positive class than a randomly chosen data point truly belonging to the negative class. A perfect AUC value of 1 corresponds to a perfect classifier (the ROC curve would contain (0, 1). The fact that <code>words_list_model</code> has an AUC of .906 means that roughly 90.6% of the time it is more likely to classify a spam email as spam than a ham email as spam.</p>
<p>By inspection, the AUC of the random classifier is 0.5, though this can vary slightly due to the randomness. An effective model will have an AUC much higher than 0.5, which <code>words_list_model</code> achieves. If a model's AUC is less than 0.5, it performs worse than random predictions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h3><p>AUC is an essential metric for evaluating models on class-imbalanced datasets. After training a model, it is best practice to generate an ROC curve and calculate AUC to determine the next step. If the AUC is sufficiently high, use the ROC curve to identify the best classification threshold. However, if the AUC is not satisfactory, consider doing further EDA and feature selection to improve the model.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/17'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">confusion_matrix</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">markers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'triangle'</span><span class="p">:[</span><span class="s1">'^'</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">0</span><span class="p">]],</span> 
           <span class="s1">'square'</span><span class="p">:[</span><span class="s1">'s'</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">1</span><span class="p">]],</span>
           <span class="s1">'circle'</span><span class="p">:[</span><span class="s1">'o'</span><span class="p">,</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">()[</span><span class="mi">2</span><span class="p">]]}</span>

<span class="k">def</span> <span class="nf">plot_binary</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
    <span class="n">data_copy</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">data_copy</span><span class="p">[</span><span class="s1">'$y$ == '</span> <span class="o">+</span> <span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_copy</span><span class="p">[</span><span class="s1">'$y$'</span><span class="p">]</span> <span class="o">==</span> <span class="n">label</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'category'</span><span class="p">)</span>
    
    <span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data_copy</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'$y$ == '</span> <span class="o">+</span> <span class="n">label</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> 
               <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="n">markers</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s1">'x'</span><span class="p">],</span> <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="n">markers</span><span class="p">[</span><span class="n">label</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="s1">'gray'</span><span class="p">],</span>
               <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'gist_yarg'</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Observed'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Predicted'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="s1">'iris-setosa'</span><span class="p">,</span> <span class="s1">'iris-versicolor'</span><span class="p">,</span> <span class="s1">'iris-virginica'</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="p">[</span><span class="s1">'iris-setosa'</span><span class="p">,</span> <span class="s1">'iris-versicolor'</span><span class="p">,</span> <span class="s1">'iris-virginica'</span><span class="p">],</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">'horizontal'</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">'top'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_label_position</span><span class="p">(</span><span class="s1">'top'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multiclass-Classification">Multiclass Classification<a class="anchor-link" href="#Multiclass-Classification">¶</a></h2><p>Our classifiers thus far perform binary classification where each observation belongs to one of two classes; we classified emails as either ham or spam, for example. However, many data science problems involve <strong>multiclass classification</strong>, in which we would like to classify observations as one of several different classes. For example, we may be interested in classifying emails into folders such as Family, Friends, Work, and Promotions. To solve these types of problems, we use a new method called <strong>one-vs-rest (OvR) classification</strong>.</p>
<h3 id="One-Vs-Rest-Classification">One-Vs-Rest Classification<a class="anchor-link" href="#One-Vs-Rest-Classification">¶</a></h3><p>In OvR classification (also known as one-vs-all, or OvA), we decompose a multiclass classification problem into several different binary classification problems. For example, we might observe training data as shown below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">shapes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
    <span class="p">[[</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">3.6</span><span class="p">,</span> <span class="s1">'triangle'</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">3.2</span><span class="p">,</span> <span class="s1">'triangle'</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.8</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="s1">'triangle'</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="s1">'square'</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.9</span><span class="p">,</span> <span class="s1">'square'</span><span class="p">],</span> <span class="p">[</span><span class="mf">2.6</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s1">'square'</span><span class="p">],</span>
     <span class="p">[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.9</span><span class="p">,</span> <span class="s1">'circle'</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="s1">'circle'</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.9</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="s1">'circle'</span><span class="p">]],</span>
    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">,</span> <span class="s1">'$y$'</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">shapes</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'$y$'</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="p">[</span><span class="s1">'^'</span><span class="p">,</span> <span class="s1">'s'</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">],</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_6_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our goal is to build a multiclass classifier that labels observations as <code>triangle</code>, <code>square</code>, or <code>circle</code> given values for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1026.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1428-Title">
<title id="MathJax-SVG-1428-Title">x_1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1026.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1429-Title">
<title id="MathJax-SVG-1429-Title">x_2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
</svg></span>. First, we want to build a binary classifier <code>lr_triangle</code> that predicts observations as <code>triangle</code> or not <code>triangle</code>:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_binary</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="s1">'triangle'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_8_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Similarly, we build binary classifiers <code>lr_square</code> and <code>lr_circle</code> for the remaining classes:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_binary</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="s1">'square'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_10_0.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_binary</span><span class="p">(</span><span class="n">shapes</span><span class="p">,</span> <span class="s1">'circle'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_11_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We know that the output of the sigmoid function in logistic regression is a probability value from 0 to 1. To solve our multiclass classification task, we find the probability of the positive class in each binary classifier and select the class that outputs the highest positive class probability. For example, if we have a new observation with the following values:</p>
<table>
<thead><tr>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1026.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1430-Title">
<title id="MathJax-SVG-1430-Title">x_1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
</svg></span></th>
<th><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.384ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1026.4 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1431-Title">
<title id="MathJax-SVG-1431-Title">x_2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
</svg></span></th>
</tr>
</thead>
<tbody>
<tr>
<td>3.2</td>
<td>2.5</td>
</tr>
</tbody>
</table>
<p>Then our multiclass classifier would input these values to each of <code>lr_triangle</code>, <code>lr_square</code>, and <code>lr_circle</code>. We extract the positive class probability of each of the three classifiers:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">lr_triangle</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">lr_triangle</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">shapes</span><span class="p">[[</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">]],</span> <span class="n">shapes</span><span class="p">[</span><span class="s1">'$y$'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'triangle'</span><span class="p">)</span>
<span class="n">proba_triangle</span> <span class="o">=</span> <span class="n">lr_triangle</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="n">lr_square</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">lr_square</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">shapes</span><span class="p">[[</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">]],</span> <span class="n">shapes</span><span class="p">[</span><span class="s1">'$y$'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'square'</span><span class="p">)</span>
<span class="n">proba_square</span> <span class="o">=</span> <span class="n">lr_square</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

<span class="n">lr_circle</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">lr_circle</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">shapes</span><span class="p">[[</span><span class="s1">'$x_1$'</span><span class="p">,</span> <span class="s1">'$x_2$'</span><span class="p">]],</span> <span class="n">shapes</span><span class="p">[</span><span class="s1">'$y$'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'circle'</span><span class="p">)</span>
<span class="n">proba_circle</span> <span class="o">=</span> <span class="n">lr_circle</span><span class="o">.</span><span class="n">predict_proba</span><span class="p">([[</span><span class="mf">3.2</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">]])[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<table>
<thead><tr>
<th><code>lr_triangle</code></th>
<th><code>lr_square</code></th>
<th><code>lr_circle</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>0.145748</td>
<td>0.285079</td>
<td>0.497612</td>
</tr>
</tbody>
</table>
<p>Since the positive class probability of <code>lr_circle</code> is the greatest of the three, our multiclass classifier predicts that the observation is a circle.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Case-Study:-Iris-dataset">Case Study: Iris dataset<a class="anchor-link" href="#Case-Study:-Iris-dataset">¶</a></h2><p>The <a href="https://archive.ics.uci.edu/ml/datasets/iris">Iris dataset</a> is a famous dataset that is often used in data science to explore machine learning concepts. There are three classes, each representing a type of Iris plant:</p>
<ul>
<li>Iris-setosa</li>
<li>Iris-versicolor</li>
<li>Iris-virginica</li>
</ul>
<p>There are four features available in the dataset:</p>
<ul>
<li>Sepal length (cm)</li>
<li>Sepal width (cm)</li>
<li>Petal length (cm)</li>
<li>Petal width (cm)</li>
</ul>
<p><img alt="" src="https://raw.githubusercontent.com/DS-100/textbook/master/assets/petal_sepal.png"></p>
<p>We will create a multiclass classifier that predicts the type of Iris plant based on the four features above. First, we read in the data:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'https://archive.ics.uci.edu/ml/machine-learning-databases/iris/iris.data'</span><span class="p">,</span>
                  <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s1">'sepal_length'</span><span class="p">,</span> <span class="s1">'sepal_width'</span><span class="p">,</span> <span class="s1">'petal_length'</span><span class="p">,</span> <span class="s1">'petal_width'</span><span class="p">,</span> <span class="s1">'species'</span><span class="p">])</span>

<span class="n">iris</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>sepal_length</th>
<th>sepal_width</th>
<th>petal_length</th>
<th>petal_width</th>
<th>species</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr>
<th>1</th>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr>
<th>2</th>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
<td>Iris-setosa</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>147</th>
<td>6.5</td>
<td>3.0</td>
<td>5.2</td>
<td>2.0</td>
<td>Iris-virginica</td>
</tr>
<tr>
<th>148</th>
<td>6.2</td>
<td>3.4</td>
<td>5.4</td>
<td>2.3</td>
<td>Iris-virginica</td>
</tr>
<tr>
<th>149</th>
<td>5.9</td>
<td>3.0</td>
<td>5.1</td>
<td>1.8</td>
<td>Iris-virginica</td>
</tr>
</tbody>
</table>
<p>150 rows × 5 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">'species'</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">iris</span><span class="p">[</span><span class="s1">'species'</span><span class="p">]</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.35</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>After dividing the dataset into train and test splits, we fit a multiclass classifier to our training data. By default, scikit-learn's <code>LogisticRegression</code> sets <code>multi_class='ovr'</code>, which creates binary classifiers for each unique class:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class='ovr', n_jobs=1,
          penalty='l2', random_state=42, solver='liblinear', tol=0.0001,
          verbose=0, warm_start=False)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We predict on the test data, and use a confusion matrix to evaluate the results.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_21_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The confusion matrix shows that our classifier misclassified two <code>Iris-versicolor</code> observations as <code>Iris-virginica</code>. In observing the <code>sepal_length</code> and <code>sepal_width</code> features, we can hypothesize why this may have occurred:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lmplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">'sepal_length'</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">'sepal_width'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">iris</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">'species'</span><span class="p">,</span> <span class="n">fit_reg</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/classification_multiclass_23_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>Iris-versicolor</code> and <code>Iris-virginica</code> points overlap for these two features. Though the remaining features (<code>petal_width</code> and <code>petal_length</code>) contribute additional information to help distinguish between the two classes, our classifier still misclassified the two observations.</p>
<p>Likewise in the real world, misclassifications can be common if two classes bear similar features. Confusion matrices are valuable because they help us identify the errors that our classifier makes, and thus provides insight on what kind of additional features we may need to extract in order to improve the classifier.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multilabel-Classification">Multilabel Classification<a class="anchor-link" href="#Multilabel-Classification">¶</a></h2><p>Another type of classification problem is <strong>multilabel classification</strong>, in which each observation can have multiple labels. An example would be a document classification system: a document can have positive or negative sentiment, religious or nonreligious content, and liberal or conservative leaning. Multilabel problems can also be multiclass; we may want our document classification system to distinguish between a list of genres, or identify the language that the document is written in.</p>
<p>We may perform multilabel classification by simply training a separate classifier on each set of labels. To label a new point, we combine each classifier's predictions.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>Classification problems are often complex in nature. Sometimes, the problem requires us to distinguish an observation between multiple classes; in other situations, we may need to assign several labels to each observation. We leverage our knowledge of binary classifiers to create multiclass and multilabel classification systems that can achieve these tasks.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Statistical-Inference">Statistical Inference<a class="anchor-link" href="#Statistical-Inference">¶</a></h1><p>Although data scientists often work with individual samples of data, we are
almost always interested in making generalizations about the population that
the data were collected from. This chapter discusses methods for <em>statistical
inference</em>, the process of drawing conclusions about a entire population using
a dataset.</p>
<p>Statistical inference primarily leans on two methods: hypothesis tests and
confidence intervals. In the recent past these methods relied heavily on normal
theory, a branch of statistics that requires substantial assumptions about the
population. Today, the rapid rise of powerful computing resources has
enabled a new class of methods based on <em>resampling</em> that generalize to many
types of populations.</p>
<p>We first review inference using permutation tests and the bootstrap method. We
then introduce bootstrap methods for regression inference and skewed
distributions.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Hypothesis-Testing-and-Confidence-Intervals">Hypothesis Testing and Confidence Intervals<a class="anchor-link" href="#Hypothesis-Testing-and-Confidence-Intervals">¶</a></h2><p>In this section, we provide a brief review of hypothesis testing using the bootstrap and permutation tests. We assume familiarity with this topic since it is covered at length in Computational and Inferential Thinking, the textbook for Data 8. For a more thorough explanation of the concepts explained here, see <a href="https://www.inferentialthinking.com/chapters/11/Testing_Hypotheses">Chapter 11</a>, <a href="https://www.inferentialthinking.com/chapters/12/Comparing_Two_Samples">Chapter 12</a>, and <a href="https://www.inferentialthinking.com/chapters/13/Estimation">Chapter 13</a> of Computational and Inferential Thinking.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Hypothesis-Tests">Hypothesis Tests<a class="anchor-link" href="#Hypothesis-Tests">¶</a></h2><p>When applying data science techniques to different domains, we are often faced with questions about the world. For example, does drinking coffee cause sleep deprivation? Do autonomous vehicles crash more often then non-autonomous vehicles? Does drug X help treat pneumonia? To help answer these questions, we use hypothesis tests to make informed conclusions based on observed evidence/data.</p>
<p>Since data collection is often an imprecise process, we are often unsure whether the patterns in our dataset are due to noise or real phenomena. Hypothesis testing helps us determine whether a pattern could have happened because of random fluctuations in our data collection.</p>
<p>To explore hypothesis testing, we start with an example. The table <code>baby</code> contains information on baby weights at birth. It records the baby's birth weight in ounces and whether or not the mother smoked during pregnancy for 1174 babies.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">baby</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'baby.csv'</span><span class="p">)</span>
<span class="n">baby</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">"Birth Weight"</span><span class="p">,</span> <span class="s2">"Maternal Smoker"</span><span class="p">]]</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Birth Weight</th>
<th>Maternal Smoker</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>120</td>
<td>False</td>
</tr>
<tr>
<th>1</th>
<td>113</td>
<td>False</td>
</tr>
<tr>
<th>2</th>
<td>128</td>
<td>True</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1171</th>
<td>130</td>
<td>True</td>
</tr>
<tr>
<th>1172</th>
<td>125</td>
<td>False</td>
</tr>
<tr>
<th>1173</th>
<td>117</td>
<td>False</td>
</tr>
</tbody>
</table>
<p>1174 rows × 2 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Design">Design<a class="anchor-link" href="#Design">¶</a></h3><p>We would like to see whether maternal smoking was associated with birth weight.  To set up our hypothesis test, we can represent the two views of the world using the following null and alternative hypotheses:</p>
<p><strong>Null hypothesis:</strong> In the population, the distribution of birth weights of babies is the same for mothers who don't smoke as for mothers who do. The difference in the sample is due to chance.</p>
<p><strong>Alternative hypothesis:</strong> In the population, the babies of the mothers who smoke have a lower birth weight, on average, than the babies of the non-smokers.</p>
<p>Our ultimate goal is to make a decision between these two data generation models. One important point to notice is that we construct our hypotheses about the <em>parameters</em> of the data generation model rather than the outcome of the experiment. For example, we should not construct a null hypothesis such as "The birth weights of smoking mothers will be equal to the birth weights of nonsmoking mothers", since there is natural variability in the outcome of this process.</p>
<p>The null hypothesis emphasizes that if the data look different from what the null hypothesis predicts, the difference is due to nothing but chance. Informally, the alternative hypothesis says that the observed difference is "real."</p>
<p>We should take a closer look at the structure of our alternative hypothesis. In our current set up, notice that we would reject the null hypothesis if the birth weights of babies of the mothers who smoke are significantly lower than the birth weights of the babies of the mothers who do not smoke. In other words, the alternative hypothesis encompasses/supports one side of the distribution. We call this a <strong>one-sided</strong> alternative hypothesis. In general, we would only want to use this type of alternative hypothesis if we have a good reason to believe that it is impossible to see babies of the mothers who smoke have a higher birth weight, on average.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To visualize the data, we've plotted histograms of the baby weights for babies born to maternal smokers and non-smokers.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">smokers_hist</span> <span class="o">=</span> <span class="p">(</span><span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>
                <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Maternal Smoker"</span><span class="p">))</span>
<span class="n">non_smokers_hist</span> <span class="o">=</span> <span class="p">(</span><span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>
                    <span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Not Maternal Smoker"</span><span class="p">))</span>
<span class="n">smokers_hist</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Baby Birth Weights"</span><span class="p">)</span>
<span class="n">smokers_hist</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Proportion per Unit"</span><span class="p">)</span>
<span class="n">smokers_hist</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Distribution of Birth Weights"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_7_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The weights of the babies of the mothers who smoked seem lower on average than the weights of the babies of the non-smokers. Could this difference likely have occurred due to random variation? We can try to answer this question using a hypothesis test.</p>
<p>To perform a hypothesis test, we assume a particular model for generating the data; then, we ask ourselves, what is the chance we would see an outcome as extreme as the one that we observed? Intuitively, if the chance of seeing the outcome we observed is very small, the model that we assumed may not be the appropriate model.</p>
<p>In particular, we assume that the null hypothesis and its probability model, the <strong>null model</strong>, is true. In other words, we assume that the null hypothesis is true and focus on what the value of the statistic would be under under the null hypothesis. This chance model says that there is no underlying difference; the distributions in the samples are different just due to chance.</p>
<h3 id="Test-Statistic">Test Statistic<a class="anchor-link" href="#Test-Statistic">¶</a></h3><p>In our example, we would assume that maternal smoking has no effect on baby weight (where any observed difference is due to chance). In order to choose between our hypotheses, we will use the difference between the two group means as our <strong>test statistic</strong>.
Formally, our test statistic is</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.106ex" height="2.676ex" style="vertical-align: -1.005ex;" viewBox="0 -719.6 9087.2 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1432-Title">
<title id="MathJax-SVG-1432-Title">\mu_{\text{smoking}} - \mu_{\text{non-smoking}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-73"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="394" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6F" x="1228" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6B" x="1728" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="2257" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6E" x="2535" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-67" x="3092" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3466" y="0"></use>
<g transform="translate(4466,0)">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6E"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6F" x="556" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6E" x="1057" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2D" x="1613" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-73" x="1947" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="2341" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6F" x="3175" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6B" x="3675" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="4204" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6E" x="4482" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-67" x="5039" y="0"></use>
</g>
</g>
</g>
</svg></span><p>so that small values (that is, large negative values) of this statistic will favor the alternative hypothesis. Let's calculate the observed value of test statistic:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nonsmoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>
<span class="n">smoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>
<span class="n">observed_difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smoker</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">nonsmoker</span><span class="p">)</span>
<span class="n">observed_difference</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>-9.266142572024918</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If there were really no difference between the two distributions in the underlying population, then whether each mother was a maternal smoker or not should not affect the average birth weight. In other words, the label True or False with respect to maternal smoking should make no difference to the average.</p>
<p>Therefore, in order to simulate the test statistic under the null hypothesis, we can shuffle all the birth weights randomly among the mothers. We conduct this random permutation below.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="n">series</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Shuffles a series and resets index to preserve shuffle when adding series</span>
<span class="sd">    back to DataFrame.</span>
<span class="sd">    '''</span>
    <span class="k">return</span> <span class="n">series</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">baby</span><span class="p">[</span><span class="s2">"Shuffled"</span><span class="p">]</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Birth Weight"</span><span class="p">])</span>
<span class="n">baby</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>Birth Weight</th>
<th>Maternal Smoker</th>
<th>Shuffled</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>120</td>
<td>False</td>
<td>122</td>
</tr>
<tr>
<th>1</th>
<td>113</td>
<td>False</td>
<td>167</td>
</tr>
<tr>
<th>2</th>
<td>128</td>
<td>True</td>
<td>115</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>1171</th>
<td>130</td>
<td>True</td>
<td>116</td>
</tr>
<tr>
<th>1172</th>
<td>125</td>
<td>False</td>
<td>133</td>
</tr>
<tr>
<th>1173</th>
<td>117</td>
<td>False</td>
<td>120</td>
</tr>
</tbody>
</table>
<p>1174 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conducting-a-Permutation-Test">Conducting a Permutation Test<a class="anchor-link" href="#Conducting-a-Permutation-Test">¶</a></h3><p>Tests based on random permutations of the data are called <strong>permutation tests</strong>. In the cell below, we will simulate our test statistic many times and collect the differences in an array.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>

<span class="n">repetitions</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">repetitions</span><span class="p">):</span>
    <span class="n">baby</span><span class="p">[</span><span class="s2">"Shuffled"</span><span class="p">]</span> <span class="o">=</span> <span class="n">shuffle</span><span class="p">(</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Birth Weight"</span><span class="p">])</span>
  
    <span class="c1"># Find the difference between the means of two randomly assigned groups</span>
    <span class="n">nonsmoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Shuffled"</span><span class="p">]</span>
    <span class="n">smoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Shuffled"</span><span class="p">]</span>
    <span class="n">simulated_difference</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">smoker</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">nonsmoker</span><span class="p">)</span>

    <span class="n">differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">differences</span><span class="p">,</span> <span class="n">simulated_difference</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We plot a histogram of the simulated difference in means below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">differences_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">differences_df</span><span class="p">[</span><span class="s2">"differences"</span><span class="p">]</span> <span class="o">=</span> <span class="n">differences</span>
<span class="n">diff_hist</span> <span class="o">=</span> <span class="n">differences_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"differences"</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">diff_hist</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Birth Weight Difference"</span><span class="p">)</span>
<span class="n">diff_hist</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Proportion per Unit"</span><span class="p">)</span>
<span class="n">diff_hist</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Distribution of Birth Weight Differences"</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It makes intuitive sense that the distribution of differences is centered around 0 since the two groups should have the same average under the null hypothesis.</p>
<p>In order to draw a conclusion for this hypothesis test, we should calculate the p-value. The empirical p-value of the test is the proportion of simulated differences that were equal to or less than the observed difference.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">differences</span> <span class="o">&lt;=</span> <span class="n">observed_difference</span><span class="p">)</span> <span class="o">/</span> <span class="n">repetitions</span>
<span class="n">p_value</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.0</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>At the beginning of the hypothesis test we typically choose a p-value <strong>threshold of significance</strong> (commonly denoted as alpha). If our p-value is below our significance threshold, then we reject the null hypothesis. The most commonly chosen thresholds are 0.01 and 0.05, where 0.01 is considered to be more "strict" since we would need more evidence in favor of the alternative hypothesis to reject the null hypothesis.</p>
<p>In either of these two cases, we reject the null hypothesis since the p-value is less than the significance threshold.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bootstrap-Confidence-Intervals">Bootstrap Confidence Intervals<a class="anchor-link" href="#Bootstrap-Confidence-Intervals">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Data scientists must often estimate an unknown population parameter using a random sample. Although we would ideally like to take numerous samples from the population to generate a sampling distribution, we are often limited to a single sample by money and time.</p>
<p>Fortunately, a large, randomly collected sample looks like the original population. The bootstrap procedure uses this fact to simulate new samples by resampling from the original sample.</p>
<p>To conduct the bootstrap, we perform the following steps:</p>
<ol>
<li>Sample with replacement from the original sample (now the bootstrap population). These samples are called bootstrap samples. We typically take thousands of bootstrap samples (~10,000 is common).</li>
<li>Calculate the statistic of interest for each bootstrap sample. This statistic is called the bootstrap statistic, and the empirical distribution of these bootstrap statistics is an approximation to the sampling distribution of the bootstrapped statistic.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="alt text" src="https://ds8.gitbooks.io/textbook/content/notebooks-images/Bootstrap_25_0.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We may use the bootstrap sampling distribution to create a confidence interval which we use to estimate the value of the population parameter.</p>
<p>Since the birth weight data provides a large, random sample, we may act as if the data on mothers who did not smoke are representative of the population of nonsmoking mothers. Similarly, we act as if the data for smoking mothers are representative of the population of smoking mothers.</p>
<p>Therefore, we treat our original sample as the bootstrap population to perform the bootstrap procedure:</p>
<ol>
<li>Draw a sample with replacement from the nonsmoking mothers and calculate the mean birth weight for these mothers. We also draw a sample with replacement from the smoking mothers and calculate the mean birth weight.</li>
<li>Calculate the difference in means.</li>
<li>Repeat the above process 10000 times, obtaining 10000 mean differences.</li>
</ol>
<p>This procedure gives us a empirical sampling distribution of differences in mean baby weights.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="n">sample</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bootstrap</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">stat</span><span class="p">,</span> <span class="n">replicates</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
        <span class="n">stat</span><span class="p">(</span><span class="n">resample</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">replicates</span><span class="p">)</span>
    <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">nonsmoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>
<span class="n">smoker</span> <span class="o">=</span> <span class="n">baby</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">baby</span><span class="p">[</span><span class="s2">"Maternal Smoker"</span><span class="p">],</span> <span class="s2">"Birth Weight"</span><span class="p">]</span>

<span class="n">nonsmoker_means</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">nonsmoker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">smoker_means</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">smoker</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>

<span class="n">mean_differences</span> <span class="o">=</span> <span class="n">smoker_means</span> <span class="o">-</span> <span class="n">nonsmoker_means</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We plot the empirical distribution of the difference in means below:</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">mean_differences_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">mean_differences_df</span><span class="p">[</span><span class="s2">"differences"</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mean_differences</span><span class="p">)</span>
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">mean_differences_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"differences"</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mean_diff</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Birth Weight Difference"</span><span class="p">)</span>
<span class="n">mean_diff</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Proportion per Unit"</span><span class="p">)</span>
<span class="n">mean_diff</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Distribution of Birth Weight Differences"</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_27_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Finally, to construct a 95% confidence interval we take the 2.5th and 97.5th percentiles of the bootstrap statistics:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mean_differences</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> 
 <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">mean_differences</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(-11.36909646997882, -7.181670323140913)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This confidence interval allows us to state with 95% confidence that the population mean difference in birth weights is between -11.37 and -7.18 ounces.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this section, we review hypothesis testing using the permutation test and confidence intervals using the bootstrap. To conduct a hypothesis test, we must state our null and alternative hypotheses, select an appropriate test statistic, and perform the testing procedure to calculate a p-value. To create a confidence interval, we select an appropriate test statistic, bootstrap the original sample to generate an empirical distribution of the test statistic, and select the quantiles corresponding to our desired confidence level.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Permutation-Test">Permutation Test<a class="anchor-link" href="#Permutation-Test">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are several cases where we would like to perform a permuation test in order to test a hypothesis and learn more about the world. A permutation test is a very useful type of non-parametric test that allows us to make inferences without making statistical assumptions that underly traditional parametric tests.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One insightful example of permutation inference is the reexamination of Student Evaluation of Teaching (SET) data by Boring, Ottoboni, and Stark (2016). In this experiment, 47 students were randomly assigned to one of four sections. There are two TAs that teach two sections each; one TA is male and other is female. In two of the sections, the teaching assistants were introduced using their actual names. In the other two sections, the assistants
switched names.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#HIDDEN </span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">display</span><span class="p">(</span><span class="n">Image</span><span class="p">(</span><span class="s1">'student_setup.png'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_part2_5_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Students never met the teaching assistants face-to-face. Instead, they interacted with the students via an online forum. Homework returns were coordinated so that all students received scores/feedback all at the same time. The 2 TAs also had comparable levels of experience. At the end of the course, students evaluate the TA on promptness in returning assignment.
The authors wanted to investigate if
gender perception has any effect on SETs evaluations/ratings.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Experiment-Setup">Experiment Setup<a class="anchor-link" href="#Experiment-Setup">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We conduct a hypothesis test using a p-value cutoff of 0.05.</p>
<p>In our <strong>model</strong>, each TA has two possible ratings from each student—one for each perceived gender. Each student had an equal chance of being assigned to any one of the (gender, perceived gender) pairs. Finally, the students evaluate their TAs independently of one another.</p>
<p>The <strong>null hypothesis</strong> of this experiment is that perceived gender has no effect on SETs and any observed difference in ratings is due to chance. In other words, the evaluation of each TA should remain unchanged whether they are percieved as a male or a female. This means that each TA really only has one possible rating from each student.</p>
<p>The <strong>alternative hypothesis</strong> is that perceived gender has an effect on SETs.</p>
<p>The <strong>test statistic</strong> is the absolute difference in means of perceived male and perceived female ratings for each TA. Intuitively, we expect this to be close to 0 if gender has no effect on ratings. We can write this formally:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.989ex" height="3.009ex" style="vertical-align: -1.005ex;" viewBox="0 -863.1 12911.9 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1433-Title">
<title id="MathJax-SVG-1433-Title">
\left| \mu_{\text{perceived female}} - \mu_{\text {perceived male}} \right|
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7C"></use>
<g transform="translate(278,0)">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-155)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-70"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-72" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-63" x="1393" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="1838" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="2282" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-76" x="2561" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="3089" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-64" x="3534" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-66" x="4444" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="4750" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="5195" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-61" x="6028" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6C" x="6529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="6807" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2212" x="6332" y="0"></use>
<g transform="translate(7332,0)">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-70"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-72" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-63" x="1393" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="1838" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="2282" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-76" x="2561" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="3089" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-64" x="3534" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="4444" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-61" x="5277" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6C" x="5778" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="6056" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-7C" x="12633" y="-1"></use>
</g>
</svg></span><p>Where:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.896ex" height="13.509ex" style="vertical-align: -6.171ex;" viewBox="0 -3159.4 16746.7 5816.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1434-Title">
<title id="MathJax-SVG-1434-Title">
\begin{aligned}
\mu_{\text{perceived female}} &amp;= \frac {\sum_{j=1}^{n_1} x_{1j} + \sum_{j=1}^{n_3} x_{3j}}{{n_1} + {n_3}} \\
\mu_{\text{perceived male}} &amp;= \frac {\sum_{j=1}^{n_2} x_{2j} + \sum_{j=1}^{n_4} x_{4j}}{{n_2} + {n_4}}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,1241)">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-155)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-70"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-72" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-63" x="1393" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="1838" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="2282" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-76" x="2561" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="3089" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-64" x="3534" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-66" x="4444" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="4750" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="5195" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-61" x="6028" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6C" x="6529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="6807" y="0"></use>
</g>
</g>
<g transform="translate(531,-1687)">
 <use xlink:href="#MJMATHI-3BC" x="0" y="0"></use>
<g transform="translate(603,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-70"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="556" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-72" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-63" x="1393" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="1838" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-69" x="2282" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-76" x="2561" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="3089" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-64" x="3534" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6D" x="4444" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-61" x="5277" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-6C" x="5778" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-65" x="6056" y="0"></use>
</g>
</g>
</g>
<g transform="translate(5821,0)">
<g transform="translate(0,1241)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="9017" height="60" x="0" y="220"></rect>
<g transform="translate(60,971)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
<g transform="translate(1056,484)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-31" x="739" y="-243"></use>
</g>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
<g transform="translate(2519,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="4059" y="0"></use>
<g transform="translate(5060,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
<g transform="translate(1056,496)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-33" x="739" y="-242"></use>
</g>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
</g>
<g transform="translate(7579,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="500" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2842,-686)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="849" y="-213"></use>
 <use xlink:href="#MJMAIN-2B" x="1276" y="0"></use>
<g transform="translate(2277,0)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-33" x="849" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1687)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(1056,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="9017" height="60" x="0" y="220"></rect>
<g transform="translate(60,971)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
<g transform="translate(1056,484)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-32" x="739" y="-243"></use>
</g>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
<g transform="translate(2519,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2B" x="4059" y="0"></use>
<g transform="translate(5060,0)">
 <use xlink:href="#MJSZ1-2211" x="0" y="0"></use>
<g transform="translate(1056,490)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.574)" xlink:href="#MJMAIN-34" x="739" y="-254"></use>
</g>
<g transform="translate(1056,-308)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-3D" x="412" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="1191" y="0"></use>
</g>
</g>
<g transform="translate(7579,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="500" y="0"></use>
</g>
</g>
</g>
<g transform="translate(2842,-686)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="849" y="-213"></use>
 <use xlink:href="#MJMAIN-2B" x="1276" y="0"></use>
<g transform="translate(2277,0)">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="849" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.194ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 944.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1435-Title">
<title id="MathJax-SVG-1435-Title">n_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="849" y="-213"></use>
</g>
</svg></span> is the number of students in the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 345.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1436-Title">
<title id="MathJax-SVG-1436-Title">i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-69" x="0" y="0"></use>
</g>
</svg></span>th group and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.807ex" height="2.343ex" style="vertical-align: -1.005ex;" viewBox="0 -576.1 1208.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1437-Title">
<title id="MathJax-SVG-1437-Title">x_{ij}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
<g transform="translate(572,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6A" x="345" y="0"></use>
</g>
</g>
</svg></span> is the rating of the jth student in the ith group.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In order to determine whether gender has an effect on SET ratings, we perform a permutation test to generate an empirical distribution of the test statistic under the null hypothesis. We follow the following steps:</p>
<ol>
<li>Permute the perceived gender labels for students under the same TA. Note that we are shuffling within the left and right halves in the picture above.</li>
<li>Compute the difference in average scores for identified-female and identified-male groups. </li>
<li>Repeat many times to create an approximate sampling distribution for the difference in average scores for the 2 groups. </li>
<li>Use the approximate distribution to estimate the chance of seeing a test statistic more extreme than the one observed.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is important to understand why the permutation test is justified in this scenario. Under the null model, each student would have given their TA the same rating regardless of perceived gender. Simple random assignment then implies that for a given TA, all of their ratings had an equal chance of showing up regardless of whether they were perceived as male or female. Therefore, permuting the gender labels should have no effect on the ratings if the null hypothesis were true.</p>
<h3 id="The-Data">The Data<a class="anchor-link" href="#The-Data">¶</a></h3><p>We begin with the student and gender data below. These data are a census of 47 students enrolled in an online course at a U.S. university.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#HIDDEN </span>
<span class="n">student_eval</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'StudentRatingsData.csv'</span><span class="p">)</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">"tagender"</span><span class="p">,</span> <span class="s2">"taidgender"</span><span class="p">,</span> <span class="s2">"prompt"</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'tagender'</span><span class="p">:</span> <span class="s1">'actual'</span><span class="p">,</span> <span class="s1">'taidgender'</span><span class="p">:</span> <span class="s1">'perceived'</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">student_eval</span><span class="p">[[</span><span class="s1">'actual'</span><span class="p">,</span> <span class="s1">'perceived'</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">student_eval</span><span class="p">[[</span><span class="s1">'actual'</span><span class="p">,</span> <span class="s1">'perceived'</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">'female'</span><span class="p">,</span> <span class="s1">'male'</span><span class="p">])</span>
<span class="p">)</span>
<span class="n">student_eval</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>actual</th>
<th>perceived</th>
<th>prompt</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>female</td>
<td>male</td>
<td>4.0</td>
</tr>
<tr>
<th>1</th>
<td>female</td>
<td>male</td>
<td>5.0</td>
</tr>
<tr>
<th>2</th>
<td>female</td>
<td>male</td>
<td>5.0</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>43</th>
<td>male</td>
<td>female</td>
<td>4.0</td>
</tr>
<tr>
<th>44</th>
<td>male</td>
<td>female</td>
<td>2.0</td>
</tr>
<tr>
<th>45</th>
<td>male</td>
<td>female</td>
<td>4.0</td>
</tr>
</tbody>
</table>
<p>43 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The columns have the following meanings:</p>
<p><strong>actual</strong> – the true gender of the TA</p>
<p><strong>perceived</strong> – the gender presented to the students</p>
<p><strong>prompt</strong> – rating on promptness of HW on a scale from 1 to 5</p>
<p>After analyzing and plotting the ratings data from the experiment below,  there appears to be a difference between the groups of students, with perceived female ratings lower than male ratings; however, we need a more formal hypothesis test to see if this difference could simply be due to the random assignment of students.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">avg_ratings</span> <span class="o">=</span> <span class="p">(</span><span class="n">student_eval</span>
 <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s1">'actual'</span><span class="p">,</span> <span class="s1">'perceived'</span><span class="p">,</span> <span class="s1">'prompt'</span><span class="p">]]</span>
 <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">'actual'</span><span class="p">,</span> <span class="s1">'perceived'</span><span class="p">])</span>
 <span class="o">.</span><span class="n">mean</span><span class="p">()</span>
 <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">'prompt'</span><span class="p">:</span> <span class="s1">'mean prompt'</span><span class="p">})</span>
<span class="p">)</span>
<span class="n">avg_ratings</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th></th>
<th>mean prompt</th>
</tr>
<tr>
<th>actual</th>
<th>perceived</th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<th rowspan="2" valign="top">female</th>
<th>female</th>
<td>3.75</td>
</tr>
<tr>
<th>male</th>
<td>4.33</td>
</tr>
<tr>
<th rowspan="2" valign="top">male</th>
<th>female</th>
<td>3.42</td>
</tr>
<tr>
<th>male</th>
<td>4.36</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ind</span><span class="p">,</span> <span class="n">avg_ratings</span><span class="p">[</span><span class="s2">"mean prompt"</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">'Female (Percieved Female)'</span><span class="p">,</span> <span class="s1">'Female (Percieved Male)'</span><span class="p">,</span> <span class="s1">'Male (Percieved Female)'</span><span class="p">,</span> <span class="s2">"Male (Percieved Male)"</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Average Promptness Rating'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Actual/Percieved Gender'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">'Average Rating Per Actual/Percieved Gender'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_part2_14_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Performing-the-Experiment">Performing the Experiment<a class="anchor-link" href="#Performing-the-Experiment">¶</a></h3><p>We will compute the absolute observed difference between the average ratings of the identified male and identified female groups:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">stat</span><span class="p">(</span><span class="n">evals</span><span class="p">):</span>
    <span class="sd">'''Computes the test statistic on the evals DataFrame'''</span>
    <span class="n">avgs</span> <span class="o">=</span> <span class="n">evals</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'perceived'</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">avgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'female'</span><span class="p">,</span> <span class="s1">'prompt'</span><span class="p">]</span> <span class="o">-</span> <span class="n">avgs</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">'male'</span><span class="p">,</span> <span class="s1">'prompt'</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">observed_difference</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">student_eval</span><span class="p">)</span>
<span class="n">observed_difference</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.7978260869565217</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We see that the difference is 0.8—in this case, the average rating for those identified as female is nearly 1 point lower on a scale from 1 to 5.  Given the scale of the ratings, this difference appears to be quite large. By performing a permutation test, we will be able to find the chance of observing a difference this large under our null model.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, we can permute the perceived gender labels for each TA and calculate the test statistic 1,000 times:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">shuffle_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="sd">'''Returns a new copy of df with col shuffled'''</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">result</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">repetitions</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">gender_differences</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="n">stat</span><span class="p">(</span><span class="n">shuffle_column</span><span class="p">(</span><span class="n">student_eval</span><span class="p">,</span> <span class="s1">'perceived'</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">repetitions</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We plot the approximate sampling distribution of the difference in scores using our permutations below, showing the observed value using a red dotted line.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">differences_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">differences_df</span><span class="p">[</span><span class="s2">"gender_differences"</span><span class="p">]</span> <span class="o">=</span> <span class="n">gender_differences</span>
<span class="n">gender_hist</span> <span class="o">=</span> <span class="n">differences_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"gender_differences"</span><span class="p">]</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">gender_hist</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">"Average Gender Difference (Test Statistic)"</span><span class="p">)</span>
<span class="n">gender_hist</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">"Percent per Unit"</span><span class="p">)</span>
<span class="n">gender_hist</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">"Distribution of Gender Differences"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">observed_difference</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_introduction_part2_23_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From our calculation below, only 6 of the 1000 simulations had a difference at least as large as the one observed. Therefore, our p-value is less than the 0.05 threshold and we reject the null hypothesis in favor of the alternative.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">num_extreme</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">gender_differences</span> <span class="o">&gt;=</span> <span class="n">observed_difference</span><span class="p">)</span>
<span class="n">empirical_P</span> <span class="o">=</span> <span class="n">num_extreme</span> <span class="o">/</span> <span class="n">repetitions</span>
<span class="n">empirical_P</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0.006</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">¶</a></h3><p>Through this permuatation test, we have shown that SET are biased against female instructors by an amount that is large and statistically significant.</p>
<p>There are other studies that have also tested bias within teaching evaluations. According to Boring, Ottoboni &amp; Stark 2016, there were several other parametric tests conducted that assumed ratings of male and female instructors are independent random samples from normally distributed populations with equal variances; this type of experimental design does not align with the proposed null hypothesis, causing the p-values to be potentially misleading.</p>
<p>In contrast, Boring, Ottoboni &amp; Stark 2016 used permutation tests based on random assignment of students to class sections. Recall that during our permutation test, we did not make any underlying assumptions about the distribution of our data. In this experiment,  we did not assume that students, SET scores, grades, or any other variables comprise random samples from any populations, much less populations with normal distributions.</p>
<p>When testing a hypothesis, it is very important to carefully choose your experiment design and null hypothesis in order to obtain reliable results.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN </span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="c1">#import nbinteract as nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Bootstrapping-for-Linear-Regression-(Inference-for-the-True-Coefficients)">Bootstrapping for Linear Regression (Inference for the True Coefficients)<a class="anchor-link" href="#Bootstrapping-for-Linear-Regression-(Inference-for-the-True-Coefficients)">¶</a></h2><p>Recall that in linear regression, we fit a model of the following form
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.832ex" height="3.676ex" style="vertical-align: -1.338ex;" viewBox="0 -1006.6 13705.4 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1438-Title">
<title id="MathJax-SVG-1438-Title">
\begin{aligned}
f_\hat{\theta} (x) = \hat{\theta_0} + \hat{\theta_1} x_1 + \ldots + \hat{\theta_p} x_p
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-46)">
 <use xlink:href="#MJMATHI-66" x="0" y="0"></use>
<g transform="translate(490,-380)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
 <use xlink:href="#MJMAIN-28" x="1027" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="1417" y="0"></use>
 <use xlink:href="#MJMAIN-29" x="1989" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2656" y="0"></use>
<g transform="translate(3713,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4858" y="0"></use>
<g transform="translate(5859,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
<g transform="translate(6783,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8031" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="9032" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10427" y="0"></use>
<g transform="translate(11427,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="212" y="283"></use>
</g>
<g transform="translate(12353,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="809" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span></p>
<p>We would like to infer the true coefficients of the model. Since the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1439-Title">
<title id="MathJax-SVG-1439-Title">\hat{\theta_0}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 923.4 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1440-Title">
<title id="MathJax-SVG-1440-Title">\hat{\theta_1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="211" y="283"></use>
</g>
</svg></span>, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.723ex" height="0.843ex" style="vertical-align: -0.338ex;" viewBox="0 -217.3 1172.5 362.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1441-Title">
<title id="MathJax-SVG-1441-Title">\ldots</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-2026" x="0" y="0"></use>
</g>
</svg></span> <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.15ex" height="3.509ex" style="vertical-align: -1.005ex;" viewBox="0 -1078.4 925.5 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1442-Title">
<title id="MathJax-SVG-1442-Title">\hat{\theta_p}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="663" y="-213"></use>
 <use xlink:href="#MJMAIN-5E" x="212" y="283"></use>
</g>
</svg></span> are estimators that vary based on our training data/observations, we would like to understand how our estimated coefficients compare with the true coefficients. Bootstrapping is a <em>nonparametric</em> approach to statistical inference that gives us standard errors and confidence intervals for our parameters.</p>
<p>Let's take a look at an example of how we use bootstrapping methods within linear regression.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Data">The Data<a class="anchor-link" href="#The-Data">¶</a></h3><p>Otis Dudley Duncan was a quantitative sociologist interested in measuring the prestige levels of different occupations. There were only 90 occupations that were rated for their prestige level in the 1947 National Opinion Research Center (NORC) survey. Duncan wanted to “fill in” prestige scores for unrated occupations by using income and education data about each occupation recorded by the 1950 census. When joining the NORC data with the 1950 census data, only 45 occupations could be matched. Ultimately, Duncan's goal was to create a model to explain prestige using different characteristics; using this model, one can predict the prestige of other occupations not recorded in the NORC survey.</p>
<p>The Duncan dataset is a random sample of that contains information on the prestige and other characteristics of 45 U. S. occupations in 1950. 
The variables are:</p>
<p><code>occupation</code> represents the type of occupation/title.</p>
<p><code>income</code> represents the percentage of occupational incumbents who earned incomes in excess of $3,500.</p>
<p><code>education</code> represents the percentage of incumbents in the occupation in the 1950 U.S. Census who were high school graduates.</p>
<p><code>prestige</code> represents the percentage of respondents in a survey who rated an occupation as “good” or “excellent” in prestige.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">duncan</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'duncan.csv'</span><span class="p">)</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">"occupation"</span><span class="p">,</span> <span class="s2">"income"</span><span class="p">,</span> <span class="s2">"education"</span><span class="p">,</span> <span class="s2">"prestige"</span><span class="p">]]</span>
<span class="n">duncan</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>occupation</th>
<th>income</th>
<th>education</th>
<th>prestige</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>accountant</td>
<td>62</td>
<td>86</td>
<td>82</td>
</tr>
<tr>
<th>1</th>
<td>pilot</td>
<td>72</td>
<td>76</td>
<td>83</td>
</tr>
<tr>
<th>2</th>
<td>architect</td>
<td>75</td>
<td>92</td>
<td>90</td>
</tr>
<tr>
<th>...</th>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr>
<th>42</th>
<td>janitor</td>
<td>7</td>
<td>20</td>
<td>8</td>
</tr>
<tr>
<th>43</th>
<td>policeman</td>
<td>34</td>
<td>47</td>
<td>41</td>
</tr>
<tr>
<th>44</th>
<td>waiter</td>
<td>8</td>
<td>32</td>
<td>10</td>
</tr>
</tbody>
</table>
<p>45 rows × 4 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It is usually a good idea to explore the data through visualization in order to gain an understanding of the relationships between your variables. Below, we will visualize the correlations between income, educationa and prestige.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"education"</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"prestige"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a1cf2cd30&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_regression_6_1.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"income"</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"prestige"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a1d0224e0&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_regression_7_1.png">
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"income"</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">duncan</span><span class="p">[</span><span class="s2">"education"</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.collections.PathCollection at 0x1a1d0de5f8&gt;</pre>
</div>
</div>
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_regression_8_1.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the plots above, we see that both education and income are positively correlated with prestige; hence, both of these variables might be useful in helping explain prestige. Let's fit a linear model using these explanatory variables to explain prestige.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Fitting-the-model">Fitting the model<a class="anchor-link" href="#Fitting-the-model">¶</a></h3><p>We will fit the following model, that explains the prestige of an occupation as a linear function of income and education:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="65.819ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 28338.7 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1443-Title">
<title id="MathJax-SVG-1443-Title">
\begin{aligned}
\texttt{prestige}_i
= \theta_0^* 
+ \theta_\texttt{income}^*\cdot\texttt{income}_i
+ \theta_\texttt{education}^*\cdot\texttt{education}_i
+ \varepsilon_i
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,11)">
 <use xlink:href="#MJTT-70"></use>
 <use xlink:href="#MJTT-72" x="525" y="0"></use>
 <use xlink:href="#MJTT-65" x="1051" y="0"></use>
 <use xlink:href="#MJTT-73" x="1576" y="0"></use>
 <use xlink:href="#MJTT-74" x="2102" y="0"></use>
 <use xlink:href="#MJTT-69" x="2627" y="0"></use>
 <use xlink:href="#MJTT-67" x="3153" y="0"></use>
 <use xlink:href="#MJTT-65" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="5945" y="-376"></use>
 <use xlink:href="#MJMAIN-3D" x="4826" y="0"></use>
<g transform="translate(5882,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-30" x="663" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="7027" y="0"></use>
<g transform="translate(8028,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
<g transform="translate(469,-270)">
 <use transform="scale(0.707)" xlink:href="#MJTT-69"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6D" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-65" x="2627" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="11049" y="0"></use>
<g transform="translate(11550,0)">
 <use xlink:href="#MJTT-69"></use>
 <use xlink:href="#MJTT-6E" x="525" y="0"></use>
 <use xlink:href="#MJTT-63" x="1051" y="0"></use>
 <use xlink:href="#MJTT-6F" x="1576" y="0"></use>
 <use xlink:href="#MJTT-6D" x="2102" y="0"></use>
 <use xlink:href="#MJTT-65" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="4459" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="15270" y="0"></use>
<g transform="translate(16270,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
<g transform="translate(469,-270)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-22C5" x="20406" y="0"></use>
<g transform="translate(20907,0)">
 <use xlink:href="#MJTT-65"></use>
 <use xlink:href="#MJTT-64" x="525" y="0"></use>
 <use xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use xlink:href="#MJTT-6E" x="4204" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="6688" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="26203" y="0"></use>
<g transform="translate(27204,0)">
 <use xlink:href="#MJMATHI-3B5" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="659" y="-213"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In order to fit this model, we will define the design matrix (X) and our response variable (y):</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">duncan</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">"income"</span><span class="p">,</span> <span class="s2">"education"</span><span class="p">]]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>income</th>
<th>education</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>62</td>
<td>86</td>
</tr>
<tr>
<th>1</th>
<td>72</td>
<td>76</td>
</tr>
<tr>
<th>2</th>
<td>75</td>
<td>92</td>
</tr>
<tr>
<th>3</th>
<td>55</td>
<td>90</td>
</tr>
<tr>
<th>4</th>
<td>64</td>
<td>86</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">duncan</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">"prestige"</span><span class="p">]</span>
<span class="n">y</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>0    82
1    83
2    90
3    76
4    90
Name: prestige, dtype: int64</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Below, we fit our linear model and print all the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1444-Title">
<title id="MathJax-SVG-1444-Title">\widehat \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
</g>
</svg></span> coefficients of the model (from the equation above) after the model has been fit to the data. Note that these are our sample coefficients.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn.linear_model</span> <span class="k">as</span> <span class="nn">lm</span>

<span class="n">linear_model</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">linear_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"""</span>
<span class="s2">intercept: </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">income:    </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">education:    </span><span class="si">%.2f</span><span class="s2"></span>
<span class="s2">"""</span> <span class="o">%</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">([</span><span class="n">linear_model</span><span class="o">.</span><span class="n">intercept_</span><span class="p">])</span> <span class="o">+</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>intercept: -6.06
income:    0.60
education:    0.55

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The coefficients above give us an estimate of the true coefficients. But had our sample data been different, we would have fit our model to different data, causing these coefficients to be different. We would like to explore what our coefficients might have been using bootstrapping methods.</p>
<p>In our bootstrapping methods and analysis, we will focus on the coefficient of education. We would like to explore the partial relationship between prestige and education holding income constant (rather than the marginal relationship between prestige and education ignoring income). The partial regression coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4028.1 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1445-Title">
<title id="MathJax-SVG-1445-Title">\widehat\theta_\texttt{education}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span> illustrates the partial relationship between prestige and education within our data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bootstrapping-the-Observations">Bootstrapping the Observations<a class="anchor-link" href="#Bootstrapping-the-Observations">¶</a></h3><p>In this method, we consider the pairs <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.506ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3231.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1446-Title">
<title id="MathJax-SVG-1446-Title">(X_i, y_i)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1562" y="0"></use>
<g transform="translate(2007,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2842" y="0"></use>
</g>
</svg></span> to be our sample, so we construct the bootstrap resample by sampling with replacement from these pairs:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="73.18ex" height="3.176ex" style="vertical-align: -0.711ex; margin-bottom: -0.294ex;" viewBox="0 -934.9 31507.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1447-Title">
<title id="MathJax-SVG-1447-Title">
\begin{aligned}
(X_i^*, y_i^*) 
= (X_I, y_I), \text{ where } I=1,\dots,n \text{ is sampled uniformly at random.}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,6)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="1215" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-430"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1703" y="0"></use>
<g transform="translate(2148,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="706" y="453"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-430"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3101" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3769" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="4825" y="0"></use>
<g transform="translate(5214,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-49" x="1171" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="6500" y="0"></use>
<g transform="translate(6945,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-49" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="7892" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="8282" y="0"></use>
<g transform="translate(8727,0)">
 <use xlink:href="#MJMAIN-77" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-68" x="972" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="1529" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="1973" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="2366" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-49" x="11787" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="12570" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="13626" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="14126" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="14571" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="15911" y="0"></use>
 <use xlink:href="#MJMATHI-6E" x="16356" y="0"></use>
<g transform="translate(16956,0)">
 <use xlink:href="#MJMAIN-69" x="250" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="528" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="1173" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="1567" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="2068" y="0"></use>
 <use xlink:href="#MJMAIN-70" x="2901" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="3458" y="0"></use>
 <use xlink:href="#MJMAIN-65" x="3736" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="4181" y="0"></use>
 <use xlink:href="#MJMAIN-75" x="4987" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="5544" y="0"></use>
 <use xlink:href="#MJMAIN-69" x="6100" y="0"></use>
 <use xlink:href="#MJMAIN-66" x="6379" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="6685" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="7186" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="7578" y="0"></use>
 <use xlink:href="#MJMAIN-6C" x="8412" y="0"></use>
 <use xlink:href="#MJMAIN-79" x="8690" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="9469" y="0"></use>
 <use xlink:href="#MJMAIN-74" x="9969" y="0"></use>
 <use xlink:href="#MJMAIN-72" x="10609" y="0"></use>
 <use xlink:href="#MJMAIN-61" x="11001" y="0"></use>
 <use xlink:href="#MJMAIN-6E" x="11502" y="0"></use>
 <use xlink:href="#MJMAIN-64" x="12058" y="0"></use>
 <use xlink:href="#MJMAIN-6F" x="12615" y="0"></use>
 <use xlink:href="#MJMAIN-6D" x="13115" y="0"></use>
 <use xlink:href="#MJMAIN-2E" x="13949" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>In other words, we sample n observations with replacement from our data points; this is our bootstrap sample. Then we will fit a new linear regression model to this sampled data and record the education coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 4028.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1448-Title">
<title id="MathJax-SVG-1448-Title">\tilde\theta_\texttt{education}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span>; this coefficient is our bootstrap statistic.</p>
<h4 id="Bootstrap-Sampling-Distribution-of-$\tilde\theta_\texttt{education}$">Bootstrap Sampling Distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 4028.1 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1449-Title">
<title id="MathJax-SVG-1449-Title">\tilde\theta_\texttt{education}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span><a class="anchor-link" href="#Bootstrap-Sampling-Distribution-of-$\tilde\theta_\texttt{education}$">¶</a></h4>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">simple_resample</span><span class="p">(</span><span class="n">n</span><span class="p">):</span> 
    <span class="k">return</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">high</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">n</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bootstrap</span><span class="p">(</span><span class="n">boot_pop</span><span class="p">,</span> <span class="n">statistic</span><span class="p">,</span> <span class="n">resample</span> <span class="o">=</span> <span class="n">simple_resample</span><span class="p">,</span> <span class="n">replicates</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">boot_pop</span><span class="p">)</span>
    <span class="n">resample_estimates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">statistic</span><span class="p">(</span><span class="n">boot_pop</span><span class="p">[</span><span class="n">resample</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">replicates</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">resample_estimates</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">educ_coeff</span><span class="p">(</span><span class="n">data_array</span><span class="p">):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">data_array</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    
    <span class="n">linear_model</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">theta_educ</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">theta_educ</span>

<span class="n">data_array</span> <span class="o">=</span> <span class="n">duncan</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">[</span><span class="s2">"prestige"</span><span class="p">,</span> <span class="s2">"income"</span><span class="p">,</span> <span class="s2">"education"</span><span class="p">]]</span><span class="o">.</span><span class="n">values</span>

<span class="n">theta_hat_sampling</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">(</span><span class="n">data_array</span><span class="p">,</span> <span class="n">educ_coeff</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">theta_hat_sampling</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">normed</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"$</span><span class="se">\\</span><span class="s2">tilde{</span><span class="se">\\</span><span class="s2">theta}_</span><span class="si">{educ}</span><span class="s2">$ Values"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"Proportion per Unit"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">"Bootstrap Sampling Distribution of $</span><span class="se">\\</span><span class="s2">tilde{</span><span class="se">\\</span><span class="s2">theta}_</span><span class="si">{educ}</span><span class="s2">$ (Nonparametric)"</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_regression_19_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notice how the sampling distribution above is slightly skewed to the left.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Estimating-the-True-Coefficients">Estimating the True Coefficients<a class="anchor-link" href="#Estimating-the-True-Coefficients">¶</a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Although we cannot directly measure <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.09ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 3913.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1450-Title">
<title id="MathJax-SVG-1450-Title">\theta^*_\texttt{education}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
<g transform="translate(469,-270)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span> we can use a bootstrap confidence interval to account for variability in the sample regression coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4028.1 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1451-Title">
<title id="MathJax-SVG-1451-Title">\widehat\theta_{\texttt{education}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span>. Below, We construct an approximate 95% confidence interval for the true coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.09ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 3913.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1452-Title">
<title id="MathJax-SVG-1452-Title">\theta^*_\texttt{education}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="453"></use>
<g transform="translate(469,-270)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span>, using the bootstrap percentile method. The confidence interval extends from the 2.5th percentile to the 97.5th percentile of the 10,000 bootstrapped coefficients.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">left_confidence_interval_endpoint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">theta_hat_sampling</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">right_confidence_interval_endpoint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">theta_hat_sampling</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">)</span>

<span class="n">left_confidence_interval_endpoint</span><span class="p">,</span> <span class="n">right_confidence_interval_endpoint</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(0.24714198882974781, 0.78293602739856061)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From the confidence interval above, we are fairly certain that the true coefficient lies between 0.236 and 0.775.</p>
<h4 id="Confidence-Interval-Using-Normal-Theory">Confidence Interval Using Normal Theory<a class="anchor-link" href="#Confidence-Interval-Using-Normal-Theory">¶</a></h4><p>We can also create confidence intervals based on normal theory. Since the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.866ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 2095.2 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1453-Title">
<title id="MathJax-SVG-1453-Title">\widehat \theta_{educ}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-64" x="466" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="990" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1562" y="0"></use>
</g>
</g>
</svg></span> values appear normally distributed, we can construct a confidence interval using by computing the following:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0" height="0.343ex" style="vertical-align: -0.171ex;" viewBox="0 -73.8 0 147.5" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1454-Title">
<title id="MathJax-SVG-1454-Title">
\begin{aligned}
[\widehat \theta - z_{\frac{\alpha}{2}}*SE(\theta^*),  \widehat \theta + z_{\frac{\alpha}{2}}*SE(\theta^*)]
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"></g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.229ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 3112.4 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1455-Title">
<title id="MathJax-SVG-1455-Title">SE(\theta^*)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2722" y="0"></use>
</g>
</svg></span> is the standard error of our bootstrapped coefficients, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 468.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1456-Title">
<title id="MathJax-SVG-1456-Title">z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
</g>
</svg></span> is a constant, and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1457-Title">
<title id="MathJax-SVG-1457-Title">\widehat \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
</g>
</svg></span> is our sample coefficient. Note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.676ex" style="vertical-align: -0.338ex;" viewBox="0 -576.1 468.5 721.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1458-Title">
<title id="MathJax-SVG-1458-Title">z</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="0" y="0"></use>
</g>
</svg></span> varies depending on the confidence level of the interval we are constructing. Since we are creating a 95% confidence interval, we will use 1.96.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># We will use the statsmodels library in order to find the standard error of the coefficients</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="n">ols</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">OLS</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
<span class="n">ols_result</span> <span class="o">=</span> <span class="n">ols</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="c1"># Now you have at your disposition several error estimates, e.g.</span>
<span class="n">ols_result</span><span class="o">.</span><span class="n">HC0_se</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>income       0.15
education    0.12
dtype: float64</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">left_confidence_interval_endpoint_normal</span> <span class="o">=</span> <span class="mf">0.55</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="mf">0.12</span><span class="p">)</span>
<span class="n">right_confidence_interval_endpoint_normal</span> <span class="o">=</span> <span class="mf">0.55</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.96</span><span class="o">*</span><span class="mf">0.12</span><span class="p">)</span>
<span class="n">left_confidence_interval_endpoint_normal</span><span class="p">,</span> <span class="n">right_confidence_interval_endpoint_normal</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(0.3148000000000001, 0.7852)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Observations: </strong>
Notice how the confidence interval using normal theory is more narrow than the confidence interval using the percentile method, especially towards the left of the interval.</p>
<p>We will not go into the normal theory confidence interval in great detail, but if you would like to learn more, refer to X.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Could-the-true-coefficient-be-0?">Could the true coefficient be 0?<a class="anchor-link" href="#Could-the-true-coefficient-be-0?">¶</a></h4><p>Although we observed a positive partial relationship between education and prestige (from the 0.55 coefficient), what if the true coefficient is actually 0 and there is no partial relationship between education and prestige? In this case, the association that we observed was just due to variability in obtaining the points that form our sample.</p>
<p>To formally test whether the partial relationship between education and prestige is real, we would like to test the following hypotheses:</p>
<p><strong>Null Hypothesis:</strong> The true partial coefficient is 0.</p>
<p><strong>Alternative Hypothesis.</strong> The true partial coefficient is not 0.</p>
<p>Since we have already contructed a 95% confidence interval for the true coefficient, we just need to see whether 0 lies within this interval. Notice that 0 does not lie within our confidence interval above; therefore, we have enough evidence to reject the null hypothesis.</p>
<p>If the confidence interval for the true coefficient did contain 0, then we would not have enough evidence to reject the null hypothesis. In this case, the observed coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4028.1 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1459-Title">
<title id="MathJax-SVG-1459-Title">\widehat\theta_{\texttt{education}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span> would likely spurious.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Method-1-Bootstrapping-Reflection">Method 1 Bootstrapping Reflection<a class="anchor-link" href="#Method-1-Bootstrapping-Reflection">¶</a></h4><p>In order to build the sampling distribution of the coefficient <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.356ex" height="3.176ex" style="vertical-align: -0.671ex;" viewBox="0 -1078.4 4028.1 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1460-Title">
<title id="MathJax-SVG-1460-Title">\widehat\theta_{\texttt{education}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="83" y="283"></use>
<g transform="translate(583,-150)">
 <use transform="scale(0.707)" xlink:href="#MJTT-65"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-64" x="525" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-75" x="1051" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-63" x="1576" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-61" x="2102" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-74" x="2627" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-69" x="3153" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6F" x="3678" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJTT-6E" x="4204" y="0"></use>
</g>
</g>
</svg></span> and contruct the confidence interval for the true coefficient, we directly resampled the observations and fitted new regression models on our bootstrap samples. This method implicitly treats the regressors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1461-Title">
<title id="MathJax-SVG-1461-Title">X_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span> as random rather than fixed.</p>
<p>In some cases, we may want to treat the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 1172.8 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1462-Title">
<title id="MathJax-SVG-1462-Title">X_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
</svg></span> as fixed (if, for example, the data were derive from an experimental
design). In the case where the explanatory variables were controlled for, or the values of the explanatory variables were set by the experimenter, then we may consider the following alternative bootstrapping method.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Alternative:-Bootstrapping-the-Residuals">Alternative: Bootstrapping the Residuals<a class="anchor-link" href="#Alternative:-Bootstrapping-the-Residuals">¶</a></h3><p>Another approach to hypothesis testing in linear regression is bootstrapping the residuals. This approach makes many underlying assumptions and used less frequently in practice. In this method, we consider the <em>residuals</em> <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.667ex" height="3.343ex" style="vertical-align: -0.671ex; margin-right: -0.019ex;" viewBox="0 -1150.1 6314.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1463-Title">
<title id="MathJax-SVG-1463-Title">e_i := y_i - X_i\widehat\beta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="659" y="-213"></use>
<g transform="translate(1088,0)">
 <use xlink:href="#MJMAIN-3A"></use>
 <use xlink:href="#MJMAIN-3D" x="278" y="0"></use>
</g>
<g transform="translate(2423,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="3480" y="0"></use>
<g transform="translate(4481,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
<g transform="translate(5653,0)">
 <use xlink:href="#MJMATHI-3B2" x="0" y="0"></use>
 <use xlink:href="#MJSZ1-2C6" x="96" y="263"></use>
</g>
</g>
</svg></span> to be our sample, so we construct the bootstrap resample by sampling with replacement from these residuals. Once we construct each bootstrap sample, we can compute new fitted values using these residuals. Then, we regress these new Y values onto the fixed X values to obtain bootstrap regression coefficients.</p>
<p>For more clarity, let's break this method down into steps:</p>
<ol>
<li><p>Estimate the regression coefficients for the original sample, and calculate
the fitted value <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.302ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 560.7 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1464-Title">
<title id="MathJax-SVG-1464-Title">\widehat y</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="60" y="21"></use>
</g>
</svg></span> and residual <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.883ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 810.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1465-Title">
<title id="MathJax-SVG-1465-Title">e_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="659" y="-213"></use>
</g>
</svg></span> for each observation.</p>
</li>
<li><p>Select bootstrap samples of the residuals; we will denote these bootstrapped residuals as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.38ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 5330.2 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1466-Title">
<title id="MathJax-SVG-1466-Title">\tilde e_1, \tilde e_2, \dots \tilde e_n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-65" x="17" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="55" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="786" y="-213"></use>
 <use xlink:href="#MJMAIN-2C" x="1010" y="0"></use>
<g transform="translate(1455,0)">
 <use xlink:href="#MJMATHI-65" x="17" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="55" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="786" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2465" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2910" y="0"></use>
<g transform="translate(4249,0)">
 <use xlink:href="#MJMATHI-65" x="17" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="55" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="786" y="-213"></use>
</g>
</g>
</svg></span>. Then, calculate bootstrapped <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.102ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 905 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1467-Title">
<title id="MathJax-SVG-1467-Title">\tilde y_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="60" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="792" y="-342"></use>
</g>
</svg></span> values by computing <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.234ex" height="2.509ex" style="vertical-align: -0.671ex;" viewBox="0 -791.3 2684 1080.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1468-Title">
<title id="MathJax-SVG-1468-Title">\widehat y + \tilde e_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="60" y="21"></use>
 <use xlink:href="#MJMAIN-2B" x="782" y="0"></use>
<g transform="translate(1783,0)">
 <use xlink:href="#MJMATHI-65" x="17" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="55" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="786" y="-213"></use>
</g>
</g>
</svg></span> where the fitted values <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.459ex" height="3.509ex" style="vertical-align: -0.838ex; margin-right: -0.019ex;" viewBox="0 -1150.1 4072.7 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1469-Title">
<title id="MathJax-SVG-1469-Title">\widehat y_i = X_i\widehat\beta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-2C6" x="60" y="21"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="792" y="-342"></use>
 <use xlink:href="#MJMAIN-3D" x="1182" y="0"></use>
<g transform="translate(2239,0)">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1171" y="-213"></use>
</g>
<g transform="translate(3411,0)">
 <use xlink:href="#MJMATHI-3B2" x="0" y="0"></use>
 <use xlink:href="#MJSZ1-2C6" x="96" y="263"></use>
</g>
</g>
</svg></span>
are obtained from the original regression.</p>
</li>
<li><p>Regress the bootstrapped <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.102ex" height="2.676ex" style="vertical-align: -0.838ex;" viewBox="0 -791.3 905 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1470-Title">
<title id="MathJax-SVG-1470-Title">\tilde y_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="60" y="337"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="792" y="-342"></use>
</g>
</svg></span> values on the fixed <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1471-Title">
<title id="MathJax-SVG-1471-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> values to obtain bootstrap regression
coefficients <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1472-Title">
<title id="MathJax-SVG-1472-Title">\tilde \theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span>.</p>
</li>
<li><p>Repeat steps two and three several times in order to obtain several bootstrap regression coefficients <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.573ex" height="3.009ex" style="vertical-align: -0.671ex;" viewBox="0 -1006.6 5413.3 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1473-Title">
<title id="MathJax-SVG-1473-Title">\tilde \theta_1, \tilde \theta_2, \dots \tilde \theta_n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="825" y="-213"></use>
 <use xlink:href="#MJMAIN-2C" x="1037" y="0"></use>
<g transform="translate(1482,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="825" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2520" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="2965" y="0"></use>
<g transform="translate(4304,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="825" y="-213"></use>
</g>
</g>
</svg></span>. These can be used to compute bootstrap standard errors and confidence intervals.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Estimating-the-True-Coefficients">Estimating the True Coefficients<a class="anchor-link" href="#Estimating-the-True-Coefficients">¶</a></h4><p>Now that we have the bootstrapped regression coefficients, we can construct a confidence interval using the same techniques as before. We will leave this as an exercise.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Bootstrapping-the-Residuals-Reflection">Bootstrapping the Residuals Reflection<a class="anchor-link" href="#Bootstrapping-the-Residuals-Reflection">¶</a></h4><p>Let's reflect on this method. By randomly reattaching resampled residuals to ﬁtted values, this 
procedure implicitly assumes that the errors are identically distributed. More specifically, this method assumes that the distribution of fluctuations around the regression curve is the same for all values of the input <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.129ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 916.8 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1474-Title">
<title id="MathJax-SVG-1474-Title">x_i</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
</svg></span>. This is a disadvantage because the true errors may have nonconstant variance; this phenomenon is called heteroscedasticity.</p>
<p>Although this method does not make any assumptions about the shape of the error distribution, it implicitly assumes that the functional form of the model is correct. By relying on the model to create each bootstrap sample, we assume that the model structure is appropriate.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>In this section, we highlight bootstrapping techniques used in a linear regression setting.</p>
<p>In general, bootstrapping the observations is more commonly used for bootstrapping. This method is often more robust than other techniques because it makes less underlying assumptions; for example, if an incorrect model is fitted, this method will still yield an appropriate sampling distribution of the parameter of interest.</p>
<p>We also highlight an alternative method, which has several disadvantages. Bootstrapping the residuals can be used when we would like the treat our observations <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.98ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 852.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1475-Title">
<title id="MathJax-SVG-1475-Title">X</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-58" x="0" y="0"></use>
</g>
</svg></span> as fixed. Note that this method should be used with caution because it makes additional assumptions about the errors and form of the model.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="k">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">'talk'</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">'precision'</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option('display.float_format', '{:.2f}'.format)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">7</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    '''</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">ncols</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="n">fixed</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span>
                 <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">-</span> <span class="n">nrows</span><span class="p">,</span> <span class="n">nrows</span><span class="p">),</span>
                 <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="n">ncols</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'ilec.csv'</span><span class="p">)[</span><span class="s1">'17.5'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-Studentized-Bootstrap">The Studentized Bootstrap<a class="anchor-link" href="#The-Studentized-Bootstrap">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <strong>bootstrap</strong> is a process we learned about in Data 8 that we can use for estimating a population statistic using only one sample. The general procedure for bootstrapping is as follows:</p>
<ul>
<li>Draw a sizable sample from the population.</li>
<li>Using this sample, we <em>resample with replacement</em> to form new samples of the same size.</li>
<li>We do this many times, taking the desired statistic of each resample (e.g. we take the median of each resample).</li>
</ul>
<p>Here, we end up with many test statistics from individual resamples, from which we can form a distribution. In Data 8, we were taught to form a 95% confidence interval by taking the 2.5th percentile and the 97.5th percentile of the bootstrap statistics. This method of bootstrapping to create a confidence interval is called the <strong>percentile bootstrap.</strong> 95% confidence implies that if we take a new sample from the population and construct a confidence interval, the confidence interval will contain the population parameter with probability 0.95. However, it is important to note that confidence intervals created from real data can only approximate 95% confidence. The percentile bootstrap in particular has lower confidence than desired at small sample sizes.</p>
<p>Below, we've taken a population and created one thousand bootstrap 95% confidence intervals for the population mean for different sample sizes. The y-axis represents the fraction of the one thousand confidence intervals that contained the real population mean. Notice that at sample sizes below 20, fewer than 90% of the confidence intervals actually contain the population mean.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="../../assets/coverage_percentile_bootstrap.png"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can measure <em>coverage error</em> by calculating the difference between our measured confidence here and our desired 95% confidence. We can see that the coverage error for percentile bootstrap is very high at small sample sizes. In this chapter, we will introduce a new bootstrap method, called the <strong>studentized bootstrap</strong> method, that has a lower coverage error but requires more computation.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Repair-Times">Repair Times<a class="anchor-link" href="#Repair-Times">¶</a></h3><p>The New York Public Utilities Commission monitors the response time for repairing land-line phone service in the state. These repair times may differ over the year and according to the type of repair. We have a census of repair times for one class of repairs at one time period for a specific <em>Incumbent Local Exchange Carrier</em>, which is a telephone company which held the regional monopoly on landline service before the market was opened to competitive local exchange carriers, or the corporate successor of such a firm. The commission is interested in estimates of the average repair time. First, let's look at a distribution of all of the times.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Distribution of Repair Times'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_9_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's say we want to estimate the population mean of the repair times. We first need to define the main statistic function needed to do this. By passing in the whole population, we can see that actual average repair time is about 8.4 hours.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">stat</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">axis</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">times</span><span class="p">)</span>
<span class="n">theta</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>8.406145520144333</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we need to define a method that will return a list of indices so we can resample from the original sample without replacement.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">take_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In real life, we won't be able to draw many samples from the population (we use bootstrap to be able to use just one sample). But for demonstration purposes, we have access to the entire population, so we will take 1000 samples of size 10 and plot the distribution of the sample means.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples_from_pop</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="n">pop_sampling_dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[</span><span class="n">stat</span><span class="p">(</span><span class="n">take_sample</span><span class="p">())</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples_from_pop</span><span class="p">)]</span>
<span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pop_sampling_dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Average Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Distribution of Sample Means ($\hat{\theta}$)'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_16_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that the center of this distribution is ~5, and that it is skewed right because of the skewed distribution of the original data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparing-Distributions-of-the-Statistic">Comparing Distributions of the Statistic<a class="anchor-link" href="#Comparing-Distributions-of-the-Statistic">¶</a></h3><p>Now we can look at how a single bootstrap distribution can stack up against a distribution sampled from the population.</p>
<p>Generally, we are aiming to estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1476-Title">
<title id="MathJax-SVG-1476-Title">\theta^*</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>, our population parameter (in this case, the average repair time of the population, which we found to be ~8.4). Each individual sample can be used to calculate an estimated statistic, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1477-Title">
<title id="MathJax-SVG-1477-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> (in this case, the average repair time of a single sample). The plot above shows what we call an <em>empirical distribution</em> of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1478-Title">
<title id="MathJax-SVG-1478-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>, which is calculated of many estimated statistics from many samples from the population. For the bootstrap, however, we want the statistic of the resample of the original sample, which is called <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1479-Title">
<title id="MathJax-SVG-1479-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span>.</p>
<p>In order for the bootstrap to work, we want our original sample to look similar to the population, so that resamples also look similar to the population. If our original sample <em>does</em> look like the population, then the distribution of average repair times calculated from the resamples will look similar to the empirical distribution of samples directly from the population.</p>
<p>Let's take a look at how an individual bootstrap distribution will look. We can define methods to take samples of size 10 without replacement and bootstrap it 1000 times to get our distribution.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bootstrap_reps</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="k">def</span> <span class="nf">resample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">reps</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">reps</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">bootstrap_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">bootstrap_reps</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">):</span>
    <span class="n">resamples</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">stat</span><span class="p">(</span><span class="n">resamples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sample</span> <span class="o">=</span> <span class="n">take_sample</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bootstrap_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Average Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Distribution of Bootstrap Sample Means ($\tilde{\theta}$)'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_20_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, our distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1480-Title">
<title id="MathJax-SVG-1480-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span> doesn't look <em>quite</em> like the distribution of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1481-Title">
<title id="MathJax-SVG-1481-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>, likely because our original sample did not look like the population. As a result, our confidence intervals perform rather poorly. Below we can see a side-by-side comparison of the two distributions:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Average Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Distribution of Sample Means ($\hat{\theta}$)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">pop_sampling_dist</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Average Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">'Distribution of Bootstrap Sample Means ($\tilde{\theta}$)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bootstrap_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="n">bins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="nb">range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_22_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-Studentized-Bootstrap-Procedure">The Studentized Bootstrap Procedure<a class="anchor-link" href="#The-Studentized-Bootstrap-Procedure">¶</a></h3><p>As we saw, the main issue with percentile bootstrap procedure is that it takes a larger sample size to really reach the desired 95% confidence. With the studentized bootstrap procedure, we can do a little more calculation to get better coverage at smaller sample sizes.</p>
<p>The idea behind the studentized bootstrap procedure is to normalize the distribution of the test statistic <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1482-Title">
<title id="MathJax-SVG-1482-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span> to be centered at 0 and have a standard deviation of 1. This will correct for the spread difference and skew of the original distribution. In order to do all of this, we need to do some derivation first.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the percentile bootstrap procedure, we generate many values of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1483-Title">
<title id="MathJax-SVG-1483-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span>, and then we take the 2.5th and 97.5th percentiles for our confidence interval. For short, we refer to these percentiles as <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.371ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1451.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1484-Title">
<title id="MathJax-SVG-1484-Title">q_{2.5}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.193ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1805.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1485-Title">
<title id="MathJax-SVG-1485-Title">q_{97.5}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span>. Note that both of these values come from the bootstrap statistics.</p>
<p>With this procedure, we hope that the probability that the actual population statistic lies between our confidence intervals is about 95%. In other words, we hope for the following equality:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.789ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 11964.7 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1486-Title">
<title id="MathJax-SVG-1486-Title">
\begin{aligned}
0.95 &amp;= {\cal P}\left(q_{2.5} \leq \theta^* \leq q_{97.5}\right)
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(1769,0)">
<g transform="translate(0,-25)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJCAL-50" x="1334" y="0"></use>
<g transform="translate(2234,0)">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
<g transform="translate(389,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="2118" y="0"></use>
<g transform="translate(3174,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2264" x="4375" y="0"></use>
<g transform="translate(5432,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-29" x="7237" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>We make two approximations during this procedure: since we assume our random sample looks like the population, we approximate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1487-Title">
<title id="MathJax-SVG-1487-Title">\theta^*</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span> with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1488-Title">
<title id="MathJax-SVG-1488-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>; since we assume a random resample looks like the original sample, we approximate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1489-Title">
<title id="MathJax-SVG-1489-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> with <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1490-Title">
<title id="MathJax-SVG-1490-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span>. Since the second approximation relies on the first one, they both introduce error in the confidence interval generation, which creates the coverage error we saw in the plot.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We aim to reduce this error by normalizing our statistic. Instead of using our calculated value of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1491-Title">
<title id="MathJax-SVG-1491-Title">\tilde\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span> directly, we use:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.028ex" height="7.176ex" style="vertical-align: -2.722ex; margin-bottom: -0.282ex;" viewBox="0 -1796 3456.3 3089.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1492-Title">
<title id="MathJax-SVG-1492-Title">
\begin{aligned}
\frac
    {\tilde{\theta} - {\hat{\theta}}}
    {SE({\tilde{\theta}})}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,16)">
<g transform="translate(120,0)">
<rect stroke="none" width="2892" height="60" x="0" y="220"></rect>
<g transform="translate(251,676)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
 <use xlink:href="#MJMAIN-2212" x="806" y="0"></use>
<g transform="translate(1806,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</g>
<g transform="translate(60,-939)">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span><p>This will normalize the resample statistic by the sample statistic, and then divide by the standard deviation of the resample statistic (this standard deviation is also called the standard error, or SE).</p>
<p>This whole normalized statistic is called the Student's t-statistic, so we call this bootstrap method the <strong>studentized bootstrap</strong> or the <strong>bootstrap-t</strong> method.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As usual, we compute this statistic for many resamples, and then take the 2.5th and 97.5th percentiles — <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.371ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1451.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1493-Title">
<title id="MathJax-SVG-1493-Title"> q_{2.5} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.193ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1805.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1494-Title">
<title id="MathJax-SVG-1494-Title"> q_{97.5} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span>. As such, we hope that the normalized population parameter lies between these percentiles:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.793ex" height="7.509ex" style="vertical-align: -3.171ex;" viewBox="0 -1867.7 14980.1 3233.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1495-Title">
<title id="MathJax-SVG-1495-Title">
\begin{aligned}
0.95 &amp;= {\cal P}\left(q_{2.5} \leq \frac{\hat{\theta} - \theta^*} {SE({\hat{\theta}})} \leq q_{97.5}\right) \\
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
<g transform="translate(1769,0)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJCAL-50" x="1334" y="0"></use>
<g transform="translate(2234,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="2521" y="0"></use>
<g transform="translate(3300,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="2892" height="60" x="0" y="220"></rect>
<g transform="translate(81,676)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-2212" x="806" y="0"></use>
<g transform="translate(1806,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</g>
<g transform="translate(60,-999)">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="6988" y="0"></use>
<g transform="translate(8044,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="9849" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can now solve the inequality for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.145ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 923.4 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1496-Title">
<title id="MathJax-SVG-1496-Title">\theta^*</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</svg></span>:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.028ex" height="17.176ex" style="vertical-align: -8.005ex;" viewBox="0 -3948.7 21539.8 7395.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1497-Title">
<title id="MathJax-SVG-1497-Title">
\begin{aligned}
0.95 &amp;= {\cal P}\left(q_{2.5} \leq \frac{\hat{\theta} - \theta^*} {SE({\hat{\theta}})} \leq q_{97.5}\right) \\
 &amp;= {\cal P}\left(q_{2.5}SE({\hat{\theta}}) \leq {\hat{\theta} - \theta^*} \leq q_{97.5}SE({\hat{\theta}})\right) \\
 &amp;= {\cal P}\left(\hat{\theta} - q_{97.5}SE({\hat{\theta}}) \leq {\theta^*} \leq \hat{\theta} - q_{2.5}SE({\hat{\theta}})\right) 
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,2101)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
<g transform="translate(1769,0)">
<g transform="translate(0,2101)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJCAL-50" x="1334" y="0"></use>
<g transform="translate(2234,0)">
 <use xlink:href="#MJSZ4-28"></use>
<g transform="translate(792,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="2521" y="0"></use>
<g transform="translate(3300,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="2892" height="60" x="0" y="220"></rect>
<g transform="translate(81,676)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-2212" x="806" y="0"></use>
<g transform="translate(1806,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="513"></use>
</g>
</g>
<g transform="translate(60,-999)">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="6988" y="0"></use>
<g transform="translate(8044,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJSZ4-29" x="9849" y="0"></use>
</g>
</g>
<g transform="translate(0,-601)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJCAL-50" x="1334" y="0"></use>
<g transform="translate(2234,0)">
 <use xlink:href="#MJSZ2-28"></use>
<g transform="translate(597,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="2048" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="2694" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="3458" y="0"></use>
<g transform="translate(3848,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="4432" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="5099" y="0"></use>
<g transform="translate(6155,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
 <use xlink:href="#MJMAIN-2212" x="806" y="0"></use>
<g transform="translate(1806,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="583"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-2264" x="9163" y="0"></use>
<g transform="translate(10219,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="12024" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="12670" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="13434" y="0"></use>
<g transform="translate(13824,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="14408" y="0"></use>
 <use xlink:href="#MJSZ2-29" x="14797" y="-1"></use>
</g>
</g>
<g transform="translate(0,-2702)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJCAL-50" x="1334" y="0"></use>
<g transform="translate(2234,0)">
 <use xlink:href="#MJSZ2-28"></use>
<g transform="translate(597,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1403" y="0"></use>
<g transform="translate(2404,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="4209" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="4854" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5619" y="0"></use>
<g transform="translate(6008,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6592" y="0"></use>
 <use xlink:href="#MJMAIN-2264" x="7259" y="0"></use>
<g transform="translate(8316,0)">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2217" x="663" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-2264" x="9517" y="0"></use>
<g transform="translate(10573,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="11379" y="0"></use>
<g transform="translate(12380,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="13831" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="14477" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="15241" y="0"></use>
<g transform="translate(15631,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="16215" y="0"></use>
 <use xlink:href="#MJSZ2-29" x="16604" y="-1"></use>
</g>
</g>
</g>
</g>
</g>
</svg></span>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This means we can construct our confidence interval using just <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1498-Title">
<title id="MathJax-SVG-1498-Title">\hat\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span> (the test statistic on the original sample), <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.371ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1451.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1499-Title">
<title id="MathJax-SVG-1499-Title">q_{2.5}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.193ex" height="2.009ex" style="vertical-align: -0.671ex;" viewBox="0 -576.1 1805.2 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1500-Title">
<title id="MathJax-SVG-1500-Title">q_{97.5}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
</svg></span> (the percentiles of the normalized statistic computed with the resamples), and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 2772.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1501-Title">
<title id="MathJax-SVG-1501-Title">SE(\hat\theta)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span> (the standard deviation of the sample test statistic). This last value is estimated by using the standard deviation of the resample test statistics.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Thus, to compute a studentized bootstrap CI, we perform the following procedure:</p>
<ol>
<li>Compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 583.8 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1502-Title">
<title id="MathJax-SVG-1502-Title"> \hat{\theta} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
</svg></span>, the test statistic on the sample.</li>
<li>Bootstrap the sample a large number of times.</li>
<li>For each bootstrap resample:<ol>
<li>Compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1503-Title">
<title id="MathJax-SVG-1503-Title"> \tilde \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span>, the test statistic on the resample.</li>
<li>Compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 2772.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1504-Title">
<title id="MathJax-SVG-1504-Title"> SE({\tilde{\theta}}) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span>.</li>
<li>Compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.615ex" height="5.343ex" style="vertical-align: -2.171ex;" viewBox="0 -1365.4 4139.6 2300.3" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1505-Title">
<title id="MathJax-SVG-1505-Title"> q =  \frac{\tilde{\theta} - {\hat{\theta}}}{SE({\tilde{\theta}})} </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="738" y="0"></use>
<g transform="translate(1516,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="2105" height="60" x="0" y="220"></rect>
<g transform="translate(340,503)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-7E" x="117" y="644"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2212" x="618" y="0"></use>
<g transform="translate(987,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-5E" x="117" y="328"></use>
</g>
</g>
<g transform="translate(60,-626)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1272,0)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-7E" x="117" y="644"></use>
</g>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2417" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>.</li>
</ol>
</li>
<li>Estimate <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 2772.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1506-Title">
<title id="MathJax-SVG-1506-Title"> SE(\hat \theta) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span> using the standard deviation of the <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 583.8 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1507-Title">
<title id="MathJax-SVG-1507-Title"> \tilde \theta </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
</svg></span> values.</li>
<li>Calculate the confidence intervals thusly: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.065ex" height="4.843ex" style="vertical-align: -1.838ex;" viewBox="0 -1293.7 13805.6 2085" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1508-Title">
<title id="MathJax-SVG-1508-Title"> \left[ \hat{\theta} - q_{97.5}SE({\hat{\theta}}), \hat{\theta} - q_{2.5}SE({\hat{\theta}}) \right]</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ2-5B"></use>
<g transform="translate(472,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="1278" y="0"></use>
<g transform="translate(2279,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-37" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="1001" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="1279" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="4084" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="4729" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="5494" y="0"></use>
<g transform="translate(5883,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="6467" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="6857" y="0"></use>
<g transform="translate(7302,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="8108" y="0"></use>
<g transform="translate(9109,0)">
 <use xlink:href="#MJMATHI-71" x="0" y="0"></use>
<g transform="translate(446,-150)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMATHI-53" x="10560" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="11205" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="11970" y="0"></use>
<g transform="translate(12359,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="12943" y="0"></use>
 <use xlink:href="#MJSZ2-5D" x="13333" y="-1"></use>
</g>
</svg></span>.</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Computing-the-Standard-Error-of-the-Resample-Statistic">Computing the Standard Error of the Resample Statistic<a class="anchor-link" href="#Computing-the-Standard-Error-of-the-Resample-Statistic">¶</a></h3><p>It is important to note that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 2772.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1509-Title">
<title id="MathJax-SVG-1509-Title">SE(\hat\theta)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span>, the standard error of the resample test statistic, is not always easy to compute and is dependent on the test statistic. For the sample mean, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.73ex" height="4.343ex" style="vertical-align: -1.838ex;" viewBox="0 -1078.4 5480.8 1869.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1510-Title">
<title id="MathJax-SVG-1510-Title">SE(\tilde\theta)=\frac{\tilde\sigma}{\sqrt{n}}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="3050" y="0"></use>
<g transform="translate(3829,0)">
<g transform="translate(397,0)">
<rect stroke="none" width="1133" height="60" x="0" y="220"></rect>
<g transform="translate(364,453)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-3C3" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-7E" x="36" y="370"></use>
</g>
<g transform="translate(60,-483)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-221A" x="0" y="-101"></use>
<rect stroke="none" width="424" height="42" x="589" y="453"></rect>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="833" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span>, the standard deviation of the resample values divided by the square root of the sample size.</p>
<p>Also remember that we have to use the resample values to compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 2772.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1511-Title">
<title id="MathJax-SVG-1511-Title"> SE(\tilde \theta) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span>; we use the sample values to compute <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.343ex" style="vertical-align: -0.838ex;" viewBox="0 -1078.4 2772.8 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1512-Title">
<title id="MathJax-SVG-1512-Title"> SE(\hat \theta) </title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-5E" x="83" y="283"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If our test statistic, however, does not have an analytic expression (like the one we have for the sample mean), then we need to do a second-level bootstrap. For each resample, we bootstrap it again, and compute the test statistic on each second-level resample (the resampled resample), and compute the standard deviation using these second-level statistics. Typically, we do around 50 second-level resamples.</p>
<p>This greatly increases computation time for the studentized bootstrap procedure. If we do 50 second-level resamples, the entire procedure will take 50 times as long as if we just had an analytic expression for <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 2772.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1513-Title">
<title id="MathJax-SVG-1513-Title">SE(\tilde\theta)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Comparison-of-Studentized-Bootstrap-with-Percentile-Bootstrap">Comparison of Studentized Bootstrap with Percentile Bootstrap<a class="anchor-link" href="#Comparison-of-Studentized-Bootstrap-with-Percentile-Bootstrap">¶</a></h3><p>To assess the tradeoffs of studentized and percentile bootstrap, let's compare the coverage of the two methods using the repair times dataset.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Repair Time'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Proportion per Hour'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Distribution of Repair Times'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_34_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will take many samples from the population, compute a percentile confidence interval and a studentized confidence interval for each sample, and then compute the coverage for each. We will repeat this for varying sample sizes to see how the coverage of each method changes with sample size.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can use <code>np.percentile</code> to compute the percentile confidence interval below:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">percentile_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">bootstrap_reps</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">):</span>
    <span class="n">stats</span> <span class="o">=</span> <span class="n">bootstrap_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">stat</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">take_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">percentile_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>array([ 4.54, 29.56])</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>To do the studentized bootstrap, we need a lot more code:</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">studentized_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">bootstrap_reps</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Computes studentized test statistics for the provided sample.</span>
<span class="sd">    </span>
<span class="sd">    Returns the studentized test statistics and the SD of the</span>
<span class="sd">    resample test statistics.</span>
<span class="sd">    '''</span>
    <span class="c1"># Bootstrap the sample and compute \tilde \theta values</span>
    <span class="n">resamples</span> <span class="o">=</span> <span class="n">resample</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="p">)</span>
    <span class="n">resample_stats</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">resamples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">resample_sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">resample_stats</span><span class="p">)</span>
    
    <span class="c1"># Compute SE of \tilde \theta.</span>
    <span class="c1"># Since we're estimating the sample mean, we can use the formula.</span>
    <span class="c1"># Without the formula, we would have to do a second level bootstrap here.</span>
    <span class="n">resample_std_errs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">resamples</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>
    
    <span class="c1"># Compute studentized test statistics (q values)</span>
    <span class="n">sample_stat</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="n">t_statistics</span> <span class="o">=</span> <span class="p">(</span><span class="n">resample_stats</span> <span class="o">-</span> <span class="n">sample_stat</span><span class="p">)</span> <span class="o">/</span> <span class="n">resample_std_errs</span>
    <span class="k">return</span> <span class="n">t_statistics</span><span class="p">,</span> <span class="n">resample_sd</span>
 
<span class="k">def</span> <span class="nf">studentized_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="o">=</span><span class="n">bootstrap_reps</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="n">stat</span><span class="p">):</span>
    <span class="sd">'''</span>
<span class="sd">    Computes 95% studentized bootstrap CI</span>
<span class="sd">    '''</span>
    <span class="n">t_statistics</span><span class="p">,</span> <span class="n">resample_sd</span> <span class="o">=</span> <span class="n">studentized_stats</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">reps</span><span class="p">,</span> <span class="n">stat</span><span class="p">)</span>
    <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">t_statistics</span><span class="p">,</span> <span class="p">[</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">97.5</span><span class="p">])</span>
    
    <span class="n">sample_stat</span> <span class="o">=</span> <span class="n">stat</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">sample_stat</span> <span class="o">-</span> <span class="n">resample_sd</span> <span class="o">*</span> <span class="n">upper</span><span class="p">,</span>
            <span class="n">sample_stat</span> <span class="o">-</span> <span class="n">resample_sd</span> <span class="o">*</span> <span class="n">lower</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">take_sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">studentized_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>(4.499166906400612, 59.03291210887363)</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that everything is written out, we can compare the coverages of the two methods as the sample size increases from 4 to 100.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">coverage</span><span class="p">(</span><span class="n">cis</span><span class="p">,</span> <span class="n">parameter</span><span class="o">=</span><span class="n">theta</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">([</span><span class="n">lower</span> <span class="o">&lt;</span> <span class="n">parameter</span> <span class="o">&lt;</span> <span class="n">upper</span> <span class="k">for</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="ow">in</span> <span class="n">cis</span><span class="p">])</span>
        <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">cis</span><span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">run_trials</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">):</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">percentile_coverages</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">studentized_coverages</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">sample_sizes</span><span class="p">:</span>
        <span class="n">samples</span> <span class="o">=</span> <span class="p">[</span><span class="n">take_sample</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">samples_from_pop</span><span class="p">)]</span>
        <span class="n">percentile_cis</span> <span class="o">=</span> <span class="p">[</span><span class="n">percentile_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]</span>
        <span class="n">studentized_cis</span> <span class="o">=</span> <span class="p">[</span><span class="n">studentized_ci</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span> <span class="k">for</span> <span class="n">sample</span> <span class="ow">in</span> <span class="n">samples</span><span class="p">]</span>
        
        <span class="n">percentile_coverages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coverage</span><span class="p">(</span><span class="n">percentile_cis</span><span class="p">))</span>
        <span class="n">studentized_coverages</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">coverage</span><span class="p">(</span><span class="n">studentized_cis</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">'percentile'</span><span class="p">:</span> <span class="n">percentile_coverages</span><span class="p">,</span>
        <span class="s1">'studentized'</span><span class="p">:</span> <span class="n">studentized_coverages</span><span class="p">,</span>
    <span class="p">},</span> <span class="n">index</span><span class="o">=</span><span class="n">sample_sizes</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">time</span>

trials = run_trials(np.arange(4, 101, 2))
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>CPU times: user 1min 52s, sys: 1.08 s, total: 1min 53s
Wall time: 1min 57s
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trials</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'red'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'95</span><span class="si">% c</span><span class="s1">overage'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Sample Size'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Coverage'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Coverage vs. Sample Size for Studentized and Percentile Bootstraps'</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_studentized_46_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, the studentized bootstrap has a much better coverage at smaller sample sizes.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Summary">Summary<a class="anchor-link" href="#Summary">¶</a></h2><p>The studentized bootstrap for the most part is better than the percentile bootstrap, especially if we only have a small sample to start with. We generally want to use this method when the sample size is small or when the original data is skewed. The main drawback is its computation time, which is further magnified if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.44ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 2772.8 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1514-Title">
<title id="MathJax-SVG-1514-Title">SE(\tilde\theta)</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-53" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-45" x="645" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1410" y="0"></use>
<g transform="translate(1799,0)">
 <use xlink:href="#MJMATHI-3B8" x="15" y="0"></use>
 <use xlink:href="#MJMAIN-7E" x="83" y="599"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="2383" y="0"></use>
</g>
</svg></span> is not easy to compute.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/18'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stat</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">'ignore'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="P-hacking">P-hacking<a class="anchor-link" href="#P-hacking">¶</a></h1><p>As we discussed, a p-value or probability value is the chance, based on the model in the null hypothesis, that the test statistic is equal to the value that was observed in the data or is even further in the direction of the alternative. If a p-value is small, that means the tail beyond the observed statistic is small and so the observed statistic is far away from what the null predicts. This implies that the data support the alternative hypothesis better than they support the null. By convention, when we see that the p-value is below 0.05, the result is called statistically significant, and we reject the null hypothesis.</p>
<p>There are dangers that present itself when the p-value is misused. <em>P-hacking</em> is the act of misusing data analysis to show that patterns in data are statistically significant, when in reality they are not. This is often done by performing multiple tests on data and only focusing on the tests that return results that are significant.</p>
<p>In this section, we will go over a few examples of the dangers of p-values and p-hacking.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Multiple-Hypothesis-Testing">Multiple Hypothesis Testing<a class="anchor-link" href="#Multiple-Hypothesis-Testing">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>One of the biggest dangers of blindly relying on the p-value to determine "statistical significance" comes when we are just trying to find the "sexiest" results that give us "good" p-values. This is commonly done when doing "food frequency questionairres," or FFQs, to study eating habits' correlation with other characteristics (diseases, weight, religion, etc). 
FiveThirtyEight, an online blog that focuses on opinion poll analysis among other things, made their own FFQ, and we can use their data to run our own analysis to find some silly results that can be considered "statistically significant."</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'raw_anonymized_data.csv'</span><span class="p">)</span>
<span class="c1"># Do some EDA on the data so that categorical values get changed to 1s and 0s</span>
<span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Yes'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Innie'</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'No'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'Outie'</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># These are some of the columns that give us characteristics of FFQ-takers</span>
<span class="n">characteristics</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'cat'</span><span class="p">,</span> <span class="s1">'dog'</span><span class="p">,</span> <span class="s1">'right_hand'</span><span class="p">,</span> <span class="s1">'left_hand'</span><span class="p">]</span>

<span class="c1"># These are some of the columns that give us the quantities/frequencies of different food the FFQ-takers ate</span>
<span class="n">ffq</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'EGGROLLQUAN'</span><span class="p">,</span> <span class="s1">'SHELLFISHQUAN'</span><span class="p">,</span> <span class="s1">'COFFEEDRINKSFREQ'</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We will look specifically whether people own cats, dogs, or what handedness they are.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">characteristics</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>cat</th>
<th>dog</th>
<th>right_hand</th>
<th>left_hand</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>1</th>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>2</th>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>3</th>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<th>4</th>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Additionally, we will look at how much shellfish, eggrolls, and coffee people consumed.</p>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="n">ffq</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>EGGROLLQUAN</th>
<th>SHELLFISHQUAN</th>
<th>COFFEEDRINKSFREQ</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td>1</td>
<td>3</td>
<td>2</td>
</tr>
<tr>
<th>1</th>
<td>1</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<th>2</th>
<td>2</td>
<td>3</td>
<td>3</td>
</tr>
<tr>
<th>3</th>
<td>3</td>
<td>2</td>
<td>1</td>
</tr>
<tr>
<th>4</th>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So now we can calculate the p-value for every pair of characteristic and food frequency/quantity features.</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="k">def</span> <span class="nf">findpvalue</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">stat</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">data</span><span class="p">[</span><span class="n">f</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Calculate the p value between every characteristic and food frequency/quantity pair</span>
<span class="n">pvalues</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">characteristics</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">ffq</span><span class="p">:</span>
        <span class="n">pvalues</span><span class="p">[(</span><span class="n">c</span><span class="p">,</span><span class="n">f</span><span class="p">)]</span> <span class="o">=</span> <span class="n">findpvalue</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
<span class="n">pvalues</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_text output_subarea output_execute_result">
<pre>{('cat', 'EGGROLLQUAN'): 0.69295273146288583,
 ('cat', 'SHELLFISHQUAN'): 0.39907214094767007,
 ('cat', 'COFFEEDRINKSFREQ'): 0.0016303467897390215,
 ('dog', 'EGGROLLQUAN'): 2.8476184473490123e-05,
 ('dog', 'SHELLFISHQUAN'): 0.14713568495622972,
 ('dog', 'COFFEEDRINKSFREQ'): 0.3507350497291003,
 ('right_hand', 'EGGROLLQUAN'): 0.20123440208411372,
 ('right_hand', 'SHELLFISHQUAN'): 0.00020312599063263847,
 ('right_hand', 'COFFEEDRINKSFREQ'): 0.48693234457564749,
 ('left_hand', 'EGGROLLQUAN'): 0.75803051153936374,
 ('left_hand', 'SHELLFISHQUAN'): 0.00035282554635466211,
 ('left_hand', 'COFFEEDRINKSFREQ'): 0.1692235856830212}</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our study finds that:</p>
<table>
<thead><tr>
<th>Eating/Drinking</th>
<th>is linked to:</th>
<th>P-value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Egg rolls</td>
<td>Dog ownership</td>
<td>&lt;0.0001</td>
</tr>
<tr>
<td>Shellfish</td>
<td>Right-handedness</td>
<td>0.0002</td>
</tr>
<tr>
<td>Shellfish</td>
<td>Left-handedness</td>
<td>0.0004</td>
</tr>
<tr>
<td>Coffee</td>
<td>Cat ownership</td>
<td>0.0016</td>
</tr>
</tbody>
</table>
<p>Clearly this is flawed! Aside from the fact that some of these correlations seem to make no sense, we also found that shellfish is linked to both right and left handedness! Because we blindly tested all columns against each other for statistical significance, we were able to just choose whatever pairs gave us "statistically significant" results. This shows the dangers of blindly following the p-value without a care for proper experimental design.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A/B-Testing">A/B Testing<a class="anchor-link" href="#A/B-Testing">¶</a></h2><p>A/B testing is a very simple concept. We measure a statistic in a normal, controlled environment (we'll call this A), and then we compare that to the same statistic in an environment with <em>one</em> change. This form of testing is used frequently in marketing and ad research to compare the effectiveness of certain features of ads.</p>
<p>Let's say we are working for a company whose website lets users make their own custom videogames. The company has a free version, which lets users make very basic videogames, and a paid version, which gives users access to more advanced tools for making videogames. When a user has finished making a videogame via a free account, we send them to a landing page that gives them the option to sign up for a paid account. Our measured statistic in this case would be how many free users sign up for a paid account upon reaching this page. We can send half of our users one version of the page, which may have text explaining in detail the benefits of the paid account (this will be version A), and the other half of our users will get another version of the page, which may have a colorful graphic that explains some of the benefits of the paid account (this will be version B).</p>
<p>There is a very specific reason why it's called A/B testing, and not A/B/C/D... testing. That is because we can very easily run into problems if we try to test multiple versions at the same time.</p>
<p>Let's say that we have 15 different sign up pages (one is the control, in this case "A"), each with something different about them (one has a picture of a puppy, one has a quote from a customer, one has a graphic, etc.), and let's say that in this case, none of our variations actually has an effect on user interaction (so we can use a Gaussian distribution with a mean of 0 and a std of 0.1).</p>
</div>
</div>
</div>
<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_pages</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">permute</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">combined</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="n">shuffled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">combined</span><span class="p">),</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shuffled</span><span class="p">[:</span><span class="n">n</span><span class="p">],</span> <span class="n">shuffled</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span>

<span class="k">def</span> <span class="nf">permutedpvalue</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">test_stat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="n">resampled</span> <span class="o">=</span> <span class="p">[</span><span class="n">test_stat</span><span class="p">(</span><span class="o">*</span><span class="n">permute</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">reps</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">obs</span> <span class="o">&gt;=</span> <span class="n">resampled</span><span class="p">)</span> <span class="o">/</span> <span class="n">reps</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">reps</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_pages</span> <span class="o">=</span> <span class="mi">15</span>
<span class="c1"># This will represent percentage of users that make a paid account from the landing page</span>
<span class="c1"># Note that all pages have no effect, so they all just have a base 10% of interactions.</span>
<span class="n">landing_pages</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_pages</span><span class="p">)]</span>

<span class="c1"># This will be our "control"</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">landing_pages</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Our test statistic will be the difference between the mean percentage </span>
<span class="k">def</span> <span class="nf">test_stat</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">B</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>

<span class="n">p_vals</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_pages</span><span class="p">):</span>
    <span class="c1"># We test against each of the non-control landing pages</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">landing_pages</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p_val</span> <span class="o">=</span> <span class="n">permutedpvalue</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
    <span class="n">p_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_val</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">p_vals</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.732, 0.668, 0.037, 0.245, 0.717, 0.256, 0.683, 0.654, 0.43, 0.503, 0.897, 0.868, 0.328, 0.044]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class=" cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">distplot</span><span class="p">(</span><span class="n">p_vals</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="output_png output_subarea ">
<img src="/notebooks-images/hyp_phacking_17_0.png">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, more than one of these ads seems to have p-values less than 0.05, despite our knowing that there actually no difference between the pages. This is why we do single A/B testing with multiple trials, as opposed to multiple hypothesis testing with only single trials. It is too easy for a p-value to give us a false positive if we just try a bunch of times.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Many-Tests-for-One-Phenomenon">Many Tests for One Phenomenon<a class="anchor-link" href="#Many-Tests-for-One-Phenomenon">¶</a></h2><p>Sometimes, multiple testing can happen by accident. If many researchers are investigating the same phenomenon at the same time, then it's very possible that one of the researchers can end up with a lucky trial. That is exactly what happened during the 2010 World Cup.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Paul-the-Octopus">Paul the Octopus<a class="anchor-link" href="#Paul-the-Octopus">¶</a></h3><p>Paul the Octopus was a common octopus who lived in a Sea Life Centre in Oberhausen, Germany. He is most well known for correctly guessing all seven soccer matches Germany played during the 2010 World Cup, as well as the final match, which was between Netherlands and Spain.</p>
<p>Before a match was played, Paul's owners would place two boxes in his tank containing food, each box labeled with a different flag of the opposing countries. Whichever box Paul chose to eat from first was considered his prediction for the outcome of the match.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://news.bbcimg.co.uk/media/images/49659000/jpg/_49659323_octopus.jpg" width="400"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So why was Paul so good at predicting the outcome of these matches? Was he actually psychic, or was he just lucky? We might ask what’s the chance he got all of the predictions correct, assuming he was just “guessing”?</p>
<p>Paul correctly predicted 8 of the 2010 World Cup games, each time he had a 1/2 chance of making the correct prediction. The one way to get all 8 matches correct out of 8 is:
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.262ex" height="3.176ex" style="vertical-align: -0.838ex;" viewBox="0 -1006.6 6571 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1515-Title">
<title id="MathJax-SVG-1515-Title">(1/2)^8 = 1/256</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-28" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="389" y="0"></use>
 <use xlink:href="#MJMAIN-2F" x="890" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="1390" y="0"></use>
<g transform="translate(1891,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="550" y="583"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="3012" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="4068" y="0"></use>
 <use xlink:href="#MJMAIN-2F" x="4568" y="0"></use>
<g transform="translate(5069,0)">
 <use xlink:href="#MJMAIN-32"></use>
 <use xlink:href="#MJMAIN-35" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-36" x="1001" y="0"></use>
</g>
</g>
</svg></span></p>
<p>So was he actually psychic? Or is there something more to uncover?</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Turns out, there were tons of animals (some of them in the same zoo as Paul!) doing the same thing, trying to guess the outcome of their respective home countries' matches, including:</p>
<ul>
<li>Mani the Parakeet, from Singapore</li>
<li>Leon the Porcupine, from Germany</li>
<li>Petty the Pygmy Hippopotamus, from Germany</li>
<li>Otto Armstrong the Octopus, from Germany</li>
<li>Anton the Tamarin, from Germany</li>
<li>Jimmy the Peruvian Guinea Pig, from Germany</li>
<li>Xiaoge the Octopus, from China</li>
<li>Pauline the Octopus, from the Netherlands</li>
<li>Pino the Chimpanzee, from Estonia</li>
<li>Apelsin the Red River Hog, from Estonia</li>
<li>Harry the Crocodile, from Australia
None of whom got them all right (although Mani the Parakeet got 7 matches out of 8 right).</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Some might argue that getting them all wrong would also be remarkable. So what are the chances that at least one of the 12 animals would get either all right or all wrong?</p>
<p>We can use simple probability to figure this out. We have 12 trials (in this case, animals), where each independent trial has a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.619ex" height="3.009ex" style="vertical-align: -0.838ex;" viewBox="0 -934.9 8016.4 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1516-Title">
<title id="MathJax-SVG-1516-Title">2*(1/2)^8 = 1/128</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2217" x="722" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1445" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1834" y="0"></use>
 <use xlink:href="#MJMAIN-2F" x="2335" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="2835" y="0"></use>
<g transform="translate(3336,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="550" y="513"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="4457" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="5513" y="0"></use>
 <use xlink:href="#MJMAIN-2F" x="6014" y="0"></use>
<g transform="translate(6514,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
</g>
</svg></span> chance of getting all predictions right or wrong. So what is the probability of having <em>at least</em> one success? That's <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="53.926ex" height="3.176ex" style="vertical-align: -1.005ex;" viewBox="0 -934.9 23217.9 1367.4" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1517-Title">
<title id="MathJax-SVG-1517-Title">1 - P_{all \textrm{ }failures} = 1 - (127/128)^{12} = 1 - 0.910 = 0.090</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="722" y="0"></use>
<g transform="translate(1723,0)">
 <use xlink:href="#MJMATHI-50" x="0" y="0"></use>
<g transform="translate(642,-155)">
 <use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="529" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="828" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-66" x="1480" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="2030" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="2560" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2905" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="3204" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-72" x="3776" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="4228" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-73" x="4694" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="6395" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="7451" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="8174" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="9174" y="0"></use>
<g transform="translate(9564,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-37" x="1001" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-2F" x="11065" y="0"></use>
<g transform="translate(11566,0)">
 <use xlink:href="#MJMAIN-31"></use>
 <use xlink:href="#MJMAIN-32" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-38" x="1001" y="0"></use>
</g>
<g transform="translate(13067,0)">
 <use xlink:href="#MJMAIN-29" x="0" y="0"></use>
<g transform="translate(389,362)">
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use>
</g>
</g>
 <use xlink:href="#MJMAIN-3D" x="14543" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="15599" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="16322" y="0"></use>
<g transform="translate(17322,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="19881" y="0"></use>
<g transform="translate(20937,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="779" y="0"></use>
 <use xlink:href="#MJMAIN-39" x="1279" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="1780" y="0"></use>
</g>
</g>
</svg></span></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have an 9% chance of getting an animal that will select all of the right predictions, and that's not including all of the animals in the world that were also doing these "predictions." That's not that rare - it's the dangers of multiple testing that caused this "phenomenon." This one octopus out of many different animals in the world happened to have guessed all of the right predictions, and the popularity of the situation caused it to become magical.</p>
<p>To those of you wondering if it really was luck, it has been shown that the species <em>Octopus vulgaris</em> is actually colorblind, and some believe that octopuses are drawn to horizontal shapes, hence Paul's decision to choose Germany, except when playing against Spain and Serbia.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In the end, we know that studies are more trustworthy when they are replicated. Data scientists should try to avoid cases like Paul the Octopus's where there has only been one real case of the animal correctly predicting a bunch of World Cup matches in a row. Only when we see him doing that for multiple soccer tournaments should we start looking at the data.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="P-Hacking-is-just-the-tip-of-the-iceberg">P-Hacking is just the tip of the iceberg<a class="anchor-link" href="#P-Hacking-is-just-the-tip-of-the-iceberg">¶</a></h2><p>As it turns out, p-hacking isn't the only thing data scientists and statisticians have to worry about when making sound inferences from data. There are many stages to the design and analysis of a successful study, as shown below (from Leek &amp; Peng's <em>P values are just the tip of the iceberg</em>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://www.nature.com/polopoly_fs/7.25671.1429983882!/image/P1.jpg_gen/derivatives/landscape_300/P1.jpg"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As shown, the last step of the whole "data pipeline" is the calculation of an inferential statistic like the p-value, and having a rule applied to it (e.g. p &gt; 0.05). But there are many other decisions that are made beforehand, like experimental design or EDA, that can have much greater effects on the results - mistakes like simple rounding or measurement errors, choosing the wrong model, or not taking into account confounding factors can change everything. By changing the way data are cleaned, summarized, or modeled, we can achieve arbitrary levels of statistical significance.</p>
<p>A simple example of this would be in the case of rolling a pair of dice and getting two 6s. If we were to take a null hypothesis that the dice are fair and not weighted, and take our test statistic to be the sum of the dice, we will find that the p-value of this outcome will be 1/36 or 0.028, and gives us statistically signficant results that the dice are fair. But obviously, a single roll is not nearly enough rolls to provide us with good evidence to say whether the results are statistically significant or not, and shows that blindly applying the p-value without properly designing a good experiment can result in bad results.</p>
<p>In the end, what is most important is education on the subject of safe hypothesis testing, and making sure you don't fall into the follies of poor statistical decisions.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/19'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Vector-Space-Review">Vector Space Review<a class="anchor-link" href="#Vector-Space-Review">¶</a></h1><ul>
<li><a href="#Definition-of-a-vector">Definition of a vector</a></li>
<li><a href="#Scaling-and-adding-vectors">Scaling and adding vectors</a></li>
<li><a href="#Vector-notations">Vector notations</a></li>
<li><a href="#The-$\vec{1}$-vector">The <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 500.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1518-Title">
<title id="MathJax-SVG-1518-Title">\vec{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="485" y="259"></use>
</g>
</svg></span> vector</a></li>
</ul>
<ul>
<li><a href="#Span-of-a-set-of-vectors">Span of a set of vectors</a></li>
<li><a href="#Vector-spaces">Vector spaces</a></li>
<li><a href="#Vector-subspaces">Vector subspaces</a></li>
</ul>
<ul>
<li><a href="#Angles-between-vectors">Angles between vectors</a></li>
<li><a href="#Vector-lengths">Vector lengths</a></li>
<li><a href="#Distance-between-two-vectors">Distance between two vectors</a></li>
<li><a href="#Orthogonal-vectors">Orthogonal vectors</a></li>
<li><a href="#Projections-of-vectors">Projections of vectors</a></li>
</ul>
<h3 id="Definition-of-a-vector">Definition of a vector<a class="anchor-link" href="#Definition-of-a-vector">¶</a></h3><p>A vector is defined by a length and a direction.</p>
<p><img src="../../notebooks-images/vector_space_review__vectors.png" width="500"></p>
<p>Notice that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1519-Title">
<title id="MathJax-SVG-1519-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1520-Title">
<title id="MathJax-SVG-1520-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span> have the same length and direction. They are equal vectors.</p>
<h3 id="Scaling-and-adding-vectors">Scaling and adding vectors<a class="anchor-link" href="#Scaling-and-adding-vectors">¶</a></h3><p>To scale a vector is to change it's length.</p>
<p><img src="../../notebooks-images/vector_space_review__scaling.png" width="500"></p>
<p>Notice that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.492ex" height="3.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1437.2 1073 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1521-Title">
<title id="MathJax-SVG-1521-Title">\vec{2x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2192" x="36" y="786"></use>
</g>
</svg></span> and <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1522-Title">
<title id="MathJax-SVG-1522-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span> have the direction but different lengths. They are not equal.</p>
<p>To add two vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.333ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 2295.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1523-Title">
<title id="MathJax-SVG-1523-Title">\vec{y} + \vec{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
 <use xlink:href="#MJMAIN-2B" x="766" y="0"></use>
<g transform="translate(1767,0)">
 <use xlink:href="#MJMATHI-7A" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="528" y="35"></use>
</g>
</g>
</svg></span>, take one step according to the length of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1524-Title">
<title id="MathJax-SVG-1524-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span>, then immediately take one step according to the length of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.228ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 528.6 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1525-Title">
<title id="MathJax-SVG-1525-Title">\vec{z}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-7A" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="528" y="35"></use>
</g>
</svg></span> (or vice versa). This is also known as triangle method, where you place the initial point of a vector on the terminal point of the other.</p>
<p><img src="../../notebooks-images/vector_space_review__adding.png" width="300"></p>
<h3 id="Vector-notations">Vector notations<a class="anchor-link" href="#Vector-notations">¶</a></h3><p>Vectors are usually represented as Cartesian Coordinates.</p>
<p><img src="../../notebooks-images/vector_space_review__notation.png" width="500"></p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.711ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 14514.5 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1526-Title">
<title id="MathJax-SVG-1526-Title"> \vec{x} = \begin{bmatrix} 1 \\ 4  \end{bmatrix} , \quad 
   \vec{y} = \begin{bmatrix} 3 \\ 2  \end{bmatrix} , \quad 
   \vec{z} = \begin{bmatrix} 4 \\ 0  \end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
 <use xlink:href="#MJMAIN-3D" x="850" y="0"></use>
<g transform="translate(1906,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-34" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="3954" y="0"></use>
<g transform="translate(5399,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="6221" y="0"></use>
<g transform="translate(7277,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-33" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-32" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="9325" y="0"></use>
<g transform="translate(10770,0)">
 <use xlink:href="#MJMATHI-7A" x="1" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="528" y="35"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="11577" y="0"></use>
<g transform="translate(12633,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-34" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-30" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
</g>
</svg></span><p>In this notation, arithmetic operations we saw earlier become quite easy.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="51.258ex" height="6.176ex" style="vertical-align: -2.505ex;" viewBox="0 -1580.7 22069.4 2659.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1527-Title">
<title id="MathJax-SVG-1527-Title"> \vec{2x} = \begin{bmatrix} 2 \\ 8  \end{bmatrix} , \quad
   \vec{-0.5z} = \begin{bmatrix} -2 \\ 0  \end{bmatrix} , \quad
   \vec{2x + -0.5z} = \begin{bmatrix} 0 \\ 8  \end{bmatrix}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2192" x="36" y="786"></use>
 <use xlink:href="#MJMAIN-3D" x="1350" y="0"></use>
<g transform="translate(2407,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-32" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-38" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="4454" y="0"></use>
<g transform="translate(5899,0)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
<g transform="translate(778,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-7A" x="2058" y="0"></use>
 <use xlink:href="#MJMAIN-2192" x="764" y="786"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="8704" y="0"></use>
<g transform="translate(9760,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,650)">
 <use xlink:href="#MJMAIN-2212" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-32" x="778" y="0"></use>
</g>
 <use xlink:href="#MJMAIN-30" x="389" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="2131" y="-1"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="12586" y="0"></use>
<g transform="translate(14031,0)">
 <use xlink:href="#MJMAIN-32" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="1295" y="0"></use>
 <use xlink:href="#MJMAIN-2212" x="2295" y="0"></use>
<g transform="translate(3074,0)">
 <use xlink:href="#MJMAIN-30"></use>
 <use xlink:href="#MJMAIN-2E" x="500" y="0"></use>
 <use xlink:href="#MJMAIN-35" x="779" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-7A" x="4353" y="0"></use>
 <use xlink:href="#MJMAIN-2192" x="1912" y="786"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="19132" y="0"></use>
<g transform="translate(20188,0)">
 <use xlink:href="#MJSZ3-5B"></use>
<g transform="translate(695,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-30" x="0" y="650"></use>
 <use xlink:href="#MJMAIN-38" x="0" y="-750"></use>
</g>
</g>
 <use xlink:href="#MJSZ3-5D" x="1352" y="-1"></use>
</g>
</g>
</svg></span><p><img src="../../notebooks-images/vector_space_review__notation_arithmetic.png" width="500"></p>
<p>Vectors can be added and scaled element-wise:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.36ex" height="10.509ex" style="vertical-align: -4.671ex;" viewBox="0 -2513.6 12641.2 4524.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1528-Title">
<title id="MathJax-SVG-1528-Title">a \vec{x} + b \vec{y} = \begin{bmatrix} a \ x_1 &amp; + &amp; b \  y_1 \\
                                            &amp; \vdots &amp; \\
                                          a \  x_n &amp; + &amp; b \  y_n
                          \end{bmatrix}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
<g transform="translate(529,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="1324" y="0"></use>
 <use xlink:href="#MJMATHI-62" x="2324" y="0"></use>
<g transform="translate(2754,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="3576" y="0"></use>
<g transform="translate(4632,0)">
<g transform="translate(0,2406)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2560.657284768212) scale(1,1.3427152317880795)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3668"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
<g transform="translate(35,1606)">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
<g transform="translate(779,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
</g>
<g transform="translate(0,-1701)">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
<g transform="translate(779,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="809" y="-213"></use>
</g>
</g>
</g>
<g transform="translate(2866,0)">
 <use xlink:href="#MJMAIN-2B" x="0" y="1606"></use>
 <use xlink:href="#MJMAIN-22EE" x="250" y="-301"></use>
 <use xlink:href="#MJMAIN-2B" x="0" y="-1701"></use>
</g>
<g transform="translate(4644,0)">
<g transform="translate(35,1606)">
 <use xlink:href="#MJMATHI-62" x="0" y="0"></use>
<g transform="translate(679,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(0,-1701)">
 <use xlink:href="#MJMATHI-62" x="0" y="0"></use>
<g transform="translate(679,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
</g>
</g>
<g transform="translate(7340,2406)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2560.657284768212) scale(1,1.3427152317880795)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3668"></use>
</g>
</g>
</g>
</svg></span><h3 id="The-$\vec{1}$-vector">The <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 500.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1529-Title">
<title id="MathJax-SVG-1529-Title">\vec{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="485" y="259"></use>
</g>
</svg></span> vector<a class="anchor-link" href="#The-$\vec{1}$-vector">¶</a></h3><p>In any <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.216ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 523.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1530-Title">
<title id="MathJax-SVG-1530-Title">d</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-64" x="0" y="0"></use>
</g>
</svg></span> dimensional space, <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.843ex" style="vertical-align: -0.338ex;" viewBox="0 -1078.4 500.5 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1531-Title">
<title id="MathJax-SVG-1531-Title">\vec{1}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="485" y="259"></use>
</g>
</svg></span> is the vector of all <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.162ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 500.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1532-Title">
<title id="MathJax-SVG-1532-Title">1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-31" x="0" y="0"></use>
</g>
</svg></span>'s: 
<span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.015ex" height="10.509ex" style="vertical-align: -4.671ex;" viewBox="0 -2513.6 2159 4524.8" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1533-Title">
<title id="MathJax-SVG-1533-Title"> \begin{bmatrix} 1 \\ \vdots \\ 1  \end{bmatrix}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(0,2400)">
 <use xlink:href="#MJSZ4-23A1" x="0" y="-1155"></use>
<g transform="translate(0,-2548.677152317881) scale(1,1.3228476821192052)">
 <use xlink:href="#MJSZ4-23A2"></use>
</g>
 <use xlink:href="#MJSZ4-23A3" x="0" y="-3656"></use>
</g>
<g transform="translate(834,0)">
<g transform="translate(-11,0)">
 <use xlink:href="#MJMAIN-31" x="0" y="1600"></use>
 <use xlink:href="#MJMAIN-22EE" x="111" y="-301"></use>
 <use xlink:href="#MJMAIN-31" x="0" y="-1701"></use>
</g>
</g>
<g transform="translate(1491,2400)">
 <use xlink:href="#MJSZ4-23A4" x="0" y="-1155"></use>
<g transform="translate(0,-2548.677152317881) scale(1,1.3228476821192052)">
 <use xlink:href="#MJSZ4-23A5"></use>
</g>
 <use xlink:href="#MJSZ4-23A6" x="0" y="-3656"></use>
</g>
</g>
</svg></span></p>
<h3 id="Span-of-a-set-of-vectors">Span of a set of vectors<a class="anchor-link" href="#Span-of-a-set-of-vectors">¶</a></h3><p>The span of a set of vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.508ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 6677.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1534-Title">
<title id="MathJax-SVG-1534-Title">\{\vec{v_1}, \vec{v_2}, \dots, \vec{v_p}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1501" y="0"></use>
<g transform="translate(1946,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2946" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="3391" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4731" y="0"></use>
<g transform="translate(5176,0)">
<g transform="translate(29,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="6176" y="0"></use>
</g>
</svg></span> is the set of all possible linear combinations. For these <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.259ex" height="2.009ex" style="vertical-align: -0.671ex; margin-left: -0.089ex;" viewBox="-38.5 -576.1 542 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1535-Title">
<title id="MathJax-SVG-1535-Title">p</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-70" x="0" y="0"></use>
</g>
</svg></span> vectors:</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.25ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 16899.1 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1536-Title">
<title id="MathJax-SVG-1536-Title"> \{ c_1 \ \vec{v_1} + c_2 \ \vec{v_2} + \dots + c_p \ \vec{v_p} \ : \ \forall c_i \in F\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMATHI-63" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="613" y="-213"></use>
</g>
<g transform="translate(1637,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2860" y="0"></use>
<g transform="translate(3861,0)">
 <use xlink:href="#MJMATHI-63" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="613" y="-213"></use>
</g>
<g transform="translate(4998,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="6221" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="7222" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8616" y="0"></use>
<g transform="translate(9617,0)">
 <use xlink:href="#MJMATHI-63" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="613" y="-213"></use>
</g>
<g transform="translate(10757,0)">
<g transform="translate(29,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-3A" x="12285" y="0"></use>
 <use xlink:href="#MJMAIN-2200" x="13091" y="0"></use>
<g transform="translate(13648,0)">
 <use xlink:href="#MJMATHI-63" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="613" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2208" x="14703" y="0"></use>
 <use xlink:href="#MJMATHI-46" x="15649" y="0"></use>
 <use xlink:href="#MJMAIN-7D" x="16398" y="0"></use>
</g>
</svg></span><p>where <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.741ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 749.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1537-Title">
<title id="MathJax-SVG-1537-Title">F</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-46" x="0" y="0"></use>
</g>
</svg></span> is the field of the vector space (out of scope).</p>
<h3 id="Vector-spaces">Vector spaces<a class="anchor-link" href="#Vector-spaces">¶</a></h3><p>A vector space <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1538-Title">
<title id="MathJax-SVG-1538-Title">V</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
</g>
</svg></span> is the span of a set of vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.508ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 6677.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1539-Title">
<title id="MathJax-SVG-1539-Title">\{\vec{v_1}, \vec{v_2}, \dots, \vec{v_p}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1501" y="0"></use>
<g transform="translate(1946,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2946" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="3391" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4731" y="0"></use>
<g transform="translate(5176,0)">
<g transform="translate(29,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="6176" y="0"></use>
</g>
</svg></span>, where each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.324ex" height="3.343ex" style="vertical-align: -0.671ex;" viewBox="0 -1150.1 1000.5 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1540-Title">
<title id="MathJax-SVG-1540-Title">\vec{v_i}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(85,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
</svg></span> is a <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.398ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 2323.9 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1541-Title">
<title id="MathJax-SVG-1541-Title">n \times 1</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6E" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-D7" x="822" y="0"></use>
 <use xlink:href="#MJMAIN-31" x="1823" y="0"></use>
</g>
</svg></span> dimensional column vector.</p>
<h3 id="Vector-subspaces">Vector subspaces<a class="anchor-link" href="#Vector-subspaces">¶</a></h3><p>A subspace <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.783ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 767.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1542-Title">
<title id="MathJax-SVG-1542-Title">U</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-55" x="0" y="0"></use>
</g>
</svg></span> of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1543-Title">
<title id="MathJax-SVG-1543-Title">V</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
</g>
</svg></span> is the span of a set of vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.211ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 5257.4 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1544-Title">
<title id="MathJax-SVG-1544-Title">\{\vec{u_1}, \dots, \vec{u_q}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
 <use xlink:href="#MJMATHI-75" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
 <use xlink:href="#MJMAIN-2192" x="12" y="562"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1526" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="1972" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="3311" y="0"></use>
<g transform="translate(3756,0)">
<g transform="translate(1,0)">
 <use xlink:href="#MJMATHI-75" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-71" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="562"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="4756" y="0"></use>
</g>
</svg></span> where each <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.952ex" height="3.343ex" style="vertical-align: -0.671ex;" viewBox="0 -1150.1 2993.1 1439.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1545-Title">
<title id="MathJax-SVG-1545-Title">\vec{u_i} \in V</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(41,0)">
 <use xlink:href="#MJMATHI-75" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="809" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="562"></use>
 <use xlink:href="#MJMAIN-2208" x="1278" y="0"></use>
 <use xlink:href="#MJMATHI-56" x="2223" y="0"></use>
</g>
</svg></span>. This means every vector in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.783ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 767.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1546-Title">
<title id="MathJax-SVG-1546-Title">U</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-55" x="0" y="0"></use>
</g>
</svg></span> is also in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.787ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 769.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1547-Title">
<title id="MathJax-SVG-1547-Title">V</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-56" x="0" y="0"></use>
</g>
</svg></span>.</p>
<h3 id="Angles-between-vectors">Angles between vectors<a class="anchor-link" href="#Angles-between-vectors">¶</a></h3><p>When you put any two vectors terminal end to terminal end without changing their direction, you can measure the angle between them.</p>
<p><img src="../../notebooks-images/vector_space_review__angle.png" width="300"></p>
<h3 id="Vector-lengths">Vector lengths<a class="anchor-link" href="#Vector-lengths">¶</a></h3><p>Intuition in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.732ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1176.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1548-Title">
<title id="MathJax-SVG-1548-Title">\mathbb{R}^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1021" y="581"></use>
</g>
</svg></span> :</p>
<p>Recall the triangle method of adding two vectors. If we add two perpendicular vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.164ex" height="3.009ex" style="vertical-align: -0.505ex;" viewBox="0 -1078.4 2223.4 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1549-Title">
<title id="MathJax-SVG-1549-Title">\vec{a} + \vec{b}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="499" y="34"></use>
 <use xlink:href="#MJMAIN-2B" x="751" y="0"></use>
<g transform="translate(1752,0)">
 <use xlink:href="#MJMATHI-62" x="20" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="470" y="287"></use>
</g>
</g>
</svg></span> in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.732ex" height="2.676ex" style="vertical-align: -0.338ex;" viewBox="0 -1006.6 1176.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1550-Title">
<title id="MathJax-SVG-1550-Title">\mathbb{R}^2</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="1021" y="581"></use>
</g>
</svg></span>, then we know that the resulting vector will be the hypotenuse. In this case, we also know that the length of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.164ex" height="3.009ex" style="vertical-align: -0.505ex;" viewBox="0 -1078.4 2223.4 1295.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1551-Title">
<title id="MathJax-SVG-1551-Title">\vec{a} + \vec{b}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="499" y="34"></use>
 <use xlink:href="#MJMAIN-2B" x="751" y="0"></use>
<g transform="translate(1752,0)">
 <use xlink:href="#MJMATHI-62" x="20" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="470" y="287"></use>
</g>
</g>
</svg></span> will follow the Pythagorean Theorem: <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.5ex" height="3.509ex" style="vertical-align: -0.838ex;" viewBox="0 -1150.1 4090.3 1510.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1552-Title">
<title id="MathJax-SVG-1552-Title">\sqrt{a^2 + b^2}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJSZ1-221A" x="0" y="94"></use>
<rect stroke="none" width="3089" height="60" x="1000" y="885"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#MJMATHI-61" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="748" y="408"></use>
 <use xlink:href="#MJMAIN-2B" x="1205" y="0"></use>
<g transform="translate(2206,0)">
 <use xlink:href="#MJMATHI-62" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="607" y="408"></use>
</g>
</g>
</g>
</svg></span>.</p>
<p><img src="../../notebooks-images/vector_space_review__length.png" width="400"></p>
<p>General Formula for  Length of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.913ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 2976.2 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1553-Title">
<title id="MathJax-SVG-1553-Title">\vec{v} \in \mathbb{R}^n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="505" y="36"></use>
 <use xlink:href="#MJMAIN-2208" x="783" y="0"></use>
<g transform="translate(1729,0)">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1021" y="581"></use>
</g>
</g>
</svg></span> :
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.536ex" height="8.176ex" style="vertical-align: -3.505ex;" viewBox="0 -2011.3 14008.4 3520.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1554-Title">
<title id="MathJax-SVG-1554-Title">\begin{aligned} || \vec{v} || \quad
&amp;=  \quad \sqrt{v_1^2 + v_2^2 + \dots + v_n^2}  \\
&amp;= \quad \sqrt{\vec{v} \cdot \vec{v}}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,692)">
 <use xlink:href="#MJMAIN-7C" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="278" y="0"></use>
<g transform="translate(557,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="505" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="1063" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="1341" y="0"></use>
</g>
</g>
<g transform="translate(2609,0)">
<g transform="translate(0,692)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
 <use xlink:href="#MJSZ2-221A" x="0" y="-20"></use>
<rect stroke="none" width="7730" height="60" x="1000" y="1071"></rect>
<g transform="translate(1000,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-435"></use>
 <use xlink:href="#MJMAIN-2B" x="1161" y="0"></use>
<g transform="translate(2162,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-435"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="3323" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="4324" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="5719" y="0"></use>
<g transform="translate(6720,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="488"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="686" y="-212"></use>
</g>
</g>
</g>
</g>
<g transform="translate(0,-1185)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
 <use xlink:href="#MJMAIN-221A" x="0" y="46"></use>
<rect stroke="none" width="1735" height="60" x="833" y="787"></rect>
<g transform="translate(833,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="505" y="36"></use>
 <use xlink:href="#MJMAIN-22C5" x="728" y="0"></use>
<g transform="translate(1228,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="505" y="36"></use>
</g>
</g>
</g>
</g>
</g>
</g>
</g>
</svg></span></p>
<p>Where the final operator is the dot product.</p>
<span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.815ex" height="5.843ex" style="vertical-align: -2.338ex;" viewBox="0 -1508.9 17142.7 2515.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1555-Title">
<title id="MathJax-SVG-1555-Title"> \begin{aligned}
\vec{x} \cdot \vec{y} \quad 
&amp;= \quad x_1 \ y_1 + x_2 \ y_2 + \dots + x_n \ y_n \\
&amp;= \quad||x|| \ ||y|| \ \cos{\theta}
\end{aligned}
</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
<g transform="translate(167,0)">
<g transform="translate(-11,0)">
<g transform="translate(0,628)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
 <use xlink:href="#MJMAIN-22C5" x="794" y="0"></use>
<g transform="translate(1295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</g>
</g>
<g transform="translate(2829,0)">
<g transform="translate(0,628)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
<g transform="translate(2334,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="809" y="-213"></use>
</g>
<g transform="translate(3610,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="4777" y="0"></use>
<g transform="translate(5777,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="809" y="-213"></use>
</g>
<g transform="translate(7054,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="693" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="8220" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="9221" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="10616" y="0"></use>
<g transform="translate(11617,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="809" y="-213"></use>
</g>
<g transform="translate(12964,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="693" y="-213"></use>
</g>
</g>
<g transform="translate(0,-678)">
 <use xlink:href="#MJMAIN-3D" x="277" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2334" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="2612" y="0"></use>
 <use xlink:href="#MJMATHI-78" x="2891" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3463" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="3742" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4270" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="4549" y="0"></use>
 <use xlink:href="#MJMATHI-79" x="4827" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="5325" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="5603" y="0"></use>
<g transform="translate(6298,0)">
 <use xlink:href="#MJMAIN-63"></use>
 <use xlink:href="#MJMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="945" y="0"></use>
</g>
 <use xlink:href="#MJMATHI-3B8" x="7804" y="0"></use>
</g>
</g>
</g>
</g>
</svg></span><p>The first expression is known as the algebraic definition of the dot product, and the second is the geometric definition. Note that the dot product is the inner product defined for vectors in <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.897ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 1247.1 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1556-Title">
<title id="MathJax-SVG-1556-Title">\mathbb{R}^n</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJAMS-52" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="1021" y="581"></use>
</g>
</svg></span>.</p>
<h3 id="Distance-between-two-vectors">Distance between two vectors<a class="anchor-link" href="#Distance-between-two-vectors">¶</a></h3><span class="mjpage mjpage__block"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.151ex" height="2.843ex" style="vertical-align: -0.838ex;" viewBox="0 -863.1 10829 1223.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1557-Title">
<title id="MathJax-SVG-1557-Title">dist(\vec{x},\vec{y}) \quad = \quad || \vec{x} - \vec{y} ||</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-64" x="0" y="0"></use>
 <use xlink:href="#MJMATHI-69" x="523" y="0"></use>
 <use xlink:href="#MJMATHI-73" x="869" y="0"></use>
 <use xlink:href="#MJMATHI-74" x="1338" y="0"></use>
 <use xlink:href="#MJMAIN-28" x="1700" y="0"></use>
<g transform="translate(2089,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2662" y="0"></use>
<g transform="translate(3107,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-29" x="3651" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="5318" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="7375" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="7653" y="0"></use>
<g transform="translate(7932,0)">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
 <use xlink:href="#MJMAIN-2212" x="8726" y="0"></use>
<g transform="translate(9727,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-7C" x="10272" y="0"></use>
 <use xlink:href="#MJMAIN-7C" x="10550" y="0"></use>
</g>
</svg></span><p><img src="../../notebooks-images/vector_space_review__distance.png" width="500"></p>
<h3 id="Orthogonal-vectors">Orthogonal vectors<a class="anchor-link" href="#Orthogonal-vectors">¶</a></h3><p>For two non-zero vectors to be orthogonal, they must satisfy the property that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.534ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 3674.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1558-Title">
<title id="MathJax-SVG-1558-Title">\vec{x} \cdot \vec{y} = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
 <use xlink:href="#MJMAIN-22C5" x="794" y="0"></use>
<g transform="translate(1295,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
 <use xlink:href="#MJMAIN-3D" x="2117" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3173" y="0"></use>
</g>
</svg></span>. Since they have non-zero length, the only way for the two vectors to be orthogonal is if <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.85ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 3810.2 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1559-Title">
<title id="MathJax-SVG-1559-Title">\cos{\theta} = 0</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-63"></use>
 <use xlink:href="#MJMAIN-6F" x="444" y="0"></use>
 <use xlink:href="#MJMAIN-73" x="945" y="0"></use>
 <use xlink:href="#MJMATHI-3B8" x="1506" y="0"></use>
 <use xlink:href="#MJMAIN-3D" x="2253" y="0"></use>
 <use xlink:href="#MJMAIN-30" x="3309" y="0"></use>
</g>
</svg></span>. One satisfying <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.09ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 469.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1560-Title">
<title id="MathJax-SVG-1560-Title">\theta</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-3B8" x="0" y="0"></use>
</g>
</svg></span> is 90 degrees, our familiar right angle.</p>
<h3 id="Projections-of-vectors">Projections of vectors<a class="anchor-link" href="#Projections-of-vectors">¶</a></h3><p>To project one vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1561-Title">
<title id="MathJax-SVG-1561-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span> onto another vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1562-Title">
<title id="MathJax-SVG-1562-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span>, we want to find <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.056ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 1315.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1563-Title">
<title id="MathJax-SVG-1563-Title">k \ \vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
<g transform="translate(771,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</g>
</svg></span> that is closest to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1564-Title">
<title id="MathJax-SVG-1564-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span>.</p>
<p><img src="../../notebooks-images/vector_space_review__projection.png" width="400"></p>
<p>By the Pythagorean Theorem, we know that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.176ex" style="vertical-align: -0.338ex;" viewBox="0 -791.3 521.5 936.9" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1565-Title">
<title id="MathJax-SVG-1565-Title">k</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
</g>
</svg></span> must be the scalar such that <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.226ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 3111.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1566-Title">
<title id="MathJax-SVG-1566-Title">\vec{x} - k \ \vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
 <use xlink:href="#MJMAIN-2212" x="794" y="0"></use>
 <use xlink:href="#MJMATHI-6B" x="1795" y="0"></use>
<g transform="translate(2566,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</g>
</svg></span> is perpendicular to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1567-Title">
<title id="MathJax-SVG-1567-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span>, so  <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.056ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 1315.9 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1568-Title">
<title id="MathJax-SVG-1568-Title">k \ \vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
<g transform="translate(771,0)">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</g>
</svg></span> is the (orthogonal) projection of <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1569-Title">
<title id="MathJax-SVG-1569-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span> onto <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.264ex" height="2.676ex" style="vertical-align: -0.671ex;" viewBox="0 -863.1 544.4 1152.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1570-Title">
<title id="MathJax-SVG-1570-Title">\vec{y}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-79" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="543" y="36"></use>
</g>
</svg></span>.</p>
<p>Likewise, to project one vector <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1571-Title">
<title id="MathJax-SVG-1571-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span> onto any vector space spanned by some set of vectors <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.508ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 6677.2 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1572-Title">
<title id="MathJax-SVG-1572-Title">\{\vec{v_1}, \vec{v_2}, \dots, \vec{v_p}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMAIN-7B" x="0" y="0"></use>
<g transform="translate(500,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="1501" y="0"></use>
<g transform="translate(1946,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2C" x="2946" y="0"></use>
 <use xlink:href="#MJMAIN-2026" x="3391" y="0"></use>
 <use xlink:href="#MJMAIN-2C" x="4731" y="0"></use>
<g transform="translate(5176,0)">
<g transform="translate(29,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="6176" y="0"></use>
</g>
</svg></span>, we still find the linear combination <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.921ex" height="3.676ex" style="vertical-align: -1.005ex;" viewBox="0 -1150.1 12021.7 1582.7" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1573-Title">
<title id="MathJax-SVG-1573-Title">k_1 \ \vec{v_1} + k_2 \ \vec{v_2} + \dots + k_p \ \vec{v_p}\}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="737" y="-213"></use>
<g transform="translate(1225,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="2448" y="0"></use>
<g transform="translate(3448,0)">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="737" y="-213"></use>
</g>
<g transform="translate(4674,0)">
<g transform="translate(30,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-2B" x="5896" y="0"></use>
 <use xlink:href="#MJMAIN-22EF" x="6897" y="0"></use>
 <use xlink:href="#MJMAIN-2B" x="8292" y="0"></use>
<g transform="translate(9293,0)">
 <use xlink:href="#MJMATHI-6B" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="737" y="-213"></use>
</g>
<g transform="translate(10520,0)">
<g transform="translate(29,0)">
 <use xlink:href="#MJMATHI-76" x="0" y="0"></use>
 <use transform="scale(0.707)" xlink:href="#MJMATHI-70" x="686" y="-213"></use>
</g>
 <use xlink:href="#MJMAIN-2192" x="0" y="563"></use>
</g>
 <use xlink:href="#MJMAIN-7D" x="11521" y="0"></use>
</g>
</svg></span> that is closest to <span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="2.343ex" style="vertical-align: -0.338ex;" viewBox="0 -863.1 572.5 1008.6" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1574-Title">
<title id="MathJax-SVG-1574-Title">\vec{x}</title>
<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true">
 <use xlink:href="#MJMATHI-78" x="0" y="0"></use>
 <use xlink:href="#MJMAIN-20D7" x="549" y="35"></use>
</g>
</svg></span>.</p>
<p><img src="../../notebooks-images/vector_space_review__proj2d.png" width="500"></p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/20'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Reference-Tables">Reference Tables<a class="anchor-link" href="#Reference-Tables">¶</a></h2><p>This appendix contains reference tables for the <code>pandas</code>, <code>seaborn</code>,
<code>matplotlib</code>, and <code>scikit-learn</code> methods used in the book. It is meant to
provide a helpful overview of the small subset of methods that we use most
often in this book.</p>
<p>For each library, we list the methods used, the chapter where each method is
first mentioned, and a brief description of the method's functionality.</p>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/20'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="pandas">pandas<a class="anchor-link" href="#pandas">¶</a></h2><table>
<thead><tr>
<th>Function</th>
<th>Chapter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.html"><code>pd.DataFrame(data)</code></a></td>
<td>Tabular Data and pandas</td>
<td>Create a DataFrame from a two-dimensional array or dictionary <code>data</code></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html"><code>pd.read_csv(filepath)</code></a></td>
<td>Tabular Data and pandas</td>
<td>Import a CSV file from <code>filepath</code> as a pandas DataFrame</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.head.html"><code>pd.DataFrame.head(n=5)</code></a><br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.head.html"><code>pd.Series.head(n=5)</code></a></td>
<td>Tabular Data and pandas</td>
<td>View the first <code>n</code> rows of a DataFrame or Series</td>
</tr>
<tr>
<td><code>pd.DataFrame.index</code><br><code>pd.DataFrame.columns</code></td>
<td>Tabular Data and pandas</td>
<td>View a DataFrame's index and column values</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.describe.html"><code>pd.DataFrame.describe()</code></a><br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.describe.html"><code>pd.Series.describe()</code></a></td>
<td>Exploratory Data Analysis</td>
<td>View descriptive statistics about a DataFrame or Series</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.unique.html"><code>pd.Series.unique()</code></a></td>
<td>Exploratory Data Analysis</td>
<td>View unique values in a Series</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.value_counts.html"><code>pd.Series.value_counts()</code></a></td>
<td>Exploratory Data Analysis</td>
<td>View the number of times each unique value appears in a Series</td>
</tr>
<tr>
<td><code>df[col]</code></td>
<td>Tabular Data and pandas</td>
<td>From DataFrame <code>df</code>, return column <code>col</code> as a Series</td>
</tr>
<tr>
<td><code>df[[col]]</code></td>
<td>Tabular Data and pandas</td>
<td>From DataFrame <code>df</code>, return column <code>col</code> as a DataFrame</td>
</tr>
<tr>
<td><code>df.loc[row, col]</code></td>
<td>Tabular Data and pandas</td>
<td>From DataFrame <code>df</code>, return rows with index name <code>row</code> and column name <code>col</code>; <code>row</code> can alternatively be a boolean Series</td>
</tr>
<tr>
<td><code>df.iloc[row, col]</code></td>
<td>Tabular Data and pandas</td>
<td>From DataFrame <code>df</code>, return rows with index number <code>row</code> and column number <code>col</code>; <code>row</code> can alternatively be a boolean Series</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.isnull.html"><code>pd.DataFrame.isnull()</code></a><br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.isnull.html"><code>pd.Series.isnull()</code></a></td>
<td>Data Cleaning</td>
<td>View missing values in a DataFrame or Series</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html"><code>pd.DataFrame.fillna(value)</code></a><br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.fillna.html"><code>pd.Series.fillna(value)</code></a></td>
<td>Data Cleaning</td>
<td>Fill in missing values in a DataFrame or Series with <code>value</code></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.dropna.html"><code>pd.DataFrame.dropna(axis)</code></a><br><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dropna.html"><code>pd.Series.dropna()</code></a></td>
<td>Data Cleaning</td>
<td>Drop rows or columns with missing values from a DataFrame or Series</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.drop.html"><code>pd.DataFrame.drop(labels, axis)</code></a></td>
<td>Data Cleaning</td>
<td>Drop rows or columns named <code>labels</code> from DataFrame along <code>axis</code></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.rename.html"><code>pd.DataFrame.rename()</code></a></td>
<td>Data Cleaning</td>
<td>Rename specified rows or column in DataFrame</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.replace.html"><code>pd.DataFrame.replace(to_replace, value)</code></a></td>
<td>Data Cleaning</td>
<td>Replace <code>to_replace</code> values with <code>value</code> in DataFrame</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.reset_index.html"><code>pd.DataFrame.reset_index(drop=False)</code></a></td>
<td>Data Cleaning</td>
<td>Reset a DataFrame's indices; by default, retains old indices as a new column unless <code>drop=True</code> specified</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.sort_values.html"><code>pd.DataFrame.sort_values(by, ascending=True)</code></a></td>
<td>Tabular Data and pandas</td>
<td>Sort a DataFrame by specified columns <code>by</code>, in ascending order by default</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.groupby.html"><code>pd.DataFrame.groupby(by)</code></a></td>
<td>Tabular Data and pandas</td>
<td>Return a GroupBy object that contains a DataFrame grouped by the values in the specified columns <code>by</code></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/api.html#id41"><code>GroupBy.&lt;function&gt;</code></a></td>
<td>Tabular Data and pandas</td>
<td>Apply a function <code>&lt;function&gt;</code> to each group in a GroupBy object <code>GroupBy</code>; e.g. <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.core.groupby.GroupBy.mean.html"><code>mean()</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.core.groupby.GroupBy.count.html"><code>count()</code></a></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/api.html#computations-descriptive-stats"><code>pd.Series.&lt;function&gt;</code></a></td>
<td>Tabular Data and pandas</td>
<td>Apply a function <code>&lt;function&gt;</code> to a Series with numerical values; e.g. <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.mean.html"><code>mean()</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.max.html"><code>max()</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.median.html"><code>median()</code></a></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/api.html#string-handling"><code>pd.Series.str.&lt;function&gt;</code></a></td>
<td>Tabular Data and pandas</td>
<td>Apply a function <code>&lt;function&gt;</code> to a Series with string values; e.g. <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.len.html"><code>len()</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.lower.html"><code>lower()</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.str.split.html"><code>split()</code></a></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/api.html#datetimelike-properties"><code>pd.Series.dt.&lt;property&gt;</code></a></td>
<td>Tabular Data and pandas</td>
<td>Extract a property <code>&lt;property&gt;</code> from a Series with Datetime values; e.g. <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.year.html"><code>year</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.month.html"><code>month</code></a>, <a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.dt.date.html"><code>date</code></a></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.get_dummies.html"><code>pd.get_dummies(columns, drop_first=False)</code></a></td>
<td>---</td>
<td>Convert categorical variables <code>columns</code> to dummy variables; default retains all variables unless <code>drop_first=True</code> specified</td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.merge.html"><code>pd.merge(left, right, how, on)</code></a></td>
<td>Exploratory Data Analysis; Databases and SQL</td>
<td>Merge two DataFrames <code>left</code> and <code>right</code> together on specified columns <code>on</code>; type of join depends on <code>how</code></td>
</tr>
<tr>
<td><a href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_sql.html"><code>pd.read_sql(sql, con)</code></a></td>
<td>Databases and SQL</td>
<td>Read a SQL query <code>sql</code> on a database connection <code>con</code>, and return result as a pandas DataFrame</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/20'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Seaborn">Seaborn<a class="anchor-link" href="#Seaborn">¶</a></h2><table>
<thead><tr>
<th>Function</th>
<th>Chapter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.lmplot.html"><code>sns.lmplot(x, y, data, fit_reg=True)</code></a></td>
<td>Data Visualization</td>
<td>Create a scatterplot of <code>x</code> versus <code>y</code> from DataFrame <code>data</code>, and by default overlay a least-squares regression line</td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.distplot.html"><code>sns.distplot(a, kde=True)</code></a></td>
<td>Data Visualization</td>
<td>Create a histogram of <code>a</code>, and by default overlay a kernel density estimator</td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.barplot.html"><code>sns.barplot(x, y, hue=None, data, ci=95)</code></a></td>
<td>Data Visualization</td>
<td>Create a barplot of <code>x</code> versus <code>y</code> from DataFrame <code>data</code>, optionally factoring data based on <code>hue</code>, and by default drawing a 95% confidence interval (which can be turned off with <code>ci=None</code>)</td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.countplot.html"><code>sns.countplot(x, hue=None, data)</code></a></td>
<td>Data Visualization</td>
<td>Create a barplot of value counts of variable <code>x</code> chosen from DataFrame <code>data</code>, optionally factored by categorical variable <code>hue</code></td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.boxplot.html"><code>sns.boxplot(x=None, y, data)</code></a></td>
<td>Data Visualization</td>
<td>Create a boxplot of <code>y</code>, optionally factoring by categorical variables <code>x</code>, from the DataFrame <code>data</code></td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.kdeplot.html"><code>sns.kdeplot(x, y=None)</code></a></td>
<td>Data Visualization</td>
<td>If <code>y=None</code>, create a univariate density plot of <code>x</code>; if <code>y</code> is specified, create a bivariate density plot</td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.jointplot.html"><code>sns.jointplot(x, y, data)</code></a></td>
<td>Data Visualization</td>
<td>Combine a bivariate scatterplot of <code>x</code> versus <code>y</code> from DataFrame <code>data</code>, with univariate density plots of each variable overlaid on the axes</td>
</tr>
<tr>
<td><a href="https://seaborn.pydata.org/generated/seaborn.violinplot.html"><code>sns.violinplot(x=None, y, data)</code></a></td>
<td>Data Visualization</td>
<td>Draws a combined boxplot and kernel density estimator of variable <code>y</code>, optionally factored by categorical variable <code>x</code>, chosen from DataFrame <code>data</code></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/20'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="matplotlib">matplotlib<a class="anchor-link" href="#matplotlib">¶</a></h2><h3 id="Types-of-Plots">Types of Plots<a class="anchor-link" href="#Types-of-Plots">¶</a></h3><table>
<thead><tr>
<th>Function</th>
<th>Chapter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.scatter.html"><code>plt.scatter(x, y)</code></a></td>
<td>Data Visualization</td>
<td>Creates a scatter plot of the variable x against the variable y</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.plot.html"><code>plt.plot(x, y)</code></a></td>
<td>Data Visualization</td>
<td>Creates a line plot of the variable x against the variable y</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.hist.html"><code>plt.hist(x, bins=None)</code></a></td>
<td>Data Visualization</td>
<td>Creates a histogram of x. Bins argument can be an integer or sequence</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.bar.html"><code>plt.bar(x, height)</code></a></td>
<td>Data Visualization</td>
<td>Creates a bar plot. <code>x</code> specifies x-coordinates of bars, <code>height</code> specifies heights of the bars</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.axvline.html"><code>plt.axvline(x=0)</code></a></td>
<td>Data Visualization</td>
<td>Creates a vertical line at the x value specified</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.axhline.html"><code>plt.axhline(y=0)</code></a></td>
<td>Data Visualization</td>
<td>Creates a horizontal line at the y value specified</td>
</tr>
</tbody>
</table>
<h3 id="Plot-additions">Plot additions<a class="anchor-link" href="#Plot-additions">¶</a></h3><table>
<thead><tr>
<th>Function</th>
<th>Chapter</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://ipython.readthedocs.io/en/stable/interactive/plotting.html"><code>%matplotlib inline</code></a></td>
<td>Data Visualization</td>
<td>Causes output of plotting commands to be displayed inline</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.figure.html"><code>plt.figure(figsize=(3, 5))</code></a></td>
<td>Data Visualization</td>
<td>Creates a figure with a width of 3 inches and a height of 5 inches</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlim.html"><code>plt.xlim(xmin, xmax)</code></a></td>
<td>Data Visualization</td>
<td>Sets the x-limits of the current axes</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.xlabel.html"><code>plt.xlabel(label)</code></a></td>
<td>Data Visualization</td>
<td>Sets an x-axis label of the current axes</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.title.html"><code>plt.title(label)</code></a></td>
<td>Data Visualization</td>
<td>Sets a title of the current axes</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.legend.html"><code>plt.legend(x, height)</code></a></td>
<td>Data Visualization</td>
<td>Places a legend on the axes</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.subplots.html"><code>fig, ax = plt.subplots()</code></a></td>
<td>Data Visualization</td>
<td>Creates a figure and set of subplots</td>
</tr>
<tr>
<td><a href="https://matplotlib.org/api/_as_gen/matplotlib.pyplot.show.html"><code>plt.show()</code></a></td>
<td>Data Visualization</td>
<td>Displays a figure</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/20'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="scikit-learn">scikit-learn<a class="anchor-link" href="#scikit-learn">¶</a></h1><h2 id="Models-and-Model-Selection">Models and Model Selection<a class="anchor-link" href="#Models-and-Model-Selection">¶</a></h2><table>
<thead><tr>
<th>Import</th>
<th>Function</th>
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>sklearn.model_selection</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html"><code>train_test_split(*arrays, test_size=0.2)</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns two random subsets of each array passed in, with 0.8 of the array in the first subset and 0.2 in the second subset</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>LinearRegression()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns an ordinary least squares Linear Regression model</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>LassoCV()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns a Lasso (L1 Regularization) linear model with picking the best model by cross validation</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>RidgeCV()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns a Ridge (L2 Regularization) linear model with picking the best model by cross validation</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>ElasticNetCV()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns a ElasticNet (L1 and L2 Regularization) linear model with picking the best model by cross validation</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html"><code>LogisticRegression()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns a Logistic Regression classifier</td>
</tr>
<tr>
<td><code>sklearn.linear_model</code></td>
<td><a href="http://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegressionCV.html"><code>LogisticRegressionCV()</code></a></td>
<td>Modeling and Estimation</td>
<td>Returns a Logistic Regression classifier with picking the best model by cross validation</td>
</tr>
</tbody>
</table>
<h2 id="Working-with-a-Model">Working with a Model<a class="anchor-link" href="#Working-with-a-Model">¶</a></h2><p>Assuming you have a <code>model</code> variable that is a <code>scikit-learn</code> object:</p>
<table>
<thead><tr>
<th>Function</th>
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>model.fit(X, y)</code></td>
<td>Modeling and Estimation</td>
<td>Fits the model with the X and y passed in</td>
</tr>
<tr>
<td><code>model.predict(X)</code></td>
<td>Modeling and Estimation</td>
<td>Returns predictions on the X passed in according to the model</td>
</tr>
<tr>
<td><code>model.score(X, y)</code></td>
<td>Modeling and Estimation</td>
<td>Returns the accuracy of X predictions based on the corect values (y)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div id="ipython-notebook">

<div class="nbinteract-hide_in cell border-box-sizing code_cell rendered">
<div class="input">
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Clear previously defined variables</span>
<span class="o">%</span><span class="k">reset</span> -f

<span class="c1"># Set directory for data loading to work properly</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="s1">'~/notebooks/21'</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Contributors">Contributors<a class="anchor-link" href="#Contributors">¶</a></h2><p>This textbook contains substantial contributions from Data 100 students. We
list the contributors below and thank them for their effort in creating content
for the textbook.</p>
<table>
<thead><tr>
<th>Name</th>
<th>Contributions</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Ananth Agarwal</strong></td>
<td><a href="https://www.textbook.ds100.org/ch09/sql_rdbms.html">9.1</a> (Relational Databases), <a href="https://www.textbook.ds100.org/ch09/sql_basics.html">9.2</a> (SQL Queries), <a href="https://www.textbook.ds100.org/ch15/bias_cv.html">15.3</a> (Cross-Validation)</td>
</tr>
<tr>
<td><strong>Ashley Chien</strong></td>
<td><a href="https://www.textbook.ds100.org/ch09/sql_joins.html">9.3</a> (SQL Joins), Reference Table Appendix</td>
</tr>
<tr>
<td><strong>Andrew Do</strong></td>
<td><a href="https://www.textbook.ds100.org/ch08/text_strings.html">8.1</a> (Python String Methods), <a href="https://www.textbook.ds100.org/ch08/text_regex.html">8.2</a> (Regular Expressions), <a href="https://www.textbook.ds100.org/ch08/text_re.html">8.3</a> (Regex in Python and pandas)</td>
</tr>
<tr>
<td><strong>Sona Jeswani</strong></td>
<td><a href="https://www.textbook.ds100.org/ch18/hyp_introduction.html">18.1</a> (Introduction to Hypothesis Testing), <a href="https://www.textbook.ds100.org/ch18/hyp_introduction_part2.html">18.2</a> (Permutation Testing), <a href="https://www.textbook.ds100.org/ch18/hyp_regression.html">18.3</a> (Bootstrapping for Linear Regression)</td>
</tr>
<tr>
<td><strong>Tiffany Jann</strong></td>
<td><a href="https://www.textbook.ds100.org/ch07/web_http.html">7.1</a> (HTTP), <a href="https://www.textbook.ds100.org/ch11/gradient_convexity.html">11.3</a> (Convexity)</td>
</tr>
<tr>
<td><strong>Andrew Kim</strong></td>
<td><a href="https://www.textbook.ds100.org/ch07/web_http.html">7.1</a> (HTTP), <a href="https://www.textbook.ds100.org/ch08/text_strings.html">8.1</a> (Python String Methods), <a href="https://www.textbook.ds100.org/ch08/text_regex.html">8.2</a> (Regular Expressions), <a href="https://www.textbook.ds100.org/ch08/text_re.html">8.3</a> (Regex in Python and pandas)</td>
</tr>
<tr>
<td><strong>Jun Seo Park</strong></td>
<td><a href="https://www.textbook.ds100.org/ch09/sql_rdbms.html">9.1</a> (Relational Databases), <a href="https://www.textbook.ds100.org/ch09/sql_basics.html">9.2</a> (SQL Queries), Reference Table Appendix</td>
</tr>
<tr>
<td><strong>Allen Shen</strong></td>
<td><a href="https://www.textbook.ds100.org/ch02/probability_overview.html">2.2</a> (Probability Overview), <a href="https://www.textbook.ds100.org/ch11/gradient_convexity.html">11.3</a> (Convexity), <a href="https://www.textbook.ds100.org/ch12/prob_and_gen.html">12</a> (Probability and Generalization), <a href="https://www.textbook.ds100.org/ch15/bias_intro.html">15</a> (Bias-Variance Tradeoff)</td>
</tr>
<tr>
<td><strong>Katherine Yen</strong></td>
<td><a href="https://www.textbook.ds100.org/ch09/sql_joins.html">9.3</a> (SQL Joins), <a href="https://www.textbook.ds100.org/ch15/bias_cv.html">15.3</a> (Cross-Validation)</td>
</tr>
<tr>
<td><strong>Daniel Zhu</strong></td>
<td><a href="https://www.textbook.ds100.org/ch02/probability_overview.html">2.2</a> (Probability Overview), <a href="https://www.textbook.ds100.org/ch08/text_intro.html">8</a> (Working with Text), <a href="https://www.textbook.ds100.org/ch12/prob_and_gen.html">12</a> (Probability and Generalization), <a href="https://www.textbook.ds100.org/ch15/bias_intro.html">15</a> (Bias-Variance Tradeoff)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>

{% endraw %}
