

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>15.6. Example: Where is the Land of Opportunity? &#8212; Learning Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-113006011-1"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'UA-113006011-1');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ch/15/linear_case';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15.7. Feature Engineering for Numeric Measurements" href="linear_feature_eng.html" />
    <link rel="prev" title="15.5. Fitting the Multiple Linear Model" href="linear_multi_fit.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    <p class="title logo__title">Learning Data Science</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Frontmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../preface.html">To the Data 100 Student</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../prereqs.html">Prerequisites</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notation.html">Notation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">The Data Science Lifecycle</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/lifecycle_intro.html">1. The Data Science Lifecycle</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/lifecycle_cycle.html">1.1. The Stages of the Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/lifecycle_map.html">1.2. Examples of the Lifecycle</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/lifecycle_summary.html">1.3. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../02/data_scope_intro.html">2. Questions and Data Scope</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_big_data_hubris.html">2.1. Big Data and New Opportunities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_construct.html">2.2. Target Population, Access Frame, Sample</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_protocols.html">2.3. Instruments and Protocols</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_natural.html">2.4. Measuring Natural Phenomenon</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_accuracy.html">2.5. Accuracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02/data_scope_summary.html">2.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/theory_intro.html">3. Simulation and Data Design</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/theory_urn.html">3.1. The Urn Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/theory_election.html">3.2. Example: Simulating Election Poll Bias and Variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/theory_vaccine_efficacy.html">3.3. Example: Simulating a Randomized Trial for a Vaccine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/theory_measurement_error.html">3.4. Example: Measuring Air Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/theory_summary.html">3.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04/modeling_intro.html">4. Modeling with Summary Statistics</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04/modeling_simple.html">4.1. The Constant Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/modeling_loss_functions.html">4.2. Minimizing Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04/modeling_summary.html">4.3. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05/bus_intro.html">5. Case Study: Why is my Bus Always Late?</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05/bus_scope.html">5.1. Question and Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/bus_clean.html">5.2. Data Wrangling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/bus_eda.html">5.3. Exploring Bus Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/bus_modeling.html">5.4. Modeling Wait Times</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05/bus_summary.html">5.5. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Rectangular Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../06/pandas_intro.html">6. Working With Dataframes Using pandas</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_subsetting.html">6.1. Subsetting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_aggregating.html">6.2. Aggregating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_joining.html">6.3. Joining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_transforming.html">6.4. Transforming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_other_reps.html">6.5. How are Dataframes Different from Other Data Representations?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06/pandas_summary.html">6.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07/sql_intro.html">7. Working With Relations Using SQL</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../07/sql_subsetting.html">7.1. Subsetting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/sql_aggregating.html">7.2. Aggregating</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/sql_joining.html">7.3. Joining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/sql_transforming.html">7.4. Transforming and Common Table Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07/sql_summary.html">7.5. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Understanding The Data</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../08/files_intro.html">8. Wrangling Files</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../08/files_datasets.html">8.1. Data Source Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_formats.html">8.2. File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_encoding.html">8.3. File Encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_size.html">8.4. File Size</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_command_line.html">8.5. The Shell and Command Line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_granularity.html">8.6. Table Shape and Granularity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08/files_summary.html">8.7. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../09/wrangling_intro.html">9. Wrangling Dataframes</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_co2.html">9.1. Example: Wrangling CO2 Measurements from Mauna Loa Observatory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_checks.html">9.2. Quality Checks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_missing.html">9.3. Missing Values and Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_transformations.html">9.4. Transformations and Timestamps</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_structure.html">9.5. Modifying Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_restaurants.html">9.6. Example: Wrangling Restaurant Safety Violations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09/wrangling_summary.html">9.7. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../10/eda_intro.html">10. Exploratory Data Analysis</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_feature_types.html">10.1. Feature Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_distributions.html">10.2. What to Look For in a Distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_relationships.html">10.3. What to Look For in a Relationship</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_multi.html">10.4. Comparisons in Multivariate Settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_guidelines.html">10.5. Guidelines for Exploration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_example.html">10.6. Example: Sale Prices for Houses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10/eda_summary.html">10.7. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../11/viz_intro.html">11. Data Visualization</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_scale.html">11.1. Choosing Scale to Reveal Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_smoothing.html">11.2. Smoothing and Aggregating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_comparisons.html">11.3. Facilitating Meaningful Comparisons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_data_design.html">11.4. Incorporating the Data Design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_context.html">11.5. Adding Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_plotly.html">11.6. Creating Plots Using <code class="docutils literal notranslate"><span class="pre">plotly</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_other_tools.html">11.7. Other Tools for Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../11/viz_summary.html">11.8. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../12/pa_intro.html">12. Case Study: How Accurate are Air Quality Measurements?</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_scope.html">12.1. Question, Design, and Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_collocated.html">12.2. Finding Collocated Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_cleaning_aqs.html">12.3. Wrangling and Cleaning AQS Sensor Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_cleaning_purpleair.html">12.4. Wrangling PurpleAir Sensor Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_eda.html">12.5. Exploring PurpleAir and AQS Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_modeling.html">12.6. Creating a Model to Correct PurpleAir Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12/pa_conclusion.html">12.7. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Other Data Sources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../13/text_intro.html">13. Working with Text</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../13/text_examples.html">13.1. Examples of Text and Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/text_strings.html">13.2. String Manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/text_regex.html">13.3. Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/text_sotu.html">13.4. Text Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../13/text_summary.html">13.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../14/web_intro.html">14. Data Exchange</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../14/web_netCDF.html">14.1. NetCDF Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/web_json.html">14.2. JSON Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/web_http.html">14.3. HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/web_rest.html">14.4. REST</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/web_html.html">14.5. XML, HTML, and XPath</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14/web_summary.html">14.6. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Linear Modeling</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="linear_intro.html">15. Linear Models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="linear_simple.html">15.1. Simple Linear Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_pa.html">15.2. Example: A Simple Linear Model for Air Quality</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_simple_fit.html">15.3. Fitting the Simple Linear Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_multi.html">15.4. Multiple Linear Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_multi_fit.html">15.5. Fitting the Multiple Linear Model</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">15.6. Example: Where is the Land of Opportunity?</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_feature_eng.html">15.7. Feature Engineering for Numeric Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_categorical.html">15.8. Feature Engineering for Categorical Measurements</a></li>
<li class="toctree-l2"><a class="reference internal" href="linear_summary.html">15.9. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../16/ms_intro.html">16. Model Selection</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_overfitting.html">16.1. Overfitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_train_test.html">16.2. Train-Test Split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_cv.html">16.3. Cross-Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_regularization.html">16.4. Regularization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_risk.html">16.5. Model Bias and Variance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16/ms_summary.html">16.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../17/inf_pred_gen_intro.html">17. Theory for Inference and Prediction</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_dist.html">17.1. Distributions: Population, Empirical, Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_HT.html">17.2. Basics of Hypothesis Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_boot.html">17.3. Bootstrapping for Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_CI.html">17.4. Basics of Confidence Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_PI.html">17.5. Basics of Prediction Intervals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_prob.html">17.6. Probability for Inference and Prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../17/inf_pred_gen_summary.html">17.7. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../18/donkey_intro.html">18. Case Study: How to Weigh a Donkey</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../18/donkey_scope.html">18.1. Donkey Study Question and Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18/donkey_clean.html">18.2. Wrangling and Transforming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18/donkey_eda.html">18.3. Exploring</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18/donkey_model.html">18.4. Modeling a Donkey’s Weight</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18/donkey_summary.html">18.5. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Classification</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../19/class_intro.html">19. Classification</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../19/class_example.html">19.1. Example: Wind Damaged Trees</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19/class_pred.html">19.2. Modeling and Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19/class_log_model.html">19.3. Modeling Proportions (and Probabilities)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19/class_loss.html">19.4. A Loss Function for the Logistic Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19/class_dr.html">19.5. From Probabilities to Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19/class_summary.html">19.6. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../20/gd_intro.html">20. Numerical Optimization</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../20/gd_basics.html">20.1. Gradient Descent Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20/gd_example.html">20.2. Minimizing Huber Loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20/gd_convex.html">20.3. Convex and Differentiable Loss Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20/gd_alternative.html">20.4. Variants of Gradient Descent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20/gd_summary.html">20.5. Summary</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../21/fake_news_intro.html">21. Case Study: Detecting Fake News</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../21/fake_news_question.html">21.1. Question and Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21/fake_news_data.html">21.2. Obtaining and Wrangling the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21/fake_news_exploring.html">21.3. Exploring the Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21/fake_news_modeling.html">21.4. Modeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21/fake_news_summary.html">21.5. Summary</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../a01/prob_review.html">Probability Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="../a02/vector_space_review.html">Vector Space Review</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../a04/ref_intro.html">Reference Tables</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../a04/ref_pandas.html">pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../a04/ref_seaborn.html">Seaborn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../a04/ref_matplotlib.html">matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../a04/ref_sklearn.html">scikit-learn</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../a11/contributors.html">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../references.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://datahub.berkeley.edu/hub/user-redirect/git-pull?repo=https%3A//github.com/ds-100/textbook&urlpath=tree/textbook/content/ch/15/linear_case.ipynb&branch=master" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/ch/15/linear_case.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Example: Where is the Land of Opportunity?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explaining-upward-mobility-using-commute-time">15.6.1. Explaining Upward Mobility using Commute Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-upward-mobility-using-multiple-variables">15.6.2. Relating Upward Mobility Using Multiple Variables</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="example-where-is-the-land-of-opportunity">
<span id="sec-linear-case"></span><h1><span class="section-number">15.6. </span>Example: Where is the Land of Opportunity?<a class="headerlink" href="#example-where-is-the-land-of-opportunity" title="Permalink to this heading">#</a></h1>
<p>The US is nicknamed “the land of opportunity” because people believe that in the US
even those with few resources can end up wealthy—economists call this
economic mobility.
In one study, economist Raj Chetty and colleagues did a <a class="reference external" href="https://doi.org/10.1093/qje/qju022">large-scale data analysis on
economic mobility in the US</a>.
His basic question was whether the US is a land of opportunity.
To answer this somewhat vague question, Chetty needed a way to measure economic mobility.</p>
<p>Chetty had access to 2011-12 federal income tax records for everyone born in the US between 1980-82, and their parents tax records filed in their birth year. They matched the 30-year olds to their parents by finding the parents’ 1980-82 tax records that listed them as dependents. In total, his dataset had about 10 million people.
To measure economic mobility, Chetty grouped people born in a particular geographic region whose parents’ income was in the 25th income percentile in 1980-82. He then found the group’s average income percentile in 2011. Chetty calls this average <em>absolute upward mobility</em> (AUM).
If a region’s AUM is 25, then people born into the 25th percentile generally stay in the 25th percentile—they remain where their parents were when they born.
High AUM values mean that the region has more upward mobility.
Those born into the 25 income percentile in these regions generally wind up in a higher income bracket than their parents.
For reference, the US average AUM is about 41 at the time of this writing.
Chetty calculated the AUM for regions called commuting zones (CZ), which are roughly on the
same scale as counties.</p>
<p>While the granularity of the original data is an individual, the data Chetty analyzed has a granularity at the CZ level. Income records can’t be publicly available because of privacy,
but the AUM for a commuting zone can be made available. However, even with the granularity of a commuting zone, not all commuting zones are included in the data set because with 40 features in the data, it might be possible to identify individuals in small CZs. This limitation points to a potential coverage bias. Measurement bias is another potential problem. For example, children born into the 25th income percentile who become extremely wealthy may not file income tax.</p>
<p>We also point out the limitations of working with data that are regional averages, rather than individual measurements. The relationships found between features are often more highly correlated at the aggregate level than at the individual level. This phenomenon is called <em>ecological regression</em>, and interpretations of findings from aggregated data need to be made with care.</p>
<p>Chetty had a hunch that some places in the US have higher economic mobility than others.
His analysis found this to be true.
He found that some cities, such as San Jose, Washington DC, and Seattle, have higher
mobility than others, such as Charlotte, Milwaukee, and Atlanta.
This means that, for example, people move from low to high income brackets in San Jose
at a higher rate compared to Charlotte.
Chetty used linear models to find social and economic
factors like segregation, income inequality, and local school systems
are related to economic mobility.</p>
<p>In this analysis, our outcome variable is the AUM for a commuting zone, since we are
interested in finding features that correlate with AUM.
There are many possible such features in Chetty’s data, but
we first investigate one in particular: the fraction of people in a CZ who have a 15-minute or shorter commute to work.</p>
<section id="explaining-upward-mobility-using-commute-time">
<h2><span class="section-number">15.6.1. </span>Explaining Upward Mobility using Commute Time<a class="headerlink" href="#explaining-upward-mobility-using-commute-time" title="Permalink to this heading">#</a></h2>
<p>We begin our investigation by loading the data into a data frame called <code class="docutils literal notranslate"><span class="pre">cz_df</span></code>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cz_df</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aum</th>
      <th>travel_lt15</th>
      <th>gini</th>
      <th>rel_tot</th>
      <th>...</th>
      <th>taxrate</th>
      <th>worked_14</th>
      <th>foreign</th>
      <th>region</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>38.39</td>
      <td>0.33</td>
      <td>0.47</td>
      <td>0.51</td>
      <td>...</td>
      <td>0.02</td>
      <td>3.75e-03</td>
      <td>1.18e-02</td>
      <td>South</td>
    </tr>
    <tr>
      <th>1</th>
      <td>37.78</td>
      <td>0.28</td>
      <td>0.43</td>
      <td>0.54</td>
      <td>...</td>
      <td>0.02</td>
      <td>4.78e-03</td>
      <td>2.31e-02</td>
      <td>South</td>
    </tr>
    <tr>
      <th>2</th>
      <td>39.05</td>
      <td>0.36</td>
      <td>0.44</td>
      <td>0.67</td>
      <td>...</td>
      <td>0.01</td>
      <td>2.89e-03</td>
      <td>7.08e-03</td>
      <td>South</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>702</th>
      <td>44.12</td>
      <td>0.42</td>
      <td>0.42</td>
      <td>0.29</td>
      <td>...</td>
      <td>0.02</td>
      <td>4.82e-03</td>
      <td>9.85e-02</td>
      <td>West</td>
    </tr>
    <tr>
      <th>703</th>
      <td>41.41</td>
      <td>0.49</td>
      <td>0.41</td>
      <td>0.26</td>
      <td>...</td>
      <td>0.01</td>
      <td>4.39e-03</td>
      <td>4.33e-02</td>
      <td>West</td>
    </tr>
    <tr>
      <th>704</th>
      <td>43.20</td>
      <td>0.24</td>
      <td>0.42</td>
      <td>0.32</td>
      <td>...</td>
      <td>0.02</td>
      <td>3.67e-03</td>
      <td>1.13e-01</td>
      <td>West</td>
    </tr>
  </tbody>
</table>
<p>705 rows × 9 columns</p>
</div></div></div>
</div>
<p>Each row represents one commuting zone.
The column <code class="docutils literal notranslate"><span class="pre">aum</span></code> has the average AUM for people born in the commuting zone in 1980-82 to parents in the 25th income percentile.
There are many columns in this data frame, but for now we focus
on the fraction of people in a CZ that have a 15 minute or shorter commute time,
which is called <code class="docutils literal notranslate"><span class="pre">travel_lt15</span></code>.
We plot AUM against this fraction to look at the relationship between the two variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cz_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;travel_lt15&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;aum&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6f799fd06b75c9c1bf90f07105f2a750b20c81f46cbc9204f76d7c60fecb9736.svg" src="../../_images/6f799fd06b75c9c1bf90f07105f2a750b20c81f46cbc9204f76d7c60fecb9736.svg" /></div>
</div>
<p>The scatter plot shows a rough linear association between AUM and commute time.
Indeed, we find the correlation to be quite strong.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cz_df</span><span class="p">[[</span><span class="s1">&#39;aum&#39;</span><span class="p">,</span> <span class="s1">&#39;travel_lt15&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aum</th>
      <th>travel_lt15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aum</th>
      <td>1.00</td>
      <td>0.68</td>
    </tr>
    <tr>
      <th>travel_lt15</th>
      <td>0.68</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Let’s fit a simple linear model, to explain AUM with commute time.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">cz_df</span><span class="p">[</span><span class="s1">&#39;aum&#39;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">cz_df</span><span class="p">[[</span><span class="s1">&#39;travel_lt15&#39;</span><span class="p">]]</span>

<span class="n">model_ct</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The coefficients from the MSE minimization are:</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Intercept: </span><span class="si">{</span><span class="n">model_ct</span><span class="o">.</span><span class="n">intercept_</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Slope: </span><span class="si">{</span><span class="n">model_ct</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Intercept: 31.3
 Slope: 28.7
</pre></div>
</div>
</div>
</div>
<p>Interestingly, an increase in upward mobility of a CZ is associated with an increase in the fraction of people with a short commute time.</p>
<p>We can compare the SD of the AUM measurements to the SD of the residuals. This comparison gives us a sense of how useful the model is in explaining the AUM.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">model_ct</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">error</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">prediction</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;SD(errors): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;SD(AUM): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">cz_df</span><span class="p">[</span><span class="s1">&#39;aum&#39;</span><span class="p">])</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SD(errors): 4.14
 SD(AUM): 5.61
</pre></div>
</div>
</div>
</div>
<p>The size of the errors about the regression line have decreased from the constant model by about 25%.</p>
<p>Next, we examine the residuals for lack of fit since it can be easier to see potential problems with the fit in a residual plot.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">prediction</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">error</span><span class="p">,</span>
           <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">),</span>
           <span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a0307ab8a671be36e91524877c37b983df86a38bce194486a2c3d36f8eae3c8f.svg" src="../../_images/a0307ab8a671be36e91524877c37b983df86a38bce194486a2c3d36f8eae3c8f.svg" /></div>
</div>
<p>It appears that the errors grow with AUM. We might try a transformation of the response variable, or fitting a model that is quadratic in the commute time fraction. We consider transformations and polynomials in the next section. First we see whether including additional variables offers a more accurate prediction of AUM.</p>
</section>
<section id="relating-upward-mobility-using-multiple-variables">
<h2><span class="section-number">15.6.2. </span>Relating Upward Mobility Using Multiple Variables<a class="headerlink" href="#relating-upward-mobility-using-multiple-variables" title="Permalink to this heading">#</a></h2>
<p>In his original analysis, Chetty created several high-level
features related to segregation, income, K-12 education, etc.
We consider seven of Chetty’s predictors as we aim to build a more informative model for explaining AUM. These are described in <a class="reference internal" href="#tbl-linear-predictors"><span class="std std-numref">Table 15.1</span></a>.</p>
<table class="table" id="tbl-linear-predictors">
<caption><span class="caption-number">Table 15.1 </span><span class="caption-text">Potential explanatory for modeling AUM</span><a class="headerlink" href="#tbl-linear-predictors" title="Permalink to this table">#</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Column name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>travel_lt15</p></td>
<td><p>Fraction of people with a ≤15 minute commute to work.</p></td>
</tr>
<tr class="row-odd"><td><p>gini</p></td>
<td><p>Gini coefficient, an measure of wealth inequality. Values are between 0 and 1, where small values mean wealth is evenly distributed and large values mean more inequality.</p></td>
</tr>
<tr class="row-even"><td><p>rel_tot</p></td>
<td><p>Fraction of people who self-reported as religious.</p></td>
</tr>
<tr class="row-odd"><td><p>single_mom</p></td>
<td><p>Fraction of children with a single mother.</p></td>
</tr>
<tr class="row-even"><td><p>taxrate</p></td>
<td><p>Local tax rate.</p></td>
</tr>
<tr class="row-odd"><td><p>worked_14</p></td>
<td><p>Fraction of 14-16 year old teenagers who work.</p></td>
</tr>
<tr class="row-even"><td><p>foreign</p></td>
<td><p>Fraction of people born outside the US.</p></td>
</tr>
</tbody>
</table>
<p>Let’s first examine the correlations between AUM and the explanatory features and between the explanatory features themselves.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictors</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;travel_lt15&#39;</span><span class="p">,</span> <span class="s1">&#39;gini&#39;</span><span class="p">,</span> <span class="s1">&#39;rel_tot&#39;</span><span class="p">,</span> <span class="s1">&#39;single_mom&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;taxrate&#39;</span><span class="p">,</span> <span class="s1">&#39;worked_14&#39;</span><span class="p">,</span> <span class="s1">&#39;foreign&#39;</span>
<span class="p">]</span>

<span class="n">display_df</span><span class="p">(</span><span class="n">cz_df</span><span class="p">[([</span><span class="s1">&#39;aum&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">predictors</span><span class="p">)]</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">rows</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aum</th>
      <th>travel_lt15</th>
      <th>gini</th>
      <th>rel_tot</th>
      <th>single_mom</th>
      <th>taxrate</th>
      <th>worked_14</th>
      <th>foreign</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>aum</th>
      <td>1.00</td>
      <td>0.68</td>
      <td>-0.60</td>
      <td>0.52</td>
      <td>-0.77</td>
      <td>0.35</td>
      <td>0.65</td>
      <td>-0.03</td>
    </tr>
    <tr>
      <th>travel_lt15</th>
      <td>0.68</td>
      <td>1.00</td>
      <td>-0.56</td>
      <td>0.40</td>
      <td>-0.42</td>
      <td>0.34</td>
      <td>0.60</td>
      <td>-0.19</td>
    </tr>
    <tr>
      <th>gini</th>
      <td>-0.60</td>
      <td>-0.56</td>
      <td>1.00</td>
      <td>-0.29</td>
      <td>0.57</td>
      <td>-0.15</td>
      <td>-0.58</td>
      <td>0.31</td>
    </tr>
    <tr>
      <th>rel_tot</th>
      <td>0.52</td>
      <td>0.40</td>
      <td>-0.29</td>
      <td>1.00</td>
      <td>-0.31</td>
      <td>0.08</td>
      <td>0.28</td>
      <td>-0.11</td>
    </tr>
    <tr>
      <th>single_mom</th>
      <td>-0.77</td>
      <td>-0.42</td>
      <td>0.57</td>
      <td>-0.31</td>
      <td>1.00</td>
      <td>-0.26</td>
      <td>-0.60</td>
      <td>-0.04</td>
    </tr>
    <tr>
      <th>taxrate</th>
      <td>0.35</td>
      <td>0.34</td>
      <td>-0.15</td>
      <td>0.08</td>
      <td>-0.26</td>
      <td>1.00</td>
      <td>0.35</td>
      <td>0.26</td>
    </tr>
    <tr>
      <th>worked_14</th>
      <td>0.65</td>
      <td>0.60</td>
      <td>-0.58</td>
      <td>0.28</td>
      <td>-0.60</td>
      <td>0.35</td>
      <td>1.00</td>
      <td>-0.15</td>
    </tr>
    <tr>
      <th>foreign</th>
      <td>-0.03</td>
      <td>-0.19</td>
      <td>0.31</td>
      <td>-0.11</td>
      <td>-0.04</td>
      <td>0.26</td>
      <td>-0.15</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We see that the fraction of single mothers in the commuting zone has the strongest correlation with AUM, which implies that it is also the single best feature to explain AUM.
In addition, we see that several explanatory variables are highly correlated with each other; the Gini coefficient is highly correlated with the fraction of teenagers who work, the fraction of single mothers, and the fraction with less than a 15-minute commute. With such highly correlated features, we need to take care in interpreting the coefficients because several different models might equally explain AUM with the covariates standing in for one another.</p>
<p>To begin, we can consider all possible two-feature models to see which one has the smallest prediction error. Chetty derived 40 potential variables to use as predictors, which would have us checking <span class="math notranslate nohighlight">\((40 \times 39) /2 = 780\)</span> models. Fitting models, with all pairs, triples, etc. of variables quickly grows out of control. And, can lead to finding spurious correlations (see <a class="reference internal" href="../17/inf_pred_gen_intro.html#ch-inf-pred-theory"><span class="std std-numref">Chapter 17</span></a>).</p>
<p>Here, we keep things a bit simple and examine just one two-variable model that includes the travel time and single mother features. After that, we look at the model that has all 7 numeric explanatory features in our data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X2</span> <span class="o">=</span> <span class="n">cz_df</span><span class="p">[[</span><span class="s1">&#39;travel_lt15&#39;</span><span class="p">,</span> <span class="s1">&#39;single_mom&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">cz_df</span><span class="p">[</span><span class="s1">&#39;aum&#39;</span><span class="p">]</span>

<span class="n">model_ct_sm</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Intercept: </span><span class="si">{</span><span class="n">model_ct_sm</span><span class="o">.</span><span class="n">intercept_</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;Fraction with under 15 minute commute coefficient: </span><span class="si">{</span><span class="n">model_ct_sm</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>  
      <span class="sa">f</span><span class="s2">&quot;Fraction of single moms coefficient: </span><span class="si">{</span><span class="n">model_ct_sm</span><span class="o">.</span><span class="n">coef_</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Intercept: 49.0 
 Fraction with under 15 minute commute coefficient: 18.10 
 Fraction of single moms coefficient: 18.10
</pre></div>
</div>
</div>
</div>
<p>Notice that the coefficient for travel time is quite different than the coefficient for this variable in the simple linear model. That’s because the two features in our model are highly correlated.</p>
<p>Next we compare the errors from the two fits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction_ct_sm</span> <span class="o">=</span> <span class="n">model_ct_sm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X2</span><span class="p">)</span>
<span class="n">error_ct_sm</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">prediction_ct_sm</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; SD(errors in model 1): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">error</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
      <span class="sa">f</span><span class="s2">&quot;SD(errors in model 2): </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">error_ct_sm</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> SD(errors in model 1): 4.14
 SD(errors in model 2): 2.85
</pre></div>
</div>
</div>
</div>
<p>The SD of the residuals have been reduced by another 30%. Adding a second variable to the model seems worth the extra complexity.</p>
<p>Let’s again visually examine the residuals. We use the same scale on the <span class="math notranslate nohighlight">\(y\)</span>-axis to make it easier to compare this residual plot with the plot for the one-variable model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">prediction_ct_sm</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">error_ct_sm</span><span class="p">,</span>
           <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">),</span>
           <span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/89091dca4062ca3f983761ca413adc32cfbe5296b16a484bff475e65a92e42fa.svg" src="../../_images/89091dca4062ca3f983761ca413adc32cfbe5296b16a484bff475e65a92e42fa.svg" /></div>
</div>
<p>The larger variability in the errors for higher AUM is even more evident. The implications are that the estimates, <span class="math notranslate nohighlight">\(\hat{y}\)</span>, are unaffected, but their accuracy depends on AUM. This problem can be addressed with <em>weighted regression</em>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Once again, we point out that data scientists from different backgrounds use
different terminology to refer to the same concept.
For example, the terminology that calls each row in the design matrix <span class="math notranslate nohighlight">\(\textbf{X}\)</span> an observation and each column a variable is more common among people with backgrounds in statistics.
Others say that each column of the design matrix represents a <em>feature</em> or that each row represents a <em>record</em>.
Also, we say that our overall process of fitting and interpreting models
is called <em>modeling</em>, while others call it <em>machine learning</em>.</p>
</div>
<p>Now, let’s fit a multiple linear model that uses all seven variables to explain upward mobility. After fitting the model, we again plot the errors using the same <span class="math notranslate nohighlight">\(y\)</span>-axis scale as in the previous two residual plots.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X7</span> <span class="o">=</span> <span class="n">cz_df</span><span class="p">[</span><span class="n">predictors</span><span class="p">]</span>
<span class="n">model_7var</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X7</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">prediction_7var</span> <span class="o">=</span> <span class="n">model_7var</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X7</span><span class="p">)</span>
<span class="n">error_7var</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">prediction_7var</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">prediction_7var</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">error_7var</span><span class="p">,</span>
           <span class="n">labels</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;prediction&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;error&#39;</span><span class="p">),</span>
           <span class="n">width</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">add_hline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">line_width</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line_dash</span><span class="o">=</span><span class="s1">&#39;dash&#39;</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">update_yaxes</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/46e189a15d32f27b017ac3a6a73bde05c2a00c01091e1c530ec33386d3ee5dd2.svg" src="../../_images/46e189a15d32f27b017ac3a6a73bde05c2a00c01091e1c530ec33386d3ee5dd2.svg" /></div>
</div>
<p>The model with seven features does not appear to be much better than the two-variable model. In fact, the standard deviation of the residuals has only decreased by 8%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_7var</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.588739233574256
</pre></div>
</div>
</div>
</div>
<p>We can compare the Multiple <span class="math notranslate nohighlight">\(R^2\)</span> for these three models. (The adjustment for the number of features in the model makes little difference for us since we have over 700 observations.)</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; R-square for 7-variable model: </span><span class="si">{</span><span class="n">model_7var</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X7</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
     <span class="sa">f</span><span class="s2">&quot;R-square for 2-variable model: </span><span class="si">{</span><span class="n">model_ct_sm</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X2</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
     <span class="sa">f</span><span class="s2">&quot;R-square for 1-variable model: </span><span class="si">{</span><span class="n">model_ct</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> R-square for 7-variable model: 0.79
 R-square for 2-variable model: 0.74
 R-square for 1-variable model: 0.46
</pre></div>
</div>
</div>
</div>
<p>We confirm our earlier findings that two variables greatly improves the explanatory capability of the model, and the seven-variable model offers little improvement over the two-variable model. The small gain is not worth the added complexity of the model.</p>
<p>So far, our models have used only numeric predictor variables.
But, categorical data is often useful for model fitting as well. Additionally, in <a class="reference internal" href="../10/eda_intro.html#ch-eda"><span class="std std-numref">Chapter 10</span></a> we transformed variables and created new variables from combinations of variables. We address how to incorporate these variables into linear models next.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./ch/15"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="linear_multi_fit.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">15.5. </span>Fitting the Multiple Linear Model</p>
      </div>
    </a>
    <a class="right-next"
       href="linear_feature_eng.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">15.7. </span>Feature Engineering for Numeric Measurements</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#explaining-upward-mobility-using-commute-time">15.6.1. Explaining Upward Mobility using Commute Time</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#relating-upward-mobility-using-multiple-variables">15.6.2. Relating Upward Mobility Using Multiple Variables</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sam Lau, Joey Gonzalez, and Deb Nolan
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
License: CC BY-NC-ND 4.0
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>