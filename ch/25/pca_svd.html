
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>25.2. PCA using the Singular Value Decomposition &#8212; Principles and Techniques of Data Science</title>
    
  <link rel="stylesheet" href="../../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="25.3. PCA in Practice" href="pca_in_practice.html" />
    <link rel="prev" title="25.1. Dimensions of a Data Table" href="pca_dims.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Principles and Techniques of Data Science</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../preface.html">
   To the Reader
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../prereqs.html">
   Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notation.html">
   Notation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  The Data Science Lifecycle
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../01/lifecycle_intro.html">
   1. The Data Science Lifecycle
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_1.html">
     1.1. The Students of Data 100
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_2.html">
     1.2. Exploratory Data Analysis
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01/lifecycle_students_3.html">
     1.3. What’s in a Name?
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../02/design_intro.html">
   2. Generalizing from Data
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_dewey_truman.html">
     2.1. Dewey Defeats Truman
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_data.html">
     2.2. [In Progress] Data Design
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_sampling.html">
     2.3. Probability Sampling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02/design_srs_vs_big_data.html">
     2.4. SRS vs. “Big Data”
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../03/modeling_intro.html">
   3. Modeling and Estimation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../03/modeling_simple.html">
     3.1. Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/modeling_loss_functions.html">
     3.2. Loss Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03/modeling_abs_huber.html">
     3.3. Absolute and Huber Loss
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04/cycle_case_study_intro.html">
   4. [In progress] Case Study
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Rectangular Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../05/sql_intro.html">
   5. Relational Databases and SQL
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql_rdbms.html">
     5.1. The Relational Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql_basics.html">
     5.2. SQL
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../05/sql_joins.html">
     5.3. SQL Joins
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../06/pandas_intro.html">
   6. Data Tables in Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../06/pandas_indexes.html">
     6.1. Indexes, Slicing, and Sorting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/pandas_grouping_pivoting.html">
     6.2. Grouping and Pivoting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/pandas_apply_strings_plotting.html">
     6.3. Apply, Strings, and Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../06/pandas_joins.html">
     6.4. [In progress] Joins
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Preparing and Exploring Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../07/repr_intro.html">
   7. [In Progress] Data Representation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../07/repr_structure.html">
     7.1. Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/repr_semantics.html">
     7.2. [In Progress] Semantics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/repr_data_types.html">
     7.3. Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../07/repr_granularity.html">
     7.4. Granularity
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08/quality_intro.html">
   8. [In Progress] Data Quality
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09/eda_intro.html">
   9. [In Progress] Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../10/viz_intro.html">
   10. Data Visualization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_quantitative.html">
     10.1. Visualizing Quantitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_qualitative.html">
     10.2. Visualizing Qualitative Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_matplotlib.html">
     10.3. Customizing Plots using
     <code class="docutils literal notranslate">
      <span class="pre">
       matplotlib
      </span>
     </code>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_principles.html">
     10.4. Visualization Principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_principles_2.html">
     10.5. Visualization Principles Continued
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../10/viz_philosophy.html">
     10.6. Philosophy for Data Visualization
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../11/police_intro.html">
   11. [In progress] Case Study: Berkeley Policing
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../11/police_calls.html">
     11.1. Cleaning the Calls Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../11/police_stops.html">
     11.2. Cleaning The Stops Dataset
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Other Data Sources
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../12/text_intro.html">
   12. Working with Text
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../12/text_strings.html">
     12.1. Python String Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/text_regex.html">
     12.2. Regular Expressions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../12/text_re.html">
     12.3. Regex and Python
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../13/web_intro.html">
   13. Web Technologies
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../13/web_http.html">
     13.1. HTTP
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/web_rest.html">
     13.2. [In Progress] REST
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../13/web_html.html">
     13.3. [In Progress] XPath and HTML
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Linear Modeling
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../14/linear_models.html">
   14. Linear Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../14/linear_tips.html">
     14.1. Predicting Tip Amounts
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14/linear_fitting.html">
     14.2. [In progress] Fitting a linear model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14/linear_inference.html">
     14.3. [In progress] Inference for Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../14/linear_projection.html">
     14.4. Least Squares — A Geometric Perspective
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../15/prob_and_gen.html">
   15. Probability and Generalization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../15/prob_random_vars.html">
     15.1. Random Variables
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15/prob_exp_var.html">
     15.2. Expectation and Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../15/prob_risk.html">
     15.3. Risk
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../16/gradient_descent.html">
   16. Gradient Descent and Numerical Optimization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../16/gradient_basics.html">
     16.1. Loss Minimization Using a Program
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/gradient_descent_define.html">
     16.2. Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/gradient_convexity.html">
     16.3. Convexity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/gradient_stochastic.html">
     16.4. Stochastic Gradient Descent
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../16/gradient_lin_reg.html">
     16.5. Fitting a Linear Model Using Gradient Descent
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../17/donkey_intro.html">
   17. [In progress] Case Study: Donkey Dimensions
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../17/donkey_analysis.html">
     17.1. Linear Regression Case Study
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Multiple Linear Modeling
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../18/mult_intro.html">
   18. [In progress] Multiple Linear Regression
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../18/mult_model.html">
     18.1. Multiple Linear Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../18/mult_inference.html">
     18.2. Inference for Multiple Linear Regression
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../19/feature_engineering.html">
   19. Feature Engineering
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../19/feature_one_hot.html">
     19.1. The Walmart dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../19/feature_polynomial.html">
     19.2. Predicting Ice Cream Ratings
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../20/bias_intro.html">
   20. The Bias-Variance Tradeoff
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../20/bias_risk.html">
     20.1. Risk and Loss Minimization
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20/bias_modeling.html">
     20.2. Model Bias and Variance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../20/bias_cv.html">
     20.3. Cross-Validation
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../21/reg_intro.html">
   21. Regularization
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../21/reg_intuition.html">
     21.1. Regularization Intuition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21/reg_ridge.html">
     21.2. L2 Regularization: Ridge Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../21/reg_lasso.html">
     21.3. L1 Regularization: Lasso Regression
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../22/mult_case_intro.html">
   22. [In progress] Case Study: Multiple Linear Models
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Classification
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../23/classification_intro.html">
   23. Classification
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_prob.html">
     23.1. Regression on Probabilities
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_log_model.html">
     23.2. The Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_cost.html">
     23.3. A Loss Function for the Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_log_reg.html">
     23.4. Using Logistic Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_cost_justification.html">
     23.5. Approximating the Empirical Probability Distribution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_sgd.html">
     23.6. Fitting a Logistic Model
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_sensitivity_specificity.html">
     23.7. Evaluating Logistic Models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../23/classification_multiclass.html">
     23.8. Multiclass Classification
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Replicability
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../24/repl_intro.html">
   24. [In progress] Replicable Research
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../24/repl_phacking.html">
     24.1. P-hacking
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Extra Topics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="pca_intro.html">
   25. Dimensionality Reduction and PCA
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="pca_dims.html">
     25.1. Dimensions of a Data Table
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     25.2. PCA using the Singular Value Decomposition
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pca_in_practice.html">
     25.3. PCA in Practice
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../26/dtrees_intro.html">
   26. [In progress] Decision Trees and Random Forests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../27/clustering_intro.html">
   27. [In progress] Clustering
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../a01/prob_review.html">
   Probability Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../a02/vector_space_review.html">
   Vector Space Review
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../a03/hyp_intro.html">
   Statistical Inference Review
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../a03/hyp_introduction.html">
     Hypothesis Testing and Confidence Intervals
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../a03/hyp_introduction_part2.html">
     Permutation Test
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../a04/ref_intro.html">
   Reference Tables
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../a04/ref_pandas.html">
     pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../a04/ref_seaborn.html">
     Seaborn
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../a04/ref_matplotlib.html">
     matplotlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../a04/ref_sklearn.html">
     scikit-learn
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../a05/contributors.html">
   Contributors
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/ch/25/pca_svd.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ch/25/pca_svd.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-singular-value-decomposition">
   25.2.1. The Singular Value Decomposition
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-the-svd-in-python">
     25.2.1.1. Computing the SVD in Python
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-directions">
   25.2.2. Principal Directions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#principal-component-analysis">
   25.2.3. Principal Component Analysis
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rank-k-approximation">
   25.2.4. Rank-k Approximation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   25.2.5. Summary
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pca-using-the-singular-value-decomposition">
<h1><span class="section-number">25.2. </span>PCA using the Singular Value Decomposition<a class="headerlink" href="#pca-using-the-singular-value-decomposition" title="Permalink to this headline">¶</a></h1>
<p>This section introduces the <strong>singular value decomposition (SVD)</strong>, a tool from linear algebra that computes the principal components of a matrix. We use SVD as a step in <strong>principal component analysis (PCA)</strong>.</p>
<p>Why are linear algebra techniques useful for data analysis? Here’s one analogy. We use basic algebraic operators like addition and multiplication to summarize one-dimensional data. For example, we can compute the mean and standard deviation of the heights of Data 100 students, a one-dimensional dataset. Linear algebra provides us with matrix operators which generalize algebraic operations to multidimensional data. For instance, we can view matrix multiplication as a more general version of scalar multiplication. Linear algebra operators allow us to summarize and analyze multidimensional data.</p>
<p>In data analysis, we often examine data tables using both the domain of interest and linear algebra techniques. For example, we can say that every row of this data table contains the votes of a single congressperson.</p>
<div class="cell tag_remove-input docutils container">
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>515</th>
      <th>516</th>
      <th>517</th>
      <th>518</th>
      <th>...</th>
      <th>552</th>
      <th>553</th>
      <th>554</th>
      <th>555</th>
    </tr>
    <tr>
      <th>member</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A000055</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A000367</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>A000369</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Y000062</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Y000065</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Z000017</th>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>441 rows × 41 columns</p>
</div></div></div>
</div>
<p>This view allows us to answer questions like: “Were there any bills that were unanimously voted for?”.</p>
<p>But we can also view this same table as a 441 x 41 matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf X = \begin{bmatrix}
1 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 \\
  &amp;   &amp; \vdots &amp;   &amp;   \\
0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 \\
1 &amp; 1 &amp; \cdots &amp; 1 &amp; 0 \\
\end{bmatrix}
\end{split}\]</div>
<p>Viewing data as a matrix gives us access to the rich library of tools from linear algebra, including the SVD. This allows us to answer another set of questions, such as: “What patterns of voting emerge from all the votes?”</p>
<div class="section" id="the-singular-value-decomposition">
<h2><span class="section-number">25.2.1. </span>The Singular Value Decomposition<a class="headerlink" href="#the-singular-value-decomposition" title="Permalink to this headline">¶</a></h2>
<p>The singular value decomposition expresses any <span class="math notranslate nohighlight">\( n \times d \)</span> matrix <span class="math notranslate nohighlight">\( \mathbf X \)</span> as a product of three matrices <span class="math notranslate nohighlight">\( \mathbf U \)</span>, <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span>, and <span class="math notranslate nohighlight">\( \mathbf V \)</span>:</p>
<div class="math notranslate nohighlight">
\[
\begin{aligned}
\mathbf{X} &amp;= \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top}
\end{aligned}
\]</div>
<p>There are restrictions on <span class="math notranslate nohighlight">\( \mathbf U \)</span>, <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span>, and <span class="math notranslate nohighlight">\( \mathbf V \)</span>:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\( \mathbf U \)</span> has dimensions <span class="math notranslate nohighlight">\( n \times n \)</span>, <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span> has dimensions <span class="math notranslate nohighlight">\( n \times d \)</span>, and <span class="math notranslate nohighlight">\( \mathbf V \)</span> has dimensions <span class="math notranslate nohighlight">\( d \times d \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf U \)</span> and <span class="math notranslate nohighlight">\( \mathbf V \)</span> are orthogonal matrices. That is, <span class="math notranslate nohighlight">\( \mathbf U^\top \mathbf U = \mathbf I \)</span> and <span class="math notranslate nohighlight">\( \mathbf V^\top \mathbf V = \mathbf I \)</span>. This also implies that all columns of <span class="math notranslate nohighlight">\( \mathbf{U} \)</span> and <span class="math notranslate nohighlight">\( \mathbf{V} \)</span> have magnitude 1 and are mutually orthogonal.</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span> is a diagonal matrix. That is, all elements in <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span> are 0 unless they lie on the diagonal. In addition, the diagonal elements in <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span> are arranged from biggest to smallest.</p></li>
</ol>
<p>As a simple example, if we have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathbf{X} = \begin{bmatrix}
1 &amp; 0 \\
0 &amp; 4 \\
0 &amp; 0 \\
\end{bmatrix}
\end{aligned}
\end{split}\]</div>
<p>The SVD of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathbf{X}
&amp;= \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \\
&amp;= \begin{bmatrix}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
\begin{bmatrix}
4 &amp; 0 \\
0 &amp; 1 \\
0 &amp; 0 \\
\end{bmatrix}
\begin{bmatrix}
0 &amp; 1 \\
1 &amp; 0 \\
\end{bmatrix}
\end{aligned}
\end{split}\]</div>
<p>We can check that this decomposition reproduces <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="p">])</span>

<span class="n">U</span> <span class="o">@</span> <span class="n">S</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0],
       [0, 4],
       [0, 0]])
</pre></div>
</div>
</div>
</div>
<p>We can also check that the matrices <span class="math notranslate nohighlight">\( \mathbf U \)</span>, <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span>, and <span class="math notranslate nohighlight">\( \mathbf V \)</span> fulfill the requirements of the SVD.</p>
<p>First: <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> has dimensions <span class="math notranslate nohighlight">\( 3 \times 2 \)</span>. <span class="math notranslate nohighlight">\( \mathbf U \)</span> has dimensions <span class="math notranslate nohighlight">\( 3 \times 3 \)</span>, <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span> has dimensions <span class="math notranslate nohighlight">\( 3 \times 2 \)</span>, and <span class="math notranslate nohighlight">\( \mathbf V \)</span> has dimensions <span class="math notranslate nohighlight">\( 2 \times 2 \)</span>.</p>
<p>Second: <span class="math notranslate nohighlight">\( \mathbf U \)</span> and <span class="math notranslate nohighlight">\( \mathbf V \)</span> are orthogonal matrices:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span> <span class="o">@</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 1, 0],
       [0, 0, 1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span> <span class="o">@</span> <span class="n">V</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0],
       [0, 1]])
</pre></div>
</div>
</div>
</div>
<p>Third: <span class="math notranslate nohighlight">\( \mathbf \Sigma \)</span> is diagonal, and its diagonal elements are arranged from greatest to least.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">S</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[4, 0],
       [0, 1],
       [0, 0]])
</pre></div>
</div>
</div>
</div>
<div class="section" id="computing-the-svd-in-python">
<h3><span class="section-number">25.2.1.1. </span>Computing the SVD in Python<a class="headerlink" href="#computing-the-svd-in-python" title="Permalink to this headline">¶</a></h3>
<p>To compute the SVD in Python, we use the <code class="docutils literal notranslate"><span class="pre">np.linalg.svd</span></code> function:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">])</span>
<span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[0., 1., 0.],
        [1., 0., 0.],
        [0., 0., 1.]]),
 array([4., 1.]),
 array([[0., 1.],
        [1., 0.]]))
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">np.linalg.svd</span></code> returns a tuple of three arrays corresponding to <span class="math notranslate nohighlight">\( \mathbf{U} \)</span>, <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span>, and <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>. Notice that the <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span> value is one-dimensional numpy array rather than a diagonal matrix, which can cause problems recreating <span class="math notranslate nohighlight">\(\mathbf{X}\)</span> using the return values of <code class="docutils literal notranslate"><span class="pre">np.linalg.svd</span></code>. For convenience, we often use <code class="docutils literal notranslate"><span class="pre">full_matrices=False</span></code> in our call to <code class="docutils literal notranslate"><span class="pre">np.linalg.svd</span></code>, which reduces the dimensions of <span class="math notranslate nohighlight">\( \mathbf{U} \)</span> or <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> to match the dimensions of <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[0., 1.],
        [1., 0.],
        [0., 0.]]),
 array([4., 1.]),
 array([[0., 1.],
        [1., 0.]]))
</pre></div>
</div>
</div>
</div>
<p>This allows us to use <code class="docutils literal notranslate"><span class="pre">np.diag</span></code> to create the diagonal matrix <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span> and reproduce the original <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">U</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span> <span class="o">@</span> <span class="n">Vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 4.],
       [0., 0.]])
</pre></div>
</div>
</div>
</div>
<p>This takes advantage of the fact that an all-zero row in a matrix multiplication can be removed, in this case:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathbf{X}
&amp;= \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \\
&amp;= \begin{bmatrix}
0 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 0\\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
\begin{bmatrix}
4 &amp; 0 \\
0 &amp; 1 \\
0 &amp; 0 \\
\end{bmatrix}
\begin{bmatrix}
0 &amp; 1 \\
1 &amp; 0 \\
\end{bmatrix} \\
&amp;=
\begin{bmatrix}
0 &amp; 1 \\
1 &amp; 0 \\
0 &amp; 0 \\
\end{bmatrix}
\begin{bmatrix}
4 &amp; 0 \\
0 &amp; 1 \\
\end{bmatrix}
\begin{bmatrix}
0 &amp; 1 \\
1 &amp; 0 \\
\end{bmatrix}
\end{aligned}
\end{split}\]</div>
<p>Note that we select this example for simplicity. As we will soon see, for real datasets the elements of <span class="math notranslate nohighlight">\( \mathbf{U} \)</span>, <span class="math notranslate nohighlight">\( \mathbf{\Sigma} \)</span>, and <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> are rarely integers.</p>
</div>
</div>
<div class="section" id="principal-directions">
<h2><span class="section-number">25.2.2. </span>Principal Directions<a class="headerlink" href="#principal-directions" title="Permalink to this headline">¶</a></h2>
<p>SVD takes a data matrix <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> and produces the matrix factorization <span class="math notranslate nohighlight">\(\mathbf{X} = \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top}\)</span>. This factorization has useful properties that we use to perform dimensionality reduction.</p>
<p>First, we examine <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>. The rows of <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> (or equivalently the columns of the untransposed <span class="math notranslate nohighlight">\( \mathbf{V} \)</span>) contain the <strong>principal directions</strong> for the matrix <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>. Consider the following dataset of country-level child mortality and fertility:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;child_data.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;country&#39;</span><span class="p">)</span>
<span class="n">child_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mortality</th>
      <th>fertility</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>6.82</td>
      <td>4.48</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>1.33</td>
      <td>1.71</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>2.39</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Yemen</th>
      <td>5.30</td>
      <td>3.89</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>6.16</td>
      <td>4.93</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>5.68</td>
      <td>3.68</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 2 columns</p>
</div></div></div>
</div>
<p>To examine the principal directions of this data matrix, we first <strong>center</strong> the data by subtracting the mean of each column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cntr_child</span> <span class="o">=</span> <span class="n">child_data</span> <span class="o">-</span> <span class="n">child_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cntr_child</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mortality</th>
      <th>fertility</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>3.79</td>
      <td>1.70</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>-1.70</td>
      <td>-1.07</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>-0.64</td>
      <td>-0.07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Yemen</th>
      <td>2.27</td>
      <td>1.11</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>3.13</td>
      <td>2.15</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>2.65</td>
      <td>0.90</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 2 columns</p>
</div></div></div>
</div>
<p>Then, we compute the SVD and display the values in <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">cntr_child</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">Vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.93, -0.37],
       [-0.37,  0.93]])
</pre></div>
</div>
</div>
</div>
<p>We plot the rows of <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> as vectors on top of a scatter plot of the original data (we scaled the vectors for presentation). The first row of <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> is drawn in red, and the second in purple.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cntr_child</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mortality&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;fertility&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Vt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="mi">3</span> <span class="o">*</span> <span class="n">Vt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">arrow</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Vt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">Vt</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/pca_svd_35_0.png" src="../../_images/pca_svd_35_0.png" />
</div>
</div>
<p>Observe that the principal directions of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>, or the rows of <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>, seem to align themselves with the direction that the data vary. This is no coincidence: the principal directions of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> are precisely the orthogonal directions where <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> has the greatest variance.</p>
<p>As another example, we plot the principal directions for a dataset of human abdomen and density measurements. Again, the first principal direction is drawn in red and the second in purple.</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<img alt="../../_images/pca_svd_38_0.png" src="../../_images/pca_svd_38_0.png" />
</div>
</div>
</div>
<div class="section" id="principal-component-analysis">
<h2><span class="section-number">25.2.3. </span>Principal Component Analysis<a class="headerlink" href="#principal-component-analysis" title="Permalink to this headline">¶</a></h2>
<p>We can use principal directions to sketch a procedure for dimensionality reduction. First, we find the principal directions of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> by centering <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>, then using the SVD. If <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> has 100 dimensions, this will produce 100 principal directions. Next, we decide how many dimensions we want to reduce to; a common choice is 2. To reduce to 2 dimensions, we keep the first two principal directions and throw out the other 98. Finally, we project the data onto the first two directions. This is <strong>principal component analysis (PCA)</strong>, a method for dimensionality reduction.</p>
<p>To illustrate PCA, we will reduce the mortality/fertility dataset from two dimensions to one dimension. The data is loaded in the <code class="docutils literal notranslate"><span class="pre">child_data</span></code> DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">child_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mortality</th>
      <th>fertility</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>6.82</td>
      <td>4.48</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>1.33</td>
      <td>1.71</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>2.39</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Yemen</th>
      <td>5.30</td>
      <td>3.89</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>6.16</td>
      <td>4.93</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>5.68</td>
      <td>3.68</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 2 columns</p>
</div></div></div>
</div>
<p>As before, we center <code class="docutils literal notranslate"><span class="pre">child_data</span></code> by subtracting each column by its column mean.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cntr_child</span> <span class="o">=</span> <span class="n">child_data</span> <span class="o">-</span> <span class="n">child_data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">cntr_child</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mortality</th>
      <th>fertility</th>
    </tr>
    <tr>
      <th>country</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Afghanistan</th>
      <td>3.79</td>
      <td>1.70</td>
    </tr>
    <tr>
      <th>Albania</th>
      <td>-1.70</td>
      <td>-1.07</td>
    </tr>
    <tr>
      <th>Algeria</th>
      <td>-0.64</td>
      <td>-0.07</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Yemen</th>
      <td>2.27</td>
      <td>1.11</td>
    </tr>
    <tr>
      <th>Zambia</th>
      <td>3.13</td>
      <td>2.15</td>
    </tr>
    <tr>
      <th>Zimbabwe</th>
      <td>2.65</td>
      <td>0.90</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 2 columns</p>
</div></div></div>
</div>
<p>Next, we find the SVD of this data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">svd</span><span class="p">(</span><span class="n">cntr_child</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[-0.1 ,  0.02],
        [ 0.05, -0.04],
        [ 0.01,  0.02],
        ...,
        [-0.06,  0.02],
        [-0.09,  0.1 ],
        [-0.06, -0.02]]),
 array([43.48,  8.2 ]),
 array([[-0.93, -0.37],
        [-0.37,  0.93]]))
</pre></div>
</div>
</div>
</div>
<p>Recall that SVD computes <span class="math notranslate nohighlight">\(\mathbf{X} = \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top}\)</span>, and the matrix <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> contains the two principal directions of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>. To remove a direction, we simply drop the last row from <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vt</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.93, -0.37]])
</pre></div>
</div>
</div>
</div>
<p>Finally, we project the original data points <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> onto the single principal direction. Since the SVD enforces that principal directions in <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> have magnitude one, this a simply a matrix multiplication <span class="math notranslate nohighlight">\( \mathbf{X} \mathbf{V} \)</span>, after removing a direction from <span class="math notranslate nohighlight">\( \mathbf{V} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">@</span> <span class="n">Vt</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.15],
       [ 1.98],
       [ 0.62],
       ...,
       [-2.52],
       [-3.7 ],
       [-2.79]])
</pre></div>
</div>
</div>
</div>
<p>We have successfully performed PCA to reduce <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> from 2 dimensions to 1. Dimensionality reduction attempts to summarize the data with fewer dimensions while preserving patterns in the data. One way to verify this is to check that points that appear together in the two-dimensional data (scatter plot) also appear together one-dimensional data (rug plot).</p>
<p><img alt="pca_svd_one_vs_two.png" src="../../_images/pca_svd_one_vs_two.png" /></p>
<p>In practice, we use a simpler method to compute the reduced dimension <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> which arises from the following equivalence:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\mathbf{X} &amp;= \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \\
\mathbf{X} \mathbf{V} &amp;= \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \mathbf{V} &amp; \text{Right-multiply by $ \mathbf{V} $} \\
\mathbf{X} \mathbf{V} &amp;= \mathbf{U} \mathbf{\Sigma} &amp; \text{Since $ \mathbf{V^\top} \mathbf{V} = \mathbf{I} $} \\
\end{aligned}
\end{split}\]</div>
<p>This means that instead of removing rows from <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span> and then computing <span class="math notranslate nohighlight">\( \mathbf{X} \mathbf{V} \)</span> , we can compute <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> and then remove columns until we achieve our desired dimensionality. For this reason, we call the columns of <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> the <strong>principal components</strong> of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>.</p>
<p>To reduce <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> from 2 to 1 dimension, we can compute the principal components:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcs</span> <span class="o">=</span> <span class="n">U</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
<span class="n">pcs</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.15,  0.19],
       [ 1.98, -0.36],
       [ 0.62,  0.18],
       ...,
       [-2.52,  0.2 ],
       [-3.7 ,  0.85],
       [-2.79, -0.13]])
</pre></div>
</div>
</div>
</div>
<p>Then drop the rightmost column:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pcs</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.15],
       [ 1.98],
       [ 0.62],
       ...,
       [-2.52],
       [-3.7 ],
       [-2.79]])
</pre></div>
</div>
</div>
</div>
<p>Notice that this produces the same result as right multiplying <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> with a truncated <span class="math notranslate nohighlight">\( \mathbf{V} \)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">@</span> <span class="n">Vt</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4.15],
       [ 1.98],
       [ 0.62],
       ...,
       [-2.52],
       [-3.7 ],
       [-2.79]])
</pre></div>
</div>
</div>
</div>
<p>With this, we can describe the final procedure for PCA. To reduce an <span class="math notranslate nohighlight">\( n \times d \)</span> matrix <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> to <span class="math notranslate nohighlight">\( k \)</span> dimensions (where <span class="math notranslate nohighlight">\( k &lt; d \)</span>), we perform the following steps:</p>
<ol class="simple">
<li><p>Center <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> .</p></li>
<li><p>Use the SVD to find <span class="math notranslate nohighlight">\( \mathbf{X} = \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \)</span> .</p></li>
<li><p>Compute the principal components <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> .</p></li>
<li><p>Keep the first <span class="math notranslate nohighlight">\( k \)</span> columns of <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> .</p></li>
</ol>
</div>
<div class="section" id="rank-k-approximation">
<h2><span class="section-number">25.2.4. </span>Rank-k Approximation<a class="headerlink" href="#rank-k-approximation" title="Permalink to this headline">¶</a></h2>
<p>We can also use PCA to construct a <strong>rank-k approximation</strong> of <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>, which produces a rank <span class="math notranslate nohighlight">\( k \)</span> matrix with the same dimensions as <span class="math notranslate nohighlight">\( \mathbf{X} \)</span>. The rank-k appromixation projects the points in <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> onto the top <span class="math notranslate nohighlight">\( k \)</span> principal directions. The procedure is similar to that of PCA:</p>
<ol class="simple">
<li><p>Center <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> .</p></li>
<li><p>Use the SVD to find <span class="math notranslate nohighlight">\( \mathbf{X} = \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \)</span> .</p></li>
<li><p>Keep the first <span class="math notranslate nohighlight">\( k \)</span> columns of <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> , and the first <span class="math notranslate nohighlight">\( k \)</span> rows of <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\( \mathbf{X} \approx \mathbf{U} \mathbf{\Sigma} \mathbf{V^\top} \)</span> with the reduced <span class="math notranslate nohighlight">\( \mathbf{U} \mathbf{\Sigma} \)</span> and <span class="math notranslate nohighlight">\( \mathbf{V^\top} \)</span>.</p></li>
</ol>
<p>The function below provides an implementation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">compute_rank_k_approximation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="n">centered</span> <span class="o">=</span> <span class="n">data</span> <span class="o">-</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">centered</span><span class="p">,</span> <span class="n">full_matrices</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">approx</span> <span class="o">=</span> <span class="p">(</span><span class="n">U</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">S</span><span class="p">))[:,</span> <span class="p">:</span><span class="n">k</span><span class="p">]</span> <span class="o">@</span> <span class="n">Vt</span><span class="p">[:</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">approx</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>As an example, we will compute the rank-1 approximation of the mortality/fertility data:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rank_1</span> <span class="o">=</span> <span class="n">compute_rank_k_approximation</span><span class="p">(</span><span class="n">child_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">rank_1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mortality</th>
      <th>fertility</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.86</td>
      <td>1.53</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.84</td>
      <td>-0.73</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.58</td>
      <td>-0.23</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>180</th>
      <td>2.34</td>
      <td>0.93</td>
    </tr>
    <tr>
      <th>181</th>
      <td>3.44</td>
      <td>1.36</td>
    </tr>
    <tr>
      <th>182</th>
      <td>2.60</td>
      <td>1.03</td>
    </tr>
  </tbody>
</table>
<p>183 rows × 2 columns</p>
</div></div></div>
</div>
<p>We plot the original data in blue and the rank-1 approximation in orange:</p>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fa88197fd90&gt;
</pre></div>
</div>
<img alt="../../_images/pca_svd_65_1.png" src="../../_images/pca_svd_65_1.png" />
</div>
</div>
<p>Observe that the rank-1 approximation projects each point in <span class="math notranslate nohighlight">\( \mathbf{X} \)</span> along the direction of the first principal direction.</p>
</div>
<div class="section" id="summary">
<h2><span class="section-number">25.2.5. </span>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>This section introduces the singular value decomposition and uses the SVD to perform principal components analysis for dimensionality reduction.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch/25"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="pca_dims.html" title="previous page"><span class="section-number">25.1. </span>Dimensions of a Data Table</a>
    <a class='right-next' id="next-link" href="pca_in_practice.html" title="next page"><span class="section-number">25.3. </span>PCA in Practice</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sam Lau, Joey Gonzalez, and Deb Nolan<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <p>
License: CC BY-NC-ND 4.0
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.d3f166471bb80abb5163.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-113006011-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>