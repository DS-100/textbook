
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>5.1. Cleaning the Calls Dataset &#8212; Principles and Techniques of Data Science</title>
    
  <link rel="stylesheet" href="../../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.2d2078699c18a0efb88233928e1cf6ed.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.be0a4a0c39cd630af62a2fcf693f3f06.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="5.2. Cleaning The Stops Dataset" href="cleaning_stops.html" />
    <link rel="prev" title="5. Data Cleaning" href="cleaning_intro.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  
  <h1 class="site-logo" id="site-title">Principles and Techniques of Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <p class="caption">
 <span class="caption-text">
  Frontmatter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../../prereqs.html">
   Prerequisites
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../notation.html">
   Notation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Chapters
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01/lifecycle_intro.html">
   1. The Data Science Lifecycle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/design_intro.html">
   2. Data Design
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/pandas_intro.html">
   3. Working with Tabular Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04/eda_intro.html">
   4. Exploratory Data Analysis
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="cleaning_intro.html">
   5. Data Cleaning
  </a>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     5.1. Cleaning the Calls Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_stops.html">
     5.2. Cleaning The Stops Dataset
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_structure.html">
     5.3. Structure
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_granularity.html">
     5.4. Granularity
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_scope.html">
     5.5. Scope
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_temp.html">
     5.6. Temporality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="cleaning_faithfulness.html">
     5.7. Faithfulness
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06/viz_intro.html">
   6. Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07/web_intro.html">
   7. Web Technologies
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08/text_intro.html">
   8. Working with Text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09/sql_intro.html">
   9. Relational Databases and SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10/modeling_intro.html">
   10. Modeling and Estimation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11/gradient_descent.html">
   11. Gradient Descent and Numerical Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../12/prob_and_gen.html">
   12. Probability and Generalization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../13/linear_models.html">
   13. Linear Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../14/feature_engineering.html">
   14. Feature Engineering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../15/bias_intro.html">
   15. The Bias-Variance Tradeoff
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../16/reg_intro.html">
   16. Regularization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../17/classification_intro.html">
   17. Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../18/hyp_intro.html">
   18. Statistical Inference
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendices
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../19/vector_space_review.html">
   Vector Space Review
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../20/ref_intro.html">
   Reference Tables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../21/contributors.html">
   Contributors
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/ch/05/cleaning_calls.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/ch/05/cleaning_calls.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/executablebooks/jupyter-book/blob/master/ch/05/cleaning_calls.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-the-data-generation">
   5.1.1. Understanding the Data Generation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#are-there-missing-values">
     5.1.1.1. Are there missing values?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#are-there-any-missing-values-that-were-filled-in">
     5.1.1.2. Are there any missing values that were filled in?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#which-parts-of-the-data-were-entered-by-a-human">
     5.1.1.3. Which parts of the data were entered by a human?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#final-touchups">
     5.1.1.4. Final Touchups
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># Ignore numpy dtype warnings. These warnings are caused by an interaction</span>
<span class="c1"># between numpy and Cython and can be safely ignored.</span>
<span class="c1"># Reference: https://stackoverflow.com/a/40846742</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.dtype size changed&quot;</span><span class="p">)</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">message</span><span class="o">=</span><span class="s2">&quot;numpy.ufunc size changed&quot;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">nbinteract</span> <span class="k">as</span> <span class="nn">nbi</span>

<span class="n">sns</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="s1">&#39;talk&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">threshold</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_rows</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">max_columns</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;precision&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1"># This option stops scientific notation for pandas</span>
<span class="c1"># pd.set_option(&#39;display.float_format&#39;, &#39;{:.2f}&#39;.format)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="cleaning-the-calls-dataset">
<h1><span class="section-number">5.1. </span>Cleaning the Calls Dataset<a class="headerlink" href="#cleaning-the-calls-dataset" title="Permalink to this headline">¶</a></h1>
<p>We will use the Berkeley Police Department’s publicly available datasets to demonstrate data cleaning techniques. We have downloaded the <a class="reference external" href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Calls-for-Service/k2nh-s5h5">Calls for Service dataset</a> and <a class="reference external" href="https://data.cityofberkeley.info/Public-Safety/Berkeley-PD-Stop-Data/6e9j-pj9p">Stops dataset</a>.</p>
<p>We can use the <code class="docutils literal notranslate"><span class="pre">ls</span></code> shell command with the <code class="docutils literal notranslate"><span class="pre">-lh</span></code> flags to see more details about the files:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>ls -lh data/
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>total 13936
-rw-r--r--@ 1 sam  staff   979K Aug 29 14:41 Berkeley_PD_-_Calls_for_Service.csv
-rw-r--r--@ 1 sam  staff    81B Aug 29 14:28 cvdow.csv
-rw-r--r--@ 1 sam  staff   5.8M Aug 29 14:41 stops.json
</pre></div>
</div>
</div>
</div>
<p>The command above shows the data files and their file sizes. This is especially useful because we now know the files are small enough to load into memory. As a rule of thumb, it is usually safe to load a file into memory that is around one fourth of the total memory capacity of the computer. For example, if a computer has 4GB of RAM we should be able to load a 1GB CSV file in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>. To handle larger datasets we will need additional computational tools that we will cover later in this book.</p>
<p>Notice the use of the exclamation point before <code class="docutils literal notranslate"><span class="pre">ls</span></code>. This tells Jupyter that the next line of code is a shell command, not a Python expression. We can run any available shell command in Jupyter using <code class="docutils literal notranslate"><span class="pre">!</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The `wc` shell command shows us how many lines each file has.</span>
<span class="c1"># We can see that the `stops.json` file has the most lines (29852).</span>
<span class="o">!</span>wc -l data/*
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   16497 data/Berkeley_PD_-_Calls_for_Service.csv
       8 data/cvdow.csv
   29852 data/stops.json
   46357 total
</pre></div>
</div>
</div>
</div>
<div class="section" id="understanding-the-data-generation">
<h2><span class="section-number">5.1.1. </span>Understanding the Data Generation<a class="headerlink" href="#understanding-the-data-generation" title="Permalink to this headline">¶</a></h2>
<p>We will state important questions you should ask of all datasets before data cleaning or processing. These questions are related to how the data were generated, so data cleaning will usually <strong>not</strong> be able to resolve issues that arise here.</p>
<p><strong>What do the data contain?</strong> The website for the Calls for Service data states that the dataset describes “crime incidents (not criminal reports) within the last 180 days”. Further reading reveals that “not all calls for police service are included (e.g. Animal Bite)”.</p>
<p>The website for the Stops data states that the dataset contains data on all “vehicle detentions (including bicycles) and pedestrian detentions (up to five persons)” since January 26, 2015.</p>
<p><strong>Are the data a census?</strong> This depends on our population of interest. For example, if we are interested in calls for service within the last 180 days for crime incidents then the Calls dataset is a census. However, if we are interested in calls for service within the last 10 years the dataset is clearly not a census. We can make similar statements about the Stops dataset since the data collection started on January 26, 2015.</p>
<p><strong>If the data form a sample, is it a probability sample?</strong> If we are investigating a period of time that the data do not have entries for, the data do not form a probability sample since there is no randomness involved in the data collection process — we have all data for certain time periods but no data for others.</p>
<p><strong>What limitations will this data have on our conclusions?</strong> Although we will ask this question at each step of our data processing, we can already see that our data impose important limitations. The most important limitation is that we cannot make unbiased estimations for time periods not covered by our datasets.</p>
<p>Let’s now clean the Calls dataset. The <code class="docutils literal notranslate"><span class="pre">head</span></code> shell command prints the first five lines of the file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>head data/Berkeley_PD_-_Calls_for_Service.csv
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CASENO,OFFENSE,EVENTDT,EVENTTM,CVLEGEND,CVDOW,InDbDate,Block_Location,BLKADDR,City,State
17091420,BURGLARY AUTO,07/23/2017 12:00:00 AM,06:00,BURGLARY - VEHICLE,0,08/29/2017 08:28:05 AM,&quot;2500 LE CONTE AVE
Berkeley, CA
(37.876965, -122.260544)&quot;,2500 LE CONTE AVE,Berkeley,CA
17020462,THEFT FROM PERSON,04/13/2017 12:00:00 AM,08:45,LARCENY,4,08/29/2017 08:28:00 AM,&quot;2200 SHATTUCK AVE
Berkeley, CA
(37.869363, -122.268028)&quot;,2200 SHATTUCK AVE,Berkeley,CA
17050275,BURGLARY AUTO,08/24/2017 12:00:00 AM,18:30,BURGLARY - VEHICLE,4,08/29/2017 08:28:06 AM,&quot;200 UNIVERSITY AVE
Berkeley, CA
(37.865491, -122.310065)&quot;,200 UNIVERSITY AVE,Berkeley,CA
</pre></div>
</div>
</div>
</div>
<p>It appears to be a comma-separated values (CSV) file, though it’s hard to tell whether the entire file is formatted properly. We can use <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> to read in the file as a DataFrame. If <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> errors, we will have to dig deeper and manually resolve formatting issues. Fortunately, <code class="docutils literal notranslate"><span class="pre">pd.read_csv</span></code> successfully returns a DataFrame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calls</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/Berkeley_PD_-_Calls_for_Service.csv&#39;</span><span class="p">)</span>
<span class="n">calls</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17050275</td>
      <td>BURGLARY AUTO</td>
      <td>08/24/2017 12:00:00 AM</td>
      <td>18:30</td>
      <td>...</td>
      <td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
      <td>200 UNIVERSITY AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5505</th>
      <td>17018126</td>
      <td>DISTURBANCE</td>
      <td>04/01/2017 12:00:00 AM</td>
      <td>12:22</td>
      <td>...</td>
      <td>1600 FAIRVIEW ST\nBerkeley, CA\n(37.850001, -1...</td>
      <td>1600 FAIRVIEW ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5506</th>
      <td>17090665</td>
      <td>THEFT MISD. (UNDER $950)</td>
      <td>04/01/2017 12:00:00 AM</td>
      <td>12:00</td>
      <td>...</td>
      <td>2000 DELAWARE ST\nBerkeley, CA\n(37.874489, -1...</td>
      <td>2000 DELAWARE ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5507</th>
      <td>17049700</td>
      <td>SEXUAL ASSAULT MISD.</td>
      <td>08/22/2017 12:00:00 AM</td>
      <td>20:02</td>
      <td>...</td>
      <td>2400 TELEGRAPH AVE\nBerkeley, CA\n(37.866761, ...</td>
      <td>2400 TELEGRAPH AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>5508 rows × 11 columns</p>
</div></div></div>
</div>
<p>We can define a function to show different slices of the data and then interact with it:</p>
<div class="cell tag_interactive docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">df_interact</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Outputs sliders that show rows and columns of df</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">peek</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">row</span><span class="p">:</span><span class="n">row</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">col</span><span class="p">:</span><span class="n">col</span> <span class="o">+</span> <span class="mi">6</span><span class="p">]</span>
    <span class="n">interact</span><span class="p">(</span><span class="n">peek</span><span class="p">,</span> <span class="n">row</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="mi">5</span><span class="p">),</span> <span class="n">col</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">6</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1"> rows, </span><span class="si">{}</span><span class="s1"> columns) total&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="n">df_interact</span><span class="p">(</span><span class="n">calls</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "967b6424709545f9bbb7f6517ce5e234", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5508 rows, 11 columns) total
</pre></div>
</div>
</div>
</div>
<p>Based on the output above, the resulting DataFrame looks reasonably well-formed since the columns are properly named and the data in each column seems to be entered consistently. What data does each column contain? We can look at the dataset website:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Type</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CASENO</p></td>
<td><p>Case Number</p></td>
<td><p>Number</p></td>
</tr>
<tr class="row-odd"><td><p>OFFENSE</p></td>
<td><p>Offense Type</p></td>
<td><p>Plain Text</p></td>
</tr>
<tr class="row-even"><td><p>EVENTDT</p></td>
<td><p>Date Event Occurred</p></td>
<td><p>Date &amp; Time</p></td>
</tr>
<tr class="row-odd"><td><p>EVENTTM</p></td>
<td><p>Time Event Occurred</p></td>
<td><p>Plain Text</p></td>
</tr>
<tr class="row-even"><td><p>CVLEGEND</p></td>
<td><p>Description of Event</p></td>
<td><p>Plain Text</p></td>
</tr>
<tr class="row-odd"><td><p>CVDOW</p></td>
<td><p>Day of Week Event Occurred</p></td>
<td><p>Number</p></td>
</tr>
<tr class="row-even"><td><p>InDbDate</p></td>
<td><p>Date dataset was updated in the portal</p></td>
<td><p>Date &amp; Time</p></td>
</tr>
<tr class="row-odd"><td><p>Block_Location</p></td>
<td><p>Block level address of event</p></td>
<td><p>Location</p></td>
</tr>
<tr class="row-even"><td><p>BLKADDR</p></td>
<td><p></p></td>
<td><p>Plain Text</p></td>
</tr>
<tr class="row-odd"><td><p>City</p></td>
<td><p></p></td>
<td><p>Plain Text</p></td>
</tr>
<tr class="row-even"><td><p>State</p></td>
<td><p></p></td>
<td><p>Plain Text</p></td>
</tr>
</tbody>
</table>
<p>On the surface the data looks easy to work with. However, before starting data analysis we must answer the following questions:</p>
<ol class="simple">
<li><p><strong>Are there missing values in the dataset?</strong> This question is important because missing values can represent many different things. For example, missing addresses could mean that locations were removed to protect anonymity, or that some respondents chose not to answer a survey question, or that a recording device broke.</p></li>
<li><p><strong>Are there any missing values that were filled in (e.g. a 999 for unknown age or 12:00am for unknown date)?</strong> These will clearly impact analysis if we ignore them.</p></li>
<li><p><strong>Which parts of the data were entered by a human?</strong> As we will soon see, human-entered data is filled with inconsistencies and mispellings.</p></li>
</ol>
<p>Although there are plenty more checks to go through, these three will suffice for many cases. See the <a class="reference external" href="https://github.com/Quartz/bad-data-guide">Quartz bad data guide</a> for a more complete list of checks.</p>
<div class="section" id="are-there-missing-values">
<h3><span class="section-number">5.1.1.1. </span>Are there missing values?<a class="headerlink" href="#are-there-missing-values" title="Permalink to this headline">¶</a></h3>
<p>This is a simple check in <code class="docutils literal notranslate"><span class="pre">pandas</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># True if row contains at least one null value</span>
<span class="n">null_rows</span> <span class="o">=</span> <span class="n">calls</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">calls</span><span class="p">[</span><span class="n">null_rows</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>116</th>
      <td>17014831</td>
      <td>BURGLARY AUTO</td>
      <td>03/16/2017 12:00:00 AM</td>
      <td>22:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>478</th>
      <td>17042511</td>
      <td>BURGLARY AUTO</td>
      <td>07/20/2017 12:00:00 AM</td>
      <td>16:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>486</th>
      <td>17022572</td>
      <td>VEHICLE STOLEN</td>
      <td>04/22/2017 12:00:00 AM</td>
      <td>21:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4945</th>
      <td>17091287</td>
      <td>VANDALISM</td>
      <td>07/01/2017 12:00:00 AM</td>
      <td>08:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>4947</th>
      <td>17038382</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>06/30/2017 12:00:00 AM</td>
      <td>15:00</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5167</th>
      <td>17091632</td>
      <td>VANDALISM</td>
      <td>08/15/2017 12:00:00 AM</td>
      <td>23:30</td>
      <td>...</td>
      <td>Berkeley, CA\n(37.869058, -122.270455)</td>
      <td>NaN</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>27 rows × 11 columns</p>
</div></div></div>
</div>
<p>It looks like 27 calls didn’t have a recorded address in BLKADDR. Unfortunately, the data description isn’t very clear on how the locations were recorded. We know that all of these calls were made for events in Berkeley, so we can likely assume that the addresses for these calls were originally somewhere in Berkeley.</p>
</div>
<div class="section" id="are-there-any-missing-values-that-were-filled-in">
<h3><span class="section-number">5.1.1.2. </span>Are there any missing values that were filled in?<a class="headerlink" href="#are-there-any-missing-values-that-were-filled-in" title="Permalink to this headline">¶</a></h3>
<p>From the missing value check above we can see that the Block_Location column has Berkeley, CA recorded if the location was missing.</p>
<p>In addition, an inspection of the <code class="docutils literal notranslate"><span class="pre">calls</span></code> table shows us that the EVENTDT column has the correct dates but records 12am for all of its times. Instead, the times are in the EVENTTM column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the first 7 rows of the table again for reference</span>
<span class="n">calls</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>Block_Location</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE\nBerkeley, CA\n(37.876965, -...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE\nBerkeley, CA\n(37.869363, -...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>2</th>
      <td>17050275</td>
      <td>BURGLARY AUTO</td>
      <td>08/24/2017 12:00:00 AM</td>
      <td>18:30</td>
      <td>...</td>
      <td>200 UNIVERSITY AVE\nBerkeley, CA\n(37.865491, ...</td>
      <td>200 UNIVERSITY AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>3</th>
      <td>17019145</td>
      <td>GUN/WEAPON</td>
      <td>04/06/2017 12:00:00 AM</td>
      <td>17:30</td>
      <td>...</td>
      <td>1900 SEVENTH ST\nBerkeley, CA\n(37.869318, -12...</td>
      <td>1900 SEVENTH ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>4</th>
      <td>17044993</td>
      <td>VEHICLE STOLEN</td>
      <td>08/01/2017 12:00:00 AM</td>
      <td>18:00</td>
      <td>...</td>
      <td>100 PARKSIDE DR\nBerkeley, CA\n(37.854247, -12...</td>
      <td>100 PARKSIDE DR</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>5</th>
      <td>17037319</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>06/28/2017 12:00:00 AM</td>
      <td>12:00</td>
      <td>...</td>
      <td>1500 PRINCE ST\nBerkeley, CA\n(37.851503, -122...</td>
      <td>1500 PRINCE ST</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>6</th>
      <td>17030791</td>
      <td>BURGLARY RESIDENTIAL</td>
      <td>05/30/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>300 MENLO PL\nBerkeley, CA\n</td>
      <td>300 MENLO PL</td>
      <td>Berkeley</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
<p>7 rows × 11 columns</p>
</div></div></div>
</div>
<p>As a data cleaning step, we want to merge the EVENTDT and EVENTTM columns to record both date and time in one field. If we define a function that takes in a DF and returns a new DF, we can later use <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.pipe.html"><code class="docutils literal notranslate"><span class="pre">pd.pipe</span></code></a> to apply all transformations in one go.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">combine_event_datetimes</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="n">combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span>
        <span class="c1"># Combine date and time strings</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;EVENTDT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;EVENTTM&#39;</span><span class="p">],</span>
        <span class="n">infer_datetime_format</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">EVENTDTTM</span><span class="o">=</span><span class="n">combined</span><span class="p">)</span>

<span class="c1"># To peek at the result without mutating the calls DF:</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
      <th>EVENTDTTM</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>2017-07-23 06:00:00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>2200 SHATTUCK AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>2017-04-13 08:45:00</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 12 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="which-parts-of-the-data-were-entered-by-a-human">
<h3><span class="section-number">5.1.1.3. </span>Which parts of the data were entered by a human?<a class="headerlink" href="#which-parts-of-the-data-were-entered-by-a-human" title="Permalink to this headline">¶</a></h3>
<p>It looks like most of the data columns are machine-recorded, including the date, time, day of week, and location of the event.</p>
<p>In addition, the OFFENSE and CVLEGEND columns appear to contain consistent values. We can check the unique values in each column to see if anything was misspelled:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;OFFENSE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;BURGLARY AUTO&#39;, &#39;THEFT FROM PERSON&#39;, &#39;GUN/WEAPON&#39;,
       &#39;VEHICLE STOLEN&#39;, &#39;BURGLARY RESIDENTIAL&#39;, &#39;VANDALISM&#39;,
       &#39;DISTURBANCE&#39;, &#39;THEFT MISD. (UNDER $950)&#39;, &#39;THEFT FROM AUTO&#39;,
       &#39;DOMESTIC VIOLENCE&#39;, &#39;THEFT FELONY (OVER $950)&#39;, &#39;ALCOHOL OFFENSE&#39;,
       &#39;MISSING JUVENILE&#39;, &#39;ROBBERY&#39;, &#39;IDENTITY THEFT&#39;,
       &#39;ASSAULT/BATTERY MISD.&#39;, &#39;2ND RESPONSE&#39;, &#39;BRANDISHING&#39;,
       &#39;MISSING ADULT&#39;, &#39;NARCOTICS&#39;, &#39;FRAUD/FORGERY&#39;,
       &#39;ASSAULT/BATTERY FEL.&#39;, &#39;BURGLARY COMMERCIAL&#39;, &#39;MUNICIPAL CODE&#39;,
       &#39;ARSON&#39;, &#39;SEXUAL ASSAULT FEL.&#39;, &#39;VEHICLE RECOVERED&#39;,
       &#39;SEXUAL ASSAULT MISD.&#39;, &#39;KIDNAPPING&#39;, &#39;VICE&#39;, &#39;HOMICIDE&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;CVLEGEND&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;BURGLARY - VEHICLE&#39;, &#39;LARCENY&#39;, &#39;WEAPONS OFFENSE&#39;,
       &#39;MOTOR VEHICLE THEFT&#39;, &#39;BURGLARY - RESIDENTIAL&#39;, &#39;VANDALISM&#39;,
       &#39;DISORDERLY CONDUCT&#39;, &#39;LARCENY - FROM VEHICLE&#39;, &#39;FAMILY OFFENSE&#39;,
       &#39;LIQUOR LAW VIOLATION&#39;, &#39;MISSING PERSON&#39;, &#39;ROBBERY&#39;, &#39;FRAUD&#39;,
       &#39;ASSAULT&#39;, &#39;NOISE VIOLATION&#39;, &#39;DRUG VIOLATION&#39;,
       &#39;BURGLARY - COMMERCIAL&#39;, &#39;ALL OTHER OFFENSES&#39;, &#39;ARSON&#39;, &#39;SEX CRIME&#39;,
       &#39;RECOVERED VEHICLE&#39;, &#39;KIDNAPPING&#39;, &#39;HOMICIDE&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Since each value in these columns appears to be spelled correctly, we won’t have to perform any corrections on these columns.</p>
<p>We also check the BLKADDR column for inconsistencies and find that sometimes an address is recorded (e.g. 2500 LE CONTE AVE) but other times a cross street is recorded (e.g. ALLSTON WAY &amp; FIFTH ST). This suggests that a human entered this data in and this column will be difficult to use for analysis. Fortunately we can use the latitude and longitude of the event instead of the street address.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calls</span><span class="p">[</span><span class="s1">&#39;BLKADDR&#39;</span><span class="p">][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5001</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0            2500 LE CONTE AVE
5001    ALLSTON WAY &amp; FIFTH ST
Name: BLKADDR, dtype: object
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="final-touchups">
<h3><span class="section-number">5.1.1.4. </span>Final Touchups<a class="headerlink" href="#final-touchups" title="Permalink to this headline">¶</a></h3>
<p>This dataset seems almost ready for analysis. The Block_Location column seems to contain strings that record address, latitude, and longitude. We will want to separate the latitude and longitude for easier use.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">split_lat_lon</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="n">calls</span><span class="p">[</span><span class="s1">&#39;Block_Location&#39;</span><span class="p">]</span>
        <span class="c1"># Get coords from string</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># Remove parens from coords</span>
        <span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="c1"># Split latitude and longitude</span>
        <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="s1">&#39;Latitude&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="s1">&#39;Longitude&#39;</span><span class="p">})</span>
    <span class="p">)</span>

<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>City</th>
      <th>State</th>
      <th>Latitude</th>
      <th>Longitude</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>37.876965</td>
      <td>-122.260544</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17020462</td>
      <td>THEFT FROM PERSON</td>
      <td>04/13/2017 12:00:00 AM</td>
      <td>08:45</td>
      <td>...</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>37.869363</td>
      <td>-122.268028</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 13 columns</p>
</div></div></div>
</div>
<p>Then, we can match the day of week number with its weekday:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This DF contains the day for each number in CVDOW</span>
<span class="n">day_of_week</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/cvdow.csv&#39;</span><span class="p">)</span>
<span class="n">day_of_week</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CVDOW</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Monday</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Tuesday</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Wednesday</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Thursday</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>Friday</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>Saturday</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">match_weekday</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">day_of_week</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;CVDOW&#39;</span><span class="p">)</span>
<span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CASENO</th>
      <th>OFFENSE</th>
      <th>EVENTDT</th>
      <th>EVENTTM</th>
      <th>...</th>
      <th>BLKADDR</th>
      <th>City</th>
      <th>State</th>
      <th>Day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>17091420</td>
      <td>BURGLARY AUTO</td>
      <td>07/23/2017 12:00:00 AM</td>
      <td>06:00</td>
      <td>...</td>
      <td>2500 LE CONTE AVE</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>Sunday</td>
    </tr>
    <tr>
      <th>1</th>
      <td>17038302</td>
      <td>BURGLARY AUTO</td>
      <td>07/02/2017 12:00:00 AM</td>
      <td>22:00</td>
      <td>...</td>
      <td>BOWDITCH STREET &amp; CHANNING WAY</td>
      <td>Berkeley</td>
      <td>CA</td>
      <td>Sunday</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 12 columns</p>
</div></div></div>
</div>
<p>We’ll drop columns we no longer need:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drop_unneeded_cols</span><span class="p">(</span><span class="n">calls</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">calls</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;CVDOW&#39;</span><span class="p">,</span> <span class="s1">&#39;InDbDate&#39;</span><span class="p">,</span> <span class="s1">&#39;Block_Location&#39;</span><span class="p">,</span> <span class="s1">&#39;City&#39;</span><span class="p">,</span>
                               <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENTDT&#39;</span><span class="p">,</span> <span class="s1">&#39;EVENTTM&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we’ll pipe the <code class="docutils literal notranslate"><span class="pre">calls</span></code> DF through all the functions we’ve defined:</p>
<div class="cell tag_interactive docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">calls_final</span> <span class="o">=</span> <span class="p">(</span><span class="n">calls</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">combine_event_datetimes</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">split_lat_lon</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">match_weekday</span><span class="p">)</span>
               <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_unneeded_cols</span><span class="p">))</span>
<span class="n">df_interact</span><span class="p">(</span><span class="n">calls_final</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id": "180d3f2d1d494fdeb26f3228a56f6758", "version_major": 2, "version_minor": 0}
</script><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5508 rows, 8 columns) total
</pre></div>
</div>
</div>
</div>
<p>The Calls dataset is now ready for further data analysis. In the next section, we will clean the Stops dataset.</p>
<div class="cell tag_hide_input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HIDDEN</span>
<span class="c1"># Save data to CSV for other chapters</span>
<span class="c1"># calls_final.to_csv(&#39;../ch5/data/calls.csv&#39;, index=False)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch/05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="cleaning_intro.html" title="previous page"><span class="section-number">5. </span>Data Cleaning</a>
    <a class='right-next' id="next-link" href="cleaning_stops.html" title="next page"><span class="section-number">5.2. </span>Cleaning The Stops Dataset</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sam Lau, Joey Gonzalez, and Deb Nolan<br/>
        
            &copy; Copyright 2020.<br/>
          <div class="extra_footer">
            <p>
License: CC BY-NC-ND 4.0
</p>

          </div>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../../_static/js/index.3da636dd464baa7582d2.js"></script>


    
    <!-- Google Analytics -->
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-113006011-1', 'auto');
      ga('set', 'anonymizeIp', true);
      ga('send', 'pageview');
    </script>
    <script async src='https://www.google-analytics.com/analytics.js'></script>
    <!-- End Google Analytics -->
    
  </body>
</html>